<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="ja">
<!-- Created on October, 1  2005 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=euc-jp">
<META NAME="keywords" CONTENT="meadow,mule,emacs,lisp,elisp,gnus,setting,設定,unix,cygwin">
<META http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="description" CONTENT="Meadowの設定を紹介するページです">
<TITLE>GNU Emacs Lispリファレンスマニュアル:  カレンダーと日誌のカスタマイズ</TITLE>

<META NAME="description" CONTENT="GNU Emacs Lispリファレンスマニュアル:  カレンダーと日誌のカスタマイズ">
<META NAME="keywords" CONTENT="GNU Emacs Lispリファレンスマニュアル:  カレンダーと日誌のカスタマイズ">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

<LINK REL="contents" HREF="elisp_toc.html#SEC_Contents">
<LINK REL="index" HREF="elisp_48.html#SEC681">
<LINK REL="next" HREF="elisp_40.html#SEC636">
<LINK REL="prev" HREF="elisp_38.html#SEC599">

<META http-equiv="Content-Style-Type" content="text/css">
<!-- 鶯と龜 ←日本語EUC誤判別対策用らしい; -->
<link rel="StyleSheet" href="../../../../soft/css/midnight.css" type="text/css" id="css1">
<script type="text/javascript" src="style1.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../soft/css/meadowmemo.css">

</HEAD>
<BODY LANG="ja" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<!--Infoseek Analyzer start-->
<script LANGUAGE="javascript">PgNo=6;</script>
<script src="http://js1.infoseek.co.jp/bin/57/00170.js"></script>
<noscript><a href="http://ax1.www.infoseek.co.jp/bin/go?0017057f" target="_blank">
<img src="http://ax1.www.infoseek.co.jp/bin/logo?0017057f" border=0></a></noscript>
<!--Infoseek Analyzer end-->
<a name="top"> </a>

<br><A NAME="SEC625"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_38.html#SEC624"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC626"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_38.html#SEC599"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_40.html#SEC636"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Calendar"></A>
<H1> 38. カレンダーと日誌のカスタマイズ </H1>
<!--docid::SEC625::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Calendar">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Calendar</a>"<br>
"texi/elisp21/カレンダーと日誌のカスタマイズ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AB%A5%EC%A5%F3%A5%C0%A1%BC%A4%C8%C6%FC%BB%EF%A4%CE%A5%AB%A5%B9%A5%BF%A5%DE%A5%A4%A5%BA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

カレンダーや日誌を個人の好みに合わせるための
カスタマイズ項目がたくさんあります。
<P>

<div class="menuindex"><SCRIPT language=JavaScript src="index38.js"></SCRIPT></div><noscript><BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_39.html#SEC626">38.1 カレンダーのカスタマイズ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Defaults you can set.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_39.html#SEC627">38.2 祝祭日のカスタマイズ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Defining your own holidays.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_39.html#SEC628">38.3 日付表示書式</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Changing the format.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_39.html#SEC629">38.4 時刻表示書式</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Changing the format.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_39.html#SEC630">38.5 夏時間</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Changing the default.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_39.html#SEC631">38.6 日誌のカスタマイズ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Defaults you can set.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_39.html#SEC632">38.7 ヘブライ暦日付やイスラム暦日付の日誌記録</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to obtain them.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_39.html#SEC633">38.8 装飾日誌表示</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Enhancing the diary display, sorting entries, 
                             using included diary files.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_39.html#SEC634">38.9 S式項目と装飾日誌表示</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Fancy things you can do.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_39.html#SEC635">38.10 約束の警告表示のカスタマイズ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Customizing appointment reminders.</TD></TR>
</TABLE></BLOCKQUOTE></noscript>
<P>

<A NAME="Calendar Customizing"></A>
<HR SIZE="6">
<br><A NAME="SEC626"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC625"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC627"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Calendar Customizing"></A>
<H2> 38.1 カレンダーのカスタマイズ </H2>
<!--docid::SEC626::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Calendar%20Customizing">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Calendar%20Customizing</a>"<br>
"texi/elisp21/カレンダーのカスタマイズ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AB%A5%EC%A5%F3%A5%C0%A1%BC%A4%CE%A5%AB%A5%B9%A5%BF%A5%DE%A5%A4%A5%BA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX3007"></A>
<P>

変数<CODE>view-diary-entries-initially</CODE>に<CODE>t</CODE>を設定しておくと、
カレンダーを呼び出すと現在の日に対する日誌記録を自動的に表示できます。
その日がウィンドウで見える場合に限って日誌記録が表示されます。
つぎの行、
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(setq view-diary-entries-initially t)
(calendar)
</pre></td></tr></table><P>

を個人のファイル`<TT>.emacs</TT>'に入れておくと、
Emacsを起動するたびに、カレンダーと日誌の両者のウィンドウを表示します。
<P>

<A NAME="IDX3008"></A>
同様に、変数<CODE>view-calendar-holidays-initially</CODE>に
<CODE>t</CODE>を設定しておくと、
カレンダーに入ると自動的に3か月分の祝祭日一覧を表示します。
祝祭日一覧は別のウィンドウに現れます。
<P>

<A NAME="IDX3009"></A>
変数<CODE>mark-diary-entries-in-calendar</CODE>に<CODE>t</CODE>を設定すると、
日誌に入れてある日付に印を付けられます。
カレンダーのウィンドウ内容を再計算するときにこの効果が現れます。
これらの日付に印を付ける方法は2つあります。
ディスプレイで使えるならばフェイス（see 節 <A HREF="elisp_38.html#SEC611">37.10 フェイス</A>）を変更するか、
日付にプラス記号（`<SAMP>+</SAMP>'）を付加します。
<P>

<A NAME="IDX3010"></A>
同様に、変数<CODE>mark-holidays-in-calendar</CODE>に<CODE>t</CODE>を設定すると、
フェイスを変えるかアスタリスク（`<SAMP>*</SAMP>'）を付加することで
祝祭日に印を付けられます。
<P>

<A NAME="IDX3011"></A>
<A NAME="IDX3012"></A>
変数<CODE>calendar-holiday-marker</CODE>は、
祝祭日の日付にどのように印を付けるかを指定します。
その値は、日付に付加する文字か日付の表示に使うフェイス名です。
同様に、変数<CODE>diary-entry-marker</CODE>は、
日誌に入っている日付にどのように印を付けるかを指定します。
カレンダー（calendar）モードは、このような目的のために
<CODE>holiday-face</CODE>と<CODE>diary-face</CODE>という名前のフェイスを作成します。
Emacsが端末で複数のフェイスを扱える場合には、
これらの変数のデフォルト値はこれらのシンボルです。
<P>

<A NAME="IDX3013"></A>
変数<CODE>calendar-load-hook</CODE>は、
（カレンダーを実際に表示し始めるまえに）カレンダーパッケージを初めて
ロードしたときに実行されるノーマルフックです。
<P>

<A NAME="IDX3014"></A>
カレンダーを開始するとノーマルフック<CODE>initial-calendar-window-hook</CODE>を
実行します。
カレンダーの表示を再計算してもこのフックは実行されません。
しかし、コマンド<KBD>q</KBD>でカレンダーを抜けてから再度カレンダーに入ると
このフックを再度実行します。
<P>

<A NAME="IDX3015"></A>
変数<CODE>today-visible-calendar-hook</CODE>は、
今日の日付がウィンドウで見えるときに
カレンダーバッファにカレンダーの準備を終えてから実行される
ノーマルフックです。
このフックの1つの用途は、今日の日付をアスタリスクで置き換えることです。
それにはフック関数<CODE>calendar-star-date</CODE>を使います。
<P>

<A NAME="IDX3016"></A>
<TABLE><tr><td>&nbsp;</td><td class=example><pre>(add-hook 'today-visible-calendar-hook 'calendar-star-date)
</pre></td></tr></table><P>

他の標準的なフック関数は、フェイスを変更するかアスタリスクを付加することで
現在の日付に印を付けます。
つぎのように使います。
<P>

<A NAME="IDX3017"></A>
<TABLE><tr><td>&nbsp;</td><td class=example><pre>(add-hook 'today-visible-calendar-hook 'calendar-mark-today)
</pre></td></tr></table><P>

<A NAME="IDX3018"></A>
変数<CODE>calendar-today-marker</CODE>は、
今日の日付の印の付け方を指定します。
その値は、日付に付加する文字か日付の表示に使うフェイス名です。
この目的のために<CODE>calendar-today-face</CODE>という名前のフェイスがあります。
Emacsが端末で複数のフェイスを扱える場合には、
この変数のデフォルト値はこのシンボルです。
<P>

<A NAME="IDX3019"></A>
同様なノーマルフック<CODE>today-invisible-calendar-hook</CODE>は、
現在の日付がウィンドウで見え<EM>ない</EM>ときに実行されます。
<P>

<A NAME="Holiday Customizing"></A>
<HR SIZE="6">
<br><A NAME="SEC627"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC626"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC628"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Holiday Customizing"></A>
<H2> 38.2 祝祭日のカスタマイズ </H2>
<!--docid::SEC627::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Holiday%20Customizing">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Holiday%20Customizing</a>"<br>
"texi/elisp21/祝祭日のカスタマイズ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BD%CB%BA%D7%C6%FC%A4%CE%A5%AB%A5%B9%A5%BF%A5%DE%A5%A4%A5%BA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX3020"></A>
<A NAME="IDX3021"></A>
<A NAME="IDX3022"></A>
<A NAME="IDX3023"></A>
Emacsは、複数のリストの中の1つのリストに入っている項目群で
定義される祝祭日を把握しています。
これらの祝祭日のリストに祝祭日を追加したり削除して
個人の目的に合うようにカスタマイズできます。
Emacsが使用する祝祭日のリストは、
一般祝祭日（<CODE>general-holidays</CODE>）、
地域祝祭日（<CODE>local-holidays</CODE>）、
キリスト教祝祭日（<CODE>christian-holidays</CODE>）、
ヘブライ（ユダヤ教）祝祭日（<CODE>hebrew-holidays</CODE>）、
イスラム（回教徒）祝祭日（<CODE>islamic-holidays</CODE>）、
その他の祝祭日（<CODE>other-holidays</CODE>）です。
<P>

<A NAME="IDX3024"></A>
一般祝祭日は、デフォルトでは、合州国に共通の祝祭日です。
これらの祝祭日を削除するには、<CODE>general-holidays</CODE>に<CODE>nil</CODE>を設定します。
<P>

<A NAME="IDX3025"></A>
デフォルトの地域祝祭日はありません（サイトによってはある）。
以下に述べるように、
変数<CODE>local-holidays</CODE>に祝祭日の任意のリストを設定できます。
<P>

<A NAME="IDX3026"></A>
<A NAME="IDX3027"></A>
<A NAME="IDX3028"></A>
デフォルトでは、Emacsが承知している宗教のすべての祝祭日が
Emacsに入っているのではなく、世俗的なカレンダーに共通するものだけです。
宗教上の祝祭日を網羅的に入れるには、
<CODE>all-christian-calendar-holidays</CODE>、
<CODE>all-hebrew-calendar-holidays</CODE>、
<CODE>all-islamic-calendar-holidays</CODE>の変数のいずれか（あるいは、すべて）に
<CODE>t</CODE>を設定します。
宗教上の祝祭日を削除するには、対応する
<CODE>christian-holidays</CODE>、<CODE>hebrew-holidays</CODE>、
<CODE>islamic-holidays</CODE>の変数のいずれか（あるいは、すべて）に
<CODE>nil</CODE>を設定します。
<P>

<A NAME="IDX3029"></A>
変数<CODE>other-holidays</CODE>には、祝祭日の任意のリストを設定できます。
このリストは、普通は空ですが、個人的な使用を意図しています。
<P>

<A NAME="IDX3030"></A>
リスト（<CODE>general-holidays</CODE>、<CODE>local-holidays</CODE>、
<CODE>christian-holidays</CODE>、<CODE>hebrew-holidays</CODE>、
<CODE>islamic-holidays</CODE>、<CODE>other-holidays</CODE>）のおのおのは、
祝祭日（あるいは祝祭日のリスト）を記述する
<EM>祝祭日形式</EM>（holiday form）から成るリストです。
<P>

可能な祝祭日形式の一覧をつぎに示します。
月と日は1から数えますが、『曜日』は日曜日を0と数えます。
要素<VAR>string</VAR>は、文字列で表した祝祭日の名称です。
<P>

<DL COMPACT>
<DT><CODE>(holiday-fixed <VAR>month</VAR> <VAR>day</VAR> <VAR>string</VAR>)</CODE>
<DD>グレゴリオ暦の固定した日付。
<P>

<DT><CODE>(holiday-float <VAR>month</VAR> <VAR>dayname</VAR> <VAR>k</VAR> <VAR>string</VAR>)</CODE>
<DD>グレゴリオ暦の<VAR>month</VAR>月の<VAR>k</VAR>番目の曜日<VAR>dayname</VAR>。
（日曜日は<VAR>dayname</VAR>=0、…。）
<VAR>k</VAR>が負であると、月末から数える。
<P>

<DT><CODE>(holiday-hebrew <VAR>month</VAR> <VAR>day</VAR> <VAR>string</VAR>)</CODE>
<DD>ヘブライ暦の固定した日付。
<P>

<DT><CODE>(holiday-islamic <VAR>month</VAR> <VAR>day</VAR> <VAR>string</VAR>)</CODE>
<DD>イスラム暦の固定した日付。
<P>

<DT><CODE>(holiday-julian <VAR>month</VAR> <VAR>day</VAR> <VAR>string</VAR>)</CODE>
<DD>ユリウス暦の固定した日付。
<P>

<DT><CODE>(holiday-sexp <VAR>sexp</VAR> <VAR>string</VAR>)</CODE>
<DD>Lisp式<VAR>sexp</VAR>で計算される日付。
計算式では、年として変数<CODE>year</CODE>を使い、祝祭日の日付を返す。
あるいは、その年に該当する祝祭日がなければ<CODE>nil</CODE>を返す。
<VAR>sexp</VAR>の値は、<CODE>(<VAR>month</VAR> <VAR>day</VAR> <VAR>year</VAR>)</CODE>の形の
リストで表した日付であること。
<P>

<DT><CODE>(if <VAR>condition</VAR> <VAR>holiday-form</VAR>)</CODE>
<DD>条件<VAR>condition</VAR>が真である場合にのみ祝祭日になる。
<P>

<DT><CODE>(<VAR>function</VAR> [<VAR>args</VAR>])</CODE>
<DD>引数<VAR>args</VAR>で関数<VAR>function</VAR>を呼び出して計算される日付のリスト。
</DL>
<P>

たとえば、フランスで7月14日に祝われる革命記念日（Bastille Day）を
扱えるようにするにはつぎのようにします。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(setq other-holidays '((holiday-fixed 7 14 "Bastille Day")))
</FONT></pre></td></tr></table><P>

祝祭日形式 <CODE>(holiday-fixed 7 14 "Bastille Day")</CODE>は、
7の月（7月）の14日目を指定します。
<P>

多くの祝祭日は、特定の月の特定の週にあります。
バージン諸島で4月の第4月曜日に祝われる
ハリケーン祈願日（Hurricane Supplication Day）を記述する
祝祭日形式はつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(holiday-float 8 1 4 "Hurricane Supplication Day")
</FONT></pre></td></tr></table><P>

ここで、8は8月、1は月曜日（日曜日は0、火曜日は2といった具合）、4は
その月の4回目（1は最初、2は2回目、-1は最後、-2は最後の1つまえ
といった具合）を意味します。
<P>

ヘブライ暦、イスラム暦、ユリウス暦の固定した日付の祝祭日も指定できます。
たとえば、
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(setq other-holidays
      '((holiday-hebrew 10 2 "Last day of Hanukkah")
        (holiday-islamic 3 12 "Mohammed's Birthday")
        (holiday-julian 4 2 "Jefferson's Birthday")))
</FONT></pre></td></tr></table><P>

は、ハヌカー祭の最終日（ヘブライ暦の月はニサンNisanを1と数える）、
イスラムが祝うモハメッドの誕生日
（イスラム暦の月はムハラMuharramを1と数える）、
ユリウス暦の1743年4月2日のトーマスジェファーソンの誕生日を
追加します。
<P>

条件付きの祝祭日を含めるには、Emacs Lispの<CODE>if</CODE>や<CODE>holiday-sexp</CODE>を
使います。
たとえば、アメリカ大統領選挙は、4で割り切れる年の11月の第1月曜日の
あとの最初の火曜日に行われます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(holiday-sexp (if (= 0 (% year 4))
                   (calendar-gregorian-from-absolute
                    (1+ (calendar-dayname-on-or-before
                          1 (+ 6 (calendar-absolute-from-gregorian
                                  (list 11 1 year))))))
              "US Presidential Election"))
</FONT></pre></td></tr></table><P>

あるいは、
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(if (= 0 (% displayed-year 4))
    (fixed 11
           (extract-calendar-day
             (calendar-gregorian-from-absolute
               (1+ (calendar-dayname-on-or-before
                     1 (+ 6 (calendar-absolute-from-gregorian
                              (list 11 1 displayed-year)))))))
           "US Presidential Election"))
</FONT></pre></td></tr></table><P>

特別な計算を必要とする祝祭日は、これまでの形式にあてはまりません。
そのような場合、計算を行うLisp関数を書く必要があります。
たとえば、日食月食を含めるには、
<CODE>other-holidays</CODE>に<CODE>(eclipses)</CODE>を追加して、
以下のような形でカレンダーウィンドウの見えている範囲の期間内の
対応するグレゴリオ暦の日付の（空である可能性もある）リストを
返すEmacs Lisp関数<CODE>(eclipses)</CODE>を書きます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(((6 27 1991) "Lunar Eclipse") ((7 11 1991) "Solar Eclipse") ... )
</FONT></pre></td></tr></table><P>

<A NAME="Date Display Format"></A>
<HR SIZE="6">
<br><A NAME="SEC628"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC627"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC629"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Date Display Format"></A>
<H2> 38.3 日付表示書式 </H2>
<!--docid::SEC628::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Date%20Display%20Format">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Date%20Display%20Format</a>"<br>
"texi/elisp21/日付表示書式"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C6%FC%C9%D5%C9%BD%BC%A8%BD%F1%BC%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX3031"></A>
<P>

日誌、モード行、メッセージに現れる日付の表示方法は、
<CODE>calendar-date-display-form</CODE>を設定することでカスタマイズできます。
この変数は、
文字列で表した数字が入った<CODE>month</CODE>、<CODE>day</CODE>、<CODE>year</CODE>の各変数と、
英字の文字列が入った<CODE>monthname</CODE>と<CODE>dayname</CODE>の各変数を
用いた式のリストを保持しています。
アメリカスタイルでは、このリストのデフォルト値はつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>((if dayname (concat dayname ", ")) monthname " " day ", " year)
</FONT></pre></td></tr></table><P>

一方、ヨーロッパスタイルでは、この値のデフォルトはつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>((if dayname (concat dayname ", ")) day " " monthname " " year)
</FONT></pre></td></tr></table><P>

ISO規格の日付の表記法はつぎのとおりです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(year "-" month "-" day)
</FONT></pre></td></tr></table><P>

典型的なアメリカの書式はつぎのとおりです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(month "/" day "/" (substring year -2))
</FONT></pre></td></tr></table><P>

<A NAME="Time Display Format"></A>
<HR SIZE="6">
<br><A NAME="SEC629"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC628"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC630"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Time Display Format"></A>
<H2> 38.4 時刻表示書式 </H2>
<!--docid::SEC629::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Time%20Display%20Format">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Time%20Display%20Format</a>"<br>
"texi/elisp21/時刻表示書式"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BB%FE%B9%EF%C9%BD%BC%A8%BD%F1%BC%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX3032"></A>
<P>

カレンダーと日誌はデフォルトではアメリカスタイル、
つまり、12時制で時刻を表示します。
ヨーロッパスタイルやアメリカ軍の24時制を好むならば、
変数<CODE>calendar-time-display-form</CODE>を変更します。
この変数は、
文字列で表した数字が入った<CODE>12-hours</CODE>、<CODE>24-hours</CODE>、
<CODE>minutes</CODE>の各変数と、
英字の文字列が入った<CODE>am-pm</CODE>と<CODE>time-zone</CODE>の各変数を
用いた式のリストを保持しています。
<CODE>calendar-time-display-form</CODE>のデフォルト値はつぎのとおりです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(12-hours ":" minutes am-pm
          (if time-zone " (") time-zone (if time-zone ")"))
</FONT></pre></td></tr></table><P>

つぎの値では、ヨーロッパスタイルの時刻になります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(24-hours ":" minutes
          (if time-zone " (") time-zone (if time-zone ")"))
</FONT></pre></td></tr></table><P>

<A NAME="Daylight Savings"></A>
<HR SIZE="6">
<br><A NAME="SEC630"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC629"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC631"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Daylight Savings"></A>
<H2> 38.5 夏時間 </H2>
<!--docid::SEC630::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Daylight%20Savings">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Daylight%20Savings</a>"<br>
"texi/elisp21/夏時間"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B2%C6%BB%FE%B4%D6">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX3033"></A>
<P>

Emacsは、標準時間と夏時間の違いを理解しています。
つまり、日出入時刻、夏至冬至、春分秋分、朔弦望ではその違いを考慮します。
夏時間の規則は、地域ごと、年ごとに変わりえます。
正しく扱うためには、どの規則が適用されるかをEmacsが知っている必要があります。
<P>

読者の居住地域に適用される規則を記録している
オペレーティングシステムもあります。
これらのシステム上では、Emacsは自動的にシステムから必要な情報を得られます。
この情報の一部やすべてが欠落していると、
GNU世界の中心であるマサチューセッツ州ケンブリッジで
現在使用している規則で補います。
<P>

<A NAME="IDX3034"></A>
<A NAME="IDX3035"></A>
デフォルトで選んだ規則が読者の地域に適切でないときには、
変数<CODE>calendar-daylight-savings-starts</CODE>と
<CODE>calendar-daylight-savings-ends</CODE>に設定してEmacsに伝えます。
これらの値は、変数<CODE>year</CODE>を使ったLisp式である必要があります。
これらの式を評価すると、夏時間を開始／終了するグレゴリオ暦の日付を表す
<CODE>(<VAR>month</VAR> <VAR>day</VAR> <VAR>year</VAR>)</CODE>の形のリストに
なる必要があります。
夏時間をとらない場合には、値は<CODE>nil</CODE>であるべきです。
<P>

Emacsは、これらの式を用いて夏時間の開始と終了を判定し、
祝祭日や太陽／月に関する時刻を補正します。
<P>

マサチューセッツ州ケンブリッジに対する値は、つぎのとおりです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(calendar-nth-named-day 1 0 4 year)
(calendar-nth-named-day -1 0 10 year)
</pre></td></tr></table><P>

つまり、指定された<CODE>year</CODE>年の4月の最初の日曜日と
その年の10月の最後の日曜日です。
10月1日に夏時間を始めると変更したとすると、
変数<CODE>calendar-daylight-savings-starts</CODE>に
つぎのように設定します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(list 10 1 year)
</pre></td></tr></table><P>

より複雑な例として、ヘブライ暦のニサンの初日に夏時間が始まるとしましょう。
<CODE>calendar-daylight-savings-starts</CODE>には、
つぎの値を設定します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(calendar-gregorian-from-absolute
  (calendar-absolute-from-hebrew
    (list 1 1 (+ year 3760))))
</pre></td></tr></table><P>

これは、ニサンはヘブライ暦の最初の月であり、
ヘブライ暦年とグレゴリオ暦年はニサンで3760年違うからです。
<P>

読者の地域で夏時間をとっていなかったり、
つねに標準時間を望む場合には、
<CODE>calendar-daylight-savings-starts</CODE>と
<CODE>calendar-daylight-savings-ends</CODE>に<CODE>nil</CODE>を設定します。
<P>

<A NAME="IDX3036"></A>
変数<CODE>calendar-daylight-time-offset</CODE>は、
夏時間と標準時間の分で計った差を指定します。
ケンブリッジに対する値は60です。
<P>

<A NAME="IDX3037"></A>
<A NAME="IDX3038"></A>
変数<CODE>calendar-daylight-savings-starts-time</CODE>と
<CODE>calendar-daylight-savings-ends-time</CODE>は、
夏時間と標準時間との移行が行われる
地方時の真夜中の0時からの経過分を指定します。
ケンブリッジでは、どちらの変数の値も120です。
<P>

<A NAME="Diary Customizing"></A>
<HR SIZE="6">
<br><A NAME="SEC631"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC630"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC632"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Diary Customizing"></A>
<H2> 38.6 日誌のカスタマイズ </H2>
<!--docid::SEC631::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Diary%20Customizing">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Diary%20Customizing</a>"<br>
"texi/elisp21/日誌のカスタマイズ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C6%FC%BB%EF%A4%CE%A5%AB%A5%B9%A5%BF%A5%DE%A5%A4%A5%BA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX3039"></A>
通常、日誌用バッファのウィンドウのモード行には、
日誌記録の日付に一致する祝祭日があれば表示されます。
祝祭日を検査する処理には数秒を要するので、
祝祭日情報を含めると日誌用バッファの表示に遅れが生じます。
祝祭日情報をなくして日誌用バッファの表示を速くしたい場合には、
変数<CODE>holidays-in-diary-buffer</CODE>に<CODE>nil</CODE>を設定します。
<P>

<A NAME="IDX3040"></A>
変数<CODE>number-of-diary-entries</CODE>は、
一度に表示する日誌記録の日数を制御します。
これは、<CODE>view-diary-entries-initially</CODE>が<CODE>t</CODE>であるときの
最初の表示に影響します。
たとえば、デフォルト値は1で、現在の日付の日誌記録のみを表示します。
値が2であると、現在とつぎの日付の日誌記録を表示します。
この値は7要素のベクトルでもかまいません。
たとえば、値が<CODE>[0 2 2 2 2 4 1]</CODE>であると、
日曜日には日誌記録をなにも表示せず、
月曜日から木曜日には現在とつぎの日付の日誌記録を表示し、
金曜日には金曜日から月曜日の日誌記録を表示し、
土曜日にはその日だけの日誌記録を表示します。
<P>

<A NAME="IDX3041"></A>
<A NAME="IDX3042"></A>
変数<CODE>print-diary-entries-hook</CODE>は、
日誌用バッファで現在見えている日誌記録のみを収めた一時的なバッファの
準備ができると実行されるノーマルフックです。
（他の関係ない日誌記録は一時的なバッファには入っていない。
日誌用バッファではそれらは隠されている。）
このフックのデフォルト値は、コマンド<CODE>lpr-buffer</CODE>で印刷します。
別のコマンドで印刷したい場合には、単にこのフックの値を変更します。
別の用途は、たとえば、行を日付と時刻で並び替えることです。
<P>

<A NAME="IDX3043"></A>
<CODE>diary-date-forms</CODE>に設定すれば、
目的に合うように個人の日誌ファイル内の日付の書式を
アメリカスタイルやヨーロッパスタイルにカスタマイズできます。
この変数は、日付を認識するパターンのリストです。
各パターンは、正規表現（see 節 <A HREF="elisp_34.html#SEC551">33.2 正規表現</A>）や
<CODE>month</CODE>、<CODE>day</CODE>、<CODE>year</CODE>、<CODE>monthname</CODE>、
<CODE>dayname</CODE>のシンボルを要素とするリストです。
これらの要素すべては、日誌ファイル内の特定種類のテキストに一致する
パターンとして働きます。
全体として日付パターンとして一致するには、
すべての要素が順に一致する必要があります。
<P>

日付パターンの正規表現は、`<SAMP>*</SAMP>'を単語構成文字に変更した
標準の構文テーブルを用いて通常どおりに一致をとります。
<P>

<CODE>month</CODE>、<CODE>day</CODE>、<CODE>year</CODE>、<CODE>monthname</CODE>、<CODE>dayname</CODE>の
シンボルは、対象にしている月、日、年、月の名前、曜日です。
数に一致するシンボルは、数の先頭にある0を許します。
名前に一致するシンボルは、3文字の省略形や大文字で始まることを許します。
日誌記録では`<SAMP>*</SAMP>'は『任意の日』『任意に月』などを表し、
対象とする日付に関係なく一致するべきなので、
すべてのシンボルは`<SAMP>*</SAMP>'に一致できます。
<P>

アメリカスタイルの<CODE>diary-date-forms</CODE>のデフォルト値はつぎのとおりです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>((month "/" day "[^/0-9]")
 (month "/" day "/" year "[^0-9]")
 (monthname " *" day "[^,0-9]")
 (monthname " *" day ", *" year "[^0-9]")
 (dayname "\\W"))
</pre></td></tr></table><P>

リスト内の日付パターンは、<EM>互いに排他的</EM>であり、
日誌記録の日付と1つの白文字以外には他の部分に一致してはいけません。
互いに排他的であるためには、
パターンは日付を終える白文字を越えて日誌記録本文に一致する必要があります。
それには、日付パターンの最初の要素は<CODE>backup</CODE>である必要があります。
これにより、日付を認識する処理では、
一致し終えてから日誌記録の現在の単語の先頭に戻ります。
たとえ<CODE>backup</CODE>を使ったとしても、
日付パターンは日誌本体の最初の単語を越えて一致してはいけません。
ヨーロッパスタイルの<CODE>diary-date-forms</CODE>のデフォルト値は、
つぎのとおりです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>((day "/" month "[^/0-9]")
 (day "/" month "/" year "[^0-9]")
 (backup day " *" monthname "\\W+\\<[^*0-9]")
 (day " *" monthname " *" year "[^0-9]")
 (dayname "\\W"))
</pre></td></tr></table><P>

ここでは、3番目のパターンで<CODE>backup</CODE>を使っています。
4番目のパターンと区別するために、
日付のつぎの単語の一部と一致する必要があるからです。
<P>

<A NAME="Hebrew/Islamic Entries"></A>
<HR SIZE="6">
<br><A NAME="SEC632"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC631"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC633"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Hebrew/Islamic Entries"></A>
<H2> 38.7 ヘブライ暦日付やイスラム暦日付の日誌記録 </H2>
<!--docid::SEC632::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Hebrew/Islamic%20Entries">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Hebrew/Islamic%20Entries</a>"<br>
"texi/elisp21/ヘブライ暦日付やイスラム暦日付の日誌記録"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%D8%A5%D6%A5%E9%A5%A4%CE%F1%C6%FC%C9%D5%A4%E4%A5%A4%A5%B9%A5%E9%A5%E0%CE%F1%C6%FC%C9%D5%A4%CE%C6%FC%BB%EF%B5%AD%CF%BF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

日誌ファイルには、世界標準のグレゴリオ暦日付に加えて、
ヘブライ暦日付やイスラム暦日付を入れることもできます。
しかし、そのような記録の認識には時間がかかり、
ほとんどの人はそれらを使わないので、
それらは明示的にオンにする必要があります。
日誌でヘブライ暦日付の日誌記録を認識できるように望むなら、
たとえば、つぎのようにする必要があります。
<P>

<A NAME="IDX3044"></A>
<A NAME="IDX3045"></A>
<A NAME="IDX3046"></A>
<A NAME="IDX3047"></A>
<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(add-hook 'nongregorian-diary-listing-hook 'list-hebrew-diary-entries)
(add-hook 'nongregorian-diary-marking-hook 'mark-hebrew-diary-entries)
</FONT></pre></td></tr></table><P>

イスラム暦日付の日誌記録を望むなら、つぎのようにします。
<P>

<A NAME="IDX3048"></A>
<A NAME="IDX3049"></A>
<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(add-hook 'nongregorian-diary-listing-hook 'list-islamic-diary-entries)
(add-hook 'nongregorian-diary-marking-hook 'mark-islamic-diary-entries)
</FONT></pre></td></tr></table><P>

ヘブライ暦日付やイスラム暦日付の日誌記録は、
グレゴリオ暦日付と同じ形式ですが、
ヘブライ暦日付のまえには`<SAMP>H</SAMP>'、
イスラム暦日付のまえには`<SAMP>I</SAMP>'がある点が異なります。
さらに、ヘブライ暦やイスラム暦の月は、最初の3文字で一意に決まらないため、
月の省略形は使えません。
たとえば、ヘブライ暦日付Heshvan 25の日誌記録はつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>HHeshvan 25 Happy Hebrew birthday!
</FONT></pre></td></tr></table><P>

これはヘブライ暦日付Heshvan 25に対する任意の日誌に現れます。
イスラム暦日付Dhu al-Qada 25に一致する日誌記録はつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>IDhu al-Qada 25 Happy Islamic birthday!
</FONT></pre></td></tr></table><P>

グレゴリオ暦日付の日誌記録では、
ヘブライ暦日付とイスラム暦日付の記録は、
それらの前にアンパサンド（`<SAMP>&#38;</SAMP>'）があると印付けされません。
<P>

ヘブライ暦やイスラム暦において
指定した日付や似た日付に一致する日誌記録を作成するための
カレンダーのコマンド一覧をつぎに示します。
<P>

<DL COMPACT>
<DT><KBD>i h d</KBD>
<DD>選択した日付に対応するヘブライ暦日付に日誌記録を追加する
（<CODE>insert-hebrew-diary-entry</CODE>）。
<DT><KBD>i h m</KBD>
<DD>選択した日付に対応するヘブライ暦月の日に日誌記録を追加する
（<CODE>insert-monthly-hebrew-diary-entry</CODE>）。
この日誌記録は、選択した日付のヘブライ暦の月内の日と同じ
任意の日付に一致する。
<DT><KBD>i h y</KBD>
<DD>選択した日付のヘブライ暦年の日に日誌記録を追加する
（<CODE>insert-yearly-hebrew-diary-entry</CODE>）。
この日誌記録は、選択した日付のヘブライ暦の月とその月内の日と同じ
任意の日付に一致する。
<DT><KBD>i i d</KBD>
<DD>選択した日付に対応するイスラム暦日付に日誌記録を追加する
（<CODE>insert-islamic-diary-entry</CODE>）。
<DT><KBD>i i m</KBD>
<DD>選択した日付に対応するイスラム暦の月内の日に日誌記録を追加する
（<CODE>insert-monthly-islamic-diary-entry</CODE>）。
<DT><KBD>i i y</KBD>
<DD>選択した日付のイスラム暦年の日に日誌記録を追加する
（<CODE>insert-yearly-islamic-diary-entry</CODE>）。
</DL>
<P>

<A NAME="IDX3050"></A>
<A NAME="IDX3051"></A>
<A NAME="IDX3052"></A>
<A NAME="IDX3053"></A>
<A NAME="IDX3054"></A>
<A NAME="IDX3055"></A>
これらのコマンドは、日誌記録の対応する普通のコマンドと同様に働きます。
カレンダーウィンドウにおいてポイントがある日付に作用し、
日誌記録の日付に関する部分のみを挿入します。
日誌記録の本文は自分で入力する必要があります。
<P>

<A NAME="Fancy Diary Display"></A>
<HR SIZE="6">
<br><A NAME="SEC633"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC632"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC634"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Fancy Diary Display"></A>
<H2> 38.8 装飾日誌表示 </H2>
<!--docid::SEC633::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Fancy%20Diary%20Display">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Fancy%20Diary%20Display</a>"<br>
"texi/elisp21/装飾日誌表示"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C1%F5%BE%FE%C6%FC%BB%EF%C9%BD%BC%A8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX3056"></A>
<A NAME="IDX3057"></A>
<P>

日誌表示は、日誌用バッファを準備してからフック<CODE>diary-display-hook</CODE>を
実行することで動作します。
このフックのデフォルト値（<CODE>simple-diary-display</CODE>）は、
関係ない日誌記録を隠してからバッファを表示します。
しかし、つぎのようにフックを指定すると
<P>

<A NAME="IDX3058"></A>
<A NAME="IDX3059"></A>
<TABLE><tr><td>&nbsp;</td><td class=example><pre>(add-hook 'diary-display-hook 'fancy-diary-display)
</pre></td></tr></table><P>

装飾日誌表示を行えます。
日誌記録と祝祭日を表示専用の特別なバッファにコピーして表示します。
別のバッファにコピーするので、表示テキストが綺麗になるように変更できます。
たとえば、日付順に記録をソートするなどです。
<P>

単純な日誌表示では、<CODE>print-diary-entries</CODE>でバッファ内容を印刷できます。
1週間分の毎日の日誌を印刷するには、
その週の日曜日にポイントを置いて<KBD>7 d</KBD>と打ってから
<KBD>M-x print-diary-entries</KBD>を行います。
祝祭日が入っていると表示が遅くなりますが、
変数<CODE>holidays-in-diary-buffer</CODE>に<CODE>nil</CODE>を設定すると速くできます。
<P>

<A NAME="IDX3060"></A>
通常、装飾日誌用バッファでは、
たとえ祝祭日であっても日誌記録がない日は表示しません。
そのような日を装飾日誌用バッファに表示するには、
変数<CODE>diary-list-include-blanks</CODE>に<CODE>t</CODE>を設定します。
<P>

<A NAME="IDX3061"></A>
装飾日誌表示を使うときには、
ノーマルフック<CODE>list-diary-entries-hook</CODE>を使って
各日誌記録を時刻でソートできます。
つぎのようにします。
<P>

<A NAME="IDX3062"></A>
<TABLE><tr><td>&nbsp;</td><td class=example><pre>(add-hook 'list-diary-entries-hook 'sort-diary-entries t)
</pre></td></tr></table><P>

これは、各日ごとに認識できる時刻で始まる日誌記録をソートします。
各日の先頭には時刻のついていない日誌項目がきます。
<P>

装飾日誌表示には、取り込んだ日誌ファイルを処理する能力もあります。
これにより、グループのメンバは、グループに共通な行事を記述した
日誌ファイルを共有できます。
つぎのような行を日誌ファイルに書きます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>#include "<VAR>filename</VAR>"
</FONT></pre></td></tr></table><P>

そうすると、ファイル<VAR>filename</VAR>から
日誌記録を装飾日誌用バッファに取り込みます。
取り込み機構は再帰的ですから、
取り込んだファイル内で別のファイルを取り込むことができます。
もちろん、取り込みが循環しないように注意してください。
取り込み機能をオンにするにはつぎのようにします。
<P>

<A NAME="IDX3063"></A>
<A NAME="IDX3064"></A>
<A NAME="IDX3065"></A>
<A NAME="IDX3066"></A>
<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(add-hook 'list-diary-entries-hook 'include-other-diary-files)
(add-hook 'mark-diary-entries-hook 'mark-included-diary-files)
</FONT></pre></td></tr></table><P>

通常の日誌表示は個人の日誌ファイルの記録を直接表示するため、
取り込み機構は装飾日誌表示でのみ動作します。
<P>

<A NAME="Sexp Diary Entries"></A>
<HR SIZE="6">
<br><A NAME="SEC634"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC633"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC635"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Sexp Diary Entries"></A>
<H2> 38.9 S式項目と装飾日誌表示 </H2>
<!--docid::SEC634::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Sexp%20Diary%20Entries">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Sexp%20Diary%20Entries</a>"<br>
"texi/elisp21/S式項目と装飾日誌表示"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2FS%BC%B0%B9%E0%CC%DC%A4%C8%C1%F5%BE%FE%C6%FC%BB%EF%C9%BD%BC%A8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX3067"></A>
<P>

S式を使った日誌記録は、
複雑な条件で適用される日誌記録を作る以上のことができます。
装飾日誌表示を使っている場合には、S式日誌項目は、
日付に依存した記録テキストを生成できます。
たとえば、記念日の記録では、テキストに何回目の記念日であるかを入れられます。
したがって、つぎの日誌記録の`<SAMP>%d</SAMP>'は年齢で置き換えられます。
<P>

<A NAME="IDX3068"></A>
<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>%%(diary-anniversary 10 31 1948) Arthur's birthday (%d years old)
</FONT></pre></td></tr></table><P>

つまり、装飾日誌用バッファでは、1990年10月31日の項目はつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>Arthur's birthday (42 years old)
</FONT></pre></td></tr></table><P>

日誌ファイルにつぎの項目が入っていると、
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>%%(diary-anniversary 10 31 1948) Arthur's %d%s birthday
</FONT></pre></td></tr></table><P>

装飾日誌用バッファでは、1990年10月31日の項目はつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>Arthur's 42nd birthday
</FONT></pre></td></tr></table><P>

同様に、周期的な日誌項目では繰り返し回数を計算できます。
<P>

<A NAME="IDX3069"></A>
<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>%%(diary-cyclic 50 1 1 1990) Renew medication (%d%s time)
</FONT></pre></td></tr></table><P>

は、1990年9月8日の装飾日誌表示ではつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>Renew medication (5th time)
</FONT></pre></td></tr></table><P>

<P>

当日の日誌項目としてだけでなく、
それよりまえの日の日誌項目にも含めるためのS式日誌項目があります。
たとえば、記念日の1週間前に督促がほしいときには、
つぎのようにします。
<P>

<A NAME="IDX3070"></A>
<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>%%(diary-remind '(diary-anniversary 12 22 1968) 7) Ed's anniversary
</FONT></pre></td></tr></table><P>

すると、装飾日誌には、12月15日と12月22日に
<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>Ruth &#38; Ed's anniversary
</FONT></pre></td></tr></table>と表示されます。
<P>

<A NAME="IDX3071"></A>
関数<CODE>diary-date</CODE>は、整数や整数のリストや<CODE>t</CODE>で指定した
月、日、年の組み合わせで表される日付に適用されます。
たとえば、
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>%%(diary-date '(10 11 12) 22 t) Rake leaves
</FONT></pre></td></tr></table><P>

により、装飾日誌には、各年の10月22日、11月22日、12月22日には
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>Rake leaves
</FONT></pre></td></tr></table><P>

と表示されます。
<P>

<A NAME="IDX3072"></A>
関数<CODE>diary-float</CODE>により、
11月の第3金曜日とか4月の最後の火曜日といった
日付に適用する日誌記録を記述できます。
パラメータは、月<VAR>month</VAR>、曜日<VAR>dayname</VAR>、添字<VAR>n</VAR>です。
日曜日を<VAR>dayname</VAR>=0、月曜日を<VAR>dayname</VAR>=1、…として、
<VAR>month</VAR>月の<VAR>n</VAR>番目の曜日<VAR>dayname</VAR>に項目が現れます。
<VAR>n</VAR>が負であると、<VAR>month</VAR>月の月末から数えます。
<VAR>month</VAR>は、月のリストでも、1つの月でも、全部の月を指定する<CODE>t</CODE>でも
かまいません。
省略可能なパラメータ<VAR>day</VAR>を指定して、
<VAR>month</VAR>月の<VAR>n</VAR>番目の曜日<VAR>dayname</VAR>の
前後の<VAR>day</VAR>日を指定できます。
<VAR>n</VAR>が正だと<VAR>day</VAR>のデフォルトは1であり、
<VAR>n</VAR>が負だと<VAR>day</VAR>のデフォルトは<VAR>month</VAR>月の月末です。
たとえば、
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>%%(diary-float t 1 -1) Pay rent
</FONT></pre></td></tr></table><P>

は、装飾日誌に各月の最後の月曜日に
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>Pay rent
</FONT></pre></td></tr></table><P>

を表示します。
<P>

S式日誌項目の一般性により、アルゴリズムで日誌項目を指定できます。
S式日誌項目には、項目を当該日に適用するどうかを計算する式を含められます。
その値が<CODE>nil</CODE>以外であると、その項目を当該日に適用します。
その式では、対象とする日付を知るために変数<CODE>date</CODE>を使えます。
この変数の値は、グレゴリオ暦で表した
リスト<CODE>(<VAR>month</VAR> <VAR>day</VAR> <VAR>year</VAR>)</CODE>です。
<P>

毎月のウィークデイである21日か、
21日が週末の場合にはそのまえの金曜日に給料を支払われるとしましょう。
そのような日付に一致するS式日誌項目はつぎのように書けます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>&#38;%%(let ((dayname (calendar-day-of-week date))
         (day (car (cdr date))))
      (or (and (= day 21) (memq dayname '(1 2 3 4 5)))
          (and (memq day '(19 20)) (= dayname 5)))
         ) Pay check deposited
</FONT></pre></td></tr></table><P>

以下のS式日誌項目は、日付に依存して変わるテキストを
日誌項目に入れる機能を（装飾日誌表示で）利用できます。
<P>

<A NAME="IDX3073"></A>
<A NAME="IDX3074"></A>
<A NAME="IDX3075"></A>
<A NAME="IDX3076"></A>
<A NAME="IDX3077"></A>
<A NAME="IDX3078"></A>
<A NAME="IDX3079"></A>
<A NAME="IDX3080"></A>
<A NAME="IDX3081"></A>
<A NAME="IDX3082"></A>
<DL COMPACT>
<DT><CODE>%%(diary-sunrise-sunset)</CODE>
<DD>今日の地方時での日出入時刻に対する日誌項目を作る。
<DT><CODE>%%(diary-phases-of-moon)</CODE>
<DD>月に朔弦望に対する日誌項目を作る。
<DT><CODE>%%(diary-day-of-year)</CODE>
<DD>年内の通算日数と残り日数で今日の日誌項目を作る。
<DT><CODE>%%(diary-iso-date)</CODE>
<DD>今日に対応するISO商用暦の日誌項目を作る。
<DT><CODE>%%(diary-julian-date)</CODE>
<DD>今日に対応するユリウス暦の日誌項目を作る。
<DT><CODE>%%(diary-astro-day-number)</CODE>
<DD>今日に対応する天文通算日（ユリウス日）の日誌項目を作る。
<DT><CODE>%%(diary-hebrew-date)</CODE>
<DD>今日に対応するヘブライ暦の日誌項目を作る。
<DT><CODE>%%(diary-islamic-date)</CODE>
<DD>今日に対応するイスラム暦の日誌項目を作る。
<DT><CODE>%%(diary-french-date)</CODE>
<DD>今日に対応するフランス革命暦の日誌項目を作る。
<DT><CODE>%%(diary-mayan-date)</CODE>
<DD>今日に対応するマヤ暦の日誌項目を作る。
</DL>
<P>

したがって、
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>&#38;%%(diary-hebrew-date)
</pre></td></tr></table><P>

を含んだ日誌項目は、装飾日誌表示を使っていると、
毎日の日誌表示に対応するヘブライ暦の日付を含めることになります。
（単純な日誌表示では、行`<SAMP>&#38;%%(diary-hebrew-date)</SAMP>'は
すべての日付の日誌に現れるが、特別なことはなにもしない。）
<P>

つぎの関数は、ある標準的な方法でヘブライ暦に基づく
S式日誌項目を構成するために使えます。
<P>

<A NAME="IDX3083"></A>
<A NAME="IDX3084"></A>
<A NAME="IDX3085"></A>
<A NAME="IDX3086"></A>
<A NAME="IDX3087"></A>
<A NAME="IDX3088"></A>
<A NAME="IDX3089"></A>
<A NAME="IDX3090"></A>
<A NAME="IDX3091"></A>
<A NAME="IDX3092"></A>
<DL COMPACT>
<DT><CODE>%%(diary-rosh-hodesh)</CODE>
<DD>各ヘブライ月の礼拝の始まりと終りを教える日誌項目を作る。
<DT><CODE>%%(diary-parasha)</CODE>
<DD>毎週のシナゴーグ朗読会を教える土曜日の日誌項目を作る。
<DT><CODE>%%(diary-sabbath-candles)</CODE>
<DD>安息日のたそがれの<EM>地方時</EM>を教える金曜日の日誌項目を作る。
<DT><CODE>%%(diary-omer)</CODE>
<DD>適切ならばオーメル<A NAME="DOCF11" HREF="elisp_fot.html#FOOT11">(11)</A>
の回数を与える日誌項目を作る。
<DT><CODE>%%(diary-yahrzeit <VAR>month</VAR> <VAR>day</VAR> <VAR>year</VAR>) <VAR>name</VAR></CODE>
<DD>命日に対応した日誌項目を作る。
命日の日付は<EM>グレゴリオ暦</EM>で指定する。
正しいヘブライ暦の追悼日とその前日に日誌項目が現れる。
（ヨーロッパスタイルでは、パラメータの順序を
<VAR>day</VAR>、<VAR>month</VAR>、<VAR>year</VAR>と変える。）
</DL>
<P>

<A NAME="Appt Customizing"></A>
<HR SIZE="6">
<br><A NAME="SEC635"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_39.html#SEC634"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_40.html#SEC636"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Appt Customizing"></A>
<H2> 38.10 約束の警告表示のカスタマイズ </H2>
<!--docid::SEC635::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Appt%20Customizing">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Appt%20Customizing</a>"<br>
"texi/elisp21/約束の警告表示のカスタマイズ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CC%F3%C2%AB%A4%CE%B7%D9%B9%F0%C9%BD%BC%A8%A4%CE%A5%AB%A5%B9%A5%BF%A5%DE%A5%A4%A5%BA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

Emacsにどのように約束の警告表示を行わせ、
どの程度前から行わせるかは、つぎの変数に設定することで正確に指定できます。
<P>

<A NAME="IDX3093"></A>
<A NAME="IDX3094"></A>
<A NAME="IDX3095"></A>
<A NAME="IDX3096"></A>
<A NAME="IDX3097"></A>
<A NAME="IDX3098"></A>
<A NAME="IDX3099"></A>
<A NAME="IDX3100"></A>
<DL COMPACT>
<DT><CODE>appt-message-warning-time</CODE>
<DD>約束の警告表示を開始する時間を分で表したもの。
デフォルトは10分である。
<DT><CODE>appt-audible</CODE>
<DD>これが<CODE>nil</CODE>以外であると、Emacsは約束の警告表示として端末のベルを鳴らす。
デフォルトは<CODE>t</CODE>。
<DT><CODE>appt-visible</CODE>
<DD>これが<CODE>nil</CODE>以外であると、Emacsは約束のメッセージをエコー領域に表示する。
デフォルトは<CODE>t</CODE>。
<DT><CODE>appt-display-mode-line</CODE>
<DD>これが<CODE>nil</CODE>以外であると、Emacsは約束までの残り分数をモード行に表示する。
デフォルトは<CODE>t</CODE>。
<DT><CODE>appt-msg-window</CODE>
<DD>これが<CODE>nil</CODE>以外であると、
Emacsは約束のメッセージを別のウィンドウに表示する。
デフォルトは<CODE>t</CODE>。
<DT><CODE>appt-disp-window-function</CODE>
<DD>この変数は、約束のメッセージを表示するウィンドウを作るための関数を保持する。
<DT><CODE>appt-delete-window-function</CODE>
<DD>この変数は、時間が過ぎたら
約束のメッセージを表示したウィンドウを削除するための関数を保持する。
<DT><CODE>appt-display-duration</CODE>
<DD>約束のメッセージを表示する秒数。
デフォルトは5秒である。
</DL>
<A NAME="System Interface"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<a name="bottom"> </a>
<script type="text/javascript" src="style2.js"></script>
<div class="footer">
    <br>
    このページはMeadow (Emacs) の紹介ページです <br>
このWebページの各文書は自由にリンク・複製・再配布・改変していただいて構いません．
<br>ただし，複製・再配布・改変の場合は Meadow Memo のURLを記載しておいて下さい．<br>
<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=about%20link">Medow memoへのリンクについて</a>．<br>

間違い，要望等があれば<a href="mailto:akihisa@mail.ne.jp">akihisa@mail.ne.jp</a> か下記でどうぞ<br>

<br>

<FORM METHOD="post" ACTION="http://www.bookshelf.jp/cgi-bin/wwwmail.cgi" >
お名前：<INPUT TYPE="text" NAME="name" SIZE="30" MAXLENGTH="40" VALUE="ななしさん"><br>
メールアドレス：<INPUT TYPE="text" NAME="EMAIL" SIZE="25" MAXLENGTH="60" VALUE="secret@mail.adr"><br>
<input type="hidden" name="HPAGE" value="">
つっこみ：<br><TEXTAREA NAME="MESSAGE" ROWS="5" COLS="50">
</TEXTAREA><br><br>
<INPUT TYPE="submit" VALUE="送信">
<INPUT TYPE="reset" VALUE="クリア">
</FORM>

<br><A HREF="http://www.bookshelf.jp/cgi-bin/xct.cgi">ページ別カウンタ</a>
<br> Since 2002/12/13 <br>
</div>

</BODY>

</HTML>
