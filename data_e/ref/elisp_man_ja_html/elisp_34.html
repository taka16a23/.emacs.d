<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="ja">
<!-- Created on October, 1  2005 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=euc-jp">
<META NAME="keywords" CONTENT="meadow,mule,emacs,lisp,elisp,gnus,setting,設定,unix,cygwin">
<META http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="description" CONTENT="Meadowの設定を紹介するページです">
<TITLE>GNU Emacs Lispリファレンスマニュアル:  探索と一致</TITLE>

<META NAME="description" CONTENT="GNU Emacs Lispリファレンスマニュアル:  探索と一致">
<META NAME="keywords" CONTENT="GNU Emacs Lispリファレンスマニュアル:  探索と一致">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

<LINK REL="contents" HREF="elisp_toc.html#SEC_Contents">
<LINK REL="index" HREF="elisp_48.html#SEC681">
<LINK REL="next" HREF="elisp_35.html#SEC564">
<LINK REL="prev" HREF="elisp_33.html#SEC528">

<META http-equiv="Content-Style-Type" content="text/css">
<!-- 鶯と龜 ←日本語EUC誤判別対策用らしい; -->
<link rel="StyleSheet" href="../../../../soft/css/midnight.css" type="text/css" id="css1">
<script type="text/javascript" src="style1.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../soft/css/meadowmemo.css">

</HEAD>
<BODY LANG="ja" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<!--Infoseek Analyzer start-->
<script LANGUAGE="javascript">PgNo=6;</script>
<script src="http://js1.infoseek.co.jp/bin/57/00170.js"></script>
<noscript><a href="http://ax1.www.infoseek.co.jp/bin/go?0017057f" target="_blank">
<img src="http://ax1.www.infoseek.co.jp/bin/logo?0017057f" border=0></a></noscript>
<!--Infoseek Analyzer end-->
<a name="top"> </a>

<br><A NAME="SEC549"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_33.html#SEC548"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC550"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_33.html#SEC528"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_35.html#SEC564"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Searching and Matching"></A>
<H1> 33. 探索と一致 </H1>
<!--docid::SEC549::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Searching%20and%20Matching">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Searching%20and%20Matching</a>"<br>
"texi/elisp21/探索と一致"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C3%B5%BA%F7%A4%C8%B0%EC%C3%D7">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2542"></A>
<P>

GNU Emacsにはバッファから指定したテキストを探す方法が2つあります。
文字列そのものを正確に探索するのと正規表現の探索です。
正規表現の探索のあとでは、
正規表現全体やそのさまざまな部分に一致したテキストを表す
<EM>マッチデータ</EM>（match data）を調べることができます。
<P>

<div class="menuindex"><SCRIPT language=JavaScript src="index33.js"></SCRIPT></div><noscript><BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC550">33.1 文字列の探索</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Search for an exact match.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC551">33.2 正規表現</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Describing classes of strings.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC554">33.3 正規表現の探索</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Searching for a match for a regexp.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC555">33.4 POSIXの正規表現探索</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Searching POSIX-style for the longest match.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC556">33.5 探索と置換</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Internals of <CODE>query-replace</CODE>.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC557">33.6 マッチデータ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Finding out which part of the text matched
                            various parts of a regexp, after regexp search.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC562">33.7 探索と大文字小文字</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Case-independent or case-significant searching.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC563">33.8 編集に用いられる標準的な正規表現</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Useful regexps for finding sentences, pages,...</TD></TR>
</TABLE></BLOCKQUOTE></noscript>
<P>

`<SAMP>skip-chars<small>...</small></SAMP>'などの関数もある種の探索を行います。
See 節 <A HREF="elisp_30.html#SEC471">29.2.7 文字群の飛び越し</A>。
<P>

<A NAME="String Search"></A>
<HR SIZE="6">
<br><A NAME="SEC550"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC549"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC551"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="String Search"></A>
<H2> 33.1 文字列の探索 </H2>
<!--docid::SEC550::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=String%20Search">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=String%20Search</a>"<br>
"texi/elisp21/文字列の探索"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CA%B8%BB%FA%CE%F3%A4%CE%C3%B5%BA%F7">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2543"></A>
<P>

これらは、バッファ内のテキストを探索するための基本関数です。
これらはプログラムで使うことを意図していますが、
対話的に呼び出すこともできます。
その場合、探索文字列を問い合わせてきますが、
<VAR>limit</VAR>と<VAR>noerror</VAR>は<CODE>nil</CODE>に、<VAR>repeat</VAR>は1に設定されます。
<P>

これらの探索関数は、バッファがマルチバイトであると
探索文字列をマルチバイトに変換します。
バッファがユニバイトであると探索文字列をユニバイトに変換します。
See 節 <A HREF="elisp_33.html#SEC529">32.1 テキスト表現</A>。
<P>

<A NAME="IDX2544"></A>
<DL>
<DT><U>コマンド:</U> <B>search-forward</B> <I>string &#38;optional limit noerror repeat</I>
<DD>この関数は、ポイントから前方へ向けて文字列<VAR>string</VAR>に
ちょうど一致するものを探す。
それに成功すれば、ポイントをみつけた出現箇所の末尾に移動し、
ポイントの新たな値を返す。
一致がみつからなければ、戻り値と副作用は<VAR>noerror</VAR>に依存する（下記参照）。
<P>

つぎの例では、ポイントは始めは行頭にある。
そして<CODE>(search-forward "fox")</CODE>は`<SAMP>fox</SAMP>'の最後の文字のうしろに
ポイントを移動する。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
-!-The quick brown fox jumped over the lazy dog.
---------- Buffer: foo ----------

(search-forward "fox")
     => 20

---------- Buffer: foo ----------
The quick brown fox-!- jumped over the lazy dog.
---------- Buffer: foo ----------
</pre></td></tr></table><P>

引数<VAR>limit</VAR>は探索の上限を指定する。
（カレントバッファ内の位置であること。）
その位置を越える箇所での一致は受け入れない。
<VAR>limit</VAR>を省略したり<CODE>nil</CODE>であると、
デフォルトは、バッファの参照可能部分の末尾である。
<P>

<A NAME="IDX2545"></A>
探索に失敗した場合の動作は、<VAR>noerror</VAR>の値に依存する。
<VAR>noerror</VAR>が<CODE>nil</CODE>であると、
エラー<CODE>search-failed</CODE>を通知する。
<VAR>noerror</VAR>が<CODE>t</CODE>であると、
<CODE>search-forward</CODE>は<CODE>nil</CODE>を返しなにもしない。
<VAR>noerror</VAR>が<CODE>nil</CODE>でも<CODE>t</CODE>でもないと、
<CODE>search-forward</CODE>はポイントを上限位置へ移動して<CODE>nil</CODE>を返す。
（この場合にもポイントの新たな値を返すほうが一貫性があるが、
値<CODE>nil</CODE>に依存しているプログラムがある。）
<P>

<VAR>repeat</VAR>を指定してあると（正の数であること）、
その回数だけ探索を繰り返す（一致箇所の末尾を新たな探索の開始位置とする）。
連続してこれらの探索に成功すると関数は成功し、
ポイントを移動してその新たな値を返す。
さもなければ探索は失敗である。
</DL>
<P>

<A NAME="IDX2546"></A>
<DL>
<DT><U>コマンド:</U> <B>search-backward</B> <I>string &#38;optional limit noerror repeat</I>
<DD>この関数は、ポイントから後方へ向けて<VAR>string</VAR>を探索する。
<CODE>search-forward</CODE>と同様であるが、後方へ向けて探索し
一致箇所の先頭にポイントを置く点が異なる。
</DL>
<P>

<A NAME="IDX2547"></A>
<DL>
<DT><U>コマンド:</U> <B>word-search-forward</B> <I>string &#38;optional limit noerror repeat</I>
<DD><A NAME="IDX2548"></A>
この関数は、ポイントから前方へ向けて<VAR>string</VAR>に一致する『単語』を探索する。
一致をみつけると、一致箇所の末尾にポイントを設定し
ポイントの新たな値を返す。
<P>

単語の一致では、<VAR>string</VAR>を単語の列とみなし、
それらを区切る句読点は無視する。
バッファ内の同じ単語の列を探す。
バッファ内の各単語は別々になっている必要があるが
（単語`<SAMP>ball</SAMP>'を探索すると単語`<SAMP>balls</SAMP>'には一致しない）、
句読点や空白の詳細は無視される
（`<SAMP>ball boy</SAMP>'を探索すると`<SAMP>ball.  Boy!</SAMP>'に一致する）。
<P>

つぎの例では、ポイントは始めはバッファの先頭にある。
探索するとポイントは`<SAMP>y</SAMP>'と`<SAMP>!</SAMP>'のあいだに移動する。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
-!-He said "Please!  Find
the ball boy!"
---------- Buffer: foo ----------

(word-search-forward "Please find the ball, boy.")
     => 35

---------- Buffer: foo ----------
He said "Please!  Find
the ball boy-!-!"
---------- Buffer: foo ----------
</pre></td></tr></table><P>

<VAR>limit</VAR>が<CODE>nil</CODE>以外（カレントバッファ内の位置）であると、
それは探索の上限を指定する。
みつかった一致箇所はその位置を越えてはならない。
<P>

<VAR>noerror</VAR>が<CODE>nil</CODE>であると、
探索に失敗するとエラー<CODE>word-search-failed</CODE>を通知する。
<VAR>noerror</VAR>が<CODE>t</CODE>であると、
エラーを通知するかわりに<CODE>nil</CODE>を返す。
<VAR>noerror</VAR>が<CODE>nil</CODE>でも<CODE>t</CODE>でもないと、
ポイントを<VAR>limit</VAR>（あるいはバッファの末尾）へ移動して<CODE>nil</CODE>を返す。
<P>

<VAR>repeat</VAR>が<CODE>nil</CODE>以外であると、
その回数だけ探索を繰り返す。
ポイントは最後の一致箇所の末尾へ置かれる。
</DL>
<P>

<A NAME="IDX2549"></A>
<DL>
<DT><U>コマンド:</U> <B>word-search-backward</B> <I>string &#38;optional limit noerror repeat</I>
<DD>この関数はポイントから後方へ向けて<VAR>string</VAR>に一致する単語を探索する。
この関数は<CODE>word-search-forward</CODE>と同様であるが、
後方へ向けて探索し一致箇所の先頭にポイントを置く点が異なる。
</DL>
<P>

<A NAME="Regular Expressions"></A>
<HR SIZE="6">
<br><A NAME="SEC551"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC550"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC552"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Regular Expressions"></A>
<H2> 33.2 正規表現 </H2>
<!--docid::SEC551::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Regular%20Expressions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Regular%20Expressions</a>"<br>
"texi/elisp21/正規表現"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C0%B5%B5%AC%C9%BD%B8%BD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2550"></A>
<A NAME="IDX2551"></A>
<P>

<EM>正規表現</EM>（regular expression、略して<EM>regexp</EM>）は、
文字列の（無限の可能性もある）集合を表すパターンです。
正規表現への一致を探すことは、非常に強力な操作です。
本節では、正規表現の書き方を説明します。
続く節では、それらを探索する方法を説明します。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC552">33.2.1 正規表現の構文</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Rules for writing regular expressions.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC553">33.2.2 複雑な正規表現の例</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Illustrates regular expression syntax.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Syntax of Regexps"></A>
<HR SIZE="6">
<br><A NAME="SEC552"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC551"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC553"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Syntax of Regexps"></A>
<H3> 33.2.1 正規表現の構文 </H3>
<!--docid::SEC552::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Syntax%20of%20Regexps">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Syntax%20of%20Regexps</a>"<br>
"texi/elisp21/正規表現の構文"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C0%B5%B5%AC%C9%BD%B8%BD%A4%CE%B9%BD%CA%B8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

正規表現では、数個の文字が特別な構成であり、残りは<EM>普通</EM>です。
普通の文字は、その文字だけに一致する単純な正規表現です。
特別な文字は、`<SAMP>.</SAMP>'、`<SAMP>*</SAMP>'、`<SAMP>+</SAMP>'、
`<SAMP>?</SAMP>'、`<SAMP>[</SAMP>'、`<SAMP>]</SAMP>'、`<SAMP>^</SAMP>'、`<SAMP>$</SAMP>'、`<SAMP>\</SAMP>'であり、
将来新たな文字が定義されることはありません。
正規表現に現れるこれら以外の文字は、
まえに`<SAMP>\</SAMP>'がない限り普通の文字です。
<P>

たとえば、`<SAMP>f</SAMP>'は特別な文字ではないので普通の文字です。
ですから、`<SAMP>f</SAMP>'は文字列`<SAMP>f</SAMP>'だけに一致する正規表現です。
（これは文字列`<SAMP>ff</SAMP>'には一致しない。）
同様に、`<SAMP>o</SAMP>'は`<SAMP>o</SAMP>'だけに一致する正規表現です。
<P>

任意の2つの正規表現<VAR>a</VAR>と<VAR>b</VAR>を連結できます。
その結果は、<VAR>a</VAR>が文字列の始めの部分に一致し、かつ、
<VAR>b</VAR>がその文字列の残りに一致するときにその文字列に一致する
正規表現になります。
<P>

簡単な例として、正規表現 `<SAMP>f</SAMP>'と`<SAMP>o</SAMP>'を連結して
正規表現`<SAMP>fo</SAMP>'を得られます。
これは文字列`<SAMP>fo</SAMP>'だけに一致します。
これは明らかですね。
より強力なことをするには、特別な文字の1つを使う必要があります。
それらの一覧を以下に示します。
<P>

<DL COMPACT>
<DT>`<SAMP>.</SAMP>' （ピリオド）
<DD><A NAME="IDX2552"></A>
<A NAME="IDX2553"></A>
特別な文字であり、改行以外の任意の1文字に一致する。
連結を使って`<SAMP>a.b</SAMP>'のような正規表現を作れる。
これは、`<SAMP>a</SAMP>'で始まり`<SAMP>b</SAMP>'で終る任意の3文字の文字列に一致する。
<P>

<DT>`<SAMP>*</SAMP>'
<DD><A NAME="IDX2554"></A>
<A NAME="IDX2555"></A>
単独では構成要素ではない。
直前の正規表現を可能な限り反復することを意味する後置演算子である。
すなわち、`<SAMP>o*</SAMP>'は（`<SAMP>o</SAMP>'が存在しない場合も含めて）
任意個の`<SAMP>o</SAMP>'に一致する。
<P>

`<SAMP>*</SAMP>'はつねに先行する<EM>最小</EM>の正規表現に適用される。
したがって、`<SAMP>fo*</SAMP>'は`<SAMP>fo</SAMP>'を繰り返すのではなく、
`<SAMP>o</SAMP>'を繰り返す。
この正規表現は`<SAMP>f</SAMP>'、`<SAMP>fo</SAMP>'、`<SAMP>foo</SAMP>'などに一致する。
<P>

`<SAMP>*</SAMP>'を用いた構成の一致を処理するときには、
ただちに得られる限りの反復回数に展開される。
そうしてから、残りのパターンを処理する。
一致に失敗するとバックトラック（後戻り）が発生して、
`<SAMP>*</SAMP>'を用いた構成の反復回数を減らして
パターンの残りの部分が一致できるようにする。
たとえば、文字列`<SAMP>caaar</SAMP>'に対して
`<SAMP>ca*ar</SAMP>'を一致させることを考えてみる。
始めに、`<SAMP>a*</SAMP>'を3つの`<SAMP>a</SAMP>'すべてに一致させようとする。
しかし、残りのパターンが`<SAMP>ar</SAMP>'なのに`<SAMP>r</SAMP>'しか残っていないため、
この試みは失敗する。
そこで、つぎは`<SAMP>a*</SAMP>'を`<SAMP>a</SAMP>'2つだけに一致させる。
こうすると、残りの正規表現も正しく一致する。
<P>

入れ子にした反復演算子がバックトラックのループを指定する場合、
それはとても遅くなる。
たとえば、正規表現`<SAMP>\(x+y*\)*a</SAMP>'を
`<SAMP>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxz</SAMP>'の列に一致させると
最終的に失敗するまで何時間も費してしまう。
遅さの原因は、Emacsは35個の`<SAMP>x</SAMP>'をグループに分ける各方法を
すべて試してからでないとそれらが一致しないことを結論できないからである。
読者の正規表現が素早く動作することを保証するために、
入れ子になった繰り返しを注意深く調べること。
<P>

<DT>`<SAMP>+</SAMP>'
<DD><A NAME="IDX2556"></A>
<A NAME="IDX2557"></A>
`<SAMP>*</SAMP>'に似た後置演算子だが、
直前の正規表現に1回以上一致する必要がある。
たとえば、`<SAMP>ca+r</SAMP>'は、文字列`<SAMP>car</SAMP>'や`<SAMP>caaaar</SAMP>'には一致するが、
文字列`<SAMP>cr</SAMP>'には一致ない。
一方、`<SAMP>ca*r</SAMP>'の場合は、上記の3つすべてに一致する。
<P>

<DT>`<SAMP>?</SAMP>'
<DD><A NAME="IDX2558"></A>
<A NAME="IDX2559"></A>
`<SAMP>*</SAMP>'に似た後置演算子だが、
直前の正規表現に1回だけ一致するか、あるいは、1回も一致しない。
たとえば、`<SAMP>ca?r</SAMP>'は、`<SAMP>car</SAMP>'や`<SAMP>cr</SAMP>'に一致するが、
他のものには一致しない。
<P>

<DT>`<SAMP>[ <small>...</small> ]</SAMP>'
<DD><A NAME="IDX2560"></A>
<A NAME="IDX2561"></A>
<A NAME="IDX2562"></A>
<A NAME="IDX2563"></A>
<A NAME="IDX2564"></A>
`<SAMP>[</SAMP>'で始まり`<SAMP>]</SAMP>'で終る<EM>文字選択</EM>を表す。
もっとも単純な場合は、
この2つの中括弧のあいだにある文字の1つ1つがこの文字選択に一致する。
<P>

したがって、`<SAMP>[ad]</SAMP>'は、`<SAMP>a</SAMP>'1文字か`<SAMP>d</SAMP>'1文字のどちらにも一致する。
`<SAMP>[ad]*</SAMP>'は、`<SAMP>a</SAMP>'と`<SAMP>d</SAMP>'だけから成る
（空の文字列を含む）任意の文字列に一致する。
このことから、`<SAMP>c[ad]*r</SAMP>'は、
`<SAMP>cr</SAMP>'、`<SAMP>car</SAMP>'、`<SAMP>cdr</SAMP>'、`<SAMP>caddaar</SAMP>'などに一致することがわかる。
<P>

文字選択には、文字範囲の指定を含めることもでき、
始めの文字と終りの文字のあいだに`<SAMP>-</SAMP>'を書く。
つまり、`<SAMP>[a-z]</SAMP>'はすべてのASCII小英文字に一致する。
範囲指定と個々の文字を自由に織り混ぜてよく、
`<SAMP>[a-z$%.]</SAMP>'のように書ける。
これは、任意のASCII小英文字、`<SAMP>$</SAMP>'、`<SAMP>%</SAMP>'、ピリオドに一致する。
 
正規表現`<SAMP>[\200-\377]</SAMP>'で
すべての非ASCII文字につねに一致するとは限らない。
ユニバイト（see 節 <A HREF="elisp_33.html#SEC529">32.1 テキスト表現</A>）のバッファや文字列を
探索するときにはうまく働くが、マルチバイトのバッファや文字列では
多くの非ASCII文字のコードは8進数0377より大きいために働かない。
しかし、正規表現`<SAMP>[^\000-\177]</SAMP>'は、
ASCII文字のみを除外しているため、
マルチバイト表現でもユニバイト表現でもすべての非ASCII文字に一致する。
<P>

範囲指定の始めと終りは同じ文字集合（see 節 <A HREF="elisp_33.html#SEC533">32.5 文字集合</A>）に
属している必要がある。
したがって、`<SAMP>[a-\x8e0]</SAMP>'は正しくない。
`<SAMP>a</SAMP>'はASCII文字集合に属し、
文字0x8e0（グレーブアクセント付き`<SAMP>a</SAMP>'）は
EmacsのLatin-1の文字集合に属しているからである。
<P>

正規表現の普通の特別な文字は、文字選択の内側では特別ではないことに注意。
文字選択の内側では、まったく別の文字の集まり、
`<SAMP>]</SAMP>'、`<SAMP>-</SAMP>'、`<SAMP>^</SAMP>'が特別である。
<P>

文字選択に`<SAMP>]</SAMP>'を含めるには、
`<SAMP>]</SAMP>'を最初の文字として指定する必要がある。
たとえば、`<SAMP>[]a]</SAMP>'は、`<SAMP>]</SAMP>'や`<SAMP>a</SAMP>'に一致する。
`<SAMP>-</SAMP>'を含めるには、`<SAMP>-</SAMP>'を文字選択の最初の文字か
最後の文字として書くか、範囲指定のあとに置く。
したがって、`<SAMP>[]-]</SAMP>'は、`<SAMP>]</SAMP>'と`<SAMP>-</SAMP>'の両方に一致する。
<P>

文字選択に`<SAMP>^</SAMP>'を含めるには、`<SAMP>^</SAMP>'を文字選択の2番目以降に置く。
<P>

<DT>`<SAMP>[^ <small>...</small> ]</SAMP>'
<DD><A NAME="IDX2565"></A>
<A NAME="IDX2566"></A>
`<SAMP>[^</SAMP>'は<EM>文字選択の補集合</EM>の始まりを意味し、
指定した文字を除く任意の文字に一致する。
すなわち、`<SAMP>[^a-z0-9A-Z]</SAMP>'は、
英文字と数字文字を<EM>除く</EM>すべての文字に一致する。
<P>

`<SAMP>^</SAMP>'は文字選択の先頭になければ文字選択では特別な意味を持たない。
`<SAMP>^</SAMP>'に続く文字は先頭にあるものとして扱われる
（いいかえれば、ここでは`<SAMP>-</SAMP>'や`<SAMP>]</SAMP>'は特別な意味を持たない）。
<P>

文字選択の補集合は、一致しない文字として改行を指定しない限り、
改行にも一致する。
この点は、<CODE>grep</CODE>のようなプログラムでの正規表現の扱い方と対照的である。
<P>

<DT>`<SAMP>^</SAMP>'
<DD><A NAME="IDX2567"></A>
<A NAME="IDX2568"></A>
空の文字列に一致する特別な文字であり、
一致を取る対象のテキストの行頭のみに一致する。
それ以外では、一致に失敗する。
したがって、`<SAMP>^foo</SAMP>'は、行頭にある`<SAMP>foo</SAMP>'に一致する。
<P>

バッファのかわりに文字列と一致を取るときには、
`<SAMP>^</SAMP>'は文字列の先頭や改行文字`<SAMP>\n</SAMP>'のうしろに一致する。
<P>

<DT>`<SAMP>$</SAMP>'
<DD><A NAME="IDX2569"></A>
<A NAME="IDX2570"></A>
`<SAMP>^</SAMP>'と同様だが行末のみに一致する。
したがって、`<SAMP>x+$</SAMP>'は、
行末にある1文字以上の`<SAMP>x</SAMP>'から成る文字列に一致する。
<P>

バッファのかわりに文字列と一致を取るときには、
`<SAMP>$</SAMP>'は文字列の末尾や改行文字`<SAMP>\n</SAMP>'のまえに一致する。
<P>

<DT>`<SAMP>\</SAMP>'
<DD><A NAME="IDX2571"></A>
<A NAME="IDX2572"></A>
2つの機能がある。
（`<SAMP>\</SAMP>'を含む）特別な文字をクォートする（意味を抑える）ことと、
特別な構成を導入することである。
<P>

`<SAMP>\</SAMP>'は特別な文字をクォートするので、
`<SAMP>\$</SAMP>'は文字`<SAMP>$</SAMP>'だけに一致する正規表現、
`<SAMP>\[</SAMP>'は文字`<SAMP>[</SAMP>'だけに一致する正規表現、
といった具合になる。
<P>

`<SAMP>\</SAMP>'にはLisp文字列の入力構文（see 節 <A HREF="elisp_3.html#SEC34">2.3.8 文字列型</A>）でも
特別な意味があり、`<SAMP>\</SAMP>'でクォートする必要があることに注意してほしい。
たとえば、文字`<SAMP>\</SAMP>'に一致する正規表現は`<SAMP>\\</SAMP>'である。
文字群`<SAMP>\\</SAMP>'を含むLisp文字列を書くには、各`<SAMP>\</SAMP>'をクォートするために
`<SAMP>\</SAMP>'が必要である。
したがって、`<SAMP>\</SAMP>'に一致する正規表現の入力構文は<CODE>"\\\\"</CODE>である。
</DL>
<P>

<STRONG>注意：</STRONG><CODE> </CODE>従来との互換性のために、
特別な文字がそれらの特別な意味をなしえない文脈で使われた場合には、
普通の文字として扱われる。
たとえば、`<SAMP>*foo</SAMP>'では、`<SAMP>*</SAMP>'の対象となる正規表現が直前にないため、
`<SAMP>*</SAMP>'は普通の文字として扱われる。
このようなふるまいに依存することはよいことではない。
特別な文字は書く位置に関係なくクォートするべきである。
<P>

多くの場合、任意の文字を伴う`<SAMP>\</SAMP>'はその文字だけに一致します。
しかし、いくつか例外があって、
`<SAMP>\</SAMP>'で始まる2文字列が特別な意味を持つ場合があります。
（2文字目にくる文字は、
単独で使った場合にはつねに普通の文字として扱われる。）
以下に`<SAMP>\</SAMP>'の構成を示します。
<P>

<DL COMPACT>
<DT>`<SAMP>\|</SAMP>'
<DD><A NAME="IDX2573"></A>
<A NAME="IDX2574"></A>
<A NAME="IDX2575"></A>
選択肢を指定する。
`<SAMP>\|</SAMP>'をあいだに伴った2つの正規表現<VAR>a</VAR>と<VAR>b</VAR>は、
<VAR>a</VAR>か<VAR>b</VAR>のいずれかに一致する文字列に一致する正規表現となる。
<P>

したがって、`<SAMP>foo\|bar</SAMP>'は、`<SAMP>foo</SAMP>'や`<SAMP>bar</SAMP>'に一致するが、
それ以外の文字列には一致しない。
<P>

`<SAMP>\|</SAMP>'は、周囲にある適用しうる正規表現の中でも最大のものに適用される。
`<SAMP>\|</SAMP>'によるグループ化を制限するのは、
これを囲む`<SAMP>\( <small>...</small> \)</SAMP>'によるグループ化だけである。
<P>

何度`<SAMP>\|</SAMP>'を使っても処理できるだけの十分なバックトラック能力がある。
<P>

<DT>`<SAMP>\( <small>...</small> \)</SAMP>'
<DD><A NAME="IDX2576"></A>
<A NAME="IDX2577"></A>
<A NAME="IDX2578"></A>
<A NAME="IDX2579"></A>
<A NAME="IDX2580"></A>
以下の3つの目的を果たすグループ化のための構成。
<P>

<OL>
<LI>
他の操作に使うために一連の選択肢`<SAMP>\|</SAMP>'を括る。
したがって、`<SAMP>\(foo\|bar\)x</SAMP>'は、
`<SAMP>foox</SAMP>'か`<SAMP>barx</SAMP>'のいずれかに一致する。
<P>

<LI>
後置演算子、`<SAMP>*</SAMP>'、`<SAMP>+</SAMP>'、`<SAMP>?</SAMP>'を適用できるように、
複雑な正規表現を括る。
したがって、`<SAMP>ba\(na\)*</SAMP>'は、
`<SAMP>bananana</SAMP>'のように、（0個以上の）任意個の
文字列`<SAMP>na</SAMP>'に一致する。
<P>

<LI>
あとで参照できるように、一致した部分文字列を記録する。
</OL>
<P>

最後の使い方は、括弧によるグループ化という考え方から
派生したものではない。
同一の`<SAMP>\( <small>...</small> \)</SAMP>'構成に与えた2つめの別の機能である。
実用上、これら2つの意味が混同されることはないからである。
この機能をつぎに説明する。
<P>

<DT>`<SAMP>\<VAR>digit</VAR></SAMP>'
<DD><VAR>d</VAR>番目に現れた`<SAMP>\( <small>...</small> \)</SAMP>'に一致したテキストと
同じテキストに一致する。
<P>

いいかえれば、一致を処理するときには、
`<SAMP>\( <small>...</small> \)</SAMP>'構成の末尾に達すると、
この構成に一致したテキストの始めと終りを記録する。
そして、正規表現のそれよりうしろでは、
『<VAR>d</VAR>番目に現れた`<SAMP>\( <small>...</small> \)</SAMP>'に一致したテキスト』という意味で
それがなんであろうと`<SAMP>\</SAMP>'に続けて数字<VAR>d</VAR>を使える。
<P>

1つの正規表現内に現れる最初の9個の`<SAMP>\( <small>...</small> \)</SAMP>'に一致する文字列には、
正規表現中で開き括弧が現れた順に、1から9までの番号を割り振る。
そのため、`<SAMP>\1</SAMP>'から`<SAMP>\9</SAMP>'で、
対応する`<SAMP>\( <small>...</small> \)</SAMP>'に一致したテキストを参照できる。
<P>

たとえば、`<SAMP>\(.*\)\1</SAMP>'は、改行を含まない文字列で、かつ、
前半と後半が同一である文字列に一致する。
`<SAMP>\(.*\)</SAMP>'は前半部分に一致し、それはどのようなものでもかまわない。
一方、それに続く`<SAMP>\1</SAMP>'は、
前半部分とまったく同じテキストに一致しなければならない。
<P>

<DT>`<SAMP>\w</SAMP>'
<DD><A NAME="IDX2581"></A>
<A NAME="IDX2582"></A>
任意の単語構成文字に一致する。
エディタの構文テーブルによってこの文字が決まる。
see 節 <A HREF="elisp_35.html#SEC564">34. 構文テーブル</A>。
<P>

<DT>`<SAMP>\W</SAMP>'
<DD><A NAME="IDX2583"></A>
<A NAME="IDX2584"></A>
単語構成文字以外の文字に一致する。
<P>

<DT>`<SAMP>\s<VAR>code</VAR></SAMP>'
<DD><A NAME="IDX2585"></A>
<A NAME="IDX2586"></A>
構文コードが<VAR>code</VAR>である文字だけに一致する。
ここで、<VAR>code</VAR>は構文コードを表す文字である。
つまり、`<SAMP>w</SAMP>'は単語構成要素を、
`<SAMP>-</SAMP>'は白文字を、`<SAMP>(</SAMP>'は開き括弧を表すといった具合である。
白文字の構文を表すには、`<SAMP>-</SAMP>'か空白のいずれかを使う。
構文コードとそれらを表す文字の一覧については、
see 節 <A HREF="elisp_35.html#SEC567">34.2.1 構文クラス一覧</A>。
<P>

<DT>`<SAMP>\S<VAR>code</VAR></SAMP>'
<DD><A NAME="IDX2587"></A>
<A NAME="IDX2588"></A>
構文が<VAR>code</VAR>でない任意の文字に一致する。
</DL>
<P>

つぎの正規表現は空の文字列に一致します。
つまりこれらは文字を使用しませんが、
これらが一致するかどうか文脈に依存します。
<P>

<DL COMPACT>
<DT>`<SAMP>\`</SAMP>'
<DD><A NAME="IDX2589"></A>
<A NAME="IDX2590"></A>
空の文字列に一致するが、
一致対象であるバッファや文字列の先頭に限る。
<P>

<DT>`<SAMP>\'</SAMP>'
<DD><A NAME="IDX2591"></A>
<A NAME="IDX2592"></A>
空の文字列に一致するが、
一致対象であるバッファや文字列の末尾に限る。
<P>

<DT>`<SAMP>\=</SAMP>'
<DD><A NAME="IDX2593"></A>
<A NAME="IDX2594"></A>
空の文字列に一致するが、ポイント位置に限る。
（文字列に対する一致ではこの構文は定義されない。）
<P>

<DT>`<SAMP>\b</SAMP>'
<DD><A NAME="IDX2595"></A>
<A NAME="IDX2596"></A>
空の文字列に一致するが、単語の先頭や末尾に限る。
したがって、`<SAMP>\bfoo\b</SAMP>'は、単語として独立して現れる`<SAMP>foo</SAMP>'に一致する。
`<SAMP>\bballs?\b</SAMP>'は、単語として独立して現れる
`<SAMP>ball</SAMP>'や`<SAMP>balls</SAMP>'に一致する。
<P>

`<SAMP>\b</SAMP>'は、
バッファの先頭や末尾にあるテキストとは無関係に、
バッファの先頭や末尾にも一致する。
<P>

<DT>`<SAMP>\B</SAMP>'
<DD><A NAME="IDX2597"></A>
<A NAME="IDX2598"></A>
空の文字列に一致するが、単語の先頭や末尾<EM>以外</EM>に限る。
<P>

<DT>`<SAMP>\&#60;</SAMP>'
<DD><A NAME="IDX2599"></A>
<A NAME="IDX2600"></A>
空の文字列に一致するが、単語の先頭に限る。
`<SAMP>\&#60;</SAMP>'はバッファの先頭にも一致するが、単語構成文字が続く場合に限る。
<P>

<DT>`<SAMP>\&#62;</SAMP>'
<DD><A NAME="IDX2601"></A>
<A NAME="IDX2602"></A>
空の文字列に一致するが、単語の末尾に限る。
`<SAMP>\&#62;</SAMP>'はバッファの末尾にも一致するが、
単語構成文字で終了している場合に限る。
</DL>
<P>

<A NAME="IDX2603"></A>
任意の文字列が正しい正規表現ではありません。
たとえば、（`<SAMP>[]]</SAMP>'のような少数の例外を除けば）
角括弧が対応していない文字列は正しくありませんし、
1つの`<SAMP>\</SAMP>'で終る文字列も正しくありません。
不正な正規表現を探索関数に渡すと、
エラー<CODE>invalid-regexp</CODE>が通知されます。
<P>

<A NAME="IDX2604"></A>
<DL>
<DT><U>Function:</U> <B>regexp-quote</B> <I>string</I>
<DD>この関数は、<VAR>string</VAR>だけに正確に一致する正規表現の文字列を返す。
これにより、正規表現を必要とする関数を呼び出すときに
この文字列だけに正確に一致できる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(regexp-quote "^The cat$")
     => "\\^The cat\\$"
</pre></td></tr></table><P>

<CODE>regexp-quote</CODE>の用途の1つは、
正規表現で記述された文脈に正確に一致する文字列を組み合わせることである。
たとえば、つぎは、白文字で囲まれた<VAR>string</VAR>の値で表される文字列を探索する。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(re-search-forward
 (concat "\\s-" (regexp-quote string) "\\s-"))
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2605"></A>
<DL>
<DT><U>Function:</U> <B>regexp-opt</B> <I>strings &#38;optional paren</I>
<DD><A NAME="IDX2606"></A>
この関数は、文字列<VAR>strings</VAR>のいずれかに一致する
効率よい正規表現を返す。
これは、たとえばフォントロック（font-lock）モードなどで、
可能な限り高速な一致や探索を行う必要がある場合に有用である。
<P>

省略可能な引数<VAR>paren</VAR>が<CODE>nil</CODE>以外であると、
返される正規表現はつねに少なくとも1つの括弧によるグループ構文で囲まれる。
<P>

つぎの<CODE>regexp-opt</CODE>の簡略版定義は、
実際の値に等価な（ただしそれほど効率よくない）正規表現を生成する。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun regexp-opt (strings paren)
  (let ((open-paren (if paren "\\(" ""))
        (close-paren (if paren "\\)" "")))
    (concat open-paren
            (mapconcat 'regexp-quote strings "\\|")
            close-paren)))
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2607"></A>
<DL>
<DT><U>Function:</U> <B>regexp-opt-depth</B> <I>regexp</I>
<DD><A NAME="IDX2608"></A>
この関数は、var{regexp}内のグループ化構文（括弧で括った式）の
総個数を返す。
</DL>
<P>

<A NAME="Regexp Example"></A>
<HR SIZE="6">
<br><A NAME="SEC553"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC552"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC554"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Regexp Example"></A>
<H3> 33.2.2 複雑な正規表現の例 </H3>
<!--docid::SEC553::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Regexp%20Example">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Regexp%20Example</a>"<br>
"texi/elisp21/複雑な正規表現の例"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CA%A3%BB%A8%A4%CA%C0%B5%B5%AC%C9%BD%B8%BD%A4%CE%CE%E3">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

ここでは、任意個数の白文字を伴った文末を認識するために
Emacsで使われている複雑な正規表現について述べます。
それは変数<CODE>sentence-end</CODE>の値です。
<P>

まず、タブ文字と空白を区別するためにLisp構文の文字列として
正規表現を示します。
文字列定数はダブルクォートで始まり終ります。
`<SAMP>\"</SAMP>'は文字列の一部としてのダブルクォート、
`<SAMP>\\</SAMP>'は文字列の一部としてのバックスラッシュ、
`<SAMP>\t</SAMP>'はタブ、`<SAMP>\n</SAMP>'は改行を表します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>"[.?!][]\"')}]*\\($\\| $\\|\t\\|  \\)[ \t\n]*"
</pre></td></tr></table><P>

対照的に、変数<CODE>sentence-end</CODE>を評価するとつぎのように
なっているはずです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>sentence-end
     => "[.?!][]\"')}]*\\($\\| $\\|  \\|  \\)[       
]*"
</pre></td></tr></table><P>

この出力では、タブと改行はそれ自身として現れています。
<P>

この正規表現には、連続してつぎのような4つの部分が含まれています。
<P>

<DL COMPACT>
<DT><CODE>[.?!]</CODE>
<DD>パターンの最初の部分は、3つの文字、ピリオド、疑問符、感嘆符の
いずれかに一致する文字選択である。
一致部分はこれらの3つの文字の1つで始まる必要がある。
<P>

<DT><CODE>[]\"')}]*</CODE>
<DD>パターンの2番目の部分は、ピリオド、疑問符、感嘆符のいずれかに続く、
任意の閉じ括弧やクォーテーションマークの0個以上の繰り返しに一致する。
<CODE>\"</CODE>は、文字列内のダブルクォートを表すLisp構文である。
最後の`<SAMP>*</SAMP>'は、直前の正規表現（この場合は文字選択）を
0回以上繰り返すことを表す。
<P>

<DT><CODE>\\($\\| $\\|\t\\|  \\)</CODE>
<DD>パターンの3番目の部分は、文末に続く白文字、
つまり、（空白を伴うかもしれない）行末、1つのタブ、2つの空白の
いずれかに一致する。
2つのバックスラッシュは、括弧や縦棒を正規表現の構文にする。
括弧はグループを区切り、縦棒は選択肢を区切る。
ドル記号は行末に一致するために用いている。
<P>

<DT><CODE>[ \t\n]*</CODE>
<DD>パターンの最後の部分は、
文末に最低限必要な白文字より余計な白文字に一致する。
</DL>
<P>

<A NAME="Regexp Search"></A>
<HR SIZE="6">
<br><A NAME="SEC554"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC553"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC555"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Regexp Search"></A>
<H2> 33.3 正規表現の探索 </H2>
<!--docid::SEC554::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Regexp%20Search">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Regexp%20Search</a>"<br>
"texi/elisp21/正規表現の探索"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C0%B5%B5%AC%C9%BD%B8%BD%A4%CE%C3%B5%BA%F7">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2609"></A>
<A NAME="IDX2610"></A>
<P>

GNU Emacsでは、正規表現に一致するつぎの部分を
インクリメンタルにもそうでなくも探せます。
インクリメンタルサーチコマンドについては、
<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=emacs21&node=Regexp%20Search">GNU Emacs マニュアル</a>を
参照してください。
ここでは、プログラムで有用な探索関数のみについて述べます。
基本的なものは<CODE>re-search-forward</CODE>です。
<P>

これらの探索関数は、バッファがマルチバイトであれば
正規表現をマルチバイトに変換します。
バッファがユニバイトであれば、正規表現をユニバイトに変換します。
See 節 <A HREF="elisp_33.html#SEC529">32.1 テキスト表現</A>。
<P>

<A NAME="IDX2611"></A>
<DL>
<DT><U>コマンド:</U> <B>re-search-forward</B> <I>regexp &#38;optional limit noerror repeat</I>
<DD>この関数は、カレントバッファにおいて前方へ向けて
正規表現<VAR>regexp</VAR>に一致するテキストの文字列を探索する。
関数は<VAR>regexp</VAR>に一致しないテキストはすべて飛び越え、
みつけた一致箇所の末尾へポイントを置く。
ポイントの新たな値を返す。
<P>

<VAR>limit</VAR>が<CODE>nil</CODE>以外（カレントバッファ内の位置であること）であると、
探索の上限を表す。
その位置を越える箇所での一致は受け入れない。
<P>

<VAR>repeat</VAR>を指定してあると（正の数であること）、
その回数だけ探索を繰り返す（一致箇所の末尾を新たな探索の開始位置とする）。
連続してこれらの探索に成功すると関数は成功し、
ポイントを移動してその新たな値を返す。
さもなければ探索は失敗である。
<P>

関数が失敗した場合の動作は、<VAR>noerror</VAR>の値に依存する。
<VAR>noerror</VAR>が<CODE>nil</CODE>であると、
エラー<CODE>search-failed</CODE>を通知する。
<VAR>noerror</VAR>が<CODE>t</CODE>であると、
<CODE>re-search-forward</CODE>はなにもせずに<CODE>nil</CODE>を返す。
<VAR>noerror</VAR>が<CODE>nil</CODE>でも<CODE>t</CODE>でもないと、
<CODE>re-search-forward</CODE>はポイントを<VAR>limit</VAR>（あるいはバッファの末尾）へ
移動して<CODE>nil</CODE>を返す。
<P>

つぎの例では、ポイントは始めは`<SAMP>T</SAMP>'のまえにある。
探索を呼び出すと、ポイントは当該行の末尾
（`<SAMP>hat</SAMP>'の`<SAMP>t</SAMP>'と改行のあいだ）へ移動する。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
I read "-!-The cat in the hat
comes back" twice.
---------- Buffer: foo ----------

(re-search-forward "[a-z]+" nil t 5)
     => 27

---------- Buffer: foo ----------
I read "The cat in the hat-!-
comes back" twice.
---------- Buffer: foo ----------
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2612"></A>
<DL>
<DT><U>コマンド:</U> <B>re-search-backward</B> <I>regexp &#38;optional limit noerror repeat</I>
<DD>この関数は、カレントバッファにおいて後方へ向けて
正規表現<VAR>regexp</VAR>に一致するテキストの文字列を探索し、
みつけた一致箇所の先頭へポイントを置く。
<P>

この関数は<CODE>re-search-forward</CODE>に類似したものであるが、
単純な鏡像ではない。
<CODE>re-search-forward</CODE>は、一致箇所の先頭が
開始位置に可能な限り近い一致箇所を探す。
<CODE>re-search-backward</CODE>が完全な鏡像であれば、
一致箇所の末尾が可能な限り近い一致箇所を探す。
しかし、実際には、一致箇所の先頭が可能な限り近い一致箇所を探す。
これは、正規表現との一致をとる処理は、
指定開始位置において先頭から末尾へ向けてつねに行われるからである。
<P>

<CODE>re-search-forward</CODE>の完全な鏡像には、
正規表現の一致を末尾から先頭へ向けて行う特別な機能が必要である。
それを実装する手間をかけるほどの価値はない。
</DL>
<P>

<A NAME="IDX2613"></A>
<DL>
<DT><U>Function:</U> <B>string-match</B> <I>regexp string &#38;optional start</I>
<DD>この関数は、文字列<VAR>string</VAR>において正規表現<VAR>regexp</VAR>に一致した
最初の箇所の添字を返す。
あるいは、一致がなければ<CODE>nil</CODE>を返す。
<VAR>start</VAR>が<CODE>nil</CODE>以外であると、
<VAR>string</VAR>の指定した添字から探索を始める。
<P>

たとえばつぎのとおりである。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(string-match
 "quick" "The quick brown fox jumped quickly.")
     => 4
(string-match
 "quick" "The quick brown fox jumped quickly." 8)
     => 27
</pre></td></tr></table><P>

文字列の最初の文字の添字は0であり、
2番目の文字の添字は1であるといった具合になる。
<P>

この関数から戻ったあとでは、
一致箇所を越えた最初の文字の添字は<CODE>(match-end 0)</CODE>で得られる。
see 節 <A HREF="elisp_34.html#SEC557">33.6 マッチデータ</A>。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(string-match
 "quick" "The quick brown fox jumped quickly." 8)
     => 27

(match-end 0)
     => 32
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2614"></A>
<DL>
<DT><U>Function:</U> <B>looking-at</B> <I>regexp</I>
<DD>この関数は、カレントバッファ内のポイントの直後のテキストが
正規表現<VAR>regexp</VAR>に一致するかどうかを調べる。
ここで『直後』とは、開始位置は固定されていて、
ポイントのうしろの最初の文字で始まる場合にのみ探索は成功する。
結果は、一致すれば<CODE>t</CODE>であり、さもなければ<CODE>nil</CODE>である。
<P>

この関数はポイントを移動しないが、マッチデータを更新する。
<CODE>match-beginning</CODE>や<CODE>match-end</CODE>を使ってマッチデータを参照できる。
<P>

つぎの例では、ポイントは`<SAMP>T</SAMP>'の直前にある。
ポイントがこれ以外の場所にあると結果は<CODE>nil</CODE>になる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
I read "-!-The cat in the hat
comes back" twice.
---------- Buffer: foo ----------

(looking-at "The cat in the hat$")
     => t
</pre></td></tr></table></DL>
<P>

<A NAME="POSIX Regexps"></A>
<HR SIZE="6">
<br><A NAME="SEC555"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC554"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC556"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="POSIX Regexps"></A>
<H2> 33.4 POSIXの正規表現探索 </H2>
<!--docid::SEC555::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=POSIX%20Regexps">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=POSIX%20Regexps</a>"<br>
"texi/elisp21/POSIXの正規表現探索"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2FPOSIX%A4%CE%C0%B5%B5%AC%C9%BD%B8%BD%C3%B5%BA%F7">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

普通の正規表現関数は、`<SAMP>\|</SAMP>'や反復構文を扱うために必要なときには
バックトラックしますが、これを行い続けるのは
<EM>なんらか</EM>の一致をみつけるまでです。
みつけてしまえば、それらは成功してみつけた最初の一致を報告します。
<P>

本節では、正規表現の一致に関するPOSIX規格で規定された
完全なバックトラックを行う代替の探索関数について述べます。
それらはすべての可能性を試し尽くしすべての一致箇所を探し終える
までバックトラックを継続してます。
そのため、POSIXで要求されるとおりの最長の一致を報告できるのです。
これは動作がとても遅いですから、最長一致が本当に必要な場合に限って
これらの関数を使ってください。
<P>

<A NAME="IDX2615"></A>
<DL>
<DT><U>Function:</U> <B>posix-search-forward</B> <I>regexp &#38;optional limit noerror repeat</I>
<DD>これは<CODE>re-search-forward</CODE>と同様であるが、
正規表現の一致に関するPOSIX規格で規定された完全なバックトラックを行う。
</DL>
<P>

<A NAME="IDX2616"></A>
<DL>
<DT><U>Function:</U> <B>posix-search-backward</B> <I>regexp &#38;optional limit noerror repeat</I>
<DD>これは<CODE>re-search-backward</CODE>と同様であるが、
正規表現の一致に関するPOSIX規格で規定された完全なバックトラックを行う。
</DL>
<P>

<A NAME="IDX2617"></A>
<DL>
<DT><U>Function:</U> <B>posix-looking-at</B> <I>regexp</I>
<DD>これは<CODE>looking-at</CODE>と同様であるが、
正規表現の一致に関するPOSIX規格で規定された完全なバックトラックを行う。
</DL>
<P>

<A NAME="IDX2618"></A>
<DL>
<DT><U>Function:</U> <B>posix-string-match</B> <I>regexp string &#38;optional start</I>
<DD>これは<CODE>string-match</CODE>と同様であるが、
正規表現の一致に関するPOSIX規格で規定された完全なバックトラックを行う。
</DL>
<P>

<A NAME="Search and Replace"></A>
<HR SIZE="6">
<br><A NAME="SEC556"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC555"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC557"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Search and Replace"></A>
<H2> 33.5 探索と置換 </H2>
<!--docid::SEC556::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Search%20and%20Replace">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Search%20and%20Replace</a>"<br>
"texi/elisp21/探索と置換"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C3%B5%BA%F7%A4%C8%C3%D6%B4%B9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2619"></A>
<P>

<A NAME="IDX2620"></A>
<DL>
<DT><U>Function:</U> <B>perform-replace</B> <I>from-string replacements query-flag regexp-flag delimited-flag &#38;optional repeat-count map</I>
<DD>この関数は、<CODE>query-replace</CODE>と関連するコマンドの中身である。
<VAR>from-string</VAR>の出現を探しだし、それらの一部やすべてを置き換える。
<VAR>query-flag</VAR>が<CODE>nil</CODE>であると、すべての出現を置換する。
さもなければ、1つ1つユーザーにどうするかを問い合わせる。
<P>

<VAR>regexp-flag</VAR>が<CODE>nil</CODE>以外であると、
<VAR>from-string</VAR>を正規表現として扱う。
さもなければ、その字面とおりに一致する。
<VAR>delimited-flag</VAR>が<CODE>nil</CODE>以外であると、
単語区切りで囲まれたもののみを対象にする。
<P>

引数<VAR>replacements</VAR>は、出現を置き換えるものを指定する。
それが文字列であれば、その文字列を使う。
文字列のリストでもよく、要素を巡回して使う。
<P>

<VAR>repeat-count</VAR>が<CODE>nil</CODE>以外であれば、整数であること。
これは、<VAR>replacements</VAR>のリスト内の各文字列を
つぎに進めるまえに何回使用するかを指定する。
<P>

通常、キーマップ<CODE>query-replace-map</CODE>で、
可能なユーザーの応答を定義する。
引数<VAR>map</VAR>が<CODE>nil</CODE>以外であれば、
<CODE>query-replace-map</CODE>のかわりに使うキーマップである。
</DL>
<P>

<A NAME="IDX2621"></A>
<DL>
<DT><U>Variable:</U> <B>query-replace-map</B>
<DD>この変数は、<CODE>y-or-n-p</CODE>や<CODE>map-y-or-n-p</CODE>に加えて、
<CODE>query-replace</CODE>や関連する関数に対する
正しいユーザー応答を定義する特別なキーマップを保持する。
2つの意味で普通のものではない。
<P>

<UL>
<LI>
『キーバインディング』はコマンドではなく、
このキーマップを用いる関数にのみ意味がある単なるシンボルである。
<P>

<LI>
プレフィックスキーは扱えない。
各キーバインディングは単一イベントのキー列である必要がある。
これは、関数では入力を得るために<CODE>read-key-sequence</CODE>を使わずに、
『自前』でイベントを読み取り探索するからである。
</UL>
</DL>
<P>

<CODE>query-replace-map</CODE>向けの意味のある『バインディング』をつぎに示します。
<CODE>query-replace</CODE>と関連するものだけに意味のあるものもあります。
<P>

<DL COMPACT>
<DT><CODE>act</CODE>
<DD>当該動作を行う、いいかえれば『yes』。
<P>

<DT><CODE>skip</CODE>
<DD>この問いに対する動作は行わない、いいかえれば『no』。
<P>

<DT><CODE>exit</CODE>
<DD>この問いには『no』で答え、
残りの応答も『no』と仮定して一連の問いを止める。
<P>

<DT><CODE>act-and-exit</CODE>
<DD>この問いには『yes』で答え、
残りの応答は『no』と仮定して一連の問いを止める。
<P>

<DT><CODE>act-and-show</CODE>
<DD>この問いには『yes』で答えるが、結果を表示する。
つぎの問いへは進まない。
<P>

<DT><CODE>automatic</CODE>
<DD>この問いと以降の一連の問いに『yes』で答え、
これ以降ユーザーに問い合わせない。
<P>

<DT><CODE>backup</CODE>
<DD>問いに答えたまえの箇所へ戻る。
<P>

<DT><CODE>edit</CODE>
<DD>この問いに対処するために、通常の動作のかわりに再帰編集に入る。
<P>

<DT><CODE>delete-and-edit</CODE>
<DD>対象のテキストを削除してから、
それを置き換えるために再帰編集に入る。
<P>

<DT><CODE>recenter</CODE>
<DD>ウィンドウの中央に位置決めして再表示してから、
同じ問いを問い直す。
<P>

<DT><CODE>quit</CODE>
<DD>ただちに中断する。
<CODE>y-or-n-p</CODE>と関連する関数でのみ、この応答を用いる。
<P>

<DT><CODE>help</CODE>
<DD>ヘルプを表示してから、再度問い直す。
</DL>
<P>

<A NAME="Match Data"></A>
<HR SIZE="6">
<br><A NAME="SEC557"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC556"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC558"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Match Data"></A>
<H2> 33.6 マッチデータ </H2>
<!--docid::SEC557::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Match%20Data">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Match%20Data</a>"<br>
"texi/elisp21/マッチデータ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%DE%A5%C3%A5%C1%A5%C7%A1%BC%A5%BF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2622"></A>
<P>

Emacsは、正規表現の探索中に捜し出したテキスト断片の開始／終了位置を
記録しています。
つまり、たとえば、rmailメッセージ内で日付のような複雑なパターンを
探索してから、パターンの制御をもとに一致した一部分を取り出せるのです。
<P>

マッチデータは、通常、もっとも最近に行った探索のみを記述するので、
あとで使用したい探索とそのマッチデータを使うあいだに、
不注意に別の探索を行わないように注意してください。
あいだで探索を行う必要がある場合には、その周りで
マッチデータを保存／復元してそれらが上書きされないようにします。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC558">33.6.1 一致したテキストの置換</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Replacing a substring that was matched.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC559">33.6.2 マッチデータの簡単な参照</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Accessing single items of match data,
			    such as where a particular subexpression started.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC560">33.6.3 マッチデータ全体を参照する</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Accessing the entire match data at once, as a list.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_34.html#SEC561">33.6.4 マッチデータの保存と復元</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Saving and restoring the match data.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Replacing Match"></A>
<HR SIZE="6">
<br><A NAME="SEC558"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC557"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC559"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Replacing Match"></A>
<H3> 33.6.1 一致したテキストの置換 </H3>
<!--docid::SEC558::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Replacing%20Match">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Replacing%20Match</a>"<br>
"texi/elisp21/一致したテキストの置換"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B0%EC%C3%D7%A4%B7%A4%BF%A5%C6%A5%AD%A5%B9%A5%C8%A4%CE%C3%D6%B4%B9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

この関数は、最後の探索で一致したテキストを<VAR>replacement</VAR>で置換します。
<P>

<A NAME="IDX2623"></A>
<A NAME="IDX2624"></A>
<DL>
<DT><U>Function:</U> <B>replace-match</B> <I>replacement &#38;optional fixedcase literal string subexp</I>
<DD>この関数は、最後の探索で一致したバッファ内（あるいは文字列<VAR>string</VAR>）の
テキストを置換する。
当該テキストを<VAR>replacement</VAR>で置き換える。
<P>

バッファで最後に探索を行った場合には、
<VAR>string</VAR>に<CODE>nil</CODE>を指定すること。
そうすると、<CODE>replace-match</CODE>はバッファを編集することで置換を行い、
置換したテキストの末尾にポイントを置き<CODE>t</CODE>を返す。
<P>

文字列で探索した場合には、<VAR>string</VAR>に同じ文字列を渡すこと。
そうすると、<CODE>replace-match</CODE>は新たな文字列を構築することで
置換を行い、新たな文字列を返す。
<P>

<VAR>fixedcase</VAR>が<CODE>nil</CODE>以外であると、
置換テキストの大文字小文字は変更しない。
さもなければ、置換テキストの大文字小文字は、
対象テキストの大文字小文字に応じて変換される。
元テキストがすべて大文字であると、置換テキストも大文字に変換される。
元テキストの最初の単語が大文字で始まっていると、
置換テキストの最初の単語も大文字で始める。
元テキストが1単語のみであり、しかも、その単語が大文字1文字であると、
<CODE>replace-match</CODE>はすべてが大文字ではなく大文字で始まるとみなす。
<P>

<CODE>case-replace</CODE>が<CODE>nil</CODE>であると、
<VAR>fixed-case</VAR>の値に関わらず、大文字小文字変換を行わない。
see 節 <A HREF="elisp_34.html#SEC562">33.7 探索と大文字小文字</A>。
<P>

<VAR>literal</VAR>が<CODE>nil</CODE>以外であると、
必要に応じて大文字小文字変換は行うものの
<VAR>replacement</VAR>をそのまま挿入する。
それが<CODE>nil</CODE>（デフォルト）であると、
文字`<SAMP>\</SAMP>'を特別に扱う。
<VAR>replacement</VAR>に`<SAMP>\</SAMP>'が現れるときには、
つぎの列のいずれかであること。
<P>

<DL COMPACT>
<DT>`<SAMP>\&#38;</SAMP>'
<DD><A NAME="IDX2625"></A>
<A NAME="IDX2626"></A>
`<SAMP>\&#38;</SAMP>'は置換対象のテキスト全体を表す。
<P>

<DT>`<SAMP>\<VAR>n</VAR></SAMP>'
<DD><A NAME="IDX2627"></A>
<A NAME="IDX2628"></A>
<VAR>n</VAR>を数字文字とすると`<SAMP>\<VAR>n</VAR></SAMP>'は、
もとの正規表現内の<VAR>n</VAR>番目の部分式に一致したテキストを表す。
部分式とは、`<SAMP>\(<small>...</small>\)</SAMP>'で囲んでグループ化した式である。
<P>

<DT>`<SAMP>\\</SAMP>'
<DD><A NAME="IDX2629"></A>
<A NAME="IDX2630"></A>
`<SAMP>\\</SAMP>'は置換テキスト内で1つの`<SAMP>\</SAMP>'を表す。
</DL>
<P>

<VAR>subexp</VAR>が<CODE>nil</CODE>以外であると、
一致箇所全体ではなく正規表現の<VAR>subexp</VAR>番目の部分式に
一致した箇所のみを置換することを指示する。
たとえば、`<SAMP>foo \(ba*r\)</SAMP>'に一致させたあとで、
<VAR>subexp</VAR>に1を指定して<CODE>replace-match</CODE>を呼び出すと、
`<SAMP>\(ba*r\)</SAMP>'に一致したテキストのみを置換することを意味する。
</DL>
<P>

<A NAME="Simple Match Data"></A>
<HR SIZE="6">
<br><A NAME="SEC559"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC558"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC560"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Simple Match Data"></A>
<H3> 33.6.2 マッチデータの簡単な参照 </H3>
<!--docid::SEC559::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Simple%20Match%20Data">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Simple%20Match%20Data</a>"<br>
"texi/elisp21/マッチデータの簡単な参照"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%DE%A5%C3%A5%C1%A5%C7%A1%BC%A5%BF%A4%CE%B4%CA%C3%B1%A4%CA%BB%B2%BE%C8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節では、最後の探索や一致操作において
なにに一致したのかを調べるためのマッチデータの使い方を説明します。
<P>

一致したテキスト全体や正規表現の括弧で括った特定の部分式に一致した
テキストを調べることができます。
以下の関数の引数<VAR>count</VAR>でどれかを指定します。
<VAR>count</VAR>がゼロであれば、一致全体を調べることになります。
<VAR>count</VAR>が正であれば、望みの部分式を指定します。
<P>

正規表現の部分式は、エスケープした括弧`<SAMP>\(<small>...</small>\)</SAMP>'でグループ化した
式であることに注意してください。
<VAR>count</VAR>番目の部分式は、正規表現全体の先頭から
`<SAMP>\(</SAMP>'の出現を数えてみつけます。
最初の部分式は1、つぎは2、といった具合です。
部分式は正規表現だけにあります。
単純な文字列探索のあとでは、利用可能な情報は一致全体に関するものだけです。
<P>

探索に失敗すると、マッチデータを変更することもしないこともあります。
過去には探索に失敗しても変更しなかったのですが、
将来そうなります。
<P>

<A NAME="IDX2631"></A>
<DL>
<DT><U>Function:</U> <B>match-string</B> <I>count &#38;optional in-string</I>
<DD>この関数は、最後の探索や一致操作で一致したテキストを文字列として返す。
<VAR>count</VAR>がゼロであるとテキスト全体を返す。
<VAR>count</VAR>が正であれば、<VAR>count</VAR>番目の括弧で囲んだ部分式に対応する
部分のみを返す。
<VAR>count</VAR>が範囲を越えていたり、当該部分式に一致するものがない場合には、
値は<CODE>nil</CODE>である。
<P>

最後の探索や一致操作を<CODE>string-match</CODE>で文字列に対して行った場合には、
引数<VAR>in-string</VAR>として同じ文字列を渡すこと。
バッファの探索や一致のあとでは、<VAR>in-string</VAR>を省略するか
<CODE>nil</CODE>を渡すこと。
ただし、<CODE>match-string</CODE>を呼び出すときのカレントバッファが
探索を行ったときのバッファであること。
</DL>
<P>

<A NAME="IDX2632"></A>
<DL>
<DT><U>Function:</U> <B>match-string-no-properties</B> <I>count</I>
<DD>この関数は<CODE>match-string</CODE>と同様であるが、
結果にはテキスト属性を含まない。
</DL>
<P>

<A NAME="IDX2633"></A>
<DL>
<DT><U>Function:</U> <B>match-beginning</B> <I>count</I>
<DD>この関数は、最後の正規表現探索やその部分式に一致したテキストの開始位置を返す。
<P>

<VAR>count</VAR>がゼロであると、値は一致全体の開始位置である。
さもなければ、<VAR>count</VAR>は正規表現内の部分式を指定し、
関数の値は当該部分式に一致した部分の開始位置である。
<P>

一致に利用されなかった選択肢`<SAMP>\|</SAMP>'内の部分式に対しては、
値は<CODE>nil</CODE>である。
</DL>
<P>

<A NAME="IDX2634"></A>
<DL>
<DT><U>Function:</U> <B>match-end</B> <I>count</I>
<DD>この関数は<CODE>match-beginning</CODE>と同様であるが、
一致箇所の開始位置ではなく終了位置を返す点が異なる。
</DL>
<P>

コメントでテキスト内の位置を示しながら
マッチデータの利用例を示します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(string-match "\\(qu\\)\\(ick\\)"
              "The quick fox jumped quickly.")
              ;0123456789      
     => 4

(match-string 0 "The quick fox jumped quickly.")
     => "quick"
(match-string 1 "The quick fox jumped quickly.")
     => "qu"
(match-string 2 "The quick fox jumped quickly.")
     => "ick"

(match-beginning 1)       ; 一致箇所`<SAMP>qu</SAMP>'の先頭は
     => 4                 ;   添字4

(match-beginning 2)       ; 一致箇所`<SAMP>ick</SAMP>'の先頭は
     => 6                 ;   添字6

(match-end 1)             ; 一致箇所`<SAMP>qu</SAMP>'の末尾は
     => 6                 ;   添字6

(match-end 2)             ; 一致箇所`<SAMP>ick</SAMP>'の末尾は
     => 9                 ;   添字9
</pre></td></tr></table><P>

別の例も示します。
ポイントは始めは行頭にあります。
探索によって、ポイントは空白と単語`<SAMP>in</SAMP>'のあいだに移動します。
一致箇所全体の先頭はバッファの9番目の文字（`<SAMP>T</SAMP>'）であり、
最初の部分式の一致箇所の先頭は13番目の文字（`<SAMP>c</SAMP>'）です。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(list
  (re-search-forward "The \\(cat \\)")
  (match-beginning 0)
  (match-beginning 1))
    => (9 9 13)

---------- Buffer: foo ----------
I read "The cat -!-in the hat comes back" twice.
        ^   ^
        9  13
---------- Buffer: foo ----------
</pre></td></tr></table><P>

（この例では、返される添字はバッファ内位置であり、
バッファの最初の文字を1と数える。）
<P>

<A NAME="Entire Match Data"></A>
<HR SIZE="6">
<br><A NAME="SEC560"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC559"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC561"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Entire Match Data"></A>
<H3> 33.6.3 マッチデータ全体を参照する </H3>
<!--docid::SEC560::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Entire%20Match%20Data">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Entire%20Match%20Data</a>"<br>
"texi/elisp21/マッチデータ全体を参照する"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%DE%A5%C3%A5%C1%A5%C7%A1%BC%A5%BF%C1%B4%C2%CE%A4%F2%BB%B2%BE%C8%A4%B9%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

関数<CODE>match-data</CODE>と<CODE>set-match-data</CODE>は、
マッチデータ全体を一度に読んだり書いたりします。
<P>

<A NAME="IDX2635"></A>
<DL>
<DT><U>Function:</U> <B>match-data</B>
<DD>この関数は、最後の探索で一致したテキストに関するすべての情報を収めた
新たに構築したリストを返す。
要素0が式全体に一致した部分の先頭位置であり、
要素1が式全体に一致した部分の終了位置である。
つぎの2つの要素は最初の部分式に一致した部分の先頭／終了位置、
といった具合である。
一般に、要素
番号2<VAR>n</VAR>
は<CODE>(match-beginning <VAR>n</VAR>)</CODE>に対応し、
要素
番号2<VAR>n</VAR> + 1
は<CODE>(match-end <VAR>n</VAR>)</CODE>に対応する。
<P>

バッファで行った一致ではすべての要素はマーカか<CODE>nil</CODE>であり、
<CODE>string-match</CODE>により文字列で行った一致では
すべての要素は整数か<CODE>nil</CODE>である。
<P>

探索関数の呼び出しとその探索結果としてのマッチデータを参照するための
<CODE>match-data</CODE>の呼び出しのあいだには、
別の探索があってはならない。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(match-data)
     =>  (#&#60;marker at 9 in foo&#62;
          #&#60;marker at 17 in foo&#62;
          #&#60;marker at 13 in foo&#62;
          #&#60;marker at 17 in foo&#62;)
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2636"></A>
<DL>
<DT><U>Function:</U> <B>set-match-data</B> <I>match-list</I>
<DD>この関数は、<VAR>match-list</VAR>の要素からマッチデータを設定する。
<VAR>match-list</VAR>は、以前に<CODE>match-data</CODE>の呼び出しで得たリストであること。
<P>

<VAR>match-list</VAR>が存在しないバッファを指していても、エラーにはならない。
無意味な情報をマッチデータに設定するが、害にはならない。
<P>

<A NAME="IDX2637"></A>
<CODE>store-match-data</CODE>はほぼ廃れている<CODE>set-match-data</CODE>の別名である。
</DL>
<P>

<A NAME="Saving Match Data"></A>
<HR SIZE="6">
<br><A NAME="SEC561"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC560"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC562"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Saving Match Data"></A>
<H3> 33.6.4 マッチデータの保存と復元 </H3>
<!--docid::SEC561::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Saving%20Match%20Data">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Saving%20Match%20Data</a>"<br>
"texi/elisp21/マッチデータの保存と復元"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%DE%A5%C3%A5%C1%A5%C7%A1%BC%A5%BF%A4%CE%CA%DD%C2%B8%A4%C8%C9%FC%B8%B5">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

探索を行う可能性がある関数を呼び出す場合、
あとで使うためにそれ以前の探索によるマッチデータを保存したいときには、
当該関数の呼び出しの周りでマッチデータを保存し復元する必要があります。
つぎの例は、マッチデータを保存し損なった場合に生じる問題点を
示しています。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(re-search-forward "The \\(cat \\)")
     => 48
(foo)                   ; <CODE>foo</CODE>はさらに
                        ;   探索する
(match-end 0)
     => 61              ; 予期しない結果。48でない！
</pre></td></tr></table><P>

マッチデータの保存と復元は<CODE>save-match-data</CODE>で行えます。
<P>

<A NAME="IDX2638"></A>
<DL>
<DT><U>Macro:</U> <B>save-match-data</B> <I>body<small>...</small></I>
<DD>このマクロは、周りのマッチデータを保存し復元して、
<VAR>body</VAR>を実行する。
</DL>
<P>

スペシャルフォーム<CODE>save-match-data</CODE>の効果をまねるために
<CODE>match-data</CODE>とともに<CODE>set-match-data</CODE>を使うこともできます。
つぎのようにします。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(let ((data (match-data)))
  (unwind-protect
      <small>...</small>   ; もとのマッチデータを変更しても大丈夫
    (set-match-data data)))
</pre></td></tr></table><P>

プロセスフィルタ関数（see 節 <A HREF="elisp_37.html#SEC594">36.9.2 プロセスフィルタ関数</A>）や
プロセスの番兵（see 節 <A HREF="elisp_37.html#SEC596">36.10 番兵：プロセスの状態変化の検出</A>）を実行するときには、
Emacsは自動的にマッチデータを保存し復元します。
<P>

<A NAME="Searching and Case"></A>
<HR SIZE="6">
<br><A NAME="SEC562"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC561"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC563"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Searching and Case"></A>
<H2> 33.7 探索と大文字小文字 </H2>
<!--docid::SEC562::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Searching%20and%20Case">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Searching%20and%20Case</a>"<br>
"texi/elisp21/探索と大文字小文字"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C3%B5%BA%F7%A4%C8%C2%E7%CA%B8%BB%FA%BE%AE%CA%B8%BB%FA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2639"></A>
<P>

デフォルトでは、Emacsの探索は探索対象テキストの大文字小文字を区別しません。
`<SAMP>FOO</SAMP>'を探す指定を行うと、
`<SAMP>Foo</SAMP>'や`<SAMP>foo</SAMP>'にも一致するとみなします。
これは、正規表現にも適用されます。
したがって、`<SAMP>[aB]</SAMP>'は、`<SAMP>a</SAMP>'や`<SAMP>A</SAMP>'や`<SAMP>b</SAMP>'や`<SAMP>B</SAMP>'に一致します。
<P>

この機能を望まないときには、
変数<CODE>case-fold-search</CODE>に<CODE>nil</CODE>を設定します。
すると、すべての文字は大文字小文字を保ってそのとおりに一致します。
これはバッファローカルな変数ですから、
変数を変更してもカレントバッファだけに影響します。
（see 節 <A HREF="elisp_11.html#SEC151">10.10.1 バッファローカルな変数の紹介</A>。）
あるいは、<CODE>default-case-fold-search</CODE>の値を変更します。
これは、<CODE>case-fold-search</CODE>を書き変えていないバッファ向けの
デフォルト値です。
<P>

ユーザーレベルのインクリメンタルサーチ機能では、
大文字小文字の区別は異なった扱い方をします。
小英文字を与えるとその大文字にも一致しますが、
大英文字を与えると大文字のみに一致します。
しかし、これはLispコードで使用している探索関数には
まったく関係ありません。
<P>

<A NAME="IDX2640"></A>
<DL>
<DT><U>User Option:</U> <B>case-replace</B>
<DD>この変数は、置換関数が大文字小文字を保存するかどうかを決定する。
変数が<CODE>nil</CODE>であると、置換テキストをそのまま使うことを意味する。
<CODE>nil</CODE>以外の値であると、置換対象のテキストに応じて
置換テキストの大文字小文字を変換することを意味する。
<P>

この変数が実際に効果を発揮するのは関数<CODE>replace-match</CODE>においてである。
see 節 <A HREF="elisp_34.html#SEC558">33.6.1 一致したテキストの置換</A>。
</DL>
<P>

<A NAME="IDX2641"></A>
<DL>
<DT><U>User Option:</U> <B>case-fold-search</B>
<DD>このバッファローカルな変数は、
大文字小文字を区別して探索するかどうかを決定する。
変数が<CODE>nil</CODE>であると大文字小文字を区別する。
さもなければ大文字小文字を区別しない。
</DL>
<P>

<A NAME="IDX2642"></A>
<DL>
<DT><U>Variable:</U> <B>default-case-fold-search</B>
<DD>この変数の値は、<CODE>case-fold-search</CODE>を書き変えていないバッファ向けの
デフォルト値である。
これは<CODE>(default-value 'case-fold-search)</CODE>と同じである。
</DL>
<P>

<A NAME="Standard Regexps"></A>
<HR SIZE="6">
<br><A NAME="SEC563"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_34.html#SEC562"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_35.html#SEC564"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Standard Regexps"></A>
<H2> 33.8 編集に用いられる標準的な正規表現 </H2>
<!--docid::SEC563::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Standard%20Regexps">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Standard%20Regexps</a>"<br>
"texi/elisp21/編集に用いられる標準的な正規表現"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CA%D4%BD%B8%A4%CB%CD%D1%A4%A4%A4%E9%A4%EC%A4%EB%C9%B8%BD%E0%C5%AA%A4%CA%C0%B5%B5%AC%C9%BD%B8%BD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2643"></A>
<A NAME="IDX2644"></A>
<P>

本節では、編集上の特定目的に用いられる正規表現を保持している
変数について述べます。
<P>

<A NAME="IDX2645"></A>
<DL>
<DT><U>Variable:</U> <B>page-delimiter</B>
<DD>これは、ページを区切る行頭を記述した正規表現である。
デフォルト値は、<CODE>"^\014"</CODE>（つまり、<CODE>"^^L"</CODE>すなわち<CODE>"^\C-l"</CODE>）
である。
これはページ送り文字で始まる行に一致する。
</DL>
<P>

つぎの2つの正規表現は、つねに行の先頭から一致が
始まると仮定しては<EM>いけません</EM>。
一致の開始位置を固定する`<SAMP>^</SAMP>'を使うべきではありません。
ほとんどの場合、段落コマンドは行の先頭でのみ一致を検査しますから、
`<SAMP>^</SAMP>'は不必要であることを意味します。
幅0以外の左端余白があると、段落コマンドは左端余白のうしろからの一致を
受け入れます。
そのような場合、`<SAMP>^</SAMP>'は誤りです。
しかし、左端余白をけっして使わないモードならば、
`<SAMP>^</SAMP>'は無害です。
<P>

<A NAME="IDX2646"></A>
<DL>
<DT><U>Variable:</U> <B>paragraph-separate</B>
<DD>これは、段落を区切る行の始まりを認識するための正規表現である。
（これを変更したら、<CODE>paragraph-start</CODE>も変更すること。）
デフォルト値は<CODE>"[ \t\f]*$"</CODE>であり、
（左端余白に続く）空白やタブやページ送りだけから成る行に一致する。
</DL>
<P>

<A NAME="IDX2647"></A>
<DL>
<DT><U>Variable:</U> <B>paragraph-start</B>
<DD>これは、段落を始める行や区切る行の始まりを認識するための正規表現である。
デフォルト値は<CODE>"[ \t\n\f]"</CODE>であり、
（左端余白に続く）空白やタブやページ送りだけから成る行に一致する。
</DL>
<P>

<A NAME="IDX2648"></A>
<DL>
<DT><U>Variable:</U> <B>sentence-end</B>
<DD>これは、文末を記述する正規表現である。
（これに関わらず、段落の区切りも文末である。）
デフォルト値はつぎのとおりである。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>"[.?!][]\"')}]*\\($\\| $\\|\t\\| \\)[ \t\n]*"
</pre></td></tr></table><P>

これは、ピリオド、疑問符、感嘆符のいずれかのあとに
閉じ括弧文字が続き（なくてもよい）、
タブや空白や改行が続くことを意味する。
<P>

この正規表現の詳しい説明は、<A HREF="elisp_34.html#SEC553">33.2.2 複雑な正規表現の例</A>を参照。
</DL>
<A NAME="Syntax Tables"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<a name="bottom"> </a>
<script type="text/javascript" src="style2.js"></script>
<div class="footer">
    <br>
    このページはMeadow (Emacs) の紹介ページです <br>
このWebページの各文書は自由にリンク・複製・再配布・改変していただいて構いません．
<br>ただし，複製・再配布・改変の場合は Meadow Memo のURLを記載しておいて下さい．<br>
<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=about%20link">Medow memoへのリンクについて</a>．<br>

間違い，要望等があれば<a href="mailto:akihisa@mail.ne.jp">akihisa@mail.ne.jp</a> か下記でどうぞ<br>

<br>

<FORM METHOD="post" ACTION="http://www.bookshelf.jp/cgi-bin/wwwmail.cgi" >
お名前：<INPUT TYPE="text" NAME="name" SIZE="30" MAXLENGTH="40" VALUE="ななしさん"><br>
メールアドレス：<INPUT TYPE="text" NAME="EMAIL" SIZE="25" MAXLENGTH="60" VALUE="secret@mail.adr"><br>
<input type="hidden" name="HPAGE" value="">
つっこみ：<br><TEXTAREA NAME="MESSAGE" ROWS="5" COLS="50">
</TEXTAREA><br><br>
<INPUT TYPE="submit" VALUE="送信">
<INPUT TYPE="reset" VALUE="クリア">
</FORM>

<br><A HREF="http://www.bookshelf.jp/cgi-bin/xct.cgi">ページ別カウンタ</a>
<br> Since 2002/12/13 <br>
</div>

</BODY>

</HTML>
