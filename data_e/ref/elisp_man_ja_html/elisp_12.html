<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="ja">
<!-- Created on October, 1  2005 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=euc-jp">
<META NAME="keywords" CONTENT="meadow,mule,emacs,lisp,elisp,gnus,setting,設定,unix,cygwin">
<META http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="description" CONTENT="Meadowの設定を紹介するページです">
<TITLE>GNU Emacs Lispリファレンスマニュアル:  関数</TITLE>

<META NAME="description" CONTENT="GNU Emacs Lispリファレンスマニュアル:  関数">
<META NAME="keywords" CONTENT="GNU Emacs Lispリファレンスマニュアル:  関数">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

<LINK REL="contents" HREF="elisp_toc.html#SEC_Contents">
<LINK REL="index" HREF="elisp_48.html#SEC681">
<LINK REL="next" HREF="elisp_13.html#SEC171">
<LINK REL="prev" HREF="elisp_11.html#SEC136">

<META http-equiv="Content-Style-Type" content="text/css">
<!-- 鶯と龜 ←日本語EUC誤判別対策用らしい; -->
<link rel="StyleSheet" href="../../../../soft/css/midnight.css" type="text/css" id="css1">
<script type="text/javascript" src="style1.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../soft/css/meadowmemo.css">

</HEAD>
<BODY LANG="ja" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<!--Infoseek Analyzer start-->
<script LANGUAGE="javascript">PgNo=6;</script>
<script src="http://js1.infoseek.co.jp/bin/57/00170.js"></script>
<noscript><a href="http://ax1.www.infoseek.co.jp/bin/go?0017057f" target="_blank">
<img src="http://ax1.www.infoseek.co.jp/bin/logo?0017057f" border=0></a></noscript>
<!--Infoseek Analyzer end-->
<a name="top"> </a>

<br><A NAME="SEC156"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_11.html#SEC155"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC157"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_11.html#SEC136"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_13.html#SEC171"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Functions"></A>
<H1> 11. 関数 </H1>
<!--docid::SEC156::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Functions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Functions</a>"<br>
"texi/elisp21/関数"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%D8%BF%F4">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

Lispプログラムは、主にLisp関数から構成されます。
本章では、関数とはなにか、引数をどのように受け取るのか、
どのように関数を定義するのかを説明します。
<P>

<div class="menuindex"><SCRIPT language=JavaScript src="index11.js"></SCRIPT></div><noscript><BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC157">11.1 関数とはなにか</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Lisp functions vs. primitives; terminology.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC158">11.2 ラムダ式</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How functions are expressed as Lisp objects.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC163">11.3 関数を命名する</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">A symbol can serve as the name of a function.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC164">11.4 関数を定義する</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Lisp expressions for defining functions.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC165">11.5 関数呼び出し</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to use an existing function.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC166">11.6 マップ関数</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Applying a function to each element of a list, etc.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC167">11.7 無名関数</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Lambda expressions are functions with no names.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC168">11.8 関数セルの内容の参照</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Accessing or setting the function definition
                            of a symbol.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC169">11.9 インライン関数</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Defining functions that the compiler will open code.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC170">11.10 関数に関連したその他の話題</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Cross-references to specific Lisp primitives
                            that have a special bearing on how functions work.</TD></TR>
</TABLE></BLOCKQUOTE></noscript>
<P>

<A NAME="What Is a Function"></A>
<HR SIZE="6">
<br><A NAME="SEC157"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC156"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC158"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="What Is a Function"></A>
<H2> 11.1 関数とはなにか </H2>
<!--docid::SEC157::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=What%20Is%20a%20Function">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=What%20Is%20a%20Function</a>"<br>
"texi/elisp21/関数とはなにか"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%D8%BF%F4%A4%C8%A4%CF%A4%CA%A4%CB%A4%AB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

一般的には、関数とは、<EM>引数</EM>（arguments）と呼ばれる値を与えられ、
計算を行うための規則です。
この計算結果を関数の値と呼びます。
計算では副作用、つまり、変数の値やデータ構造の内容に継続する変更
を伴うこともできます。
<P>

Emacs Lispの関数や関数のようなオブジェクトに関する重要な用語をあげておきます。
<P>

<DL COMPACT>
<DT><EM>関数</EM>
<DD><A NAME="IDX638"></A>
Emacs Lispでは、Lispプログラムにおいて引数に適用可能ものは
なんであれ<EM>関数</EM>（function）である。
Lispで書いた関数を意味する場合もある。
スペシャルフォームやマクロは関数ではない。
<P>

<DT><EM>基本関数</EM>
<DD><A NAME="IDX639"></A>
<A NAME="IDX640"></A>
<A NAME="IDX641"></A>
<EM>基本関数</EM>（primitive）は、<CODE>car</CODE>や<CODE>append</CODE>などのCで書いた
Lispから呼び出し可能な関数である。
これらの関数は、<EM>組み込み</EM>関数とか<EM>subrs</EM>とも呼ぶ。
（スペシャルフォームは基本関数とも考えられる。）
<P>

関数を基本関数として実装する理由は、
それが基本的なものである、
それがオペレーティングシステムの機能に対する
低レベルのインターフェイスを提供する、
あるいは、高速に動作する必要があるからである。
基本関数を変更したり追加する唯一の方法は、
Cソースを変更してエディタを再コンパイルすることである。
see 節 <A HREF="elisp_43.html#SEC672">C.5 Emacs基本関数の書き方</A>。
<P>

<DT><EM>ラムダ式</EM>
<DD><EM>ラムダ式</EM>（lambda expression）は、Lispで書いた関数である。
これらについては以下の節で説明する。
See 節 <A HREF="elisp_12.html#SEC158">11.2 ラムダ式</A>。
<P>

<DT><EM>スペシャルフォーム</EM>
<DD><EM>スペシャルフォーム</EM>（special form）は関数に似た基本関数であるが、
その引数すべてを普通のようには評価しない。
引数の一部を評価したり、普通とは異なる順序で評価したり、
複数回評価したりする。
多くのスペシャルフォームについては、
<A HREF="elisp_10.html#SEC122">9. 制御構造</A>で説明してある。
<P>

<DT><EM>マクロ</EM>
<DD><A NAME="IDX642"></A>
<EM>マクロ</EM>（macro）は、プログラマがLispで定義した構文である。
マクロと関数との違いは、マクロは、
読者が書いたLisp式をもとの式のかわりに評価される等価な式に変換する。
マクロは、スペシャルフォームでできる種類のことを
Lispプログラマに提供する。
マクロの定義方法と使い方については、see 節 <A HREF="elisp_13.html#SEC171">12. マクロ</A>。
<P>

<DT><EM>コマンド</EM>
<DD><A NAME="IDX643"></A>
<EM>コマンド</EM>（command）とは、
<CODE>command-execute</CODE>が起動できるオブジェクトであり、
キー列に対して定義できる。
いくつかの関数はコマンドである。
Lispで書いた関数に対話宣言（see 節 <A HREF="elisp_21.html#SEC283">20.2 コマンドの定義</A>）が含まれているとき、
その関数はコマンドである。
そのような関数は、他の関数と同様にLisp式から呼び出すことができる。
その場合、関数がコマンドであるという事実は関係ない。
<P>

キーボードマクロ（文字列かベクトル）もコマンドであるが、
それらは関数ではない。
シンボルの関数定義がコマンドであれば、シンボルはコマンドである。
そのようなシンボルは、<KBD>M-x</KBD>で起動できる。
シンボルの定義が関数であれば、シンボルは関数でもある。
<P>

<DT><EM>打鍵コマンド</EM>
<DD><A NAME="IDX644"></A>
<EM>打鍵コマンド</EM>（keystroke command）とは、
キー列（典型的には1から3打鍵）にバインドされたコマンドである。
ここでの区別は、Emacs以外のエディタの『コマンド』の意味との
混乱を防ぐためであるが、
Lispプログラムにとっては、この区別は普通は重要ではない。
<P>

<DT><EM>バイトコード関数</EM>
<DD><EM>バイトコード関数</EM>（byte-code function）とは、
バイトコンパイラでコンパイルした関数である。
see 節 <A HREF="elisp_3.html#SEC45">2.3.15 バイトコード関数型</A>。
</DL>
<P>

<A NAME="IDX645"></A>
<DL>
<DT><U>Function:</U> <B>functionp</B> <I>object</I>
<DD><A NAME="IDX646"></A>
この関数は、<VAR>object</VAR>が、なんらかの関数、スペシャルフォーム、
マクロであれば、<CODE>t</CODE>を返す。
</DL>
<P>

<A NAME="IDX647"></A>
<DL>
<DT><U>Function:</U> <B>subrp</B> <I>object</I>
<DD>この関数は、<VAR>object</VAR>が組み込み関数（つまり、Lisp基本関数）であれば
<CODE>t</CODE>を返す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(subrp 'message)            ; <CODE>message</CODE>はシンボルであり、
     => nil                 ;   subrオブジェクトではない
(subrp (symbol-function 'message))
     => t
</pre></td></tr></table></DL>
<P>

<A NAME="IDX648"></A>
<DL>
<DT><U>Function:</U> <B>byte-code-function-p</B> <I>object</I>
<DD>この関数は、<VAR>object</VAR>がバイトコード関数であれば<CODE>t</CODE>を返す。
たとえば、つぎのとおり。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(byte-code-function-p (symbol-function 'next-line))
     => t
</pre></td></tr></table></DL>
<P>

<A NAME="Lambda Expressions"></A>
<HR SIZE="6">
<br><A NAME="SEC158"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC157"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC159"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Lambda Expressions"></A>
<H2> 11.2 ラムダ式 </H2>
<!--docid::SEC158::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Lambda%20Expressions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Lambda%20Expressions</a>"<br>
"texi/elisp21/ラムダ式"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%E9%A5%E0%A5%C0%BC%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX649"></A>
<P>

Lispで書いた関数はつぎのようなリストです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(lambda (<VAR>arg-variables</VAR><small>...</small>)
  [<VAR>documentation-string</VAR>]
  [<VAR>interactive-declaration</VAR>]
  <VAR>body-forms</VAR><small>...</small>)
</pre></td></tr></table><P>

このようなリストを<EM>ラムダ式</EM>（lambda expression）と呼びます。
Emacs Lispでは、これは式として正しいもので、
それ自身に評価されます。
Lispの他の方言では、ラムダ式は正しい式ではありません。
いずれの場合でも、その主な用途は式として評価することではなく、
関数として呼び出すことです。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC159">11.2.1 ラムダ式の構成要素</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">The parts of a lambda expression.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC160">11.2.2 簡単なラムダ式の例</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">A simple example.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC161">11.2.3 引数リストのその他の機能</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Details and special features of argument lists.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_12.html#SEC162">11.2.4 関数の説明文字列</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to put documentation in a function.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Lambda Components"></A>
<HR SIZE="6">
<br><A NAME="SEC159"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC158"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC160"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Lambda Components"></A>
<H3> 11.2.1 ラムダ式の構成要素 </H3>
<!--docid::SEC159::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Lambda%20Components">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Lambda%20Components</a>"<br>
"texi/elisp21/ラムダ式の構成要素"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%E9%A5%E0%A5%C0%BC%B0%A4%CE%B9%BD%C0%AE%CD%D7%C1%C7">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

Lispで書いた関数（『ラムダ式』）はつぎのようなリストです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(lambda (<VAR>arg-variables</VAR><small>...</small>)
  [<VAR>documentation-string</VAR>]
  [<VAR>interactive-declaration</VAR>]
  <VAR>body-forms</VAR><small>...</small>)
</pre></td></tr></table><P>

<A NAME="IDX650"></A>
ラムダ式の先頭要素は、つねにシンボル<CODE>lambda</CODE>です。
このシンボルは、リストが関数を表すことを示します。
関数は<CODE>lambda</CODE>で始まると定義してあるのは、
他の目的向けの他のリストが誤って正しい関数とならないようにするためです。
<P>

第2要素は、シンボルのリスト、つまり、引数変数名です。
これを<EM>ラムダリスト</EM>（lambda list）と呼びます。
Lisp関数が呼ばれると、引数値をラムダリストの変数に対応させ、
指定した値を持つローカル束縛になります。
See 節 <A HREF="elisp_11.html#SEC139">10.3 ローカル変数</A>。
<P>

説明文字列は、関数定義の内側にあるLisp文字列オブジェクトであり、
Emacsのヘルプ機能に対して関数を記述します。
See 節 <A HREF="elisp_12.html#SEC162">11.2.4 関数の説明文字列</A>。
<P>

対話宣言は、<CODE>(interactive <VAR>code-string</VAR>)</CODE>の形式のリストです。
この宣言は、関数が対話的に使われたときに、
どのように引数を与えるかを指定します。
この宣言を有する関数を<EM>コマンド</EM>（commands）と呼びます。
コマンドは、<KBD>M-x</KBD>で呼び出したり、キーにバインドできます。
このように呼ばれることを意図していない関数には、
対話宣言を付けてはいけません。
対話宣言の書き方については、See 節 <A HREF="elisp_21.html#SEC283">20.2 コマンドの定義</A>。
<P>

<A NAME="IDX651"></A>
残りの要素は、関数の<EM>本体</EM>（body）です。
関数の動作を行うLispコードです
（Lispプログラマとしては、『評価するべきLispフォームのリスト』という）。
関数が返す値は、本体の最後の要素が返す値です。
<P>

<A NAME="Simple Lambda"></A>
<HR SIZE="6">
<br><A NAME="SEC160"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC159"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC161"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Simple Lambda"></A>
<H3> 11.2.2 簡単なラムダ式の例 </H3>
<!--docid::SEC160::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Simple%20Lambda">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Simple%20Lambda</a>"<br>
"texi/elisp21/簡単なラムダ式の例"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%CA%C3%B1%A4%CA%A5%E9%A5%E0%A5%C0%BC%B0%A4%CE%CE%E3">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

つぎの関数を考えてみましょう。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(lambda (a b c) (+ a b c))
</pre></td></tr></table><P>

この関数を呼び出すには、つぎのように式のCARにこの関数を書きます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>((lambda (a b c) (+ a b c))
 1 2 3)
</pre></td></tr></table><P>

この呼び出しは、変数<CODE>a</CODE>には1、変数<CODE>b</CODE>には2、
変数<CODE>c</CODE>には3を束縛し、ラムダ式の本体を評価します。
本体の評価ではこれらを加算し、結果6を生じます。
したがって、この関数呼び出しは6を返します。
<P>

つぎの例のように、他の関数呼び出しの結果が引数になることもあります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>((lambda (a b c) (+ a b c))
 1 (* 2 3) (- 5 4))
</pre></td></tr></table><P>

これは、引数、<CODE>1</CODE>、<CODE>(* 2 3)</CODE>、<CODE>(- 5 4)</CODE>を
左から右へ順に評価します。
そして、引数値、1、6、1にラムダ式を適用し、値8を生じます。
<P>

このようにフォームのCARとしてラムダ式を書くのは、
あまり便利ではありません。
スペシャルフォーム<CODE>let</CODE>（see 節 <A HREF="elisp_11.html#SEC139">10.3 ローカル変数</A>）を使って、
ローカル変数を作ってそれらに値を与えても、同じ結果を得られます。
さらに、<CODE>let</CODE>は見通しがよく使いやすいです。
実用上、ラムダ式は、シンボルの関数定義として格納して名前付き関数を作るか、
他の関数に引数として渡します（see 節 <A HREF="elisp_12.html#SEC167">11.7 無名関数</A>）。
<P>

しかしながら、スペシャルフォーム<CODE>let</CODE>がなかった初期のLispでは、
ラムダ式を明示的に呼び出すことはとても便利でした。
その頃では、ラムダ式はローカル変数を束縛し初期化する唯一の方法でした。
<P>

<A NAME="Argument List"></A>
<HR SIZE="6">
<br><A NAME="SEC161"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC160"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC162"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Argument List"></A>
<H3> 11.2.3 引数リストのその他の機能 </H3>
<!--docid::SEC161::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Argument%20List">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Argument%20List</a>"<br>
"texi/elisp21/引数リストのその他の機能"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B0%FA%BF%F4%A5%EA%A5%B9%A5%C8%A4%CE%A4%BD%A4%CE%C2%BE%A4%CE%B5%A1%C7%BD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX652"></A>
<A NAME="IDX653"></A>
<A NAME="IDX654"></A>
<P>

単純な関数の例<CODE>(lambda (a b c) (+ a b c))</CODE>では、
3つの引数変数を指定しているので、これは3引数で呼び出す必要があります。
2引数や4引数で呼び出そうとすると、
エラー<CODE>wrong-number-of-arguments</CODE>になります。
<P>

特定の引数を省略できる関数を書けると便利なことがしばしばあります。
たとえば、関数<CODE>substring</CODE>は3つの引数、つまり、
文字列、開始と終了の添字を取りますが、
第3引数を省略するとデフォルトは文字列の<VAR>length</VAR>になります。
<CODE>list</CODE>や<CODE>+</CODE>のように、
特定の関数では任意個数の引数を受け付けると便利なこともあります。
<P>

<A NAME="IDX655"></A>
<A NAME="IDX656"></A>
<A NAME="IDX657"></A>
<A NAME="IDX658"></A>
関数呼び出し時に省略してもよい引数を指定するには、
省略可能な引数のまえにキーワード<CODE>&#38;optional</CODE>を含めるだけです。
0個以上の引数のリストを指定するには、
最後の引数のまえにキーワード<CODE>&#38;rest</CODE>を含めます。
<P>

したがって、引数リストの完全な構文はつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(<VAR>required-vars</VAR><small>...</small>
               ; 必須の引数
 [&#38;optional <VAR>optional-vars</VAR><small>...</small>]
               ; 省略可能な引数
 [&#38;rest <VAR>rest-var</VAR>])
               ; 残りの引数
</pre></td></tr></table><P>

角括弧は、<CODE>&#38;optional</CODE>や<CODE>&#38;rest</CODE>の節や
それに続く変数は省略できることを示します。
<P>

関数呼び出し時には、各<VAR>required-vars</VAR>に1つの実引数が必要です。
0個以上の<VAR>optional-vars</VAR>にも実引数が必要ですが、
ラムダリストに<CODE>&#38;rest</CODE>がない限り、
<VAR>optional-vars</VAR>の個数を超える実引数は指定できません。
<CODE>&#38;rest</CODE>があれば、任意個の余分な実引数を指定できます。
<P>

<CODE>&#38;optional</CODE>や<CODE>&#38;rest</CODE>に対応する実引数を省略すると、
それらのデフォルトは<CODE>nil</CODE>です。
関数では、<CODE>nil</CODE>を明示した引数と省略した引数とを区別する方法はありません。
しかしながら、関数本体で<CODE>nil</CODE>を適切な意味ある値の省略と
みなすことは自由です。
<CODE>substring</CODE>はそのようにしています。
<CODE>substring</CODE>の第3引数が<CODE>nil</CODE>であると、
指定した文字列の長さを使うことを意味します。
<P>

<A NAME="IDX659"></A>
<BLOCKQUOTE>
<B>Common Lispに関した注意：</B><CODE> </CODE>
Common Lispでは、省略可能引数を省略したときのデフォルト値を関数で指定できる。
Emacs Lispではつねに<CODE>nil</CODE>を使う。
Emacs Lispには、明示的に引数を指定したかどうか調べる
『supplied-p』変数はない。
</BLOCKQUOTE>
<P>

たとえば、引数リストはつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(a b &#38;optional c d &#38;rest e)
</pre></td></tr></table><P>

これは、<CODE>a</CODE>と<CODE>b</CODE>に最初の2つの実引数を束縛し、これらは必須です。
さらに1個か2個の引数を指定すると、
それらは、それぞれ<CODE>c</CODE>と<CODE>d</CODE>に束縛します。
最初の4個よりあとの引数はリストにまとめ、
<CODE>e</CODE>にそのリストを束縛します。
引数が2個だけであると、<CODE>c</CODE>は<CODE>nil</CODE>です。
引数が2個か3個だけであると、<CODE>d</CODE>は<CODE>nil</CODE>です。
引数が4個以下であると、<CODE>e</CODE>は<CODE>nil</CODE>です。
<P>

省略可能な引数のあとに必須引数を指定する方法はありませんし、
それには意味がありません。
なぜそうなのかを理解するために、上の例で、
<CODE>c</CODE>は省略可能であり、<CODE>d</CODE>は必須であるとしましょう。
3つの実引数を指定したとき、どの引数を3番目と考えるのでしょう？<CODE> </CODE>
同様に、<CODE>&#38;rest</CODE>のうしろに余分に（必須、もしくは省略可能な）引数が
あっても意味がありません。
<P>

引数リストと正しい呼び出しの例をあげます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>((lambda (n) (1+ n))                ; 1個が必須
 1)                                 ; 引数は1個だけ
     => 2
((lambda (n &#38;optional n1)           ; 1個は必須、1個は省略可
         (if n1 (+ n n1) (1+ n)))   ; 引数は1個か2個
 1 2)
     => 3
((lambda (n &#38;rest ns)               ; 1個は必須、あとは残り全部
         (+ n (apply '+ ns)))       ; 引数は1個以上いくつでもよい
 1 2 3 4 5)
     => 15
</FONT></pre></td></tr></table><P>

<A NAME="Function Documentation"></A>
<HR SIZE="6">
<br><A NAME="SEC162"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC161"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC163"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Function Documentation"></A>
<H3> 11.2.4 関数の説明文字列 </H3>
<!--docid::SEC162::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Documentation">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Documentation</a>"<br>
"texi/elisp21/関数の説明文字列"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%D8%BF%F4%A4%CE%C0%E2%CC%C0%CA%B8%BB%FA%CE%F3">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX660"></A>
<A NAME="IDX661"></A>
<P>

ラムダ式には、ラムダリストの直後に
<EM>説明文字列</EM>（documentation string）があってもかまいません。
この文字列は関数の実行には影響しません。
コメントのようなものですが、Lisp内部に現れる系統的なコメントであり、
Emacsのヘルプ機能が使用します。
<VAR>documentation-string</VAR>の参照方法については、See 節 <A HREF="elisp_24.html#SEC363">23. 説明文</A>。
<P>

読者のプログラムの関数すべてに、
たとえ内部的に使用されるものであっても説明文字列を与えることはよいことです。
説明文字列はコメントに似ていますが、参照するのはもっと簡単です。
<P>

説明文字列の先頭行は、その1行で完結しているべきです。
というのは、<CODE>apropos</CODE>は先頭行だけを表示するからです。
関数の機能をまとめた1つか2つの文にしましょう。
<P>

説明文字列の先頭は、ソースファイル上では普通字下げしてあるでしょうが、
それらの空白は文字列を始めるダブルクォートのまえにありますから、
それらは文字列の一部ではありません。
説明文字列の残りの行を字下げして、
プログラムソース上でテキスト行が揃うようにする人もいます。
しかし、<EM>それはまちがいです</EM>。
後続の行の字下げは文字列の内側にあります。
ソースファイルで綺麗に見えても、
ヘルプコマンドの表示では不恰好になります。
<P>

関数の必須の構成要素（本体）があとに続くのに、
説明文字列を省略できるのを不思議に思うかもしれません。
文字列を評価すると、副作用なしに、その文字列を返すので、
それが本体の最後のフォームでなければ、なんの効果もありません。
したがって、実用上、本体の最初のフォームと
説明文字列を混同することはありません。
本体のフォームが文字列だけであると、
それは戻り値でもあり説明文字列でもあります。
<P>

<A NAME="Function Names"></A>
<HR SIZE="6">
<br><A NAME="SEC163"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC162"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC164"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Function Names"></A>
<H2> 11.3 関数を命名する </H2>
<!--docid::SEC163::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Names">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Names</a>"<br>
"texi/elisp21/関数を命名する"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%D8%BF%F4%A4%F2%CC%BF%CC%BE%A4%B9%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX662"></A>
<A NAME="IDX663"></A>
<A NAME="IDX664"></A>
<P>

ほとんどの計算機言語では、各関数には名前があります。
名前のない関数という考えは本質的ではありません。
Lispでは、もっとも厳密にいえば、関数には名前はありません。
関数は、先頭要素が単に<CODE>lambda</CODE>であるリスト、
バイトコード関数オブジェクト、あるいは、基本関数のsubrオブジェクトです。
<P>

しかしながら、シンボルは関数の名前として働きます。
シンボルの<EM>関数セル</EM>（function cell、see 節 <A HREF="elisp_8.html#SEC102">7.1 シンボルの構成要素</A>）に
関数を入れると、このようになります。
そうすると、シンボルそのものは正当な呼び出し可能な関数となり、
関数セルが参照するリストやsubrオブジェクトと等価になります。
関数セルの内容をシンボルの<EM>関数定義</EM>（function definition）とも呼びます。
シンボルのかわりにシンボルの関数定義を使う処理を
<EM>シンボルの関数間接</EM>（symbol function indirection）と呼びます。
See 節 <A HREF="elisp_9.html#SEC115">8.2.4 シンボルの関数間接</A>。
<P>

実用上、ほとんどすべての関数には、このようにして名前が付いていて、
その名前で参照します。
たとえば、シンボル<CODE>car</CODE>は、
その関数セルに基本関数のsubrオブジェクト<CODE>#&#60;subr car&#62;</CODE>が格納してあるので、
その動作を行う関数として動作します。
<P>

関数に名前を与えるのは、Lisp式からその名前で参照できると便利だからです。
<CODE>#&#60;subr car&#62;</CODE>のような基本関数のsubrオブジェクトでは、
名前はそれらを参照する唯一の方法です。
そのようなオブジェクトには入力構文はありません。
Lispで書いた関数では、明示的なラムダ式より名前を使うほうがより便利です。
また、関数に名前があればそれを参照できます。
つまり、再帰呼び出しができます。
関数の名前をその定義そのものに書くことは、
関数定義がそれ自身を指すようにする
（これは不可能ではないにしても、実用上はさまざまな欠点がある）よりは、
とても便利です。
<P>

関数を指名するシンボルで関数をしばしば識別します。
たとえば、しばしば『関数<CODE>car</CODE>』といって、
シンボル<CODE>car</CODE>と関数定義である基本関数のsubrオブジェクトとを区別しません。
ほとんどの目的には、区別する必要はありません。
<P>

たとえそうであっても、関数に一意な名前は必要ないことを
心に留めておいてください。
関数オブジェクトは<EM>普通</EM>1つのシンボルの関数セルだけに現れますが、
これは単なる便法です。
<CODE>fset</CODE>を使って、複数のシンボルに格納するのは簡単です。
そうすると、各シンボルは同じ関数を同等に指名します。
<P>

関数名として使うシンボルは、変数としても使えます。
シンボルのこれら2つの使い方は独立していて衝突しません。
（SchemeなどのLispの方言のなかには、
シンボルの値とその関数定義を区別しないものもある。
変数としてのシンボルの値は、その関数定義でもある。）
シンボルに関数定義を与えていないと、そのシンボルを関数としては使えません。
これは、シンボルに変数としての値があるかどうかには関係しません。
<P>

<A NAME="Defining Functions"></A>
<HR SIZE="6">
<br><A NAME="SEC164"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC163"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC165"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Defining Functions"></A>
<H2> 11.4 関数を定義する </H2>
<!--docid::SEC164::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Defining%20Functions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Defining%20Functions</a>"<br>
"texi/elisp21/関数を定義する"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%D8%BF%F4%A4%F2%C4%EA%B5%C1%A4%B9%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX665"></A>
<P>

関数を作成するときには、普通、関数に名前を与えます。
これを<EM>関数を定義する</EM>と呼び、
スペシャルフォーム<CODE>defun</CODE>で行います。
<P>

<A NAME="IDX666"></A>
<DL>
<DT><U>Special Form:</U> <B>defun</B> <I>name argument-list body-forms</I>
<DD><CODE>defun</CODE>は、新たにLisp関数を定義する普通の方法である。
これは、シンボル<VAR>name</VAR>をつぎのような関数として定義する。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(lambda <VAR>argument-list</VAR> . <VAR>body-forms</VAR>)
</pre></td></tr></table><P>

<CODE>defun</CODE>は、このラムダ式を<VAR>name</VAR>の関数セルに格納する。
値<VAR>name</VAR>を返すが、普通、これは無視する。
<P>

前述（see 節 <A HREF="elisp_12.html#SEC158">11.2 ラムダ式</A>）のように、
<VAR>argument-list</VAR>は引数名のリストであり、
キーワード<CODE>&#38;optional</CODE>や<CODE>&#38;rest</CODE>が入っていてもよい。
また、<VAR>body-forms</VAR>の最初の2つは、説明文字列と対話宣言でもよい。
<P>

同一のシンボル<VAR>name</VAR>を変数として使っていても衝突はない。
というのは、シンボルの値セルは関数セルとは独立だからである。
see 節 <A HREF="elisp_8.html#SEC102">7.1 シンボルの構成要素</A>。
<P>

例を示そう。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun foo () 5)
     => foo
(foo)
     => 5

(defun bar (a &#38;optional b &#38;rest c)
    (list a b c))
     => bar
(bar 1 2 3 4 5)
     => (1 2 (3 4 5))
(bar 1)
     => (1 nil nil)
(bar)
error--> Wrong number of arguments.

(defun capitalize-backwards ()
  "Upcase the last letter of a word."
  (interactive)
  (backward-word 1)
  (forward-word 1)
  (backward-char 1)
  (capitalize-word 1))
     => capitalize-backwards
</pre></td></tr></table><P>

既存の関数を意図せずに再定義しないように注意すること。
<CODE>defun</CODE>は、たとえ<CODE>car</CODE>などの基本関数であっても、
なんの躊躇も注意もせずに再定義してしまう。
既存関数の再定義は注意深く行うが、
不本意な再定義と熟考した再定義を区別する方法はない。
</DL>
<P>

<A NAME="IDX667"></A>
<DL>
<DT><U>Function:</U> <B>defalias</B> <I>name definition</I>
<DD>このスペシャルフォームは、
シンボル<VAR>name</VAR>を定義<VAR>definition</VAR>（任意の正しいLisp関数）とする
関数として定義する。
<P>

<CODE>defalias</CODE>を使う正しい場所は、
特定の関数名が定義されている場所である。
特に、ロード中のソースファイルで明示的に名前が現れている場所である。
というのは、<CODE>defalias</CODE>は、<CODE>defun</CODE>と同様に、
関数が定義されたファイルを記録するからである（see 節 <A HREF="elisp_15.html#SEC198">14.7 アンロード</A>）。
<P>

一方、他の目的で関数定義を操作するプログラムでは、
そのような記録を保持しない<CODE>fset</CODE>を使うのがよい。
</DL>
<P>

<CODE>defun</CODE>のように関数を定義し、かつ、
Lispコンパイラに関数定義を展開するように指示する
<CODE>defsubst</CODE>も参照してください。
See 節 <A HREF="elisp_12.html#SEC169">11.9 インライン関数</A>。
<P>

<A NAME="Calling Functions"></A>
<HR SIZE="6">
<br><A NAME="SEC165"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC164"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC166"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Calling Functions"></A>
<H2> 11.5 関数呼び出し </H2>
<!--docid::SEC165::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Calling%20Functions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Calling%20Functions</a>"<br>
"texi/elisp21/関数呼び出し"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%D8%BF%F4%B8%C6%A4%D3%BD%D0%A4%B7">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX668"></A>
<A NAME="IDX669"></A>
<P>

関数を定義することは、全体の半分でしかありません。
関数を<EM>呼ぶ</EM>までは、つまり、実行を命じなければ、関数はなにもしません。
関数呼び出しは<EM>起動</EM>（invocation）ともいいます。
<P>

関数を起動するもっとも一般的な方法は、リストを評価することです。
たとえば、リスト<CODE>(concat "a" "b")</CODE>を評価すると、
関数<CODE>concat</CODE>を引数<CODE>"a"</CODE>と<CODE>"b"</CODE>で呼び出します。
評価についてはSee 節 <A HREF="elisp_9.html#SEC109">8. 評価</A>。
<P>

読者のプログラムで式としてリストを書くときには、
呼び出す関数名を読者のプログラムに書きます。
つまり、プログラムを書くときに、
どの関数をどれだけの引数で呼び出すかを指定できることを意味します。
これが、普通にしたいことでしょう。
呼び出す関数を実行時に計算する必要がある場合もあるでしょう。
それには、関数<CODE>funcall</CODE>を使います。
渡す引数の個数を実行時に決定する必要があるときには、
<CODE>apply</CODE>を使います。
<P>

<A NAME="IDX670"></A>
<DL>
<DT><U>Function:</U> <B>funcall</B> <I>function &#38;rest arguments</I>
<DD><CODE>funcall</CODE>は、<VAR>function</VAR>を<VAR>arguments</VAR>で呼び出し、
<VAR>function</VAR>がなにを返そうともそれを返す。
<P>

<CODE>funcall</CODE>は関数なので、<VAR>function</VAR>の呼び出しを評価するまえに
<VAR>function</VAR>を含めた引数すべてを評価する。
つまり、呼び出す関数を得るためのどんな式でも使えることを意味する。
また、<CODE>funcall</CODE>は、読者が<VAR>arguments</VAR>に書いた式を見ることはなく、
それらの値だけを見ることになる。
これらの値は、<VAR>function</VAR>を呼び出す操作において、
2回目の評価を行うことは<EM>ない</EM>。
<CODE>funcall</CODE>は、通常の関数呼び出し処理において、
引数を評価し終えたところから始める。
<P>

引数<VAR>function</VAR>は、Lisp関数か基本関数である必要がある。
スペシャルフォームやマクロは許されない。
それらには、『未評価』の引数式を与えたときだけ意味があるからである。
<CODE>funcall</CODE>ではそのようにできない。
なぜなら、上の説明でわかるように、
未評価の引数をまったく知らないからである。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(setq f 'list)
     => list
(funcall f 'x 'y 'z)
     => (x y z)
(funcall f 'x 'y '(z))
     => (x y (z))
(funcall 'and t nil)
error--> Invalid function: #&#60;subr and&#62;
</pre></td></tr></table><P>

これらの例を<CODE>apply</CODE>の例と比較してほしい。
</DL>
<P>

<A NAME="IDX671"></A>
<DL>
<DT><U>Function:</U> <B>apply</B> <I>function &#38;rest arguments</I>
<DD><CODE>apply</CODE>は、<CODE>funcall</CODE>のように、
<VAR>function</VAR>を<VAR>arguments</VAR>で呼び出すが、1点だけ異なる。
<VAR>arguments</VAR>の最後はオブジェクトのリストであり、
<VAR>function</VAR>にはこれを、単一のリストではなく、個々の引数として渡す。
これを、<CODE>apply</CODE>は、
このリストの個々の要素が引数となるように<EM>分配する</EM>という。
<P>

<CODE>apply</CODE>は、<VAR>function</VAR>の呼び出し結果を返す。
<CODE>funcall</CODE>と同様に、<VAR>function</VAR>はLisp関数か基本関数である必要がある。
スペシャルフォームやマクロは、<CODE>apply</CODE>では意味がない。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(setq f 'list)
     => list
(apply f 'x 'y 'z)
error--> Wrong type argument: listp, z
(apply '+ 1 2 '(3 4))
     => 10
(apply '+ '(1 2 3 4))
     => 10

(apply 'append '((a b c) nil (x y z) nil))
     => (a b c x y z)
</pre></td></tr></table><P>

<CODE>apply</CODE>を使った興味深い例として、
<A HREF="elisp_12.html#SEC166">11.6 マップ関数</A>の<CODE>mapcar</CODE>の説明を見てほしい。
</DL>
<P>

<A NAME="IDX672"></A>
Lisp関数にとっては、引数として関数を受け取ったり、
データ構造（特に、フック変数や属性リスト）内の関数を探して
<CODE>funcall</CODE>や<CODE>apply</CODE>を使ってそれを呼び出すことは一般的です。
関数引数を受け付ける関数を
しばしば<EM>ファンクショナル</EM>（functionals）と呼びます。
<P>

場合によっては、ファンクショナルを呼び出すときには、
引数としてなにもしない関数（no-op）を指定できると有用です。
つぎのものは、2種類のなにもしない関数です。
<P>

<A NAME="IDX673"></A>
<DL>
<DT><U>Function:</U> <B>identity</B> <I>arg</I>
<DD>この関数は<VAR>arg</VAR>を返し、副作用を持たない。
</DL>
<P>

<A NAME="IDX674"></A>
<DL>
<DT><U>Function:</U> <B>ignore</B> <I>&#38;rest args</I>
<DD>この関数は引数を無視し、<CODE>nil</CODE>を返す。
</DL>
<P>

<A NAME="Mapping Functions"></A>
<HR SIZE="6">
<br><A NAME="SEC166"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC165"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC167"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Mapping Functions"></A>
<H2> 11.6 マップ関数 </H2>
<!--docid::SEC166::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Mapping%20Functions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Mapping%20Functions</a>"<br>
"texi/elisp21/マップ関数"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%DE%A5%C3%A5%D7%B4%D8%BF%F4">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX675"></A>
<P>

<EM>マップ関数</EM>（mapping function）は、
リストや他の集まりの各要素に指定した関数を適用します。
Emacs Lispにはそのような関数がいくつかあります。
<CODE>mapcar</CODE>と<CODE>mapconcat</CODE>はリストを走査するもので、ここで説明します。
オブジェクト配列obarray内のシンボルについて
マップする関数<CODE>mapatoms</CODE>については、
See 節 <A HREF="elisp_8.html#SEC104">7.3 シンボルの作成とインターン</A>。
<P>

これらのマップ関数では、文字テーブルは扱えません。
というのは、文字テーブルは疎な配列であり、その添字範囲も非常に大きいからです。
文字テーブルの疎な性質を考慮して文字テーブルについてマップするには、
関数<CODE>map-char-table</CODE>（see 節 <A HREF="elisp_7.html#SEC99">6.6 文字テーブル</A>）を使います。
<P>

<A NAME="IDX676"></A>
<DL>
<DT><U>Function:</U> <B>mapcar</B> <I>function sequence</I>
<DD><CODE>mapcar</CODE>は、<VAR>sequence</VAR>の各要素に順に<VAR>function</VAR>を適用し、
結果のリストを返す。
<P>

引数<VAR>sequence</VAR>は文字テーブル以外の任意の種類のシーケンスでよい。
つまり、リスト、ベクトル、ブールベクトル、あるいは、文字列である。
結果はつねにリストである。
結果の長さは<VAR>sequence</VAR>の長さと同じである。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>たとえば、つぎのとおり。

(mapcar 'car '((a b) (c d) (e f)))
     => (a c e)
(mapcar '1+ [1 2 3])
     => (2 3 4)
(mapcar 'char-to-string "abc")
     => ("a" "b" "c")

;; <CODE>my-hooks</CODE>の各関数を呼び出す
(mapcar 'funcall my-hooks)

(defun mapcar* (function &#38;rest args)
  "Apply FUNCTION to successive cars of all ARGS.
Return the list of results."
  ;; リストをつくしていなければ
  (if (not (memq 'nil args))              
      ;; CARに関数を適用する
      (cons (apply function (mapcar 'car args))  
            (apply 'mapcar* function             
                   ;; Recurse for rest of elements.
                   (mapcar 'cdr args)))))

(mapcar* 'cons '(a b c) '(1 2 3 4))
     => ((a . 1) (b . 2) (c . 3))
</FONT></pre></td></tr></table></DL>
<P>

<A NAME="IDX677"></A>
<DL>
<DT><U>Function:</U> <B>mapconcat</B> <I>function sequence separator</I>
<DD><CODE>mapconcat</CODE>は、<VAR>sequence</VAR>の各要素に<VAR>function</VAR>を適用する。
それらの結果は、文字列である必要があり、連結される。
<CODE>mapconcat</CODE>は、結果の文字列のあいだに文字列<VAR>separator</VAR>を挿入する。
普通、<VAR>separator</VAR>は、空白やコンマ、その他の句読点を含む。
<P>

引数<VAR>function</VAR>は、引数を1つ取る関数であり、
文字列を返す必要がある。
引数<VAR>sequence</VAR>は、文字テーブル以外の任意の種類のシーケンスでよい。
つまり、リスト、ベクトル、ブールベクトル、あるいは、文字列である。
  
<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(mapconcat 'symbol-name
           '(The cat in the hat)
           " ")
     => "The cat in the hat"

(mapconcat (function (lambda (x) (format "%c" (1+ x))))
           "HAL-8000"
           "")
     => "IBM.9111"
</FONT></pre></td></tr></table></DL>
<P>

<A NAME="Anonymous Functions"></A>
<HR SIZE="6">
<br><A NAME="SEC167"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC166"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC168"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Anonymous Functions"></A>
<H2> 11.7 無名関数 </H2>
<!--docid::SEC167::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Anonymous%20Functions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Anonymous%20Functions</a>"<br>
"texi/elisp21/無名関数"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CC%B5%CC%BE%B4%D8%BF%F4">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX678"></A>
<P>

Lispでは、関数とは、<CODE>lambda</CODE>で始まるリスト、
そのようなリストをコンパイルしたバイトコード関数、
あるいは、基本関数のsubrオブジェクトです。
名前は『余分』なのです。
普通の関数は<CODE>defun</CODE>で定義し、そのとき名前を与えますが、
明示的なラムダ式、つまり、無名関数を使ったほうがより簡素な場合もあります。
そのようなリストは、関数名を使える場面ならば、どこでも使えます。
<P>

そのようなリストをどんな方法で作っても、正しい関数となります。
つぎのようにしてもかまわないのです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(setq silly (append '(lambda (x)) (list (list '+ (* 3 4) 'x))))
=> (lambda (x) (+ 12 x))
</FONT></pre></td></tr></table><P>

これは、<CODE>(lambda (x) (+ 12 x))</CODE>のようなリストを計算し、
その値を<CODE>silly</CODE>の値（関数定義では<EM>ない</EM>！）とします。
<P>

この関数はつぎのように呼び出せます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(funcall silly 1)
=> 13
</pre></td></tr></table><P>

（<CODE>(silly 1)</CODE>と書いても動作<EM>しない</EM>。
なぜなら、この関数は、<CODE>silly</CODE>の<EM>関数定義</EM>ではないからである。
<CODE>silly</CODE>には関数定義を与えてなく、
変数としての値を与えただけである。）
<P>

ほとんどの場合、無名関数は読者のプログラムに現れる定数です。
たとえば、関数<CODE>mapcar</CODE>の引数の1つに渡したいときなどです。
<CODE>mapcar</CODE>は、リストの各要素に指定した関数を適用します。
<P>

第3引数に関数を取る関数<CODE>change-property</CODE>を定義します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun change-property (symbol prop function)
  (let ((value (get symbol prop)))
    (put symbol prop (funcall function value))))
</pre></td></tr></table><P>

ここで、数を2倍する関数を渡して<CODE>change-property</CODE>を使う
関数を定義します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun double-property (symbol prop)
  (change-property symbol prop '(lambda (x) (* 2 x))))
</pre></td></tr></table><P>

このような場合、つぎのように、無名関数をクォートするには、
単純なクォートのかわりにスペシャルフォーム<CODE>function</CODE>を使います。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun double-property (symbol prop)
  (change-property symbol prop
                   (function (lambda (x) (* 2 x)))))
</pre></td></tr></table><P>

<CODE>quote</CODE>のかわりに<CODE>function</CODE>を使った場合に違いがでるのは、
関数<CODE>double-property</CODE>をコンパイルしたときです。
たとえば、<CODE>double-property</CODE>の2番目の定義をコンパイルすると、
無名関数もコンパイルされます。
一方、普通の<CODE>quote</CODE>を使った最初の定義をコンパイルすると、
<CODE>change-property</CODE>へ渡す引数は、書いたとおりのリストです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(lambda (x) (* x 2))
</pre></td></tr></table><P>

Lispコンパイラは、このリストが関数に見えたとしても、
このリストを関数とはみなしません。
というのは、コンパイラには<CODE>change-property</CODE>がリストになにを行うか
わからないからです。
たぶん、第3要素のCARがシンボル<CODE>*</CODE>か
どうか調べればよいのでしょう！<CODE> </CODE>
<CODE>function</CODE>を使うと、コンパイラに対して先へ進んで
定数の関数をコンパイルしても安全であることを伝えます。
<P>

関数名をクォートするときに<CODE>quote</CODE>のかわりに<CODE>function</CODE>を
書くこともありますが、この用法はコメントのようなものです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(function <VAR>symbol</VAR>) == (quote <VAR>symbol</VAR>) == '<VAR>symbol</VAR>
</pre></td></tr></table><P>

入力構文<CODE>#'</CODE>は、<CODE>function</CODE>の省略形です。
たとえば、
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#'(lambda (x) (* x x))
</pre></td></tr></table><P>

は、つぎと等価です。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(function (lambda (x) (* x x)))
</pre></td></tr></table><P>

<A NAME="IDX679"></A>
<DL>
<DT><U>Special Form:</U> <B>function</B> <I>function-object</I>
<DD><A NAME="IDX680"></A>
このスペシャルフォームは、<VAR>function-object</VAR>を評価せずに
<VAR>function-object</VAR>を返す。
この意味では<CODE>quote</CODE>に等価である。
しかし、これは、Emacs Lispコンパイラに対しては注意書きとして働き、
<VAR>function-object</VAR>を関数としてのみ使う意図があり、
したがって、コンパイルしても安全であることを意味する。
<A HREF="elisp_9.html#SEC120">8.3 クォート</A>の<CODE>quote</CODE>と比較してほしい。
</DL>
<P>

<CODE>function</CODE>と無名関数を用いた実際的な例は、
<A HREF="elisp_24.html#SEC365">23.2 説明文字列の参照</A>の<CODE>documentation</CODE>を参照してください。
<P>

<A NAME="Function Cells"></A>
<HR SIZE="6">
<br><A NAME="SEC168"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC167"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC169"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Function Cells"></A>
<H2> 11.8 関数セルの内容の参照 </H2>
<!--docid::SEC168::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Cells">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Cells</a>"<br>
"texi/elisp21/関数セルの内容の参照"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%D8%BF%F4%A5%BB%A5%EB%A4%CE%C6%E2%CD%C6%A4%CE%BB%B2%BE%C8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

シンボルの<EM>関数定義</EM>（function definition）とは、
シンボルの関数セルに格納されたオブジェクトです。
ここで説明する関数は、シンボルの関数セルを参照したり、調べたり、
設定したりします。
<P>

<A HREF="elisp_9.html#SEC115">8.2.4 シンボルの関数間接</A>の関数<CODE>indirect-function</CODE>も参照してください。
<P>

<A NAME="IDX681"></A>
<DL>
<DT><U>Function:</U> <B>symbol-function</B> <I>symbol</I>
<DD><A NAME="IDX682"></A>
これは、<VAR>symbol</VAR>の関数セルのオブジェクトを返す。
シンボルの関数セルが空であると、エラー<CODE>void-function</CODE>を通知する。
<P>

この関数は、返すオブジェクトが正しい関数であるかどうか検査しない。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun bar (n) (+ n 2))
     => bar
(symbol-function 'bar)
     => (lambda (n) (+ n 2))
(fset 'baz 'bar)
     => bar
(symbol-function 'baz)
     => bar
</pre></td></tr></table></DL>
<P>

<A NAME="IDX683"></A>
シンボルに一度も関数定義を与えていないと、
そのシンボルの関数セルは<EM>空</EM>（void）であるといいます。
いいかえれば、関数セルにはどんなLispオブジェクトも入っていません。
そのようなシンボルを関数として呼び出そうとすると、
エラー<CODE>void-function</CODE>を通知します。
<P>

空（void）は、<CODE>nil</CODE>やシンボル<CODE>void</CODE>と違うことに注意してください。
シンボル<CODE>nil</CODE>も<CODE>void</CODE>もLispオブジェクトであり、
それらは他のオブジェクトと同様に関数セルに格納できます
（そして、それらを<CODE>defun</CODE>で定義しておけば、正しい関数である）。
空の関数セルには、どんなオブジェクトも含まれていません。
<P>

シンボルの関数定義が空かどうかは<CODE>fboundp</CODE>で調べることができます。
シンボルに関数定義を与えたあとでも、
<CODE>fmakunbound</CODE>を使ってふたたび空にできます。
<P>

<A NAME="IDX684"></A>
<DL>
<DT><U>Function:</U> <B>fboundp</B> <I>symbol</I>
<DD>この関数は、シンボルの関数セルにオブジェクトが入っていれば<CODE>t</CODE>を返し、
さもなければ<CODE>nil</CODE>を返す。
オブジェクトが正しい関数であるかどうか検査しない。
</DL>
<P>

<A NAME="IDX685"></A>
<DL>
<DT><U>Function:</U> <B>fmakunbound</B> <I>symbol</I>
<DD>この関数は<VAR>symbol</VAR>の関数セルを空にする。
これ以降にこのセルを参照しようとすると、
エラー<CODE>void-function</CODE>を引き起こす。
（<A HREF="elisp_11.html#SEC140">10.4 変数が『空』であるとき</A>の<CODE>makunbound</CODE>も参照）。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun foo (x) x)
     => foo
(foo 1)
     =>1
(fmakunbound 'foo)
     => foo
(foo 1)
error--> Symbol's function definition is void: foo
</pre></td></tr></table></DL>
<P>

<A NAME="IDX686"></A>
<DL>
<DT><U>Function:</U> <B>fset</B> <I>symbol definition</I>
<DD>この関数は、<VAR>symbol</VAR>の関数セルに<VAR>definition</VAR>を格納する。
結果は<VAR>definition</VAR>である。
通常、<VAR>definition</VAR>は関数か関数名であるべきだが、
そうであるかどうか検査しない。
引数<VAR>symbol</VAR>は通常どおり評価される引数である。
<P>

この関数の普通の3つの使い方はつぎのとおり。
<P>

<UL>
<LI>
あるシンボルの関数定義を別のものにコピーする。
いいかえれば、関数の別名を作る。
（これを新たな名前の定義と考えるならば、
<CODE>fset</CODE>のかわりに<CODE>defalias</CODE>を使うべきである。
see 節 <A HREF="elisp_12.html#SEC164">11.4 関数を定義する</A>。）
<P>

<LI>
リストではない関数定義をシンボルに与える。
これは、<CODE>defun</CODE>ではできない。
たとえば、<CODE>fset</CODE>を使って、<CODE>s1</CODE>に関数定義として
別のシンボル<CODE>s2</CODE>を与えることができる。
すると、<CODE>s1</CODE>は、<CODE>s2</CODE>の現在の定義の別名として働く。
（これを<CODE>s1</CODE>の定義と考えるのであれば、
やはり、<CODE>fset</CODE>のかわりに<CODE>defalias</CODE>を使う。）
<P>

<LI>
関数を定義したり変更したりする構文で使う。
<CODE>defun</CODE>が基本関数でなかったならば、
<CODE>fset</CODE>を使って（マクロとして）Lispで<CODE>defun</CODE>を書くことができる。
</UL>
<P>

これらの使用例を示す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>;; <CODE>foo</CODE>の定義を<CODE>old-foo</CODE>に保存する
(fset 'old-foo (symbol-function 'foo))

;; シンボル<CODE>car</CODE>を<CODE>xfirst</CODE>の関数定義にする
;; （これには、<CODE>fset</CODE>より<CODE>defalias</CODE>のほうがよい）
(fset 'xfirst 'car)
     => car
(xfirst '(1 2 3))
     => 1
(symbol-function 'xfirst)
     => car
(symbol-function (symbol-function 'xfirst))
     => #&#60;subr car&#62;

;; 名前付きのキーボードマクロを定義する
(fset 'kill-two-lines "\^u2\^k")
     => "\^u2\^k"

;; 他の関数を変更する関数
(defun copy-function-definition (new old)
  "Define NEW with the same function definition as OLD."
  (fset new (symbol-function old)))
</pre></td></tr></table></DL>
<P>

既存の関数定義を拡張する関数を書くときには、
つぎのような常套句を使うこともあります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(fset 'old-foo (symbol-function 'foo))
(defun foo ()
  "Just like old-foo, except more so."
  (old-foo)
  (more-so))
</pre></td></tr></table><P>

<CODE>foo</CODE>が自動ロードと定義されていると、これは正しく動作しません。
そのような場合には、<CODE>foo</CODE>が<CODE>old-foo</CODE>を呼び出すと、
Lispはファイルをロードして<CODE>old-foo</CODE>を定義しようとします。
しかし、これは<CODE>old-foo</CODE>ではなく<CODE>foo</CODE>を定義するので、
正しい結果を得られません。
この問題を回避する唯一の方法は、
<CODE>foo</CODE>の古い定義を移すまえに、確実にファイルをロードしておくことです。
<P>

しかし、別の箇所で定義された関数を再定義するLispファイルに対しては、
いずれにしても、これではモジュール化も見通しもよくありません。
アドバイズ機能（see 節 <A HREF="elisp_17.html#SEC208">16. Emacs Lisp関数のアドバイス <EM>(2003/10/30)</EM></A>）を使えば、見通しがよくなります。
<P>

<A NAME="Inline Functions"></A>
<HR SIZE="6">
<br><A NAME="SEC169"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC168"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC170"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Inline Functions"></A>
<H2> 11.9 インライン関数 </H2>
<!--docid::SEC169::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Inline%20Functions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Inline%20Functions</a>"<br>
"texi/elisp21/インライン関数"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%A4%A5%F3%A5%E9%A5%A4%A5%F3%B4%D8%BF%F4">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX687"></A>
<P>

<A NAME="IDX688"></A>
<CODE>defun</CODE>のかわりに<CODE>defsubst</CODE>を使うことで、
<EM>インライン関数</EM>（inline function）を定義できます。
インライン関数は、1つの点を除いて、普通の関数と同様に動作します。
そのような関数の呼び出しをコンパイルすると、
関数定義は呼び出し側で展開されます。
<P>

関数を展開すると明示的な呼び出しが高速になります。
しかし、それには欠点もあります。
その1つは、柔軟性を減らすことです。
関数の定義を変更しても、コンパイルし直すまでは、
すでに展開された呼び出しは古い定義を使い続けます。
関数を再定義できる柔軟性はEmacsでは重要な機能ですから、
速度が本当に重要でなければ、関数を展開すべきではありません。
<P>

別の欠点は、大きな関数を展開すると、コンパイルした関数のサイズが
ファイル内でもメモリ上でも増加します。
インライン関数のスピードの利点は、小さな関数でもっとも大きいので、
一般には大きな関数を展開すべきではありません。
<P>

インライン関数が実行するのと同じコードに展開するようにマクロを定義する
ことも可能です。
（see 節 <A HREF="elisp_13.html#SEC171">12. マクロ</A>。）
しかし、マクロは式で直接使った場合に制限されます。
マクロは、<CODE>apply</CODE>や<CODE>mapcar</CODE>などで呼び出せません。
さらに、普通の関数をマクロに変換するには、多少の作業が必要です。
普通の関数をインライン関数に変換するのはとても簡単です。
単に、<CODE>defun</CODE>を<CODE>defsubst</CODE>で置き換えるだけです。
インライン関数の各引数は、ちょうど1回だけ評価されるので、
マクロのように本体で引数を何回使うかを考慮する必要はありません。
（see 節 <A HREF="elisp_13.html#SEC178">12.6.1 マクロ引数の複数回評価</A>。）
<P>

インライン関数は、マクロと同様に、
同じファイル内の定義位置よりうしろで使われ展開されます。
<P>

<A NAME="Related Topics"></A>
<HR SIZE="6">
<br><A NAME="SEC170"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_12.html#SEC169"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_13.html#SEC171"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Related Topics"></A>
<H2> 11.10 関数に関連したその他の話題 </H2>
<!--docid::SEC170::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Related%20Topics">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Related%20Topics</a>"<br>
"texi/elisp21/関数に関連したその他の話題"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%D8%BF%F4%A4%CB%B4%D8%CF%A2%A4%B7%A4%BF%A4%BD%A4%CE%C2%BE%A4%CE%CF%C3%C2%EA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

関数呼び出しと関数定義に関連したいくつかの関数の一覧をあげておきます。
これらは別の場所で説明してありますが、相互参照をあげておきます。
<P>

<DL COMPACT>
<DT><CODE>apply</CODE>
<DD>see 節 <A HREF="elisp_12.html#SEC165">11.5 関数呼び出し</A>。
<P>

<DT><CODE>autoload</CODE>
<DD>see 節 <A HREF="elisp_15.html#SEC195">14.4 自動ロード</A>。
<P>

<DT><CODE>call-interactively</CODE>
<DD>see 節 <A HREF="elisp_21.html#SEC287">20.3 対話的呼び出し</A>。
<P>

<DT><CODE>commandp</CODE>
<DD>see 節 <A HREF="elisp_21.html#SEC287">20.3 対話的呼び出し</A>。
<P>

<DT><CODE>documentation</CODE>
<DD>see 節 <A HREF="elisp_24.html#SEC365">23.2 説明文字列の参照</A>。
<P>

<DT><CODE>eval</CODE>
<DD>see 節 <A HREF="elisp_9.html#SEC121">8.4 評価（eval）</A>。
<P>

<DT><CODE>funcall</CODE>
<DD>see 節 <A HREF="elisp_12.html#SEC165">11.5 関数呼び出し</A>。
<P>

<DT><CODE>function</CODE>
<DD>see 節 <A HREF="elisp_12.html#SEC167">11.7 無名関数</A>。
<P>

<DT><CODE>ignore</CODE>
<DD>see 節 <A HREF="elisp_12.html#SEC165">11.5 関数呼び出し</A>。
<P>

<DT><CODE>indirect-function</CODE>
<DD>see 節 <A HREF="elisp_9.html#SEC115">8.2.4 シンボルの関数間接</A>。
<P>

<DT><CODE>interactive</CODE>
<DD>see 節 <A HREF="elisp_21.html#SEC284">20.2.1 <CODE>interactive</CODE>の使い方</A>。
<P>

<DT><CODE>interactive-p</CODE>
<DD>see 節 <A HREF="elisp_21.html#SEC287">20.3 対話的呼び出し</A>。
<P>

<DT><CODE>mapatoms</CODE>
<DD>see 節 <A HREF="elisp_8.html#SEC104">7.3 シンボルの作成とインターン</A>。
<P>

<DT><CODE>mapcar</CODE>
<DD>see 節 <A HREF="elisp_12.html#SEC166">11.6 マップ関数</A>。
<P>

<DT><CODE>map-char-table</CODE>
<DD>see 節 <A HREF="elisp_7.html#SEC99">6.6 文字テーブル</A>。
<P>

<DT><CODE>mapconcat</CODE>
<DD>see 節 <A HREF="elisp_12.html#SEC166">11.6 マップ関数</A>。
<P>

<DT><CODE>undefined</CODE>
<DD>see 節 <A HREF="elisp_22.html#SEC324">21.7 キー探索</A>。
</DL>
<P>

<A NAME="Macros"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<a name="bottom"> </a>
<script type="text/javascript" src="style2.js"></script>
<div class="footer">
    <br>
    このページはMeadow (Emacs) の紹介ページです <br>
このWebページの各文書は自由にリンク・複製・再配布・改変していただいて構いません．
<br>ただし，複製・再配布・改変の場合は Meadow Memo のURLを記載しておいて下さい．<br>
<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=about%20link">Medow memoへのリンクについて</a>．<br>

間違い，要望等があれば<a href="mailto:akihisa@mail.ne.jp">akihisa@mail.ne.jp</a> か下記でどうぞ<br>

<br>

<FORM METHOD="post" ACTION="http://www.bookshelf.jp/cgi-bin/wwwmail.cgi" >
お名前：<INPUT TYPE="text" NAME="name" SIZE="30" MAXLENGTH="40" VALUE="ななしさん"><br>
メールアドレス：<INPUT TYPE="text" NAME="EMAIL" SIZE="25" MAXLENGTH="60" VALUE="secret@mail.adr"><br>
<input type="hidden" name="HPAGE" value="">
つっこみ：<br><TEXTAREA NAME="MESSAGE" ROWS="5" COLS="50">
</TEXTAREA><br><br>
<INPUT TYPE="submit" VALUE="送信">
<INPUT TYPE="reset" VALUE="クリア">
</FORM>

<br><A HREF="http://www.bookshelf.jp/cgi-bin/xct.cgi">ページ別カウンタ</a>
<br> Since 2002/12/13 <br>
</div>

</BODY>

</HTML>
