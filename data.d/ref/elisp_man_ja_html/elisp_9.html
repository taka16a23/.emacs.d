<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="ja">
<!-- Created on October, 1  2005 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=euc-jp">
<META NAME="keywords" CONTENT="meadow,mule,emacs,lisp,elisp,gnus,setting,設定,unix,cygwin">
<META http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="description" CONTENT="Meadowの設定を紹介するページです">
<TITLE>GNU Emacs Lispリファレンスマニュアル:  評価</TITLE>

<META NAME="description" CONTENT="GNU Emacs Lispリファレンスマニュアル:  評価">
<META NAME="keywords" CONTENT="GNU Emacs Lispリファレンスマニュアル:  評価">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

<LINK REL="contents" HREF="elisp_toc.html#SEC_Contents">
<LINK REL="index" HREF="elisp_48.html#SEC681">
<LINK REL="next" HREF="elisp_10.html#SEC122">
<LINK REL="prev" HREF="elisp_8.html#SEC101">

<META http-equiv="Content-Style-Type" content="text/css">
<!-- 鶯と龜 ←日本語EUC誤判別対策用らしい; -->
<link rel="StyleSheet" href="../../../../soft/css/midnight.css" type="text/css" id="css1">
<script type="text/javascript" src="style1.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../soft/css/meadowmemo.css">

</HEAD>
<BODY LANG="ja" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<!--Infoseek Analyzer start-->
<script LANGUAGE="javascript">PgNo=6;</script>
<script src="http://js1.infoseek.co.jp/bin/57/00170.js"></script>
<noscript><a href="http://ax1.www.infoseek.co.jp/bin/go?0017057f" target="_blank">
<img src="http://ax1.www.infoseek.co.jp/bin/logo?0017057f" border=0></a></noscript>
<!--Infoseek Analyzer end-->
<a name="top"> </a>

<br><A NAME="SEC109"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_8.html#SEC108"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC110"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_8.html#SEC101"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_10.html#SEC122"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Evaluation"></A>
<H1> 8. 評価 </H1>
<!--docid::SEC109::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Evaluation">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Evaluation</a>"<br>
"texi/elisp21/評価"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C9%BE%B2%C1">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX483"></A>
<A NAME="IDX484"></A>
<A NAME="IDX485"></A>
<P>

Emacs Lispにおける式の<EM>評価</EM>（evaluation）は、
<EM>Lispインタープリタ</EM>（Lisp interpreter）が行います。
これは、入力としてLispオブジェクトを受け取り、
<EM>式としての値</EM>を計算するプログラムです。
計算方法は、本章で述べる規則に従ってオブジェクトのデータ型に依存します。
インタープリタは、読者のプログラムのある部分を評価するために
自動的に動作しますが、Lisp基本関数<CODE>eval</CODE>を介して
インタープリタを明示的に呼ぶ出すこともできます。
<P>

<div class="menuindex"><SCRIPT language=JavaScript src="index8.js"></SCRIPT></div><noscript><BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC110">8.1 評価とは</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Evaluation in the scheme of things.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC111">8.2 フォームの種類</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How various sorts of objects are evaluated.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC120">8.3 クォート</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Avoiding evaluation (to put constants in the program).</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC121">8.4 評価（eval）</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to invoke the Lisp interpreter explicitly.</TD></TR>
</TABLE></BLOCKQUOTE></noscript>
<P>

<A NAME="Intro Eval"></A>
<HR SIZE="6">
<br><A NAME="SEC110"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC109"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC111"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Intro Eval"></A>
<H2> 8.1 評価とは </H2>
<!--docid::SEC110::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Intro%20Eval">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Intro%20Eval</a>"<br>
"texi/elisp21/評価とは"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C9%BE%B2%C1%A4%C8%A4%CF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

Lispインタープリタ、つまり、エバリュエータは、
与えられた式の値を計算するプログラムです。
Lispで書いた関数を呼び出すと、エバリュエータは、その関数本体内の
式を評価することで関数の値を計算します。
したがって、どんなLispプログラムの実行でも、
Lispインタープリタを実行することを意味します。
<P>

エバリュエータによるオブジェクトの扱い方は、
主にオブジェクトのデータ型に依存します。
<P>

<A NAME="IDX486"></A>
<A NAME="IDX487"></A>
評価することを意図したLispオブジェクトを
<EM>式</EM>（expression）とか<EM>フォーム</EM>（form）と呼びます。
式はデータオブジェクトであり単なるテキストではないという事実は、
Lisp様言語と典型的なプログラム言語との基本的な違いの1つです。
どんなオブジェクトでも評価できますが、実用上は、
数、シンボル、リスト、文字列を評価することが多いのです。
<P>

Lisp式を読み取りその式を評価することはとても一般的なことですが、
読み取りと評価は別々の動作であり、それぞれを別々に実行することもできます。
読み取り自体では、なにも評価しません。
Lispオブジェクトの表示表現をオブジェクトそのものに変換します。
このオブジェクトを評価すべきフォームとするか、
まったく別の目的に使うかは、<CODE>read</CODE>の呼び出し側で決まります。
<P>

評価とコマンドキーの解釈を混同しないでください。
エディタコマンドループは、有効なキーマップを用いて
キーボード入力をコマンド（対話的に呼び出し可能な関数）に変換し、
<CODE>call-interactively</CODE>を使ってコマンドを起動します。
コマンドがLispで書いてあれば、
コマンド自体の実行には評価が関わってきますが、
そのことは、コマンドキーの解釈自体には含まれていません。
<P>

<A NAME="IDX488"></A>
評価は再帰的な処理です。
つまり、フォームの評価では、
<CODE>eval</CODE>を呼び出してそのフォームの一部分を評価することもあります。
たとえば、関数呼び出しの評価においては、まず、
関数呼び出しの各引数を評価してから、関数本体の各フォームを評価します。
<CODE>(car x)</CODE>の評価を考えてみましょう。
まず最初に<CODE>x</CODE>を再帰的に評価する必要があります。
その値を関数<CODE>car</CODE>の引数として渡せるようにするのです。
<P>

関数呼び出しの評価においては、最終的に指定した関数を呼び出します。
See 節 <A HREF="elisp_12.html#SEC156">11. 関数</A>。
関数の実行そのものも、関数定義を評価する場合もあります。
あるいは、関数はC言語で実装されたLisp基本関数かもしれませんし、
バイトコード関数かもしれません（see 節 <A HREF="elisp_16.html#SEC200">15. バイトコンパイル</A>）。
<P>

<A NAME="IDX489"></A>
フォームの評価は、<EM>環境</EM>（environment）と呼ばれる文脈において
行われます。
環境とは、すべてのLisp変数の現在値と束縛です
<A NAME="DOCF7" HREF="elisp_fot.html#FOOT7">(7)</A>。
フォームが新たな束縛を作らずに変数を参照する場合には、
現在の環境におけるその変数の束縛の値を使います。
See 節 <A HREF="elisp_11.html#SEC136">10. 変数</A>。
<P>

<A NAME="IDX490"></A>
フォームを評価すると、変数（see 節 <A HREF="elisp_11.html#SEC139">10.3 ローカル変数</A>）を束縛して、
再帰的評価のための新たな環境を作ることがあります。
これらの環境は一時的なもので、そのフォームの評価を完了すると
消えてしまいます。
フォームは恒久的な変更を行ってもかまいません。
このような変更を<EM>副作用</EM>（side effects）と呼びます。
副作用を持つフォームの例は、<CODE>(setq foo 1)</CODE>です。
<P>

フォームの各種類ごとの評価の意味の詳細は、
以下で説明します（see 節 <A HREF="elisp_9.html#SEC111">8.2 フォームの種類</A>）。
<P>

<A NAME="Forms"></A>
<HR SIZE="6">
<br><A NAME="SEC111"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC110"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC112"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Forms"></A>
<H2> 8.2 フォームの種類 </H2>
<!--docid::SEC111::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Forms">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Forms</a>"<br>
"texi/elisp21/フォームの種類"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%D5%A5%A9%A1%BC%A5%E0%A4%CE%BC%EF%CE%E0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

評価することを意図したLispオブジェクトを<EM>フォーム</EM>（form）と呼びます。
Emacsがどのようにフォームを評価するかは、そのデータ型に依存します。
Emacsには、評価方法が異なる3種類のフォームがあります。
シンボル、リスト、および、『その他すべての型』です。
本節では、3種類すべてについて1つ1つ説明します。
まず、自己評価型フォームである『その他すべての型』から説明します。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC112">8.2.1 自己評価型フォーム</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Forms that evaluate to themselves.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC113">8.2.2 シンボルフォーム</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Symbols evaluate as variables.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC114">8.2.3 リストフォームの分類</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to distinguish various sorts of list forms.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC115">8.2.4 シンボルの関数間接</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">When a symbol appears as the car of a list,
			      we find the real function via the symbol.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC116">8.2.5 関数フォームの評価</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Forms that call functions.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC117">8.2.6 Lispマクロの評価</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Forms that call macros.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC118">8.2.7 スペシャルフォーム</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">"Special forms" are idiosyncratic primitives,
                              most of them extremely important.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_9.html#SEC119">8.2.8 自動ロード</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Functions set up to load files
                              containing their real definitions.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Self-Evaluating Forms"></A>
<HR SIZE="6">
<br><A NAME="SEC112"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC111"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC113"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Self-Evaluating Forms"></A>
<H3> 8.2.1 自己評価型フォーム </H3>
<!--docid::SEC112::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Self-Evaluating%20Forms">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Self-Evaluating%20Forms</a>"<br>
"texi/elisp21/自己評価型フォーム"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BC%AB%B8%CA%C9%BE%B2%C1%B7%BF%A5%D5%A5%A9%A1%BC%A5%E0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX491"></A>
<A NAME="IDX492"></A>
<A NAME="IDX493"></A>
<A NAME="IDX494"></A>
<A NAME="IDX495"></A>
<P>

<EM>自己評価型フォーム</EM>（self-evaluating form）とは、
リストでもシンボルでもない任意のフォームのことです。
自己評価型フォームはそれ自身に評価され、
評価結果は評価されるオブジェクトと同じものです。
つまり、数25は25と評価され、
文字列<CODE>"foo"</CODE>は文字列<CODE>"foo"</CODE>と評価されます。
同様に、ベクトルを評価してもベクトルの個々の要素を評価することはありません。
その内容をまったく変更することなく、同じベクトルを返します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>'123               ; 評価していない数
     => 123
123                ; 普通どおり評価。結果は同じ
     => 123
(eval '123)        ; 『手で』評価。結果は同じ
     => 123
(eval (eval '123)) ; 2回評価してもなにも変わらない
     => 123
</pre></td></tr></table><P>

Lispコードにおいては、数、文字、文字列、さらにベクトルでさえも、
それらが自己評価型である事実を利用して書くのが普通です。
しかし、入力構文を持たない型については、このようにしません。
というのは、それらをテキストとして書く方法がないからです。
そのような型を含むLisp式を構成するには、Lispプログラムを使います。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>;; バッファオブジェクトを含む式を作る
(setq print-exp (list 'print (current-buffer)))
     => (print #&#60;buffer eval.texi&#62;)
;; それを評価する
(eval print-exp)
     -| #&#60;buffer eval.texi&#62;
     => #&#60;buffer eval.texi&#62;
</pre></td></tr></table><P>

<A NAME="Symbol Forms"></A>
<HR SIZE="6">
<br><A NAME="SEC113"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC112"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC114"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Symbol Forms"></A>
<H3> 8.2.2 シンボルフォーム </H3>
<!--docid::SEC113::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Symbol%20Forms">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Symbol%20Forms</a>"<br>
"texi/elisp21/シンボルフォーム"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%B7%A5%F3%A5%DC%A5%EB%A5%D5%A5%A9%A1%BC%A5%E0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX496"></A>
<A NAME="IDX497"></A>
<P>

シンボルを評価するときには、シンボルを変数として扱います。
その結果は、値があれば、変数の値です。
（値セルが空であり）値がなければ、エラーを通知します。
変数の使い方について詳しくは、See 節 <A HREF="elisp_11.html#SEC136">10. 変数</A>。
<P>

つぎの例では、<CODE>setq</CODE>を使ってシンボルの値を設定します。
そのあとでシンボルを評価すると、<CODE>setq</CODE>で保存した値を取り出せます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(setq a 123)
     => 123
(eval 'a)
     => 123
a
     => 123
</pre></td></tr></table><P>

シンボル<CODE>nil</CODE>と<CODE>t</CODE>は特別に扱い、
<CODE>nil</CODE>の値はつねに<CODE>nil</CODE>であり、
<CODE>t</CODE>の値はつねに<CODE>t</CODE>です。
これらに別の値を設定したり、別の値を束縛することはできません。
したがって、<CODE>eval</CODE>はこれらを他のシンボルと同様に扱いますが、
これら2つのシンボルは自己評価型フォームのようにふるまいます。
`<SAMP>:</SAMP>'で始まる名前のシンボルも同じ意味で自己評価型であり、
同様に、その値を変更できません。
See 節 <A HREF="elisp_11.html#SEC138">10.2 変更不可能な変数</A>。
<P>

<A NAME="Classifying Lists"></A>
<HR SIZE="6">
<br><A NAME="SEC114"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC113"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC115"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Classifying Lists"></A>
<H3> 8.2.3 リストフォームの分類 </H3>
<!--docid::SEC114::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Classifying%20Lists">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Classifying%20Lists</a>"<br>
"texi/elisp21/リストフォームの分類"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%EA%A5%B9%A5%C8%A5%D5%A5%A9%A1%BC%A5%E0%A4%CE%CA%AC%CE%E0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX498"></A>
<A NAME="IDX499"></A>
<P>

フォームが空ではないリストならば、その最初の要素に依存して、
関数呼び出し、マクロ呼び出し、スペシャルフォームのいずれかです。
これらの3種類のフォームは、以下に説明するように、異なる方法で評価されます。
リストの残りの要素は、関数、マクロ、スペシャルフォームの
<EM>引数</EM>（arguments）になります。
<P>

空ではないリストを評価する最初の手順は、
その先頭要素を調べることです。
この要素は、それだけで、空ではないリストのフォームの種類を決定し、
リストの残りをどのように処理するかを決定します。
SchemeなどのLispの一部の方言と違って、先頭要素は評価<EM>しません</EM>。
<P>

<A NAME="Function Indirection"></A>
<HR SIZE="6">
<br><A NAME="SEC115"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC114"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC116"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Function Indirection"></A>
<H3> 8.2.4 シンボルの関数間接 </H3>
<!--docid::SEC115::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Indirection">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Indirection</a>"<br>
"texi/elisp21/シンボルの関数間接"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%B7%A5%F3%A5%DC%A5%EB%A4%CE%B4%D8%BF%F4%B4%D6%C0%DC">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX500"></A>
<A NAME="IDX501"></A>
<A NAME="IDX502"></A>
<A NAME="IDX503"></A>
<P>

リストの先頭要素がシンボルであると、
評価処理ではシンボルの関数セルを調べ、
もとのシンボルのかわりにその内容を使います。
その内容が別のシンボルであると、
<EM>シンボルの関数間接</EM>（symbol function indirection）と呼ばれる
この処理をシンボルでないものを得るまで繰り返します。
シンボルの関数セルに格納された関数名としてのシンボルの使い方について
詳しくは、See 節 <A HREF="elisp_12.html#SEC163">11.3 関数を命名する</A>。
<P>

この処理の結果、無限ループになる場合もあります。
つまり、シンボルの関数セルが同じシンボルを指している場合です。
あるいは、シンボルの関数セルが空の場合もありえます。
その場合、サブルーティン<CODE>symbol-function</CODE>は、
エラー<CODE>void-function</CODE>を通知します。
いずれの場合でもなければ、最終的にはシンボルでないものを取得し、
それは関数などの適切なオブジェクトであるはずです。
<P>

<A NAME="IDX504"></A>
<A NAME="IDX505"></A>
より正確にいえば、Lisp関数（ラムダ式）、バイトコード関数、
基本関数、Lispマクロ、スペシャルフォーム、自動ロードオブジェクトの
いずれかを取得しているはずです。
これらの各種類ごとに、以下の1つ1つの節で説明します。
オブジェクトがこれらのいずれの型でもない場合には、
エラー<CODE>invalid-function</CODE>を通知します。
<P>

つぎの例は、シンボルの関数間接の処理を図示したものです。
<CODE>fset</CODE>を使ってシンボルの関数セルに設定し、
<CODE>symbol-function</CODE>を使って関数セルの内容を取り出します
（see 節 <A HREF="elisp_12.html#SEC168">11.8 関数セルの内容の参照</A>）。
具体的には、シンボル<CODE>car</CODE>を<CODE>first</CODE>の関数セルに格納し、
シンボル<CODE>first</CODE>を<CODE>erste</CODE>の関数セルに格納します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>;; このような関数セルのリンクを作る
;;   -------------       -----        -------        -------
;;  | #&#60;subr car&#62; | &#60;-- | car |  &#60;-- | first |  &#60;-- | erste |
;;   -------------       -----        -------        -------
</FONT></pre></td></tr></table><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(symbol-function 'car)
     => #&#60;subr car&#62;
(fset 'first 'car)
     => car
(fset 'erste 'first)
     => first
(erste '(1 2 3))   ; <CODE>erste</CODE>が指す関数を呼び出す
     => 1
</FONT></pre></td></tr></table><P>

一方、つぎの例では、シンボルの関数間接を使わずに関数を呼び出します。
というのは、先頭引数はLispの無名関数であって、
シンボルではないからです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>((lambda (arg) (erste arg))
 '(1 2 3)) 
     => 1
</FONT></pre></td></tr></table><P>

関数を実行することは、その本体を評価することです。
この過程では、<CODE>erste</CODE>を呼び出すときにシンボルの関数間接が関わります。
<P>

組み込み関数<CODE>indirect-function</CODE>は、
明示的にシンボルの関数間接を行う簡単な方法です。
<P>

<A NAME="IDX506"></A>
<DL>
<DT><U>Function:</U> <B>indirect-function</B> <I>function</I>
<DD>この関数は、関数としての<VAR>function</VAR>の意味を返す。
<VAR>function</VAR>がシンボルであれば<VAR>function</VAR>の関数定義を探し、
その値から再度繰り返す。
<VAR>function</VAR>がシンボルでなければ<VAR>function</VAR>そのものを返す。
<P>

Lispで<CODE>indirect-function</CODE>を定義するとつぎのようになる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(defun indirect-function (function)
  (if (symbolp function)
      (indirect-function (symbol-function function))
    function))
</FONT></pre></td></tr></table></DL>
<P>

<A NAME="Function Forms"></A>
<HR SIZE="6">
<br><A NAME="SEC116"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC115"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC117"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Function Forms"></A>
<H3> 8.2.5 関数フォームの評価 </H3>
<!--docid::SEC116::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Forms">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Forms</a>"<br>
"texi/elisp21/関数フォームの評価"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%D8%BF%F4%A5%D5%A5%A9%A1%BC%A5%E0%A4%CE%C9%BE%B2%C1">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX507"></A>
<A NAME="IDX508"></A>
<A NAME="IDX509"></A>
<P>

評価すべきリストの先頭要素が、Lisp関数オブジェクト、
バイトコードオブジェクト、基本関数オブジェクトの場合、
そのリストは<EM>関数呼び出し</EM>（function call）です。
たとえば、つぎは、関数<CODE>+</CODE>の呼び出しです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(+ 1 x)
</pre></td></tr></table><P>

関数呼び出しを評価する最初の手順は、
リストの残りの要素を左から右へ順に評価することです。
その結果は実引数の値になり、1つの値がリストの1つの要素に対応します。
つぎの手順は、引数のリストで関数を呼び出すことで、
実質的には、関数<CODE>apply</CODE>（see 節 <A HREF="elisp_12.html#SEC165">11.5 関数呼び出し</A>）を使います。
関数がLispで書いてあれば、関数の引数変数を束縛するために引数を使います
（see 節 <A HREF="elisp_12.html#SEC158">11.2 ラムダ式</A>）。
そして、関数本体のフォーム群を順番に評価し、
本体の最後のフォームの値が関数呼び出しの値になります。
<P>

<A NAME="Macro Forms"></A>
<HR SIZE="6">
<br><A NAME="SEC117"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC116"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC118"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Macro Forms"></A>
<H3> 8.2.6 Lispマクロの評価 </H3>
<!--docid::SEC117::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Macro%20Forms">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Macro%20Forms</a>"<br>
"texi/elisp21/Lispマクロの評価"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2FLisp%A5%DE%A5%AF%A5%ED%A4%CE%C9%BE%B2%C1">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX510"></A>
<A NAME="IDX511"></A>
<P>

評価すべきリストの先頭要素がマクロオブジェクトの場合、
そのリストは<EM>マクロ呼び出し</EM>（macro call）です。
マクロ呼び出しを評価するときは、リストの残りの要素を評価<EM>しません</EM>。
そのかわりに、要素そのものをマクロの引数として使います。
マクロ定義は、
マクロの<EM>展開形</EM>（expansion）と呼ばれる置換フォームを計算し、
もとのフォームのかわりに展開形を評価します。
展開形は、どんな種類のフォームでもかまいません。
自己評価型の定数、シンボル、あるいは、リストです。
展開形そのものがマクロ呼び出しであると、
マクロ呼び出し以外のフォームを得られるまで、
展開形を得る処理を繰り返します。
<P>

通常のマクロ呼び出しの評価は、展開形を評価することで完了します。
しかし、マクロの展開形を必ずしもただちに評価する必要はなく、
まったく評価しなくてもかまいません。
というのは、別のプログラムもマクロ呼び出しを展開し、
それらは展開形を評価するものもあれば、評価しないものもあるからです。
<P>

普通、引数の式は、マクロ展開の計算過程では評価せず、
展開形の一部として現れます。
そして、展開形を評価するときに引数が計算されます。
<P>

たとえば、つぎのようなマクロ定義があったとします。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defmacro cadr (x)
  (list 'car (list 'cdr x)))
</pre></td></tr></table><P>

<CODE>(cadr (assq 'handler list))</CODE>のような式はマクロ呼び出しであり、
つぎのような展開形になります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(car (cdr (assq 'handler list)))
</pre></td></tr></table><P>

引数<CODE>(assq 'handler list)</CODE>が展開形に現れていることに
注意してください。
<P>

Emacs Lispのマクロに関する完全な記述は、See 節 <A HREF="elisp_13.html#SEC171">12. マクロ</A>。
<P>

<A NAME="Special Forms"></A>
<HR SIZE="6">
<br><A NAME="SEC118"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC117"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC119"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Special Forms"></A>
<H3> 8.2.7 スペシャルフォーム </H3>
<!--docid::SEC118::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Special%20Forms">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Special%20Forms</a>"<br>
"texi/elisp21/スペシャルフォーム"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%B9%A5%DA%A5%B7%A5%E3%A5%EB%A5%D5%A5%A9%A1%BC%A5%E0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX512"></A>
<A NAME="IDX513"></A>
<P>

<EM>スペシャルフォーム</EM>（special form）は、
その引数を評価しないように特別な印が付いた基本関数です。
ほとんどのスペシャルフォームは、制御構造を定義したり、
変数を束縛したりします。
これらはどれも関数ではできないことです。
<P>

各スペシャルフォームには、どの引数は評価し、
どの引数は評価せずに使うかといったそれぞれに独自の規則があります。
特定の引数を評価するかどうかは、他の引数の評価結果に依存することもあります。
<P>

以下に、Emacs Lispのすべてのスペシャルフォームをアルファベット順に、
参照箇所とともにあげておきます。
<P>

<DL COMPACT>
<DT><CODE>and</CODE>
<DD>see 節 <A HREF="elisp_10.html#SEC125">9.3 条件の組み合わせ</A>
<P>

<DT><CODE>catch</CODE>
<DD>see 節 <A HREF="elisp_10.html#SEC128">9.5.1 明示的な非ローカル脱出：<CODE> </CODE><CODE>catch</CODE>と<CODE>throw</CODE></A>
<P>

<DT><CODE>cond</CODE>
<DD>see 節 <A HREF="elisp_10.html#SEC124">9.2 条件付き実行</A>
<P>

<DT><CODE>condition-case</CODE>
<DD>see 節 <A HREF="elisp_10.html#SEC133">9.5.3.3 エラーハンドラの書き方</A>
<P>

<DT><CODE>defconst</CODE>
<DD>see 節 <A HREF="elisp_11.html#SEC141">10.5 グローバル変数を定義する</A>
<P>

<DT><CODE>defmacro</CODE>
<DD>see 節 <A HREF="elisp_13.html#SEC175">12.4 マクロ定義</A>
<P>

<DT><CODE>defun</CODE>
<DD>see 節 <A HREF="elisp_12.html#SEC164">11.4 関数を定義する</A>
<P>

<DT><CODE>defvar</CODE>
<DD>see 節 <A HREF="elisp_11.html#SEC141">10.5 グローバル変数を定義する</A>
<P>

<DT><CODE>function</CODE>
<DD>see 節 <A HREF="elisp_12.html#SEC167">11.7 無名関数</A>
<P>

<DT><CODE>if</CODE>
<DD>see 節 <A HREF="elisp_10.html#SEC124">9.2 条件付き実行</A>
<P>

<DT><CODE>interactive</CODE>
<DD>see 節 <A HREF="elisp_21.html#SEC287">20.3 対話的呼び出し</A>
<P>

<DT><CODE>let</CODE>
<DD><DT><CODE>let*</CODE>
<DD>see 節 <A HREF="elisp_11.html#SEC139">10.3 ローカル変数</A>
<P>

<DT><CODE>or</CODE>
<DD>see 節 <A HREF="elisp_10.html#SEC125">9.3 条件の組み合わせ</A>
<P>

<DT><CODE>prog1</CODE>
<DD><DT><CODE>prog2</CODE>
<DD><DT><CODE>progn</CODE>
<DD>see 節 <A HREF="elisp_10.html#SEC123">9.1 逐次実行</A>
<P>

<DT><CODE>quote</CODE>
<DD>see 節 <A HREF="elisp_9.html#SEC120">8.3 クォート</A>
<P>

<DT><CODE>save-current-buffer</CODE>
<DD>see 節 <A HREF="elisp_27.html#SEC405">26.2 カレントバッファ <EM>(2003/10/30)</EM></A>
<P>

<DT><CODE>save-excursion</CODE>
<DD>see 節 <A HREF="elisp_30.html#SEC472">29.3 エクスカージョン</A>
<P>

<DT><CODE>save-restriction</CODE>
<DD>see 節 <A HREF="elisp_30.html#SEC473">29.4 ナロイング</A>
<P>

<DT><CODE>save-window-excursion</CODE>
<DD>see 節 <A HREF="elisp_28.html#SEC432">27.16 ウィンドウ構成</A>
<P>

<DT><CODE>setq</CODE>
<DD>see 節 <A HREF="elisp_11.html#SEC144">10.8 変数値の変更</A>
<P>

<DT><CODE>setq-default</CODE>
<DD>see 節 <A HREF="elisp_11.html#SEC152">10.10.2 バッファローカルな束縛の作成と削除</A>
<P>

<DT><CODE>track-mouse</CODE>
<DD>see 節 <A HREF="elisp_29.html#SEC451">28.13 マウスの追跡</A>
<P>

<DT><CODE>unwind-protect</CODE>
<DD>see 節 <A HREF="elisp_10.html#SEC127">9.5 非ローカル脱出</A>
<P>

<DT><CODE>while</CODE>
<DD>see 節 <A HREF="elisp_10.html#SEC126">9.4 繰り返し</A>
<P>

<DT><CODE>with-output-to-temp-buffer</CODE>
<DD>see 節 <A HREF="elisp_38.html#SEC606">37.7 一時的な表示</A>
</DL>
<P>

<A NAME="IDX514"></A>
<BLOCKQUOTE>
<B>Common Lispに関した注意：</B><CODE> </CODE>
GNU Emacs LispとCommon Lispのスペシャルフォームを比較してみる。
<CODE>setq</CODE>、<CODE>if</CODE>、および、<CODE>catch</CODE>は、Emacs Lispでも
Common Lispでもスペシャルフォームである。
<CODE>defun</CODE>は、Emacs Lispではスペシャルフォームであるが、
Common Lispではマクロである。
<CODE>save-excursion</CODE>は、Emacs Lispではスペシャルフォームであるが、
Common Lispには存在しない。
<CODE>throw</CODE>は、Common Lispでは（複数の値を返す必要があるため）
スペシャルフォームであるが、
Emacs Lispでは（複数の値はないため）関数である。
</BLOCKQUOTE>
<P>

<A NAME="Autoloading"></A>
<HR SIZE="6">
<br><A NAME="SEC119"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC118"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC120"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Autoloading"></A>
<H3> 8.2.8 自動ロード </H3>
<!--docid::SEC119::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Autoloading">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Autoloading</a>"<br>
"texi/elisp21/自動ロード"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BC%AB%C6%B0%A5%ED%A1%BC%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<EM>自動ロード</EM>（autoload）は、
関数やマクロの関数定義をEmacsにまだロードしていなくても、
関数やマクロを呼び出せるようにする機構です。
定義を収めたファイルを指定します。
シンボルの関数定義に自動ロードオブジェクトあるとき、
そのシンボルを関数として呼び出すと、指定したファイルを自動的にロードします。
そうしてから、当該ファイルからロードした実際の定義を呼び出します。
See 節 <A HREF="elisp_15.html#SEC195">14.4 自動ロード</A>。
<P>

<A NAME="Quoting"></A>
<HR SIZE="6">
<br><A NAME="SEC120"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC119"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC121"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Quoting"></A>
<H2> 8.3 クォート </H2>
<!--docid::SEC120::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Quoting">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Quoting</a>"<br>
"texi/elisp21/クォート"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AF%A5%A9%A1%BC%A5%C8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX515"></A>
<P>

スペシャルフォーム<CODE>quote</CODE>は、単一の引数を
評価せずに書かれたとおりに返します。
これは、自己評価型オブジェクトではない
定数シンボルや定数リストをプログラム内に書く手段です。
（数、文字列、ベクトルなどの自己評価型オブジェクトをクォートする必要はない。）
<P>

<A NAME="IDX516"></A>
<DL>
<DT><U>Special Form:</U> <B>quote</B> <I>object</I>
<DD>このフォームは<VAR>object</VAR>を評価せずに返す。
</DL>
<P>

<A NAME="IDX517"></A>
<A NAME="IDX518"></A>
<CODE>quote</CODE>はプログラム内で頻繁に使うので、
Lispには便利な入力構文が用意してあります。
アポストロフ文字（`<SAMP>'</SAMP>'）に続けた（入力構文で書いた）Lispオブジェクトは、
先頭要素が<CODE>quote</CODE>であり2番目の要素がそのオブジェクトである
リストに展開されます。
したがって、入力構文<CODE>'x</CODE>は、<CODE>(quote x)</CODE>の省略形です。
<P>

<CODE>quote</CODE>を使った式の例をいくつかあげておきます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(quote (+ 1 2))
     => (+ 1 2)
(quote foo)
     => foo
'foo
     => foo
''foo
     => (quote foo)
'(quote foo)
     => (quote foo)
['foo]
     => [(quote foo)]
</pre></td></tr></table><P>

他のクォートの書き方には、<CODE>function</CODE>（see 節 <A HREF="elisp_12.html#SEC167">11.7 無名関数</A>）が
あります。
これは、Lispで書いた無名ラムダ式をコンパイルするようにします。
また、`<SAMP>`</SAMP>'（see 節 <A HREF="elisp_13.html#SEC176">12.5 バッククォート</A>）は、
リストの一部分をクォートし、他の部分は計算結果で置き換えるために使います。
<P>

<A NAME="Eval"></A>
<HR SIZE="6">
<br><A NAME="SEC121"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_9.html#SEC120"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_10.html#SEC122"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Eval"></A>
<H2> 8.4 評価（eval） </H2>
<!--docid::SEC121::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Eval">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Eval</a>"<br>
"texi/elisp21/評価（eval）"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C9%BE%B2%C1%A1%CAeval%A1%CB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

ほとんどの場合、実行中のプログラムにフォームが現れると
フォームは自動的に評価されます。
稀なことですが、実行時に計算したフォームを評価するように
コードを書く必要があるかもしれません。
たとえば、編集中のテキストからフォームを読み取ったり、
属性リストからフォームを取り出した場合などです。
このような場合には、関数<CODE>eval</CODE>を使います。
<P>

本節で説明した関数や変数は、フォームを評価したり、
評価処理に制限を課したり、最後の戻り値を記録したりします。
ファイルをロードしても評価が行われます（see 節 <A HREF="elisp_15.html#SEC191">14. ロード</A>）。
<P>

<STRONG>注意：</STRONG><CODE> </CODE>
データ構造の中に関数を格納して
それを<CODE>funcall</CODE>や<CODE>apply</CODE>で呼び出すほうが、
データ構造の中に式を格納してそれを評価するより、
一般に明確で柔軟性があります。
関数を使うとそれらに引数として情報を渡すことができます。
<P>

<A NAME="IDX519"></A>
<DL>
<DT><U>Function:</U> <B>eval</B> <I>form</I>
<DD>この関数は、式を評価する基本的な関数である。
<VAR>form</VAR>を現在の環境において評価し、その結果を返す。
評価処理はオブジェクトの型に依存する（see 節 <A HREF="elisp_9.html#SEC111">8.2 フォームの種類</A>）。
<P>

<CODE>eval</CODE>は関数なので、<CODE>eval</CODE>の呼び出しに現れる
引数の式は2度評価される。
<CODE>eval</CODE>を呼び出すまえの準備で1回、
関数<CODE>eval</CODE>自身による評価でもう1回である。
例を示す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(setq foo 'bar)
     => bar
(setq bar 'baz)
     => baz
;; <CODE>eval</CODE>は引数<CODE>foo</CODE>を受け取る
(eval 'foo)
     => bar
;; <CODE>eval</CODE>は引数<CODE>bar</CODE>を受け取る。それは<CODE>foo</CODE>の値
(eval foo)
     => baz
</pre></td></tr></table><P>

<CODE>eval</CODE>の呼び出しの深さは、
<CODE>max-lisp-eval-depth</CODE>（下記参照）に制限される。
</DL>
<P>

<A NAME="IDX520"></A>
<DL>
<DT><U>コマンド:</U> <B>eval-region</B> <I>start end &#38;optional stream read-function</I>
<DD>この関数は、カレントバッファの<VAR>start</VAR>と<VAR>end</VAR>で指定した
リージョン内のフォーム群を評価する。
リージョンからフォームを読み取り、
それらに対して<CODE>eval</CODE>を呼び出すことを
リージョンの末尾に達するまで、あるいは、処理されないエラーが通知されるまで
繰り返す。
<P>

<VAR>stream</VAR>が<CODE>nil</CODE>以外ならば、
リージョン内の式を評価した結果の値は<VAR>stream</VAR>を使って表示する。
see 節 <A HREF="elisp_19.html#SEC262">18.4 出力ストリーム</A>。
<P>

<VAR>read-function</VAR>が<CODE>nil</CODE>以外にならば、
それは関数である必要があり、
<CODE>read</CODE>のかわりに式を1つ1つ読むために使われる。
この関数は、入力用のストリームである1つの引数で呼び出される。
変数<CODE>load-read-function</CODE>（see 節 <A HREF="elisp_15.html#SEC192">14.1 プログラムからのロード方法</A>）を
使ってこの関数を指定することもできるが、
引数<VAR>read-function</VAR>を用いたほうが堅牢である。
<P>

<CODE>eval-region</CODE>はつねに<CODE>nil</CODE>を返す。
</DL>
<P>

<A NAME="IDX521"></A>
<A NAME="IDX522"></A>
<A NAME="IDX523"></A>
<DL>
<DT><U>コマンド:</U> <B>eval-current-buffer</B> <I>&#38;optional stream</I>
<DD>これは<CODE>eval-region</CODE>と同様だが、バッファ全体に作用する。
</DL>
<P>

<A NAME="IDX524"></A>
<DL>
<DT><U>Variable:</U> <B>max-lisp-eval-depth</B>
<DD>この変数は、
（エラーメッセージ<CODE>"Lisp nesting exceeds max-lisp-eval-depth"</CODE>で）
エラーを通知までの<CODE>eval</CODE>、<CODE>apply</CODE>、<CODE>funcall</CODE>の呼び出しの
最大の深さを制限する。
この制限、および、これを超えたときのエラーは、
不正に定義された関数によってLispが無限に再帰することを防止する
1つの方法である。
<A NAME="IDX525"></A>
<A NAME="IDX526"></A>
<P>

深さ制限は、Lispコードによる明示的な呼び出しに加えて、
Lisp式で書かれた関数の呼び出しや関数呼び出しの引数や関数本体のフォームの
再帰的な評価などの内部的な<CODE>eval</CODE>、<CODE>apply</CODE>、<CODE>funcall</CODE>の
呼び出しも数える。
<P>

この変数のデフォルト値は300。
これに100未満の値を設定すると、指定した値に達するとLispは100に設定し直す。
Lispデバッガに入ったとき、
制限に近い場合にはデバッガ自身が実行できることを保証するために値を増やす。
<P>

<CODE>max-specpdl-size</CODE>は、入れ子の深さを制限する別の方法である。
see 節 <A HREF="elisp_11.html#SEC139">10.3 ローカル変数</A>。
</DL>
<P>

<A NAME="IDX527"></A>
<DL>
<DT><U>Variable:</U> <B>values</B>
<DD>この変数の値は、
バッファから式を読み取り、評価し、結果を表示するEmacsの標準コマンドが行った
すべての式の戻り値のリストである。
リストの順序は、最新のものが最初にくる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(setq x 1)
     => 1
(list 'A (1+ 2) auto-save-default)
     => (A 3 t)
values
     => ((A 3 t) 1 <small>...</small>)
</pre></td></tr></table><P>

この変数は、最近評価したフォームの値を参照するのに便利である。
<CODE>values</CODE>そのものの値の表示は非常に長くなる可能性があるので、
その値を表示するのはよくない。
そのかわりに、つぎのようにして特定の要素を調べる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>;; もっとも最近の評価結果を参照する
(nth 0 values)
     => (A 3 t)
;; こうすると、新たな要素が追加され、
;;   すべての要素が1つうしろへさがる
(nth 1 values)
     => (A 3 t)
;; この例を実行するまえの最新のもののつぎの要素を取得する
(nth 3 values)
     => 1
</pre></td></tr></table></DL>
<P>

<A NAME="Control Structures"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<a name="bottom"> </a>
<script type="text/javascript" src="style2.js"></script>
<div class="footer">
    <br>
    このページはMeadow (Emacs) の紹介ページです <br>
このWebページの各文書は自由にリンク・複製・再配布・改変していただいて構いません．
<br>ただし，複製・再配布・改変の場合は Meadow Memo のURLを記載しておいて下さい．<br>
<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=about%20link">Medow memoへのリンクについて</a>．<br>

間違い，要望等があれば<a href="mailto:akihisa@mail.ne.jp">akihisa@mail.ne.jp</a> か下記でどうぞ<br>

<br>

<FORM METHOD="post" ACTION="http://www.bookshelf.jp/cgi-bin/wwwmail.cgi" >
お名前：<INPUT TYPE="text" NAME="name" SIZE="30" MAXLENGTH="40" VALUE="ななしさん"><br>
メールアドレス：<INPUT TYPE="text" NAME="EMAIL" SIZE="25" MAXLENGTH="60" VALUE="secret@mail.adr"><br>
<input type="hidden" name="HPAGE" value="">
つっこみ：<br><TEXTAREA NAME="MESSAGE" ROWS="5" COLS="50">
</TEXTAREA><br><br>
<INPUT TYPE="submit" VALUE="送信">
<INPUT TYPE="reset" VALUE="クリア">
</FORM>

<br><A HREF="http://www.bookshelf.jp/cgi-bin/xct.cgi">ページ別カウンタ</a>
<br> Since 2002/12/13 <br>
</div>

</BODY>

</HTML>
