<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="ja">
<!-- Created on October, 1  2005 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=euc-jp">
<META NAME="keywords" CONTENT="meadow,mule,emacs,lisp,elisp,gnus,setting,設定,unix,cygwin">
<META http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="description" CONTENT="Meadowの設定を紹介するページです">
<TITLE>GNU Emacs Lispリファレンスマニュアル:  テキスト</TITLE>

<META NAME="description" CONTENT="GNU Emacs Lispリファレンスマニュアル:  テキスト">
<META NAME="keywords" CONTENT="GNU Emacs Lispリファレンスマニュアル:  テキスト">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

<LINK REL="contents" HREF="elisp_toc.html#SEC_Contents">
<LINK REL="index" HREF="elisp_48.html#SEC681">
<LINK REL="next" HREF="elisp_33.html#SEC528">
<LINK REL="prev" HREF="elisp_31.html#SEC474">

<META http-equiv="Content-Style-Type" content="text/css">
<!-- 鶯と龜 ←日本語EUC誤判別対策用らしい; -->
<link rel="StyleSheet" href="../../../../soft/css/midnight.css" type="text/css" id="css1">
<script type="text/javascript" src="style1.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../soft/css/meadowmemo.css">

</HEAD>
<BODY LANG="ja" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<!--Infoseek Analyzer start-->
<script LANGUAGE="javascript">PgNo=6;</script>
<script src="http://js1.infoseek.co.jp/bin/57/00170.js"></script>
<noscript><a href="http://ax1.www.infoseek.co.jp/bin/go?0017057f" target="_blank">
<img src="http://ax1.www.infoseek.co.jp/bin/logo?0017057f" border=0></a></noscript>
<!--Infoseek Analyzer end-->
<a name="top"> </a>

<br><A NAME="SEC483"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_31.html#SEC482"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC484"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_31.html#SEC474"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_33.html#SEC528"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Text"></A>
<H1> 31. テキスト </H1>
<!--docid::SEC483::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Text">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Text</a>"<br>
"texi/elisp21/テキスト"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2160"></A>
<P>

本章では、バッファ内のテキストを扱う関数について述べます。
それらのほとんどは、カレントバッファ内のテキストを
調べたり挿入したり削除しますが、しばしばポイント付近で行います。
多くは対話的に使えます。
テキストを変更するすべての関数は、変更を取り消せます（see 節 <A HREF="elisp_32.html#SEC497">31.9 アンドゥ</A>）。
<P>

テキスト関連の多くの関数は、<VAR>start</VAR>と<VAR>end</VAR>という名前の引数で渡された
2つのバッファ内位置で定義されるテキストの領域に作用します。
これらの引数は、マーカ（see 節 <A HREF="elisp_31.html#SEC474">30. マーカ</A>）であるか
文字の位置を表す数値（see 節 <A HREF="elisp_30.html#SEC462">29. バッファ内の位置</A>）である必要があります。
これらの引数の順番は関係なく、<VAR>start</VAR>が領域の終了位置で
<VAR>end</VAR>が開始位置であってもまったく問題ありません。
たとえば、<CODE>(delete-region 1 10)</CODE>と<CODE>(delete-region 10 1)</CODE>は同値です。
<VAR>start</VAR>や<VAR>end</VAR>がバッファの参照可能部分の外側にあると
エラー<CODE>args-out-of-range</CODE>を通知します。
対話的な呼び出しでは、ポイントとマークをこれらの引数として使います。
<P>

<A NAME="IDX2161"></A>
本章では、バッファ内の文字を（関係あるときには）
それらのテキスト属性を含めて『テキスト』と呼びます。
<P>

<div class="menuindex"><SCRIPT language=JavaScript src="index31.js"></SCRIPT></div><noscript><BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC484">31.1 ポイント付近のテキストを調べる</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Examining text in the vicinity of point.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC485">31.2 バッファの内容を調べる</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Examining text in a general fashion.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC486">31.3 テキストの比較</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Comparing substrings of buffers.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC487">31.4 テキストの挿入</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Adding new text to a buffer.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC488">31.5 ユーザーレベルの挿入コマンド</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">User-level commands to insert text.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC489">31.6 テキストの削除</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Removing text from a buffer.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC490">31.7 ユーザーレベルの削除コマンド</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">User-level commands to delete text.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC491">31.8 キルリング</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Where removed text sometimes is saved for later use.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC497">31.9 アンドゥ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Undoing changes to the text of a buffer.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC498">31.10 アンドゥリストの管理</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to enable and disable undo information.
			How to control how much information is kept.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC499">31.11 詰め込み</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Functions for explicit filling.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC500">31.12 詰め込みのための余白</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to specify margins for filling commands.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC501">31.13 適応型詰め込み（adaptive-fill）モード</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Adaptive Fill mode chooses a fill prefix from context.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC502">31.14 自動詰め込み（auto-filling）モード</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How auto-fill mode is implemented to break lines.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC503">31.15 テキストのソート</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Functions for sorting parts of the buffer.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC504">31.16 コラムを数える</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Computing horizontal positions, and using them.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC505">31.17 字下げ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Functions to insert or adjust indentation.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC512">31.18 大文字小文字の変更</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Case conversion of parts of the buffer.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC513">31.19 テキスト属性</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Assigning Lisp property lists to text characters.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC524">31.20 文字コードの置換</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Replacing a given character wherever it appears.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC526">31.22 テキストの転置</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Swapping two portions of a buffer.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC525">31.21 レジスタ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How registers are implemented.  Accessing the text or
                       position stored in a register.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC527">31.23 変更フック</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Supplying functions to be run when text is changed.</TD></TR>
</TABLE></BLOCKQUOTE></noscript>
<P>

<A NAME="Near Point"></A>
<HR SIZE="6">
<br><A NAME="SEC484"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC483"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC485"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Near Point"></A>
<H2> 31.1 ポイント付近のテキストを調べる </H2>
<!--docid::SEC484::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Near%20Point">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Near%20Point</a>"<br>
"texi/elisp21/ポイント付近のテキストを調べる"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%DD%A5%A4%A5%F3%A5%C8%C9%D5%B6%E1%A4%CE%A5%C6%A5%AD%A5%B9%A5%C8%A4%F2%C4%B4%A4%D9%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

多くの関数は、ポイント付近の文字を調べるためのものです。
ここでは、数個の単純な関数について述べます。
<A HREF="elisp_34.html#SEC554">33.3 正規表現の探索</A>の<CODE>looking-at</CODE>も参照してください。
<P>

<A NAME="IDX2162"></A>
<DL>
<DT><U>Function:</U> <B>char-after</B> <I>&#38;optional position</I>
<DD>この関数は、カレントバッファ内の位置<VAR>position</VAR>にある
（つまり直後の）文字を返す。
<VAR>position</VAR>がバッファの先頭のまえや末尾のうしろにあるなどして
この目的に適した範囲の外側にあると、値は<CODE>nil</CODE>である。
<VAR>position</VAR>のデフォルトはポイントである。
<P>

つぎの例では、バッファの最初の文字は`<SAMP>&#64;</SAMP>'であると仮定する。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(char-to-string (char-after 1))
     => "&#64;"
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2163"></A>
<DL>
<DT><U>Function:</U> <B>char-before</B> <I>&#38;optional position</I>
<DD>この関数は、カレントバッファ内の位置<VAR>position</VAR>のまえにある文字を返す。
<VAR>position</VAR>がバッファの先頭のまえや末尾のうしろにあるなどして
この目的に適した範囲の外側にあると、値は<CODE>nil</CODE>である。
<VAR>position</VAR>のデフォルトはポイントである。
</DL>
<P>

<A NAME="IDX2164"></A>
<DL>
<DT><U>Function:</U> <B>following-char</B>
<DD>この関数は、カレントバッファのポイントのうしろにある文字を返す。
これは<CODE>(char-after (point))</CODE>と同様である。
しかし、ポイントがバッファの末尾にあると、
<CODE>following-char</CODE>は0を返す。
<P>

ポイントはつねに文字のあいだにあり、
端末のカーソルはポイントの直後の文字に重ねて表示されることに注意してほしい。
したがって、<CODE>following-char</CODE>が返す文字は、
カーソルが重なっている文字である。
<P>

つぎの例では、ポイントは`<SAMP>a</SAMP>'と`<SAMP>c</SAMP>'のあいだにある。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
Gentlemen may cry ``Pea-!-ce! Peace!,''
but there is no peace.
---------- Buffer: foo ----------

(char-to-string (preceding-char))
     => "a"
(char-to-string (following-char))
     => "c"
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2165"></A>
<DL>
<DT><U>Function:</U> <B>preceding-char</B>
<DD>この関数は、カレントバッファのポイントのまえの文字を返す。
例については上記の<CODE>following-char</CODE>を参照。
ポイントがバッファの先頭にあると、<CODE>preceding-char</CODE>は0を返す。
</DL>
<P>

<A NAME="IDX2166"></A>
<DL>
<DT><U>Function:</U> <B>bobp</B>
<DD>この関数は、ポイントがバッファの先頭にあると<CODE>t</CODE>を返す。
ナロイングしていると、これはバッファの参照可能部分の先頭を意味する。
<A HREF="elisp_30.html#SEC463">29.1 ポイント</A>の<CODE>point-min</CODE>も参照。
</DL>
<P>

<A NAME="IDX2167"></A>
<DL>
<DT><U>Function:</U> <B>eobp</B>
<DD>この関数は、ポイントがバッファの末尾にあると<CODE>t</CODE>を返す。
ナロイングしていると、これはバッファの参照可能部分の末尾を意味する。
<A HREF="elisp_30.html#SEC463">29.1 ポイント</A>の<CODE>point-max</CODE>も参照。
</DL>
<P>

<A NAME="IDX2168"></A>
<DL>
<DT><U>Function:</U> <B>bolp</B>
<DD>この関数は、ポイントが行頭にあると<CODE>t</CODE>を返す。
see 節 <A HREF="elisp_30.html#SEC468">29.2.4 テキスト行単位の移動</A>。
バッファ（あるいはその参照可能部分）の先頭は、
つねに行頭とみなす。
</DL>
<P>

<A NAME="IDX2169"></A>
<DL>
<DT><U>Function:</U> <B>eolp</B>
<DD>この関数は、ポイントが行末にあると<CODE>t</CODE>を返す。
see 節 <A HREF="elisp_30.html#SEC468">29.2.4 テキスト行単位の移動</A>。
バッファ（あるいはその参照可能部分）の末尾は、
つねに行末とみなす。
</DL>
<P>

<A NAME="Buffer Contents"></A>
<HR SIZE="6">
<br><A NAME="SEC485"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC484"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC486"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Buffer Contents"></A>
<H2> 31.2 バッファの内容を調べる </H2>
<!--docid::SEC485::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Buffer%20Contents">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Buffer%20Contents</a>"<br>
"texi/elisp21/バッファの内容を調べる"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%D0%A5%C3%A5%D5%A5%A1%A4%CE%C6%E2%CD%C6%A4%F2%C4%B4%A4%D9%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節では、Lispプログラムでバッファ内の任意の部分のテキストを文字列に変換する
ための2つの関数について述べます。
<P>

<A NAME="IDX2170"></A>
<DL>
<DT><U>Function:</U> <B>buffer-substring</B> <I>start end</I>
<DD>この関数は、カレントバッファの<VAR>start</VAR>と<VAR>end</VAR>の位置で定義される
領域のテキストのコピーを含んだ文字列を返す。
引数がバッファの参照可能部分の内側の位置でないと、
<CODE>buffer-substring</CODE>はエラー<CODE>args-out-of-range</CODE>を通知する。
<P>

<VAR>start</VAR>が<VAR>end</VAR>より小さい必要はなく、引数の順番はどちらでもよい。
しかし、ほとんどの場合、小さい引数を先に書く。
<P>

コピーされるテキストにテキスト属性がある場合、
テキスト属性もそれが属する文字とともに文字列へコピーされる。
see 節 <A HREF="elisp_32.html#SEC513">31.19 テキスト属性</A>。
しかし、バッファのオーバレイ（see 節 <A HREF="elisp_38.html#SEC607">37.8 オーバレイ</A>）とそれらの属性は
無視されコピーされない。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
This is the contents of buffer foo

---------- Buffer: foo ----------

(buffer-substring 1 10)
=> "This is t"
(buffer-substring (point-max) 10)
=> "he contents of buffer foo
"
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2171"></A>
<DL>
<DT><U>Function:</U> <B>buffer-substring-no-properties</B> <I>start end</I>
<DD>この関数は<CODE>buffer-substring</CODE>と同様であるが、
テキスト属性をコピーせずに文字だけをコピーする点が異なる。
see 節 <A HREF="elisp_32.html#SEC513">31.19 テキスト属性</A>。
</DL>
<P>

<A NAME="IDX2172"></A>
<DL>
<DT><U>Function:</U> <B>buffer-string</B>
<DD>この関数は、カレントバッファの参照可能部分全体の内容を文字列として返す。
これは、つぎと等価である。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(buffer-substring (point-min) (point-max))
</pre></td></tr></table><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
This is the contents of buffer foo

---------- Buffer: foo ----------

(buffer-string)
     => "This is the contents of buffer foo
"
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2173"></A>
<DL>
<DT><U>Function:</U> <B>thing-at-point</B> <I>thing</I>
<DD>ポイントの周りやそのうしろにある<VAR>thing</VAR>を文字列として返す。
<P>

引数<VAR>thing</VAR>は、構文上の要素の種類を指定するシンボルである。
可能な値は、<CODE>symbol</CODE>、<CODE>list</CODE>、<CODE>sexp</CODE>、
<CODE>defun</CODE>、<CODE>filename</CODE>、<CODE>url</CODE>、<CODE>word</CODE>、<CODE>sentence</CODE>、
<CODE>whitespace</CODE>、<CODE>line</CODE>、<CODE>page</CODE>などである。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
Gentlemen may cry ``Pea-!-ce! Peace!,''
but there is no peace.
---------- Buffer: foo ----------

(thing-at-point 'word)
     => "Peace"
(thing-at-point 'line)
     => "Gentlemen may cry ``Peace! Peace!,''\n"
(thing-at-point 'whitespace)
     => nil
</pre></td></tr></table></DL>
<P>

<A NAME="Comparing Text"></A>
<HR SIZE="6">
<br><A NAME="SEC486"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC485"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC487"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Comparing Text"></A>
<H2> 31.3 テキストの比較 </H2>
<!--docid::SEC486::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Comparing%20Text">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Comparing%20Text</a>"<br>
"texi/elisp21/テキストの比較"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%A4%CE%C8%E6%B3%D3">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2174"></A>
<P>

この関数により、バッファ内のテキストの部分同士を
文字列にコピーせずに比較できます。
<P>

<A NAME="IDX2175"></A>
<DL>
<DT><U>Function:</U> <B>compare-buffer-substrings</B> <I>buffer1 start1 end1 buffer2 start2 end2</I>
<DD>この関数は、同一バッファ内の2つの部分文字列、あるいは、
異なる2つのバッファの部分文字列を比較する。
始めの3つの引数は、バッファとそのバッファ内の2つの位置を与え、
1つの部分文字列を指定する。
残りの3つの引数も同様にして別の部分文字列を指定する。
カレントバッファを表すために、
<VAR>buffer1</VAR>と<VAR>buffer2</VAR>のいずれか、あるいは、
両方に<CODE>nil</CODE>を指定できる。
<P>

始めの文字列のほうが小さければ値は負であり、
始めのほうが大きければ値は正であり、等しければ0である。
結果の絶対値は、部分文字列の中で最初に異なる文字の添字足す1である。
<P>

この関数は、<CODE>case-fold-search</CODE>が<CODE>nil</CODE>以外であると、
文字の比較では大文字小文字を区別しない。
テキスト属性はつねに無視する。
<P>

カレントバッファにはテキスト`<SAMP>foobarbar haha!rara!</SAMP>'があるとする。
すると、この例の2つの部分文字列は`<SAMP>rbar </SAMP>'と`<SAMP>rara!</SAMP>'である。
2番目の文字で最初の文字列のほうが大きいので、結果は2である。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(compare-buffer-substring nil 6 11 nil 16 21)
     => 2
</pre></td></tr></table></DL>
<P>

<A NAME="Insertion"></A>
<HR SIZE="6">
<br><A NAME="SEC487"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC486"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC488"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Insertion"></A>
<H2> 31.4 テキストの挿入 </H2>
<!--docid::SEC487::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Insertion">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Insertion</a>"<br>
"texi/elisp21/テキストの挿入"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%A4%CE%C1%DE%C6%FE">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2176"></A>
<A NAME="IDX2177"></A>
<P>

<A NAME="IDX2178"></A>
<A NAME="IDX2179"></A>
<EM>挿入</EM>（insertion）とは、バッファに新たなテキストを追加することです。
挿入されたテキストはポイント位置に、つまり、
ポイントのまえの文字とポイントのあとの文字のあいだに入ります。
挿入されたテキストのまえにポイントを留める関数もあれば、
そのうしろに留める関数もあります。
前者を<EM>ポイントのうしろへ</EM>挿入と呼び、
後者を<EM>ポイントのまえへ</EM>挿入と呼びます。
<P>

挿入により、挿入箇所よりうしろの位置を指すマーカは再配置されて
同じ周りの文字に留まります（see 節 <A HREF="elisp_31.html#SEC474">30. マーカ</A>）。
マーカが挿入箇所を指している場合には、
マーカの挿入型（see 節 <A HREF="elisp_31.html#SEC479">30.5 マーカの挿入型</A>）に依存して、
挿入するとマーカが再配置されたりされなかったりします。
<CODE>insert-before-markers</CODE>などの特定の特殊な関数は、
マーカの挿入型に関わらず、
挿入されたテキストのうしろを指すように
そのようなすべてのマーカを再配置します。
<P>

カレントバッファが読み出し専用であると、挿入関数はエラーを通知します。
<P>

これらの関数は、テキストの文字群をそれらの属性とともに
文字列からバッファへコピーします。
挿入された文字群は、コピーされるまえとまったく同じ属性を持ちます。
対照的に、文字列やバッファの一部ではない孤立した引数として
指定された文字群は、周りのテキストからテキスト属性を継承します。
<P>

挿入関数は、文字列由来やバッファ由来のテキストの場合には、
マルチバイトバッファへ挿入するために
ユニバイトからマルチバイトへテキストを変換し、逆向きの変換も行います。
しかし、カレントバッファがたとえマルチバイトバッファであっても、
128から255のユニバイト文字コードはマルチバイト文字には変換しません。
See 節 <A HREF="elisp_33.html#SEC530">32.2 テキスト表現の変換</A>。
<P>

<A NAME="IDX2180"></A>
<DL>
<DT><U>Function:</U> <B>insert</B> <I>&#38;rest args</I>
<DD>この関数は、文字列や文字群<VAR>args</VAR>をカレントバッファのポイント位置に挿入し、
ポイントを先へ進める。
いいかえれば、ポイントのまえにテキストを挿入する。
<VAR>args</VAR>が文字列でも文字でもないと、エラーを通知する。
値は<CODE>nil</CODE>である。
</DL>
<P>

<A NAME="IDX2181"></A>
<DL>
<DT><U>Function:</U> <B>insert-before-markers</B> <I>&#38;rest args</I>
<DD>この関数は、文字列や文字群<VAR>args</VAR>をカレントバッファのポイント位置に挿入し、
ポイントを先へ進める。
<VAR>args</VAR>が文字列でも文字でもないと、エラーを通知する。
値は<CODE>nil</CODE>である。
<P>

挿入箇所を指していたマーカを挿入されたテキストのうしろを指すように再配置
する点で、この関数は他の挿入関数と異なる。
挿入箇所でオーバレイが始まるときには、
挿入されたテキストはオーバレイの範囲外に出る。
空でないオーバレイが挿入箇所で終るときには、
挿入されたテキストはオーバレイの範囲内に入る。
</DL>
<P>

<A NAME="IDX2182"></A>
<DL>
<DT><U>Function:</U> <B>insert-char</B> <I>character &#38;optional count inherit</I>
<DD>この関数は、カレントバッファのポイントのまえに
文字<VAR>character</VAR>を<VAR>count</VAR>個挿入する。
引数<VAR>count</VAR>は数（<CODE>nil</CODE>は1を意味する）であり、
<VAR>character</VAR>は文字であること。
値は<CODE>nil</CODE>である。
<P>

この関数は、カレントバッファがたとえマルチバイトバッファであっても、
128から255のユニバイト文字コードはマルチバイト文字には変換しない。
see 節 <A HREF="elisp_33.html#SEC530">32.2 テキスト表現の変換</A>。
<P>

<VAR>inherit</VAR>が<CODE>nil</CODE>以外であると、挿入された文字は、
挿入箇所の前後の2つの文字からスティッキテキスト属性を継承する。
</DL>
<P>

<A NAME="IDX2183"></A>
<DL>
<DT><U>Function:</U> <B>insert-buffer-substring</B> <I>from-buffer-or-name &#38;optional start end</I>
<DD>この関数は、バッファ<VAR>from-buffer-or-name</VAR>（既存であること）の部分を
カレントバッファのポイントのまえへ挿入する。
挿入されるテキストは<VAR>start</VAR>から<VAR>end</VAR>までの領域である。
（これらの引数のデフォルトは、当該バッファの参照可能部分の先頭と末尾である。）
この関数は<CODE>nil</CODE>を返す。
<P>

この例では、バッファ`<SAMP>bar</SAMP>'をカレントバッファとしてフォームを実行する。
バッファ`<SAMP>bar</SAMP>'は最初は空であると仮定する。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
We hold these truths to be self-evident, that all
---------- Buffer: foo ----------

(insert-buffer-substring "foo" 1 20)
     => nil

---------- Buffer: bar ----------
We hold these truth-!-
---------- Buffer: bar ----------
</pre></td></tr></table></DL>
<P>

挿入に加えて周りのテキストからテキスト属性を継承する他の関数については、
See 節 <A HREF="elisp_32.html#SEC519">31.19.6 テキスト属性のスティッキ性</A>。
字下げ関数が挿入した白文字もテキスト属性を継承します。
<P>

<A NAME="Commands for Insertion"></A>
<HR SIZE="6">
<br><A NAME="SEC488"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC487"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC489"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Commands for Insertion"></A>
<H2> 31.5 ユーザーレベルの挿入コマンド </H2>
<!--docid::SEC488::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Commands%20for%20Insertion">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Commands%20for%20Insertion</a>"<br>
"texi/elisp21/ユーザーレベルの挿入コマンド"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%E6%A1%BC%A5%B6%A1%BC%A5%EC%A5%D9%A5%EB%A4%CE%C1%DE%C6%FE%A5%B3%A5%DE%A5%F3%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節では、テキストを挿入する上位レベルのコマンドについて述べます。
これらはLispプログラムでも有用ですが主にユーザー向けのコマンドです。
<P>

<A NAME="IDX2184"></A>
<DL>
<DT><U>コマンド:</U> <B>insert-buffer</B> <I>from-buffer-or-name</I>
<DD>このコマンドは、<VAR>from-buffer-or-name</VAR>（既存であること）の全内容を
カレントバッファのポイントのうしろに挿入する。
挿入されたテキストのうしろにマークを置く。
値は<CODE>nil</CODE>である。
</DL>
<P>

<A NAME="IDX2185"></A>
<DL>
<DT><U>コマンド:</U> <B>self-insert-command</B> <I>count</I>
<DD><A NAME="IDX2186"></A>
<A NAME="IDX2187"></A>
このコマンドは、最後に打たれた文字を挿入する。
ポイントのまえに<VAR>count</VAR>回挿入して<CODE>nil</CODE>を返す。
ほとんどの印字文字はこのコマンドにバインドされている。
普通の状況では、<CODE>self-insert-command</CODE>は
Emacsにおいてもっとも頻繁に呼び出される関数であるが、
プログラムではキーマップに登録する以外にはほとんど使わない。
<P>

対話的に呼ばれると、<VAR>count</VAR>は数値前置引数である。
<P>

このコマンドは、挿入した文字が空白や改行であると、
<CODE>auto-fill-function</CODE>が<CODE>nil</CODE>以外であると
<CODE>auto-fill-function</CODE>を呼び出す
（see 節 <A HREF="elisp_32.html#SEC502">31.14 自動詰め込み（auto-filling）モード</A>）。
<P>

このコマンドは、略語（abbrev）モードがオンであり、かつ、
挿入した文字が単語構成構文でないと、略語展開を行う。
（<A HREF="elisp_36.html#SEC576">35. 略語と略語の展開 <EM>(2003/10/30)</EM></A>とsee 節 <A HREF="elisp_35.html#SEC567">34.2.1 構文クラス一覧</A>。）
<P>

挿入した文字が閉じ括弧構文であるときに
<CODE>blink-paren-function</CODE>を呼び出す責任も持つ
（see 節 <A HREF="elisp_38.html#SEC616">37.11 括弧を点滅する</A>）。
</DL>
<P>

<A NAME="IDX2188"></A>
<DL>
<DT><U>コマンド:</U> <B>newline</B> <I>&#38;optional number-of-newlines</I>
<DD>このコマンドは、カレントバッファのポイントのまえに改行を挿入する。
<VAR>number-of-newlines</VAR>を指定すると、その個数だけ改行文字を挿入する。
<P>

<A NAME="IDX2189"></A>
この関数は、現在のコラム番号が<CODE>fill-column</CODE>の値よりも大きく
<VAR>number-of-newlines</VAR>が<CODE>nil</CODE>であると
<CODE>auto-fill-function</CODE>を呼び出す。
<CODE>auto-fill-function</CODE>の典型的な仕事は改行を挿入することである。
ここでの全体としての効果は、改行を2つの異なる位置、つまり、
ポイント位置と行のまえの箇所に挿入することである。
<CODE>newline</CODE>は、<VAR>number-of-newlines</VAR>が<CODE>nil</CODE>以外であると
自動詰め込みを行わない。
<P>

このコマンドは、左端の余白が0以外であるとその分だけ字下げする。
see 節 <A HREF="elisp_32.html#SEC500">31.12 詰め込みのための余白</A>。
<P>

戻り値は<CODE>nil</CODE>である。
対話的に呼ばれると、<VAR>count</VAR>は数値前置引数である。
</DL>
<P>

<A NAME="IDX2190"></A>
<DL>
<DT><U>コマンド:</U> <B>split-line</B>
<DD>このコマンドは、行のポイントのうしろの部分を垂直に降ろして
変更前の真下に行を移動することで現在行を分割する。
関数<CODE>indent-to</CODE>を用いて、降ろした行の先頭に必要に応じて白文字を挿入する。
<P>

プログラムではまったくこの関数を使わない。
</DL>
<P>

<A NAME="IDX2191"></A>
<DL>
<DT><U>Variable:</U> <B>overwrite-mode</B>
<DD>この変数は、上書き（overwrite）モードがオンかどうかを制御する。
この値は、<CODE>overwrite-mode-textual</CODE>、<CODE>overwrite-mode-binary</CODE>、
<CODE>nil</CODE>のいずれかであること。
<CODE>overwrite-mode-textual</CODE>は、テキストの上書きモード
（改行とタブを特別に扱う）を指定し、
<CODE>overwrite-mode-binary</CODE>は、バイナリの上書きモード
（改行やタブも他の文字と同様に扱う）を指定する。
</DL>
<P>

<A NAME="Deletion"></A>
<HR SIZE="6">
<br><A NAME="SEC489"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC488"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC490"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Deletion"></A>
<H2> 31.6 テキストの削除 </H2>
<!--docid::SEC489::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Deletion">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Deletion</a>"<br>
"texi/elisp21/テキストの削除"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%A4%CE%BA%EF%BD%FC">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX2192"></A>
削除とは、バッファ内のテキストのある部分をキルリング
（see 節 <A HREF="elisp_32.html#SEC491">31.8 キルリング</A>）に保存せずに取りさることです。
削除したテキストはヤンクはできませんが、
アンドゥ機構（see 節 <A HREF="elisp_32.html#SEC497">31.9 アンドゥ</A>）を使って再度挿入できます。
特別な場合にはキルリングにテキストを保存する削除関数もあります。
<P>

すべての削除関数はカレントバッファに作用し、<CODE>nil</CODE>の値を返します。
<P>

<A NAME="IDX2193"></A>
<DL>
<DT><U>コマンド:</U> <B>erase-buffer</B>
<DD>この関数は、カレントバッファから全テキストを削除して空にする。
バッファが読み出し専用であると、エラー<CODE>buffer-read-only</CODE>を通知する。
さもなければ、いっさい確認を取らずにテキストを削除する。
<CODE>nil</CODE>を返す。
<P>

バッファから多量のテキストを削除すると、通常、
『バッファが縮小した』としてそのバッファの自動保存を禁止する。
しかし、<CODE>erase-buffer</CODE>はこうしない。
これまでのテキストと将来のテキストには関連がなく、
これまでのテキストのサイズと比較すべきでないと考えるからである。
</DL>
<P>

<A NAME="IDX2194"></A>
<DL>
<DT><U>コマンド:</U> <B>delete-region</B> <I>start end</I>
<DD>このコマンドは、<VAR>start</VAR>と<VAR>end</VAR>で定義されるカレントバッファの
テキストを削除する。
戻り値は<CODE>nil</CODE>である。
削除された領域の内側にポイントがあると、
その値は削除後には<VAR>start</VAR>になる。
さもなければ、マーカと同様にポイントは
周りのテキストに留まるように再配置される。
</DL>
<P>

<A NAME="IDX2195"></A>
<DL>
<DT><U>コマンド:</U> <B>delete-char</B> <I>count &#38;optional killp</I>
<DD>このコマンドは、ポイントの直後の、あるいは、
<VAR>count</VAR>が負であるとポイントの直前の<VAR>count</VAR>個の文字を削除する。
<VAR>killp</VAR>が<CODE>nil</CODE>以外であると、
削除した文字をキルリングに保存する。
<P>

対話的に呼ばれると、<VAR>count</VAR>は数値前置引数であり、
<VAR>killp</VAR>は未処理の前置引数である。
つまり、前置引数を指定すると、テキストをキルリングに保存する。
前置引数を指定しないと1文字だけを削除するが、
キルリングには保存しない。
<P>

戻り値はつねに<CODE>nil</CODE>である。
</DL>
<P>

<A NAME="IDX2196"></A>
<DL>
<DT><U>コマンド:</U> <B>delete-backward-char</B> <I>count &#38;optional killp</I>
<DD><A NAME="IDX2197"></A>
このコマンドは、ポイントの直前の、あるいは、
<VAR>count</VAR>が負であるとポイントの直後の<VAR>count</VAR>個の文字を削除する。
<VAR>killp</VAR>が<CODE>nil</CODE>以外であると、
削除した文字をキルリングに保存する。
<P>

対話的に呼ばれると、<VAR>count</VAR>は数値前置引数であり、
<VAR>killp</VAR>は未処理の前置引数である。
つまり、前置引数を指定すると、テキストをキルリングに保存する。
前置引数を指定しないと1文字だけを削除するが、
キルリングには保存しない。
<P>

戻り値はつねに<CODE>nil</CODE>である。
</DL>
<P>

<A NAME="IDX2198"></A>
<DL>
<DT><U>コマンド:</U> <B>backward-delete-char-untabify</B> <I>count &#38;optional killp</I>
<DD><A NAME="IDX2199"></A>
このコマンドは、タブを空白にかえながら後向きに<VAR>count</VAR>個の文字を削除する。
つぎに削除する文字がタブであると、まずタブを配置を保つだけの等価な個数の
空白に置換してから、タブのかわりにそれらの空白を削除する。
<VAR>killp</VAR>が<CODE>nil</CODE>以外であると、このコマンドは
削除した文字をキルリングに保存する。
<P>

<VAR>count</VAR>が正である場合に限って、タブを空白に変換する。
<VAR>count</VAR>が負であると、ポイントのうしろのちょうど
-<VAR>count</VAR>個の文字を削除する。
<P>

対話的に呼ばれると、<VAR>count</VAR>は数値前置引数であり、
<VAR>killp</VAR>は未処理の前置引数である。
つまり、前置引数を指定すると、テキストをキルリングに保存する。
前置引数を指定しないと1文字だけを削除するが、
キルリングには保存しない。
<P>

戻り値はつねに<CODE>nil</CODE>である。
</DL>
<P>

<A NAME="IDX2200"></A>
<DL>
<DT><U>User Option:</U> <B>backward-delete-char-untabify-method</B>
<DD><A NAME="IDX2201"></A>
このオプションは、<CODE>backward-delete-char-untabify</CODE>での
白文字の扱い方を指定する。
可能な値は、タブを空白に変換してから空白を削除することを意味する
デフォルトの<CODE>untabify</CODE>、
1回の呼び出しでポイントのまえにある白文字をすべて削除することを意味する
<CODE>hungry</CODE>、
白文字に対して特別なことをしないことを意味する<CODE>nil</CODE>である。
</DL>
<P>

<A NAME="User-Level Deletion"></A>
<HR SIZE="6">
<br><A NAME="SEC490"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC489"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC491"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="User-Level Deletion"></A>
<H2> 31.7 ユーザーレベルの削除コマンド </H2>
<!--docid::SEC490::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=User-Level%20Deletion">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=User-Level%20Deletion</a>"<br>
"texi/elisp21/ユーザーレベルの削除コマンド"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%E6%A1%BC%A5%B6%A1%BC%A5%EC%A5%D9%A5%EB%A4%CE%BA%EF%BD%FC%A5%B3%A5%DE%A5%F3%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節では、テキストを削除する上位レベルのコマンドについて述べます。
これらはLispプログラムでも有用ですが主にユーザー向けのコマンドです。
<P>

<A NAME="IDX2202"></A>
<DL>
<DT><U>コマンド:</U> <B>delete-horizontal-space</B>
<DD><A NAME="IDX2203"></A>
この関数は、ポイントの周りの空白やタブをすべて削除する。
<CODE>nil</CODE>を返す。
<P>

つぎの例では、毎回ポイントを2番目と3番目の文字のあいだに置いて、
各行につき1回ずつ<CODE>delete-horizontal-space</CODE>を計4回呼び出す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
I -!-thought
I -!-     thought
We-!- thought
Yo-!-u thought
---------- Buffer: foo ----------

(delete-horizontal-space)   ; Four times.
     => nil

---------- Buffer: foo ----------
Ithought
Ithought
Wethought
You thought
---------- Buffer: foo ----------
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2204"></A>
<DL>
<DT><U>コマンド:</U> <B>delete-indentation</B> <I>&#38;optional join-following-p</I>
<DD>この関数は、ポイントがある行をそのまえの行に連結する。
連結箇所の白文字は削除し、場合によっては空白1個に置き換える。
<VAR>join-following-p</VAR>が<CODE>nil</CODE>以外であると、
<CODE>delete-indentation</CODE>は、この行を後続の行に連結する。
関数は<CODE>nil</CODE>を返す。
<P>

詰め込み接頭辞があり、かつ、連結対象の2番目の行が
その接頭辞で始まっている場合には、
<CODE>delete-indentation</CODE>は連結するまえに詰め込み接頭辞を削除する。
see 節 <A HREF="elisp_32.html#SEC500">31.12 詰め込みのための余白</A>。
<P>

以下の例では、ポイントは`<SAMP>events</SAMP>'で始まる行にあり、
そのまえの行の行末に空白があっても違いはない。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>---------- Buffer: foo ----------
When in the course of human
-!-    events, it becomes necessary
---------- Buffer: foo ----------

(delete-indentation)
     => nil

---------- Buffer: foo ----------
When in the course of human-!- events, it becomes necessary
---------- Buffer: foo ----------
</FONT></pre></td></tr></table><P>

行を連結したあと、
関数<CODE>fixup-whitespace</CODE>には、
連結箇所に空白を置くかどうかを決定する責任がある。
</DL>
<P>

<A NAME="IDX2205"></A>
<DL>
<DT><U>Function:</U> <B>fixup-whitespace</B>
<DD>この関数は、文脈に応じて、
ポイントを囲む白文字すべてを1つの空白に置換するかまったくなくす。
<CODE>nil</CODE>を返す。
<P>

行の先頭や末尾では、空白の適切な量は0である。
閉じ括弧構文の文字のまえや、
開き括弧構文や式前置子構文の文字のうしろでも空白はないほうが適している。
それ以外では、空白1個が適している。
see 節 <A HREF="elisp_35.html#SEC567">34.2.1 構文クラス一覧</A>。
<P>

以下の例では、最初の行の単語`<SAMP>spaces</SAMP>'のまえにポイントがあるときに
最初に<CODE>fixup-whitespace</CODE>が呼ばれる。
2度目に呼ばれるときには、ポイントは`<SAMP>(</SAMP>'の直後にある。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>---------- Buffer: foo ----------
This has too many     -!-spaces
This has too many spaces at the start of (-!-   this list)
---------- Buffer: foo ----------

(fixup-whitespace)
     => nil
(fixup-whitespace)
     => nil

---------- Buffer: foo ----------
This has too many spaces
This has too many spaces at the start of (this list)
---------- Buffer: foo ----------
</FONT></pre></td></tr></table></DL>
<P>

<A NAME="IDX2206"></A>
<DL>
<DT><U>コマンド:</U> <B>just-one-space</B>
<DD>このコマンドは、ポイントの周りのすべての空白やタブを1個の空白に置き換える。
<CODE>nil</CODE>を返す。
</DL>
<P>

<A NAME="IDX2207"></A>
<DL>
<DT><U>コマンド:</U> <B>delete-blank-lines</B>
<DD>この関数は、ポイントを囲む空行を削除する。
前後に複数の空行がある空行にポイントがある場合、
1つの空行を残してそれ以外はすべて削除する。
孤立した1つの空行にポイントがある場合には、その行を削除する。
空行でない行にポイントがある場合には、
その行のうしろにある空行をすべて削除する。
<P>

空行とは、タブや空白のみから成る行と定義する。
<P>

<CODE>delete-blank-lines</CODE>は<CODE>nil</CODE>を返す。
</DL>
<P>

<A NAME="The Kill Ring"></A>
<HR SIZE="6">
<br><A NAME="SEC491"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC490"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC492"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="The Kill Ring"></A>
<H2> 31.8 キルリング </H2>
<!--docid::SEC491::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=The%20Kill%20Ring">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=The%20Kill%20Ring</a>"<br>
"texi/elisp21/キルリング"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AD%A5%EB%A5%EA%A5%F3%A5%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2208"></A>
<P>

<EM>キル関数</EM>は削除関数のようにテキストを削除しますが、
ユーザーが<EM>ヤンク</EM>（yank）で再度挿入できるように保存します。
これらの関数の多くは、その名前に`<SAMP>kill-</SAMP>'があります。
対照的に、`<SAMP>delete-</SAMP>'で始まる名前の関数は、
ヤンクできるようにテキストを保存しません（アンドゥはできる）。
それらは『削除』関数です。
<P>

キルコマンドの多くは主に対話的に使うものであり、
ここではそれらについては述べません。
ここで述べるのは、そのようなコマンドを書くために使う関数についてです。
これらの関数は読者がテキストをキルするコマンドを書くために使えます。
Lisp関数において内部目的のためにテキストを削除する必要があるときには、
キルリングの内容を乱さないように普通は削除関数を用いるべきです。
See 節 <A HREF="elisp_32.html#SEC489">31.6 テキストの削除</A>。
<P>

キルしたテキストはあとでヤンクできるように
<EM>キルリング</EM>（kill ring）に保存されます。
これは、最後にキルしたテキストだけでなく、
最近キルしたものを多数保持するリストです。
これを『リング』と呼ぶのは、
要素が循環しているようにヤンクが扱うからです。
このリストは変数<CODE>kill-ring</CODE>に保持されていて、
リスト向けの通常の関数で操作できますが、
本節で述べるように、それをリングとして扱う特別な関数もあります。
<P>

単語『キル』の使い方が不適当だと考える人々がいます。
『キル』したものを特に破壊<EM>しない</EM>操作を表すために使っているからです。
日常生活に照らしてみると、死は恒久的であり『キル』したものが
生き返ることはありません。
したがって、別の隠喩も提案されています。
たとえば、原稿を鋏で切り貼りすることに慣れていた前計算機世代の人々には
『カットリング』のほうが意味が通じるでしょう。
しかし、いまさら用語を変更するのは困難です。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC492">31.8.1 キルリングの概念</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">What text looks like in the kill ring.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC493">31.8.2 キル向けの関数</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Functions that kill text.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC494">31.8.3 ヤンク向けの関数</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Commands that access the kill ring.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC495">31.8.4 下位レベルのキルリング</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Functions and variables for kill ring access.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC496">31.8.5 キルリングの内部</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Variables that hold kill-ring data.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Kill Ring Concepts"></A>
<HR SIZE="6">
<br><A NAME="SEC492"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC491"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC493"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Kill Ring Concepts"></A>
<H3> 31.8.1 キルリングの概念 </H3>
<!--docid::SEC492::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Kill%20Ring%20Concepts">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Kill%20Ring%20Concepts</a>"<br>
"texi/elisp21/キルリングの概念"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AD%A5%EB%A5%EA%A5%F3%A5%B0%A4%CE%B3%B5%C7%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

キルリングは、もっとも最近にキルされたものを先頭にして、
キルされたテキストを文字列としてリストに記録します。
たとえば、短いキルリングはつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>("some text" "a different piece of text" "even older text")
</pre></td></tr></table><P>

リストの長さが<CODE>kill-ring-max</CODE>に達すると、
新たな項目を追加すると自動的に最後の項目を削除します。
<P>

キルコマンドが他のコマンドと混在する場合、
各キルコマンドはキルリングに新たな項目を追加します。
連続した複数のキルコマンドは、キルリングに1つの項目を作りあげ、
それを1個としてヤンクできます。
2番目以降の連続したキルコマンドは、最初のキルコマンドが作った
項目にテキストを追加していきます。
<P>

ヤンクでは、キルリングの1つの項目をリングの『先頭』として区別します。
リングの別の項目を『先頭』と指定することでリングを『回転』する
コマンドもあります。
<P>

<A NAME="Kill Functions"></A>
<HR SIZE="6">
<br><A NAME="SEC493"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC492"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC494"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Kill Functions"></A>
<H3> 31.8.2 キル向けの関数 </H3>
<!--docid::SEC493::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Kill%20Functions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Kill%20Functions</a>"<br>
"texi/elisp21/キル向けの関数"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AD%A5%EB%B8%FE%A4%B1%A4%CE%B4%D8%BF%F4">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<CODE>kill-region</CODE>は、テキストをキルするための普通のサブルーティンです。
この関数を呼び出す任意のコマンドは『キルコマンド』です
（その名前には`<SAMP>kill</SAMP>'があるはず）。
<CODE>kill-region</CODE>は、新たにキルされたテキストを
キルリングの先頭に新たな項目として追加したり、
もっとも最近の項目に加えます。
まえのコマンドがキルコマンドであるかどうかを
（<CODE>last-command</CODE>を使って）自動的に判定し、
もしそうならば、キルされたテキストをもっとも最近の項目に加えます。
<P>

<A NAME="IDX2209"></A>
<DL>
<DT><U>コマンド:</U> <B>kill-region</B> <I>start end</I>
<DD>この関数は、<VAR>start</VAR>と<VAR>end</VAR>で定義される領域のテキストをキルする。
テキストは削除されるが、テキスト属性とともにキルリングに保存される。
値はつねに<CODE>nil</CODE>である。
<P>

対話的に呼ばれると、<VAR>start</VAR>と<VAR>end</VAR>はポイントとマークである。
<P>

バッファが読み出し専用であると、
<CODE>kill-region</CODE>はキルリングを同様に変更するが、
バッファを変更せずにエラーを通知する。
読み出し専用バッファからキルリングへテキストをコピーするために、
ユーザーはすべてのキルコマンドを使えるのでこれは便利である。
</DL>
<P>

<A NAME="IDX2210"></A>
<DL>
<DT><U>User Option:</U> <B>kill-read-only-ok</B>
<DD>このオプションが<CODE>nil</CODE>以外であると、
<CODE>kill-region</CODE>は、バッファが読み出し専用であってもエラーとしない。
そのかわりに、キルリングを更新しバッファは変更せずに戻る。
</DL>
<P>

<A NAME="IDX2211"></A>
<DL>
<DT><U>コマンド:</U> <B>copy-region-as-kill</B> <I>start end</I>
<DD>このコマンドは、<VAR>start</VAR>と<VAR>end</VAR>で定義される領域を
（テキスト属性とともに）キルリングに保存するが、
バッファからテキストを削除しない。
<CODE>nil</CODE>を返す。
また、カーソルを一時的に移動してコピーしたテキストの範囲を示すか、
あるいは、エコー領域にメッセージを表示する。
<P>

このコマンドは<CODE>this-command</CODE>に<CODE>kill-region</CODE>を設定しないので、
これ以降のキルコマンドはキルリングの同じ項目には加えない。
<P>

Emacs 18版でも使うつもりがない限り、
Lispプログラムからは<CODE>copy-region-as-kill</CODE>を呼ばないこと。
Emacsの新しい版では、そのかわりに<CODE>kill-new</CODE>や<CODE>kill-append</CODE>を
使うほうがよい。
see 節 <A HREF="elisp_32.html#SEC495">31.8.4 下位レベルのキルリング</A>。
</DL>
<P>

<A NAME="Yank Commands"></A>
<HR SIZE="6">
<br><A NAME="SEC494"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC493"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC495"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Yank Commands"></A>
<H3> 31.8.3 ヤンク向けの関数 </H3>
<!--docid::SEC494::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Yank%20Commands">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Yank%20Commands</a>"<br>
"texi/elisp21/ヤンク向けの関数"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%E4%A5%F3%A5%AF%B8%FE%A4%B1%A4%CE%B4%D8%BF%F4">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<EM>ヤンク</EM>（yank）とは、キルリングからまえにキルされたテキストの項目を
再度挿入することです。
<P>

<A NAME="IDX2212"></A>
<DL>
<DT><U>コマンド:</U> <B>yank</B> <I>&#38;optional arg</I>
<DD><A NAME="IDX2213"></A>
このコマンドは、キルリングの先頭項目のテキストを
ポイントのまえに挿入する。
そのテキストの先頭にマークを末尾にポイントを置く。
<P>

<VAR>arg</VAR>がリスト（対話的な呼び出しではユーザーが数字文字なしに
<KBD>C-u</KBD>を打ったとき）であると、<CODE>yank</CODE>は上に述べたように
テキストを挿入するが、ヤンクしたテキストの先頭にポイントを
末尾にマークを置く。
<P>

<VAR>arg</VAR>が数であると、<CODE>yank</CODE>は<VAR>arg</VAR>番目のもっとも最近に
キルされたテキスト、つまり、キルリングリストの<VAR>arg</VAR>番目の項目を
挿入する。
<P>

<CODE>yank</CODE>はキルリングの内容を変更したり回転しない。
<CODE>nil</CODE>を返す。
</DL>
<P>

<A NAME="IDX2214"></A>
<DL>
<DT><U>コマンド:</U> <B>yank-pop</B> <I>arg</I>
<DD>このコマンドは、キルリングからヤンクした項目を
キルリングの別の項目で置き換える。
<P>

これは<CODE>yank</CODE>や別の<CODE>yank-pop</CODE>の直後でのみ許される。
そのような場合、リージョンにはヤンクしたばかりのテキストが含まれる。
<CODE>yank-pop</CODE>はそのテキストを削除し、
その位置にキルされた別のテキストを挿入する。
削除したテキストはすでにキルリングのどこかにあるので、
キルリングには追加しない。
<P>

<VAR>arg</VAR>が<CODE>nil</CODE>であると、キルリングの古い項目で置き換える。
<VAR>arg</VAR>が数であると、<VAR>arg</VAR>番古いキルで置き換える。
<VAR>arg</VAR>が負であると、より最近のキルで置き換える。
<P>

キルリング内でのキルの順番は、
最古のもののつぎに最新のものがあり、
最新のもののまえに最古のものがあるように折り返されている。
<P>

戻り値はつねに<CODE>nil</CODE>である。
</DL>
<P>

<A NAME="Low-Level Kill Ring"></A>
<HR SIZE="6">
<br><A NAME="SEC495"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC494"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC496"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Low-Level Kill Ring"></A>
<H3> 31.8.4 下位レベルのキルリング </H3>
<!--docid::SEC495::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Low-Level%20Kill%20Ring">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Low-Level%20Kill%20Ring</a>"<br>
"texi/elisp21/下位レベルのキルリング"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B2%BC%B0%CC%A5%EC%A5%D9%A5%EB%A4%CE%A5%AD%A5%EB%A5%EA%A5%F3%A5%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

これらの関数と変数は、下位レベルでキルリングを参照するためのものですが、
Lispプログラムで使っても便利です。
これらはウィンドウシステムのセレクション（see 節 <A HREF="elisp_29.html#SEC456">28.18 ウィンドウシステムのセレクション</A>）
との相互作用の面倒をみてくれるからです。
<P>

<A NAME="IDX2215"></A>
<DL>
<DT><U>Function:</U> <B>current-kill</B> <I>n &#38;optional do-not-move</I>
<DD>関数<CODE>current-kill</CODE>は、キルリングの『先頭』として区別する
ヤンクポインタを（新しいキルから古いキルへ向けて）<VAR>n</VAR>個分回転し、
リングのその位置のテキストを返す。
<P>

省略可能な第2引数<VAR>do-not-move</VAR>が<CODE>nil</CODE>以外であると、
<CODE>current-kill</CODE>は、ヤンクポインタは変更せずに、
現在のヤンクポインタから数えて<VAR>n</VAR>番目のキルを返す。
<P>

<VAR>n</VAR>が0であると、もっとも最近のキルを要求することを表し、
<CODE>current-kill</CODE>は、キルリングを調べるまえに
（以下に述べる）<CODE>interprogram-paste-function</CODE>の値を呼び出す。
</DL>
<P>

<A NAME="IDX2216"></A>
<DL>
<DT><U>Function:</U> <B>kill-new</B> <I>string</I>
<DD>この関数は、テキスト<VAR>string</VAR>を新たな項目として
キルリングの先頭に置く。
必要ならば最古の項目を破棄する。
<CODE>interprogram-cut-function</CODE>（下記参照）の値も起動する。
</DL>
<P>

<A NAME="IDX2217"></A>
<DL>
<DT><U>Function:</U> <B>kill-append</B> <I>string before-p</I>
<DD>この関数は、キルリングの先頭項目にテキスト<VAR>string</VAR>を追加する。
通常、<VAR>string</VAR>はその項目の末尾に加わるが、
<VAR>before-p</VAR>が<CODE>nil</CODE>以外であるとその項目の先頭に加わる。
この関数は、<CODE>interprogram-cut-function</CODE>（下記参照）の値も起動する。
</DL>
<P>

<A NAME="IDX2218"></A>
<DL>
<DT><U>Variable:</U> <B>interprogram-paste-function</B>
<DD>この変数は、ウィンドウシステムを使っているときに
別のプログラムからキルされたテキストを転送する方法を提供する。
その値は、<CODE>nil</CODE>であるか、引数なしの関数であること。
<P>

値が関数であると、
『もっとも最近のキル』を得るために<CODE>current-kill</CODE>が呼び出す。
関数が<CODE>nil</CODE>以外の値を返すと、
その値は『もっとも最近のキル』として使われる。
<CODE>nil</CODE>を返せば、<CODE>kill-ring</CODE>の先頭項目が使われる。
<P>

このフックの普通の用途は、
セレクションが別のアプリケーションに属する場合であっても、
ウィンドウシステムの一次セレクションを
もっとも最近のキルとして得ることである。
see 節 <A HREF="elisp_29.html#SEC456">28.18 ウィンドウシステムのセレクション</A>。
</DL>
<P>

<A NAME="IDX2219"></A>
<DL>
<DT><U>Variable:</U> <B>interprogram-cut-function</B>
<DD>この変数は、ウィンドウシステムを使っているときに
キルされたテキストを別のプログラムへ転送する方法を提供する。
その値は、<CODE>nil</CODE>であるか、引数なしの関数であること。
<P>

値が関数であると、<CODE>kill-new</CODE>と<CODE>kill-append</CODE>が
キルリングの新たな先頭項目を引数として呼び出す。
<P>

このフックの普通の用途は、
新たにキルされたテキストを
ウィンドウシステムの一次セレクションにすることである。
see 節 <A HREF="elisp_29.html#SEC456">28.18 ウィンドウシステムのセレクション</A>。
</DL>
<P>

<A NAME="Internals of Kill Ring"></A>
<HR SIZE="6">
<br><A NAME="SEC496"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC495"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC497"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Internals of Kill Ring"></A>
<H3> 31.8.5 キルリングの内部 </H3>
<!--docid::SEC496::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Internals%20of%20Kill%20Ring">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Internals%20of%20Kill%20Ring</a>"<br>
"texi/elisp21/キルリングの内部"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AD%A5%EB%A5%EA%A5%F3%A5%B0%A4%CE%C6%E2%C9%F4">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

変数<CODE>kill-ring</CODE>は、文字列のリストの形でキルリングの内容を保持します。
もっとも最近のキルがつねにリストの先頭にあります。
<P>

変数<CODE>kill-ring-yank-pointer</CODE>は、
CARがつぎにヤンクすべきテキストであるような
キルリングリストの項目を指しています。
この変数がリングの『先頭』を識別するといいます。
<CODE>kill-ring-yank-pointer</CODE>を別の項目へ動かすことを
<EM>キルリングを回転する</EM>と呼びます。
ヤンクポインタを動かす関数は、
リストの末尾からリストの先頭へ折り返しその逆も行うので、
キルリングを『リング』と呼ぶのです。
リングの回転は仮想的なものであり、
<CODE>kill-ring</CODE>の値は変更しません。
<P>

<CODE>kill-ring</CODE>も<CODE>kill-ring-yank-pointer</CODE>もLisp変数であり、
それらの値は普通のリストです。
<CODE>kill-ring-yank-pointer</CODE>の名前の単語『ポインタ』は、
つぎのヤンクコマンドで使うリストの項目を識別することが
変数の目的であることを表します。
<P>

<CODE>kill-ring-yank-pointer</CODE>の値は、キルリングリストの
1つの項目とつねに<CODE>eq</CODE>です。
これが識別する項目は、その項目のCARです。
キルリングを変更するキルコマンドも、
<CODE>kill-ring</CODE>の値をこの変数の値とします。
その効果は、新たにキルされたテキストが先頭にくるように
リングを回転することです。
<P>

キルリング<CODE>("some text" "a different piece of text" "yet older text")</CODE>の
第2項目を変数<CODE>kill-ring-yank-pointer</CODE>が指しているようすをつぎに示します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>kill-ring                  ---- kill-ring-yank-pointer
  |                       |
  |                       v
  |     --- ---          --- ---      --- ---
   --&#62; |   |   |------&#62; |   |   |--&#62; |   |   |--&#62; nil
        --- ---          --- ---      --- ---
         |                |            |            
         |                |            |            
         |                |             --&#62;"yet older text" 
         |                |
         |                 --&#62; "a different piece of text" 
         |
          --&#62; "some text"
</pre></td></tr></table><P>

<KBD>C-y</KBD>（<CODE>yank</CODE>）の直後に<KBD>M-y</KBD>（<CODE>yank-pop</CODE>）を使うと
この状態になります。
<P>

<A NAME="IDX2220"></A>
<DL>
<DT><U>Variable:</U> <B>kill-ring</B>
<DD>この変数は、もっとも最近にキルされたものを最初にして
キルされたテキストを順に並べたリストを保持する。
</DL>
<P>

<A NAME="IDX2221"></A>
<DL>
<DT><U>Variable:</U> <B>kill-ring-yank-pointer</B>
<DD>この変数の値は、キルリングのどの要素が
ヤンクするためのリングの『先頭』であるかを表す。
より正確には、その値は<CODE>kill-ring</CODE>のリストの一部であり、
そのCARは<KBD>C-y</KBD>がヤンクするキルされた文字列である。
</DL>
<P>

<A NAME="IDX2222"></A>
<DL>
<DT><U>User Option:</U> <B>kill-ring-max</B>
<DD>この変数の値は、末尾の要素が破棄されるまでに
キルリングが増大できる最大の長さである。
<CODE>kill-ring-max</CODE>のデフォルト値は30である。
</DL>
<P>

<A NAME="Undo"></A>
<HR SIZE="6">
<br><A NAME="SEC497"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC496"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC498"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Undo"></A>
<H2> 31.9 アンドゥ </H2>
<!--docid::SEC497::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Undo">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Undo</a>"<br>
"texi/elisp21/アンドゥ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%A2%A5%F3%A5%C9%A5%A5">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2223"></A>
<P>

ほとんどのバッファには、バッファのテキストに対する変更をアンドゥ（もとに戻す）
できるようにすべての変更を記録する
<EM>アンドゥリスト</EM>（undo list）があります。
（アンドゥリストのないバッファは、
Emacsがアンドゥは有用ではないと仮定する特殊目的のバッファである。）
バッファのテキストを変更するすべての基本関数は、
変数<CODE>buffer-undo-list</CODE>に収めたアンドゥリストの先頭に
自動的に要素を追加します。
<P>

<A NAME="IDX2224"></A>
<DL>
<DT><U>Variable:</U> <B>buffer-undo-list</B>
<DD>この変数の値は、カレントバッファのアンドゥリストである。
値<CODE>t</CODE>はアンドゥ情報の記録を禁止する。
</DL>
<P>

アンドゥリストの要素として可能なものをつぎに示します。
<P>

<DL COMPACT>
<DT><CODE><VAR>position</VAR></CODE>
<DD>この種の要素は、まえのポイント値を記録する。
この要素をアンドゥするとポイントを<VAR>position</VAR>へ移動する。
通常のカーソル移動では、いかなる種類のアンドゥ記録も作らないが、
削除操作ではコマンド実行前のポイント位置を記録するためにこの項目を作る。
<P>

<DT><CODE>(<VAR>beg</VAR> . <VAR>end</VAR>)</CODE>
<DD>この種の要素は、挿入されたテキストを削除する方法を表す。
挿入されたテキストはバッファの<VAR>beg</VAR>から<VAR>end</VAR>までの範囲を占める。
<P>

<DT><CODE>(<VAR>text</VAR> . <VAR>position</VAR>)</CODE>
<DD>この種の要素は、削除されたテキストを再度挿入する方法を表す。
削除されたテキストそのものは文字列<VAR>text</VAR>である。
再度挿入する位置は<CODE>(abs <VAR>position</VAR>)</CODE>である。
<P>

<DT><CODE>(t <VAR>high</VAR> . <VAR>low</VAR>)</CODE>
<DD>この種の要素は、未変更のバッファが変更されたことを表す。
<VAR>high</VAR>と<VAR>low</VAR>は2つの整数であり、それぞれ、
まえに訪問したときや保存したときの訪問しているファイルの更新時刻の
16ビットを記録している。
<CODE>primitive-undo</CODE>はこれらの値を用いて、
バッファを再度未変更と印を付けるかどうか判定する。
ファイルの更新時刻がこれに一致するときにのみ再度未変更とする。
<P>

<DT><CODE>(nil <VAR>property</VAR> <VAR>value</VAR> <VAR>beg</VAR> . <VAR>end</VAR>)</CODE>
<DD>この種の要素は、テキスト属性の変更を記録する。
変更をアンドゥするにはつぎのようにする。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(put-text-property <VAR>beg</VAR> <VAR>end</VAR> <VAR>property</VAR> <VAR>value</VAR>)
</pre></td></tr></table><P>

<DT><CODE>(<VAR>marker</VAR> . <VAR>adjustment</VAR>)</CODE>
<DD>この種の要素は、周りのテキストが削除されたために
マーカ<VAR>marker</VAR>を再配置し
<VAR>adjustment</VAR>文字分位置を移動したことを記録する。
この要素をアンドゥすると、
<VAR>marker</VAR> - <VAR>adjustment</VAR>文字に移動する。
<P>

<DT><CODE>nil</CODE>
<DD>この要素は境界である。
2つの境界のあいだの要素群を<EM>変更グループ</EM>（change group）と呼ぶ。
通常、各変更グループは1つのキーボードコマンドに対応し、
アンドゥコマンドはグループ全体を1個としてアンドゥする。
</DL>
<P>

<A NAME="IDX2225"></A>
<DL>
<DT><U>Function:</U> <B>undo-boundary</B>
<DD>この関数は、アンドゥリストに境界要素を置く。
アンドゥコマンドはそのような境界で停止し、
連続したアンドゥコマンドはよりまえの境界までアンドゥする。
この関数は<CODE>nil</CODE>を返す。
<P>

エディタコマンドループは、
各キー列を実行するまえにアンドゥの境界を自動的に作る。
したがって、各アンドゥは、1つのコマンドの効果を普通は取り消す。
自己挿入の入力文字は例外である。
コマンドループはそのような最初の文字に境界を作り、
つぎの19個の連続する自己挿入の入力文字では境界を作らず、
20番目で境界を作るということを自己挿入の入力文字が続く限り行う。
<P>

別のバッファでアンドゥ可能な変更を行うたびに
バッファのすべての変更で境界を追加する。
これは、各コマンドが変更した箇所で各バッファに境界を作ることを
保証するためである。
<P>

1つのコマンドの効果を複数に分けるためにこの関数を直接呼ぶことは有用である。
たとえば、<CODE>query-replace</CODE>は各置換のあとで<CODE>undo-boundary</CODE>を呼び出し、
ユーザーが個々の置換を1つ1つアンドゥできるようにする。
</DL>
<P>

<A NAME="IDX2226"></A>
<DL>
<DT><U>Function:</U> <B>primitive-undo</B> <I>count list</I>
<DD>これは、アンドゥリストの要素をアンドゥする基本的な関数である。
<VAR>list</VAR>の先頭の<VAR>count</VAR>個の要素をアンドゥし、<VAR>list</VAR>の残りを返す。
この関数をLispで書くこともできるが、Cで書いたほうが便利である。
<P>

<CODE>primitive-undo</CODE>は、バッファを変更すると
バッファのアンドゥリストに要素を追加する。
アンドゥコマンドは一連のアンドゥ操作を始めるときに
アンドゥリストを保存して混乱を避ける。
アンドゥ操作では、保存しておいた値を使い更新する。
アンドゥによって追加される新たな要素はこの保存された値の一部ではないので、
それらはアンドゥを続行しても干渉しない。
</DL>
<P>

<A NAME="Maintaining Undo"></A>
<HR SIZE="6">
<br><A NAME="SEC498"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC497"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC499"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Maintaining Undo"></A>
<H2> 31.10 アンドゥリストの管理 </H2>
<!--docid::SEC498::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Maintaining%20Undo">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Maintaining%20Undo</a>"<br>
"texi/elisp21/アンドゥリストの管理"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%A2%A5%F3%A5%C9%A5%A5%A5%EA%A5%B9%A5%C8%A4%CE%B4%C9%CD%FD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節では、指定されたバッファでアンドゥ情報の記録をオン／オフする
方法について述べます。
また、アンドゥリストが大きくなりすぎないように
自動的に切り詰める方法についても説明します。
<P>

新たに作成されたバッファのアンドゥ情報の記録は普通は始めオンですが、
バッファ名が空白で始まる場合は最初からオフです。
つぎの2つの関数を使うか、読者自身が<CODE>buffer-undo-list</CODE>に設定すれば、
アンドゥ記録を明示的にオン／オフできます。
<P>

<A NAME="IDX2227"></A>
<DL>
<DT><U>コマンド:</U> <B>buffer-enable-undo</B> <I>&#38;optional buffer-or-name</I>
<DD>このコマンドは、バッファ<VAR>buffer-or-name</VAR>でのアンドゥ記録をオンにし、
以降の変更を取り消せるようにする。
引数を指定しないと、カレントバッファを使う。
当該バッファでアンドゥ記録がすでにオンであると、
この関数はなにもしない。
<CODE>nil</CODE>を返す。
<P>

対話的に呼ばれると、<VAR>buffer-or-name</VAR>はカレントバッファである。
他のバッファを指定できない。
</DL>
<P>

<A NAME="IDX2228"></A>
<DL>
<DT><U>コマンド:</U> <B>buffer-disable-undo</B> <I>&#38;optional buffer</I>
<DD><A NAME="IDX2229"></A>
<DT><U>コマンド:</U> <B>buffer-flush-undo</B> <I>&#38;optional buffer</I>
<DD><A NAME="IDX2230"></A>
この関数はバッファ<VAR>buffer</VAR>のアンドゥリストを破棄し、
以降のアンドゥ情報の記録をオフにする。
その結果、これ以前の変更も以降の変更も取り消すことはできない。
<VAR>buffer</VAR>のアンドゥリストがすでにオフであると、
この関数にはなんの効果もない。
<P>

この関数は<CODE>nil</CODE>を返す。
<P>

名前<CODE>buffer-flush-undo</CODE>は廃れているとはみなさないが、
好ましい名前は<CODE>buffer-disable-undo</CODE>である。
</DL>
<P>

編集を続けるにしたがってアンドゥリストはどんどん長くなります。
これらがメモリを使い尽くさないように、
読者が設定した上限サイズにガベッジコレクションが切り詰めます。
（この目的においてアンドゥリストの『サイズ』は、
リストを構成するコンスセルの個数と削除された文字列の和である。）
2つの変数<CODE>undo-limit</CODE>と<CODE>undo-strong-limit</CODE>は、
許容できるサイズの範囲を制御します。
<P>

<A NAME="IDX2231"></A>
<DL>
<DT><U>Variable:</U> <B>undo-limit</B>
<DD>これはアンドゥリストの許容できるサイズの緩い制限である。
このサイズを越える位置にある変更グループは保持される最古のものである。
</DL>
<P>

<A NAME="IDX2232"></A>
<DL>
<DT><U>Variable:</U> <B>undo-strong-limit</B>
<DD>これはアンドゥリストの許容できるサイズの上限である。
このサイズを越える位置にある変更グループは
（これより古いものも含めて）削除される。
例外が1つあり、最新の変更グループは
それがどれほど大きくてもけっして破棄しない。
</DL>
<P>

<A NAME="Filling"></A>
<HR SIZE="6">
<br><A NAME="SEC499"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC498"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC500"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Filling"></A>
<H2> 31.11 詰め込み </H2>
<!--docid::SEC499::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Filling">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Filling</a>"<br>
"texi/elisp21/詰め込み"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B5%CD%A4%E1%B9%FE%A4%DF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2233"></A>
<P>

<EM>詰め込み</EM>（fill）とは、指定されている最大幅
（を越えず）にほぼ収まるように（行分け位置を移動して）
行の長さを調整することです。
さらに、行を<EM>幅揃え</EM>（justify）することもできます。
つまり、左右の両端や片側の余白をきちんと揃えるため
空白を挿入することです。
幅は変数<CODE>fill-column</CODE>で制御します。
読みやすいように、行は70コラム程度に収めるべきです。
<P>

テキストを挿入するにつれて自動的にテキストを詰め込むには、
自動詰め込み（auto-fill）モード（see 節 <A HREF="elisp_32.html#SEC502">31.14 自動詰め込み（auto-filling）モード</A>）を使いますが、
既存のテキストを変更しても正しくない詰め込み状態のまま放置されます。
したがって、そのようなテキストは明示的に詰め込む必要があります。
<P>

本節のほとんどの関数が返す値には意味はありません。
詰め込みを行うすべての関数は、現在の左端余白、現在の右端余白、
現在の幅揃えスタイルに注意をはらいます（see 節 <A HREF="elisp_32.html#SEC500">31.12 詰め込みのための余白</A>）。
現在の幅揃えスタイルが<CODE>none</CODE>であると、
詰め込み関数は実際にはなにもしません。
<P>

詰め込み関数には引数<VAR>justify</VAR>を取るものもあります。
それが<CODE>nil</CODE>以外であると、幅揃えの種類を指示します。
特定の幅揃えスタイルを指示するものは、
<CODE>left</CODE>、<CODE>right</CODE>、<CODE>full</CODE>、<CODE>center</CODE>です。
それが<CODE>t</CODE>であると、
テキストの当該部分には現在の幅揃えスタイルを用いることを意味します
（下記の<CODE>current-justification</CODE>を参照）。
これ以外の値は<CODE>full</CODE>として扱います。
<P>

対話的に詰め込み関数を呼ぶときに前置引数を使うと、
<VAR>justify</VAR>として値<CODE>full</CODE>を暗に指示します。
<P>

<A NAME="IDX2234"></A>
<DL>
<DT><U>コマンド:</U> <B>fill-paragraph</B> <I>justify</I>
<DD><A NAME="IDX2235"></A>
<A NAME="IDX2236"></A>
このコマンドは、ポイントがある段落、あるいは、ポイントのあとの段落を詰め込む。
<VAR>justify</VAR>が<CODE>nil</CODE>以外であると、各行の幅揃えも行う。
段落の境界を探すために普通の段落移動コマンドを用いる。
see <a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=emacs21&node=Paragraphs">GNU Emacs マニュアル</a>。
</DL>
<P>

<A NAME="IDX2237"></A>
<DL>
<DT><U>コマンド:</U> <B>fill-region</B> <I>start end &#38;optional justify nosqueeze to-eop</I>
<DD>このコマンドは、<VAR>start</VAR>から<VAR>end</VAR>の領域内の各段落を詰め込む。
<VAR>justify</VAR>が<CODE>nil</CODE>以外であれば、幅揃えも行う。
<P>

<VAR>nosqueeze</VAR>が<CODE>nil</CODE>以外であると、
行分け以外の白文字にはふれないことを意味する。
<VAR>to-eop</VAR>が<CODE>nil</CODE>以外であると、
段落の末尾まで、あるいは、
<CODE>use-hard-newlines</CODE>がオンならばつぎのハード改行（下記参照）までを
詰め込むことを意味する。
<P>

変数<CODE>paragraph-separate</CODE>は、段落の区別方法を制御する。
see 節 <A HREF="elisp_34.html#SEC563">33.8 編集に用いられる標準的な正規表現</A>。
</DL>
<P>

<A NAME="IDX2238"></A>
<DL>
<DT><U>コマンド:</U> <B>fill-individual-paragraphs</B> <I>start end &#38;optional justify mail-flag</I>
<DD>このコマンドは、領域内の各段落を各段落の詰め込み接頭辞に従って詰め込む。
したがって、段落の行が空白で字下げされていると、
詰め込んだあとの段落も同じように字下げされる。
<P>

最初の2つの引数<VAR>start</VAR>と<VAR>end</VAR>は、
詰め込むべき範囲の先頭と末尾である。
3番目と4番目の引数、<VAR>justify</VAR>と<VAR>mail-flag</VAR>は省略できる。
<VAR>justify</VAR>が<CODE>nil</CODE>以外であると、
段落の詰め込みに加えて幅揃えも行う。
<VAR>mail-flag</VAR>が<CODE>nil</CODE>以外であると、
メイルメッセージなのでヘッダ行を詰め込まないことを意味する。
<P>

通常、<CODE>fill-individual-paragraphs</CODE>は、
字下げが変わると新しい段落の開始とみなす。
<CODE>fill-individual-varying-indent</CODE>が<CODE>nil</CODE>以外であると、
区切り行のみが段落を区切るとみなす。
これは段落の先頭行と後続の行で字下げが異なる段落を処理できる。
</DL>
<P>

<A NAME="IDX2239"></A>
<DL>
<DT><U>User Option:</U> <B>fill-individual-varying-indent</B>
<DD>この変数は、上に述べたように
<CODE>fill-individual-paragraphs</CODE>の動作を変える。
</DL>
<P>

<A NAME="IDX2240"></A>
<DL>
<DT><U>コマンド:</U> <B>fill-region-as-paragraph</B> <I>start end &#38;optional justify nosqueeze squeeze-after</I>
<DD>このコマンドは、テキストの領域を1つの段落とみなして詰め込む。
領域に複数の段落があると、段落のあいだの空行は取りさる。
<VAR>justify</VAR>が<CODE>nil</CODE>以外であると幅揃えも行う。
<P>

対話的な呼び出しでは、前置引数で幅揃えを指示する。
<P>

<VAR>nosqueeze</VAR>が<CODE>nil</CODE>以外であると、
行分け以外の白文字にはふれないことを意味する。
<VAR>squeeze-after</VAR>が<CODE>nil</CODE>以外であると、
それは領域内の位置を表し、
その位置よりまえにある空白を変更しないように指示する。
<P>

適応型詰め込み（adaptive-fill）モードでは、
デフォルトの詰め込み接頭辞を選ぶために
このコマンドは<CODE>fill-context-prefix</CODE>を呼び出す。
see 節 <A HREF="elisp_32.html#SEC501">31.13 適応型詰め込み（adaptive-fill）モード</A>。
</DL>
<P>

<A NAME="IDX2241"></A>
<DL>
<DT><U>コマンド:</U> <B>justify-current-line</B> <I>how eop nosqueeze</I>
<DD>このコマンドは、現在行の単語のあいだに空白を挿入し、
ちょうど<CODE>fill-column</CODE>コラムで行が終るようにする。
<CODE>nil</CODE>を返す。
<P>

引数<VAR>how</VAR>が<CODE>nil</CODE>以外であると、
幅揃えスタイルを指定する。
可能な値は、<CODE>left</CODE>、<CODE>right</CODE>、<CODE>full</CODE>、
<CODE>center</CODE>、または、<CODE>none</CODE>である。
<CODE>t</CODE>であると、指定されている幅揃えスタイルに従うことを意味する
（下記の<CODE>current-justification</CODE>を参照）。
<CODE>nil</CODE>は、幅揃えしないことを意味する。
<P>

<VAR>eop</VAR>が<CODE>nil</CODE>以外であると、
<CODE>current-justification</CODE>が両端揃えを指定しているときには
左端揃えを行うことを意味する。
これは段落の最後の行に適用される。
段落全体として両端揃えであっても、最後の行はそうすべきではない。
<P>

<VAR>nosqueeze</VAR>が<CODE>nil</CODE>以外であると、
内側の白文字を変更しないことを意味する。
</DL>
<P>

<A NAME="IDX2242"></A>
<DL>
<DT><U>User Option:</U> <B>default-justification</B>
<DD>この変数の値は、テキスト属性で幅揃えスタイルを指定していない
テキストに対して用いる幅揃えスタイルを指定する。
可能な値は、<CODE>left</CODE>、<CODE>right</CODE>、<CODE>full</CODE>、<CODE>center</CODE>、
<CODE>none</CODE>である。
デフォルト値は<CODE>left</CODE>である。
</DL>
<P>

<A NAME="IDX2243"></A>
<DL>
<DT><U>Function:</U> <B>current-justification</B>
<DD>この関数は、ポイントの周りのテキストを詰め込むときに使う
正しい幅揃えスタイルを返す。
</DL>
<P>

<A NAME="IDX2244"></A>
<DL>
<DT><U>User Option:</U> <B>sentence-end-double-space</B>
<DD>この変数が<CODE>nil</CODE>以外であると、
直後に1つの空白を従えたピリオドを文末とみなさず、
詰め込み関数はそのような箇所で行分けしない。
</DL>
<P>

<A NAME="IDX2245"></A>
<DL>
<DT><U>Variable:</U> <B>fill-paragraph-function</B>
<DD>この変数は、段落の詰め込みに優先する方法をメジャーモードに与える。
値が<CODE>nil</CODE>以外であると、
<CODE>fill-paragraph</CODE>は詰め込み処理のためにこの関数を呼び出す。
関数が<CODE>nil</CODE>以外の値を返すと、
<CODE>fill-paragraph</CODE>は処理が完了したとみなして戻り値をただちに返す。
<P>

この機能の普通の用途は、
プログラム言語向けのモードでコメントを詰め込むためである。
この関数で普通の方法で詰め込む必要がある場合には、つぎのようにする。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(let ((fill-paragraph-function nil))
  (fill-paragraph arg))
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2246"></A>
<DL>
<DT><U>Variable:</U> <B>use-hard-newlines</B>
<DD>この変数が<CODE>nil</CODE>以外であると、
詰め込み関数は、テキスト属性<CODE>hard</CODE>を持つ改行を削除しない。
これらの『ハード改行』は段落の区切りとして働く。
</DL>
<P>

<A NAME="Margins"></A>
<HR SIZE="6">
<br><A NAME="SEC500"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC499"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC501"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Margins"></A>
<H2> 31.12 詰め込みのための余白 </H2>
<!--docid::SEC500::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Margins">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Margins</a>"<br>
"texi/elisp21/詰め込みのための余白"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B5%CD%A4%E1%B9%FE%A4%DF%A4%CE%A4%BF%A4%E1%A4%CE%CD%BE%C7%F2">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX2247"></A>
<DL>
<DT><U>User Option:</U> <B>fill-prefix</B>
<DD>このバッファローカルな変数は、普通のテキスト行の先頭に現れ、
詰め込み時には無視すべきテキストの文字列（詰め込み接頭辞）を指定する。
詰め込み接頭辞で始まらない行は段落の開始行とみなすため、
詰め込み接頭辞のあとに余分に白文字があるとそれらも段落の開始行とみなす。
詰め込み接頭辞で始まりそのあとに余分な白文字がない行は、
いっしょに詰め込める普通のテキスト行である。
<P>

左端余白がある場合には、左端余白のあとに詰め込み接頭辞が続く。
</DL>
<P>

<A NAME="IDX2248"></A>
<DL>
<DT><U>User Option:</U> <B>fill-column</B>
<DD>このバッファローカルな変数は、詰め込んだ行の最大幅を指定する。
この値は整数であり、コラム数であること。
自動詰め込み（auto-fill）モード（see 節 <A HREF="elisp_32.html#SEC502">31.14 自動詰め込み（auto-filling）モード</A>）を含めて
すべての詰め込み／幅揃え／中央揃えを行うコマンドは、
この変数に影響される。
<P>

特に他人のために書いているテキストでは、
<CODE>fill-column</CODE>を70未満にするべきである。
さもないと、人によっては快適に読むには行が長すぎて、
テキストが不恰好に見える。
</DL>
<P>

<A NAME="IDX2249"></A>
<DL>
<DT><U>Variable:</U> <B>default-fill-column</B>
<DD>この変数の値は、バッファで<CODE>fill-column</CODE>の値を設定していない場合の
<CODE>fill-column</CODE>のデフォルト値である。
これは<CODE>(default-value 'fill-column)</CODE>と同じである。
<P>

<CODE>default-fill-column</CODE>のデフォルト値は70である。
</DL>
<P>

<A NAME="IDX2250"></A>
<DL>
<DT><U>コマンド:</U> <B>set-left-margin</B> <I>from to margin</I>
<DD><VAR>from</VAR>から<VAR>to</VAR>までのテキストの
属性<CODE>left-margin</CODE>を値<VAR>margin</VAR>にする。
自動詰め込み（auto-fill）モードがオンであると、
このコマンドは、当該領域を再詰め込みして新たな余白に適合するようにする。
</DL>
<P>

<A NAME="IDX2251"></A>
<DL>
<DT><U>コマンド:</U> <B>set-right-margin</B> <I>from to margin</I>
<DD><VAR>from</VAR>から<VAR>to</VAR>までのテキストの
属性<CODE>right-margin</CODE>を値<VAR>margin</VAR>にする。
自動詰め込み（auto-fill）モードがオンであると、
このコマンドは、当該領域を再詰め込みして新たな余白に適合するようにする。
</DL>
<P>

<A NAME="IDX2252"></A>
<DL>
<DT><U>Function:</U> <B>current-left-margin</B>
<DD>この関数は、ポイントの周りのテキストを詰め込むときに使う
正しい左端余白の値を返す。
その値は、現在行の最初の文字の属性<CODE>left-margin</CODE>の値（なければ0）
と変数<CODE>left-margin</CODE>の値の和である。
</DL>
<P>

<A NAME="IDX2253"></A>
<DL>
<DT><U>Function:</U> <B>current-fill-column</B>
<DD>この関数は、ポイントの周りのテキストを詰め込むときに使う
正しい詰め込み幅を返す。
その値は、変数<CODE>fill-column</CODE>の値から
ポイント直後の文字の属性<CODE>right-margin</CODE>の値を引いたものである。
</DL>
<P>

<A NAME="IDX2254"></A>
<DL>
<DT><U>コマンド:</U> <B>move-to-left-margin</B> <I>&#38;optional n force</I>
<DD>この関数は、ポイントを現在行の左端余白へ移動する。
移動先のコラム位置は関数<CODE>current-left-margin</CODE>を呼び出して決定する。
引数<VAR>n</VAR>が<CODE>nil</CODE>以外であると、
<CODE>move-to-left-margin</CODE>は<VAR>n</VAR>-1先の行へまず移動する。
<P>

<VAR>force</VAR>が<CODE>nil</CODE>以外であると、
行の字下げが左端余白の値に一致しないときには、
字下げを修正することを指示する。
</DL>
<P>

<A NAME="IDX2255"></A>
<DL>
<DT><U>Function:</U> <B>delete-to-left-margin</B> <I>from to</I>
<DD>この関数は、<VAR>from</VAR>から<VAR>to</VAR>までのテキストから
左端余白分の字下げを取りさる。
削除する字下げ量は、<CODE>current-left-margin</CODE>を呼び出して決定する。
この関数が白文字以外を削除することは絶対にない。
</DL>
<P>

<A NAME="IDX2256"></A>
<DL>
<DT><U>Function:</U> <B>indent-to-left-margin</B>
<DD>これは、基本（fundamental）モード、テキスト（text）モードなどが使う
デフォルトの<CODE>indent-line-function</CODE>である。
その効果は、変数<CODE>left-margin</CODE>の値で指定した位置から
現在行が始まるように字下げを調整することである。
それには白文字の挿入や削除が伴う。
</DL>
<P>

<A NAME="IDX2257"></A>
<DL>
<DT><U>Variable:</U> <B>left-margin</B>
<DD>この変数は、左端余白コラムの起点を指定する。
基本（fundamental）モードでは、<KBD>C-j</KBD>がこのコラム位置に字下げする。
この変数に設定すると自動的にバッファローカルになる。
</DL>
<P>

<A NAME="IDX2258"></A>
<DL>
<DT><U>Variable:</U> <B>fill-nobreak-predicate</B>
<DD><A NAME="IDX2259"></A>
この変数は、特定の箇所では行分けしない方法をメジャーモードに提供する。
その値は関数であること。
この関数は、引数なしで行分け予定箇所にポイントを置いて呼び出される。
この関数が<CODE>nil</CODE>以外を返すと、当該箇所では行分けしない。
</DL>
<P>

<A NAME="Adaptive Fill"></A>
<HR SIZE="6">
<br><A NAME="SEC501"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC500"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC502"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Adaptive Fill"></A>
<H2> 31.13 適応型詰め込み（adaptive-fill）モード </H2>
<!--docid::SEC501::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Adaptive%20Fill">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Adaptive%20Fill</a>"<br>
"texi/elisp21/適応型詰め込み（adaptive-fill）モード"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C5%AC%B1%FE%B7%BF%B5%CD%A4%E1%B9%FE%A4%DF%A1%CAadaptive%2Dfill%A1%CB%A5%E2%A1%BC%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2260"></A>
<P>

適応型詰め込みモード（adaptive-fill）では、
詰め込むべき各段落のテキストから自動的に詰め込み接頭辞を選びます。
<P>

<A NAME="IDX2261"></A>
<DL>
<DT><U>User Option:</U> <B>adaptive-fill-mode</B>
<DD>この変数が<CODE>nil</CODE>以外であると、
適応型詰め込みモード（adaptive-fill）がオンである。
デフォルトでは<CODE>t</CODE>である。
</DL>
<P>

<A NAME="IDX2262"></A>
<DL>
<DT><U>Function:</U> <B>fill-context-prefix</B> <I>from to</I>
<DD>この関数は適応型詰め込みモード（adaptive-fill）の中核を実装するものであり、
<VAR>from</VAR>から<VAR>to</VAR>のあいだのテキストに基づいて詰め込み接頭辞を選ぶ。
以下に述べる変数に基づいて、段落の最初の2行を調べてこれを行う。
</DL>
<P>

<A NAME="IDX2263"></A>
<DL>
<DT><U>User Option:</U> <B>adaptive-fill-regexp</B>
<DD>この変数は、適応型詰め込みモード（adaptive-fill）を制御する
正規表現を保持する。
適応型詰め込みモード（adaptive-fill）では、
行の（あれば）左端余白の白文字のうしろから始まるテキストに対して
この正規表現の一致を試みる。
一致した文字群が当該行の詰め込み接頭辞の候補になる。
</DL>
<P>

<A NAME="IDX2264"></A>
<DL>
<DT><U>User Option:</U> <B>adaptive-fill-first-line-regexp</B>
<DD>1行だけの段落において、詰め込み接頭辞の候補がこの正規表現に一致するか、
<CODE>comment-start-skip</CODE>に一致すると、その候補を使う。
さもなければ、同じ幅に相当する白文字をかわりに使う。
<P>

1行だけの段落から選んだ詰め込み接頭辞が後続の行の段落の始まりである場合には、
1行だけの段落からはけっして詰め込み接頭辞を選ばない。
</DL>
<P>

<A NAME="IDX2265"></A>
<DL>
<DT><U>User Option:</U> <B>adaptive-fill-function</B>
<DD>この変数に関数を指定することで、
詰め込み接頭辞のより複雑な自動選択方法を指定できる。
この関数は、<CODE>adaptive-fill-regexp</CODE>の一致に失敗したときに、
行の左端余白のうしろにポイントを置いて呼び出され、
当該行に基づいて適切な詰め込み接頭辞を返すこと。
それが<CODE>nil</CODE>を返すと、当該行には詰め込み接頭辞がないことを意味する。
</DL>
<P>

<A NAME="Auto Filling"></A>
<HR SIZE="6">
<br><A NAME="SEC502"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC501"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC503"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Auto Filling"></A>
<H2> 31.14 自動詰め込み（auto-filling）モード </H2>
<!--docid::SEC502::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Auto%20Filling">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Auto%20Filling</a>"<br>
"texi/elisp21/自動詰め込み（auto-filling）モード"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BC%AB%C6%B0%B5%CD%A4%E1%B9%FE%A4%DF%A1%CAauto%2Dfilling%A1%CB%A5%E2%A1%BC%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2266"></A>
<A NAME="IDX2267"></A>
<P>

自動詰め込み（auto-filling）モードは、テキストを挿入するにつれて
自動的に行を詰め込むマイナモードです。
本節では、自動詰め込み（auto-filling）モードが使うフックについて述べます。
既存のテキストを詰め込んだり幅揃えするために
明示的に呼び出す関数については、<A HREF="elisp_32.html#SEC499">31.11 詰め込み</A>を参照してください。
<P>

自動詰め込み（auto-filling）モードでは、
テキストの一部を再詰め込む際の
余白や幅揃えスタイルを変更するための関数も使えるようにします。
See 節 <A HREF="elisp_32.html#SEC500">31.12 詰め込みのための余白</A>。
<P>

<A NAME="IDX2268"></A>
<DL>
<DT><U>Variable:</U> <B>auto-fill-function</B>
<DD>この変数の値は、
自己挿入される空白や改行のあとで呼び出されるべき
（引数なしの）関数であること。
これが<CODE>nil</CODE>であると、そのような場合に特別なことを行わない。
<P>

自動詰め込み（auto-filling）モードがオンであると、
<CODE>auto-fill-function</CODE>の値は<CODE>do-auto-fill</CODE>である。
この関数の目的は、行分けの通常の方針を実装することである。
<P>

<BLOCKQUOTE>
Emacsの古い版では、この変数を<CODE>auto-fill-hook</CODE>と命名していたが、
フックの標準的な慣習に従って呼ばれないため
19版で<CODE>auto-fill-function</CODE>と改名した。
</BLOCKQUOTE>
</DL>
<P>

<A NAME="IDX2269"></A>
<DL>
<DT><U>Variable:</U> <B>normal-auto-fill-function</B>
<DD>この変数は、自動詰め込み（auto-filling）モードがオンになったとき／であるときに
<CODE>auto-fill-function</CODE>として用いる関数を指定する。
メジャーモードでは、この変数のバッファローカルな値に設定することで
自動詰め込み（auto-filling）モードのふるまいを変更できる。
</DL>
<P>

<A NAME="Sorting"></A>
<HR SIZE="6">
<br><A NAME="SEC503"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC502"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC504"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Sorting"></A>
<H2> 31.15 テキストのソート </H2>
<!--docid::SEC503::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Sorting">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Sorting</a>"<br>
"texi/elisp21/テキストのソート"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%A4%CE%A5%BD%A1%BC%A5%C8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2270"></A>
<A NAME="IDX2271"></A>
<P>

本節で述べるソート関数すべては、バッファ内のテキストを並べ替えます。
これは、リスト内の要素の順番を並べ替える関数<CODE>sort</CODE>
（see 節 <A HREF="elisp_6.html#SEC90">5.6.3 リストの順序を変更する関数</A>）と対照的です。
これらの関数が返す値には意味はありません。
<P>

<A NAME="IDX2272"></A>
<DL>
<DT><U>Function:</U> <B>sort-subr</B> <I>reverse nextrecfun endrecfun &#38;optional startkeyfun endkeyfun</I>
<DD>この関数は、バッファ内のテキストをレコードに分割してソートする
汎用のテキストソートルーティンである。
本節のコマンドのほとんどは、この関数を用いる。
<P>

<CODE>sort-subr</CODE>の動作方法を理解するためは、
バッファの参照可能部分全体が
<EM>ソートレコード</EM>（sort record）と呼ばれる
重なり合いのない断片に分割されていると考える。
レコードは連続しているかもしれないし、そうでないかもしれないが、
けっして重なり合わない。
各ソートレコードの一部分（あるいは全体）をソートキーとして区別する。
ソートでは、ソートキーの順に並ぶようにレコードを並び替える。
<P>

通常、レコードをソートキーの昇順に並べ替える。
関数<CODE>sort-subr</CODE>の第1引数<VAR>reverse</VAR>が<CODE>nil</CODE>以外であると、
ソートキーの降順にレコードを並べ替える。
<P>

<CODE>sort-subr</CODE>のつぎの4つの引数は、
ソートレコードをまたいでポイントを移動するために呼ばれる関数である。
それらは、<CODE>sort-subr</CODE>で多数回呼び出される。
<P>

<OL>
<LI>
<VAR>nextrecfun</VAR>は、レコードの末尾にポイントを置いて呼び出される。
この関数は、つぎのレコードの先頭にポイントを移動する。
最初のレコードの先頭は、
<CODE>sort-subr</CODE>を呼び出したときのポイント位置であると仮定する。
したがって、<CODE>sort-subr</CODE>を呼び出すまえには、普通、
バッファの先頭にポイントを移動しておくこと。
<P>

この関数は、バッファの末尾にポイントを置いておくことで、
ソートレコードがなくなったことを表せる。
<P>

<LI>
<VAR>endrecfun</VAR>は、レコード内にポイントを置いて呼び出される。
レコードの末尾にポイントを移動する。
<P>

<LI>
<VAR>startkeyfun</VAR>は、レコードの先頭からソートキーの先頭へ
ポイントを移動するために呼び出される。
この引数は省略可能であり、省略するとレコード全体をソートキーとする。
指定した場合、その関数は、ソートキーとして用いる<CODE>nil</CODE>以外の値を返すか、
バッファのポイント位置からソートキーが始まることを表す<CODE>nil</CODE>を返すこと。
後者の場合、ソートキーの末尾を探すために<VAR>endkeyfun</VAR>が呼ばれる。
<P>

<LI>
<VAR>endkeyfun</VAR>は、ソートキーの先頭からソートキーの末尾に
ポイントを移動するために呼び出される。
この引数は省略可能である。
<VAR>startkeyfun</VAR>が<CODE>nil</CODE>を返しこの引数が省略されている
（あるいは<CODE>nil</CODE>である）と、ソートキーはレコードの末尾までである。
<VAR>startkeyfun</VAR>が<CODE>nil</CODE>以外の値を返すのであれば、
<VAR>endkeyfun</VAR>は必要ない。
</OL>
<P>

<CODE>sort-subr</CODE>の例として、
<CODE>sort-lines</CODE>の完全な関数定義を示す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>;; 説明文字列の始めの2行は、ユーザーが見るときには
;; 実質的には1行であることに注意
(defun sort-lines (reverse beg end)
  "Sort lines in region alphabetically;\
 argument means descending order.
Called from a program, there are three arguments:
REVERSE (non-nil means reverse order),\
 BEG and END (region to sort).
The variable `sort-fold-case' determines\
 whether alphabetic case affects
the sort order.
  (interactive "P\nr")
  (save-excursion
    (save-restriction
      (narrow-to-region beg end)
      (goto-char (point-min))
      (sort-subr reverse 'forward-line 'end-of-line))))
</pre></td></tr></table><P>

ここで、<CODE>forward-line</CODE>はつぎのレコードの先頭にポイントを移動し、
<CODE>end-of-line</CODE>はレコードの末尾にポイントを移動する。
レコード全体をソートキーとして用いるため、
引数<VAR>startkeyfun</VAR>と<VAR>endkeyfun</VAR>は指定しない。
<P>

関数<CODE>sort-paragraphs</CODE>もほぼ同様であるが、
つぎのように<CODE>sort-subr</CODE>を呼び出す点が異なる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(sort-subr reverse
           (function
             (lambda ()
               (while (and (not (eobp))
                      (looking-at paragraph-separate))
                 (forward-line 1))))
           'forward-paragraph)
</pre></td></tr></table><P>

<CODE>sort-subr</CODE>から戻ったあとでは、
ソートレコードを指しているマーカは意味のある位置を指していない。
</DL>
<P>

<A NAME="IDX2273"></A>
<DL>
<DT><U>User Option:</U> <B>sort-fold-case</B>
<DD>この変数が<CODE>nil</CODE>以外であると、
<CODE>sort-subr</CODE>や他のバッファソート関数は、
文字列の比較において大文字小文字を区別しない。
</DL>
<P>

<A NAME="IDX2274"></A>
<DL>
<DT><U>コマンド:</U> <B>sort-regexp-fields</B> <I>reverse record-regexp key-regexp start end</I>
<DD>このコマンドは、<VAR>start</VAR>と<VAR>end</VAR>のあいだの領域を
<VAR>record-regexp</VAR>と<VAR>key-regexp</VAR>の指定に従って
アルファベット順にソートする。
<VAR>reverse</VAR>が負の整数であると、逆順にソートする。
<P>

アルファベット順のソートとは、
最初の文字同士、2番目の文字同士といった具合に
2つのソートキーを比較することである。
不一致がみつかると、ソートキーが等しくないことを意味し、
最初の不一致箇所の文字が小さいほうのソートキーが小さい。
個々の文字は、Emacsの文字集合における文字コードの数値に従って比較する。
<P>

引数<VAR>record-regexp</VAR>の値は、バッファをソートレコードに
分割する方法を指定する。
各レコードの末尾において、この正規表現を探索し
それに一致したテキストをつぎのレコードとする。
たとえば、正規表現`<SAMP>^.+$</SAMP>'は、
少なくとも1つの文字のあとに改行があるような行に一致し、
そのような行をソートレコードとする。
正規表現の構文と意味については、see 節 <A HREF="elisp_34.html#SEC551">33.2 正規表現</A>。
<P>

引数<VAR>key-regexp</VAR>の値は、
レコードのどの部分がソートキーであるかを指定する。
<VAR>key-regexp</VAR>は、レコード全体かその一部分に一致する。
後者の場合、レコードの残りの部分は、レコードの並び替え順序には影響しないが、
レコードをその新たな位置に移動するときにいっしょに移動される。
<P>

引数<VAR>key-regexp</VAR>で
<VAR>record-regexp</VAR>の部分式に一致したテキストを参照してもよいし、
独立した正規表現でもよい。
<P>

<VAR>key-regexp</VAR>にはつぎの可能性がある。
<P>

<DL COMPACT>
<DT>`<SAMP>\<VAR>digit</VAR></SAMP>'
<DD><VAR>record-regexp</VAR>の<VAR>digit</VAR>番目の
括弧によるグループ化`<SAMP>\(...\)</SAMP>'に一致したテキストがソートキーである。
<P>

<DT>`<SAMP>\&#38;</SAMP>'
<DD>レコード全体がソートキーである。
<P>

<DT>正規表現
<DD><CODE>sort-regexp-fields</CODE>はレコード内でこの正規表現に一致するものを探す。
一致がみつかれば、それがソートキーになる。
レコード内で<VAR>key-regexp</VAR>に対する一致がみつからなければ、
レコードを無視する。
つまり、バッファ内での当該レコードの位置を変更しない。
（別のレコードが周りに移動してくるかもしれない。）
</DL>
<P>

たとえば、領域内のすべての行を各行の`<SAMP>f</SAMP>'で始まる最初の単語で
ソートするには、<VAR>record-regexp</VAR>に`<SAMP>^.*$</SAMP>'、
<VAR>key-regexp</VAR>に`<SAMP>\&#60;f\w*\&#62;</SAMP>'を指定する。
つまり、つぎのような式になる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(sort-regexp-fields nil "^.*$" "\\<f\\w*\\>"
                    (region-beginning)
                    (region-end))
</pre></td></tr></table><P>

<CODE>sort-regexp-fields</CODE>を対話的に呼び出すと、
ミニバッファで<VAR>record-regexp</VAR>と<VAR>key-regexp</VAR>を問い合わせる。
</DL>
<P>

<A NAME="IDX2275"></A>
<DL>
<DT><U>コマンド:</U> <B>sort-lines</B> <I>reverse start end</I>
<DD>このコマンドは、<VAR>start</VAR>と<VAR>end</VAR>のあいだの領域の行を
アルファベット順にソートする。
<VAR>reverse</VAR>が<CODE>nil</CODE>以外であると、逆順にソートする。
</DL>
<P>

<A NAME="IDX2276"></A>
<DL>
<DT><U>コマンド:</U> <B>sort-paragraphs</B> <I>reverse start end</I>
<DD>このコマンドは、<VAR>start</VAR>と<VAR>end</VAR>のあいだの領域の段落を
アルファベット順にソートする。
<VAR>reverse</VAR>が<CODE>nil</CODE>以外であると、逆順にソートする。
</DL>
<P>

<A NAME="IDX2277"></A>
<DL>
<DT><U>コマンド:</U> <B>sort-pages</B> <I>reverse start end</I>
<DD>このコマンドは、<VAR>start</VAR>と<VAR>end</VAR>のあいだの領域のページを
アルファベット順にソートする。
<VAR>reverse</VAR>が<CODE>nil</CODE>以外であると、逆順にソートする。
</DL>
<P>

<A NAME="IDX2278"></A>
<DL>
<DT><U>コマンド:</U> <B>sort-fields</B> <I>field start end</I>
<DD>このコマンドは、<VAR>start</VAR>と<VAR>end</VAR>のあいだの領域の行を
各行の<VAR>field</VAR>番目のフィールド同士をアルファベット順に比較してソートする。
フィールドは白文字で区切られ、1から数える。
<VAR>field</VAR>が負であると、
行末から-<VAR>field</VAR>番目のフィールドでソートする。
このコマンドは、表をソートするのに有用である。
</DL>
<P>

<A NAME="IDX2279"></A>
<DL>
<DT><U>コマンド:</U> <B>sort-numeric-fields</B> <I>field start end</I>
<DD>このコマンドは、<VAR>start</VAR>と<VAR>end</VAR>のあいだの領域の行を
各行の<VAR>field</VAR>番目のフィールド同士を数値として比較してソートする。
領域内の各行の指定したフィールドには数があること。
フィールドは白文字で区切られ、1から数える。
<VAR>field</VAR>が負であると、
行末から-<VAR>field</VAR>番目のフィールドでソートする。
このコマンドは、表をソートするのに有用である。
</DL>
<P>

<A NAME="IDX2280"></A>
<DL>
<DT><U>コマンド:</U> <B>sort-columns</B> <I>reverse &#38;optional beg end</I>
<DD>このコマンドは、<VAR>start</VAR>と<VAR>end</VAR>のあいだの領域の行を
特定範囲のコラムをアルファベット順に比較してソートする。
<VAR>beg</VAR>と<VAR>end</VAR>のコラム位置は、ソート対象のコラムの範囲を区切る。
<P>

<VAR>reverse</VAR>が<CODE>nil</CODE>以外であると、逆順にソートする。
<P>

このコマンドの普通でない点は、
位置<VAR>beg</VAR>を含む行全体と位置<VAR>end</VAR>を含む行全体も
ソート対象の領域に含まれることである。
<P>

<CODE>sort-columns</CODE>は、ユーティリティプログラム<CODE>sort</CODE>を使うため、
タブ文字を含むテキストを正しく扱えない。
ソートするまえに<KBD>M-x untabify</KBD>を使ってタブを空白に変換すること。
</DL>
<P>

<A NAME="Columns"></A>
<HR SIZE="6">
<br><A NAME="SEC504"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC503"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC505"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Columns"></A>
<H2> 31.16 コラムを数える </H2>
<!--docid::SEC504::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Columns">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Columns</a>"<br>
"texi/elisp21/コラムを数える"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%B3%A5%E9%A5%E0%A4%F2%BF%F4%A4%A8%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2281"></A>
<A NAME="IDX2282"></A>
<A NAME="IDX2283"></A>
<P>

コラム関数は、（バッファの先頭から文字を数えた）文字位置を
（スクリーンの行頭から文字を数えた）コラム位置に変換します。
<P>

これらの関数は、各文字をそれがスクリーン上で占めるコラム数を基に数える。
つまり、<CODE>ctl-arrow</CODE>の値に依存してコントロール文字は、
2コラムか4コラム占めると数え、
タブ文字は、タブの開始コラムと<CODE>tab-width</CODE>の値に依存する
コラム数を占めると数えることを意味します。
See 節 <A HREF="elisp_38.html#SEC618">37.13 通常の画面表示慣習</A>。
<P>

コラム番号の計算では、ウィンドウの幅や水平スクロール量を無視します。
その結果、コラム値は任意の大きさになりえます。
最初の（スクリーン左端の）コラムの番号は0です。
<P>

<A NAME="IDX2284"></A>
<DL>
<DT><U>Function:</U> <B>current-column</B>
<DD>この関数は、左端を0としてコラム数で数えたポイントの水平位置を返す。
コラム位置は、現在行の先頭からポイント位置までの文字すべての
表示上の表記の幅の総和である。
<P>

<CODE>current-column</CODE>の使用例については、
<A HREF="elisp_30.html#SEC468">29.2.4 テキスト行単位の移動</A>の<CODE>count-lines</CODE>を参照。
</DL>
<P>

<A NAME="IDX2285"></A>
<DL>
<DT><U>Function:</U> <B>move-to-column</B> <I>column &#38;optional force</I>
<DD>この関数は、ポイントを現在行の<VAR>column</VAR>へ移動する。
<VAR>column</VAR>の計算では、現在行の先頭からポイント位置までの
文字すべての表示上の表記の幅を考慮する。
<P>

コラム<VAR>column</VAR>が行末を越える場合、ポイントを行末へ移動する。
<VAR>column</VAR>が負であると、ポイントを行頭へ移動する。
<P>

コラム<VAR>column</VAR>がタブなどの複数コラムを占める文字の中ほどにあるために
そこへ移動できない場合には、
ポイントを当該文字の末尾へ移動する。
しかし、<VAR>force</VAR>が<CODE>nil</CODE>以外であり
<VAR>column</VAR>がタブの中ほどであると、
コラム<VAR>column</VAR>に正確に移動できるようにタブを空白に変換する。
複数コラムを占めるその他の文字では、それらを分割する方法がないため、
<VAR>force</VAR>を指定しても変則的になる。
<P>

コラム<VAR>column</VAR>に到達できるほど行が長くない場合にも
引数<VAR>force</VAR>には効果がある。
そのような場合、指定コラムに達するように行末に白文字を追加する。
<P>

<VAR>column</VAR>が整数でないと、エラーを通知する。
<P>

戻り値は、実際の移動先のコラム番号である。
</DL>
<P>

<A NAME="Indentation"></A>
<HR SIZE="6">
<br><A NAME="SEC505"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC504"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC506"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Indentation"></A>
<H2> 31.17 字下げ </H2>
<!--docid::SEC505::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Indentation">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Indentation</a>"<br>
"texi/elisp21/字下げ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BB%FA%B2%BC%A4%B2">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2286"></A>
<P>

字下げ関数は、行頭の空白を調べたり、そこへ移動したり、
変更するために使います。
行の他の白文字を変更するものもあります。
コラム関数と字下げ関数は左端を0と数えます。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC506">31.17.1 字下げ基本関数</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Functions used to count and insert indentation.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC507">31.17.2 メジャーモードの制御による字下げ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Customize indentation for different modes.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC508">31.17.3 領域全体の字下げ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Indent all the lines in a region.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC509">31.17.4 先行行相対の字下げ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Indent the current line based on previous lines.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC510">31.17.5 調整可能な『タブストップ』</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Adjustable, typewriter-like tab stops.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC511">31.17.6 字下げに基づく移動コマンド</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Move to first non-blank character.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Primitive Indent"></A>
<HR SIZE="6">
<br><A NAME="SEC506"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC505"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC507"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Primitive Indent"></A>
<H3> 31.17.1 字下げ基本関数 </H3>
<!--docid::SEC506::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Primitive%20Indent">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Primitive%20Indent</a>"<br>
"texi/elisp21/字下げ基本関数"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BB%FA%B2%BC%A4%B2%B4%F0%CB%DC%B4%D8%BF%F4">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節では、字下げを数えたり挿入するために使われる基本関数について述べます。
後続の節の関数群は、これらの基本関数を使っています。
関連する関数については、See 節 <A HREF="elisp_38.html#SEC610">37.9 表示幅</A>。
<P>

<A NAME="IDX2287"></A>
<DL>
<DT><U>Function:</U> <B>current-indentation</B>
<DD>この関数は、現在行の字下げを返す。
これは最初の白文字以外の文字の水平位置である。
行全体が白文字や空である場合には、行末の水平位置を返す。
</DL>
<P>

<A NAME="IDX2288"></A>
<DL>
<DT><U>コマンド:</U> <B>indent-to</B> <I>column &#38;optional minimum</I>
<DD>この関数は、ポイント位置から<VAR>column</VAR>に達するまでタブや空白で字下げする。
<VAR>minimum</VAR>を指定し<CODE>nil</CODE>以外であると、
<VAR>column</VAR>を越える場合であっても最低<VAR>minimum</VAR>個の空白を挿入する。
さもなければ、ポイントが<VAR>column</VAR>を越えている場合には、
この関数はなにもしない。
戻り値は、挿入した字下げが終る箇所のコラムである。
<P>

挿入された白文字は周りの文字（普通は、まえの文字）からテキスト属性を継承する。
see 節 <A HREF="elisp_32.html#SEC519">31.19.6 テキスト属性のスティッキ性</A>。
</DL>
<P>

<A NAME="IDX2289"></A>
<DL>
<DT><U>User Option:</U> <B>indent-tabs-mode</B>
<DD>この変数が<CODE>nil</CODE>以外であると、
字下げ関数は空白に加えてタブも挿入する。
さもなければ、空白のみを挿入する。
この変数に設定すると、カレントバッファでバッファローカルになる。
</DL>
<P>

<A NAME="Mode-Specific Indent"></A>
<HR SIZE="6">
<br><A NAME="SEC507"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC506"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC508"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Mode-Specific Indent"></A>
<H3> 31.17.2 メジャーモードの制御による字下げ </H3>
<!--docid::SEC507::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Mode-Specific%20Indent">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Mode-Specific%20Indent</a>"<br>
"texi/elisp21/メジャーモードの制御による字下げ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%E1%A5%B8%A5%E3%A1%BC%A5%E2%A1%BC%A5%C9%A4%CE%C0%A9%B8%E6%A4%CB%A4%E8%A4%EB%BB%FA%B2%BC%A4%B2">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

各メジャーモードの重要な機能は、
キー<KBD>TAB</KBD>を編集対象の言語に適した字下げにカスタマイズすることです。
本節では、キー<KBD>TAB</KBD>の機構とそれを制御する方法について述べます。
本節の関数は、予測できない値を返します。
<P>

<A NAME="IDX2290"></A>
<DL>
<DT><U>Variable:</U> <B>indent-line-function</B>
<DD>この変数の値は、現在行を字下げするために
<KBD>TAB</KBD>（やさまざまなコマンド）が使う関数である。
コマンド<CODE>indent-according-to-mode</CODE>は、
この関数を呼ぶこと以上のことはしない。
<P>

lispモードでは値はシンボル<CODE>lisp-indent-line</CODE>、
Cモードでは<CODE>c-indent-line</CODE>、
fortranモードでは<CODE>fortran-indent-line</CODE>である。
標準的な字下げがない基本（fundamental）モード、
テキスト（text）モード、他の多くのモードでは、
値は<CODE>indent-to-left-margin</CODE>（デフォルト値）である
</DL>
<P>

<A NAME="IDX2291"></A>
<DL>
<DT><U>コマンド:</U> <B>indent-according-to-mode</B>
<DD>このコマンドは、現在のメジャーモードに適した方法で現在行を字下げするために
<CODE>indent-line-function</CODE>で指定される関数を呼び出す。
</DL>
<P>

<A NAME="IDX2292"></A>
<DL>
<DT><U>コマンド:</U> <B>indent-for-tab-command</B>
<DD>このコマンドは、現在行を字下げするために
<CODE>indent-line-function</CODE>で指定される関数を呼び出すが、
その関数が<CODE>indent-to-left-margin</CODE>であると、
かわりに<CODE>insert-tab</CODE>を呼び出す。
（これはタブ文字を挿入する単純なコマンドである。）
</DL>
<P>

<A NAME="IDX2293"></A>
<DL>
<DT><U>コマンド:</U> <B>newline-and-indent</B>
<DD>この関数は、改行を挿入してから、
（改行を挿入したばかりの行に続く）新たな行を
メジャーモードに基づいて字下げする。
<P>

現在の<CODE>indent-line-function</CODE>を呼び出して字下げを行う。
プログラム言語向けのモードでは、これは<KBD>TAB</KBD>が行うことと同じであるが、
<KBD>TAB</KBD>がタブを挿入するテキスト向けのモードの一部では、
<CODE>newline-and-indent</CODE>は<CODE>left-margin</CODE>で指定されたコラムに字下げする。
</DL>
<P>

<A NAME="IDX2294"></A>
<DL>
<DT><U>コマンド:</U> <B>reindent-then-newline-and-indent</B>
<DD>このコマンドは、現在行を字下げし直し、ポイント位置に改行を挿入し、
（改行を挿入したばかりの行に続く）新たな行を字下げする。
<P>

このコマンドは、<CODE>indent-line-function</CODE>の現在の値を呼び出すことで、
どちらの行も現在のメジャーモードに基づいて字下げする。
プログラム言語向けのモードでは、これは<KBD>TAB</KBD>が行うことと同じであるが、
<KBD>TAB</KBD>がタブを挿入するテキスト向けのモードの一部では、
<CODE>reindent-then-newline-and-indent</CODE>は、
<CODE>left-margin</CODE>で指定されるコラムに字下げする。
</DL>
<P>

<A NAME="Region Indent"></A>
<HR SIZE="6">
<br><A NAME="SEC508"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC507"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC509"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Region Indent"></A>
<H3> 31.17.3 領域全体の字下げ </H3>
<!--docid::SEC508::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Region%20Indent">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Region%20Indent</a>"<br>
"texi/elisp21/領域全体の字下げ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CE%CE%B0%E8%C1%B4%C2%CE%A4%CE%BB%FA%B2%BC%A4%B2">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節では、領域内のすべての行を字下げするコマンドについて述べます。
これらは予測できない値を返します。
<P>

<A NAME="IDX2295"></A>
<DL>
<DT><U>コマンド:</U> <B>indent-region</B> <I>start end to-column</I>
<DD>このコマンドは、<VAR>start</VAR>（を含めて）と
<VAR>end</VAR>（を含めない）のあいだで始まる空でない各行を字下げする。
<VAR>to-column</VAR>が<CODE>nil</CODE>であると、
<CODE>indent-region</CODE>は、現在のモードの字下げ関数、
つまり、<CODE>indent-line-function</CODE>の値を呼び出して、
空でない各行を字下げする。
<P>

<VAR>to-column</VAR>が<CODE>nil</CODE>以外であると、
それは字下げ先のコラム番号を指定する整数であること。
すると、この関数は、白文字を追加するか削除して、
各行を指定どおりに字下げする。
<P>

詰め込み接頭辞がある場合、
<CODE>indent-region</CODE>は詰め込み接頭辞で行を始めることで各行を字下げする。
</DL>
<P>

<A NAME="IDX2296"></A>
<DL>
<DT><U>Variable:</U> <B>indent-region-function</B>
<DD>この変数の値は、<CODE>indent-region</CODE>の短縮版として利用可能な関数である。
領域の開始位置と終了位置の2つの引数をとる。
領域の行を1つ1つ字下げする場合と同じ結果を生じるが、
より速く動作することを意図してこの関数を設計するべきである。
<P>

値が<CODE>nil</CODE>であると短縮版はなく、
<CODE>indent-region</CODE>が実際に1行ずつ処理する。
<P>

短縮版関数はCモードやlispモードのようなモードで有用である。
そのようなモードでは、<CODE>indent-line-function</CODE>で関数定義の始まりを
走査する必要があり、これを各行に適用すると自乗の時間がかかる。
短縮版では、字下げし終えた関数定義を通過するたびに
走査情報を更新でき、これには線形時間かかるだけである。
個々の行を高速に字下げできるモードでは、短縮版は必要ない。
<P>

引数<VAR>to-column</VAR>に<CODE>nil</CODE>以外を指定した<CODE>indent-region</CODE>には
別の意味があり、この変数を使わない。
</DL>
<P>

<A NAME="IDX2297"></A>
<DL>
<DT><U>コマンド:</U> <B>indent-rigidly</B> <I>start end count</I>
<DD>このコマンドは、<VAR>start</VAR>（を含めて）と
<VAR>end</VAR>（を含めない）のあいだで始まる行すべてを
コラム数<VAR>count</VAR>だけ字下げする。
これは、領域を1つの塊として動かしてその領域の『形を保つ』。
このコマンドは、字下げしていないテキストの領域だけでなく、
整形済みの領域を字下げするためにも有用である。
<P>

たとえば、<VAR>count</VAR>が3であると、
このコマンドは指定した領域内の各行の行頭に3コラムの字下げを追加する。
<P>

メイル（mail）モードでは、<KBD>C-c C-y</KBD>（<CODE>mail-yank-original</CODE>）が
返信対象のメッセージからコピーしたテキストを字下げするために
<CODE>indent-rigidly</CODE>を使っている。
</DL>
<P>

<A NAME="IDX2298"></A>
<DL>
<DT><U>Function:</U> <B>indent-code-rigidly</B> <I>start end columns &#38;optional nochange-regexp</I>
<DD>この関数は<CODE>indent-rigidly</CODE>と同様であるが、
文字列やコメントで始まる行を変更しない点が異なる。
<P>

さらに、（<VAR>nochange-regexp</VAR>が<CODE>nil</CODE>以外のとき）
行の先頭が<VAR>nochange-regexp</VAR>に一致する場合にも行を変更しない。
</DL>
<P>

<A NAME="Relative Indent"></A>
<HR SIZE="6">
<br><A NAME="SEC509"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC508"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC510"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Relative Indent"></A>
<H3> 31.17.4 先行行相対の字下げ </H3>
<!--docid::SEC509::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Relative%20Indent">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Relative%20Indent</a>"<br>
"texi/elisp21/先行行相対の字下げ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C0%E8%B9%D4%B9%D4%C1%EA%C2%D0%A4%CE%BB%FA%B2%BC%A4%B2">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節では、先行する行の内容に基づいて現在行を字下げする2つの
コマンドについて述べます。
<P>

<A NAME="IDX2299"></A>
<DL>
<DT><U>コマンド:</U> <B>indent-relative</B> <I>&#38;optional unindented-ok</I>
<DD>このコマンドは、空白でないまえの行のつぎの<EM>字下げ位置</EM>のコラムに
達するまで、ポイント位置に白文字を挿入する。
字下げ位置とは、白文字に続く白文字以外の文字である。
つぎの字下げ位置とは、現在行のポイントのコラム位置より大きな
最初の字下げ位置のことである。
たとえば、テキスト行の白文字以外の最初の文字より左側で、
その下の行にポイントがあると、
白文字を挿入してそのコラム位置にポイントを移動する。
<P>

空白でないまえの行に、つぎの字下げ位置（つまり、ポイント位置より
大きなコラム）がないと、<CODE>indent-relative</CODE>は、
（<VAR>unindented-ok</VAR>が<CODE>nil</CODE>以外であれば）なにもしないか、
<CODE>tab-to-tab-stop</CODE>を呼び出す。
したがって、まえのテキスト行が短くてその行末より右側で、
その下の行にポイントがあると、このコマンドは、通常どおり、
白文字を挿入してつぎのタブ位置へポイントを移動する。
<P>

<CODE>indent-relative</CODE>の戻り値は予測できない。
<P>

つぎの例では、ポイントは2行目の行頭にある。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>            This line is indented twelve spaces.
-!-The quick brown fox jumped.
</pre></td></tr></table><P>

式<CODE>(indent-relative nil)</CODE>を評価すると、つぎのようになる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>            This line is indented twelve spaces.
            -!-The quick brown fox jumped.
</pre></td></tr></table><P>

つぎの例では、ポイントは`<SAMP>jumped</SAMP>'の`<SAMP>m</SAMP>'と`<SAMP>p</SAMP>'のあいだにある。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>            This line is indented twelve spaces.
The quick brown fox jum-!-ped.
</pre></td></tr></table><P>

式<CODE>(indent-relative nil)</CODE>を評価すると、つぎのようになる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>            This line is indented twelve spaces.
The quick brown fox jum  -!-ped.
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2300"></A>
<DL>
<DT><U>コマンド:</U> <B>indent-relative-maybe</B>
<DD>このコマンドは、引数<VAR>unindented-ok</VAR>に<CODE>t</CODE>を指定して
<CODE>indent-relative</CODE>を呼び出すことで、
まえの行と同様に字下げする。
戻り値は予測できない。
<P>

空行でないまえの行に現在のコラム位置を越える字下げ位置がなければ、
このコマンドはなにもしない。
</DL>
<P>

<A NAME="Indent Tabs"></A>
<HR SIZE="6">
<br><A NAME="SEC510"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC509"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC511"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Indent Tabs"></A>
<H3> 31.17.5 調整可能な『タブストップ』 </H3>
<!--docid::SEC510::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Indent%20Tabs">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Indent%20Tabs</a>"<br>
"texi/elisp21/調整可能な『タブストップ』"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C4%B4%C0%B0%B2%C4%C7%BD%A4%CA%A1%D8%A5%BF%A5%D6%A5%B9%A5%C8%A5%C3%A5%D7%A1%D9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2301"></A>
<P>

本節では、ユーザー指定の『タブストップ』の機構と、
それを使ったり設定するための機構について説明します。
『タブストップ』という名前を使うのは、
この機構がタイプライタのタブストップに似た機能だからです。
この機能は、適切な個数の空白とタブ文字を挿入して
つぎのタブストップのコラムへ到達しますが、
バッファ内のタブ文字の表示に影響することはありません
（see 節 <A HREF="elisp_38.html#SEC618">37.13 通常の画面表示慣習</A>）。
テキスト（text）モードなどの少数のメジャーモードでのみ、
入力としての文字<KBD>TAB</KBD>がこのタブストップ機能を使います。
<P>

<A NAME="IDX2302"></A>
<DL>
<DT><U>コマンド:</U> <B>tab-to-tab-stop</B>
<DD>このコマンドは、<CODE>tab-stop-list</CODE>で定義されたつぎのタブストップコラムまで、
ポイントのまえに空白やタブを挿入する。
このリストで現在のコラム番号より大きな要素を探し、
その要素を字下げ位置のコラムとして使う。
そのような要素がなければ、このコマンドはないもしない。
</DL>
<P>

<A NAME="IDX2303"></A>
<DL>
<DT><U>User Option:</U> <B>tab-stop-list</B>
<DD>この変数は、<CODE>tab-to-tab-stops</CODE>が使うタブストップコラムのリストである。
それらの要素は、昇順の整数であること。
タブストップコラムの間隔は、等間隔である必要はない。
<P>

タブストップを対話的に編集するには<KBD>M-x edit-tab-stops</KBD>を使う。
</DL>
<P>

<A NAME="Motion by Indent"></A>
<HR SIZE="6">
<br><A NAME="SEC511"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC510"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC512"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Motion by Indent"></A>
<H3> 31.17.6 字下げに基づく移動コマンド </H3>
<!--docid::SEC511::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Motion%20by%20Indent">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Motion%20by%20Indent</a>"<br>
"texi/elisp21/字下げに基づく移動コマンド"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BB%FA%B2%BC%A4%B2%A4%CB%B4%F0%A4%C5%A4%AF%B0%DC%C6%B0%A5%B3%A5%DE%A5%F3%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

これらのコマンドは、主に対話的に使うもので、
テキストの字下げに基づいて動作します。
<P>

<A NAME="IDX2304"></A>
<DL>
<DT><U>コマンド:</U> <B>back-to-indentation</B>
<DD>このコマンドは、現在行（ポイントが位置する行）の
白文字でない最初の文字へポイントを移動する。
<CODE>nil</CODE>を返す。
</DL>
<P>

<A NAME="IDX2305"></A>
<DL>
<DT><U>コマンド:</U> <B>backward-to-indentation</B> <I>arg</I>
<DD>このコマンドは、<VAR>arg</VAR>行だけポイントを後方へ移動してから、
当該行の白文字でない最初の文字へポイントを移動する。
<CODE>nil</CODE>を返す。
</DL>
<P>

<A NAME="IDX2306"></A>
<DL>
<DT><U>コマンド:</U> <B>forward-to-indentation</B> <I>arg</I>
<DD>このコマンドは、<VAR>arg</VAR>行だけポイントを前方へ移動してから、
当該行の白文字でない最初の文字へポイントを移動する。
<CODE>nil</CODE>を返す。
</DL>
<P>

<A NAME="Case Changes"></A>
<HR SIZE="6">
<br><A NAME="SEC512"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC511"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC513"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Case Changes"></A>
<H2> 31.18 大文字小文字の変更 </H2>
<!--docid::SEC512::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Case%20Changes">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Case%20Changes</a>"<br>
"texi/elisp21/大文字小文字の変更"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C2%E7%CA%B8%BB%FA%BE%AE%CA%B8%BB%FA%A4%CE%CA%D1%B9%B9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2307"></A>
<P>

ここに述べる大文字小文字の変更コマンドは、
カレントバッファのテキストに作用します。
文字列や文字の大文字小文字を変換する関数については、
See 節 <A HREF="elisp_5.html#SEC79">4.8 Lispの大文字小文字変換</A>。
どの文字が大文字でどの文字が小文字であり、それらをどのように変換するかを
カスタマイズする方法については、See 節 <A HREF="elisp_5.html#SEC80">4.9 大文字小文字テーブル</A>。
<P>

<A NAME="IDX2308"></A>
<DL>
<DT><U>コマンド:</U> <B>capitalize-region</B> <I>start end</I>
<DD>この関数は、<VAR>start</VAR>と<VAR>end</VAR>で定義される領域内の
すべての単語をキャピタライズ（大文字で始まるように）する。
つまり、各単語の最初の文字を大文字に、残りの文字を小文字に変換する。
この関数は<CODE>nil</CODE>を返す。
<P>

領域の端が単語の途中にあると、
その単語の領域内の部分を1つの単語とみなす。
<P>

<CODE>capitalize-region</CODE>を対話的に呼び出すと、
<VAR>start</VAR>と<VAR>end</VAR>はポイントとマークであり、小さいほうがさきにくる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
This is the contents of the 5th foo.
---------- Buffer: foo ----------

(capitalize-region 1 44)
=> nil

---------- Buffer: foo ----------
This Is The Contents Of The 5th Foo.
---------- Buffer: foo ----------
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2309"></A>
<DL>
<DT><U>コマンド:</U> <B>downcase-region</B> <I>start end</I>
<DD>この関数は、<VAR>start</VAR>と<VAR>end</VAR>で定義される領域内の
すべての文字を小文字に変換する。
この関数は<CODE>nil</CODE>を返す。
<P>

<CODE>downcase-region</CODE>を対話的に呼び出すと、
<VAR>start</VAR>と<VAR>end</VAR>はポイントとマークであり、小さいほうが先にくる。
</DL>
<P>

<A NAME="IDX2310"></A>
<DL>
<DT><U>コマンド:</U> <B>upcase-region</B> <I>start end</I>
<DD>この関数は、<VAR>start</VAR>と<VAR>end</VAR>で定義される領域内の
すべての文字を大文字に変換する。
この関数は<CODE>nil</CODE>を返す。
<P>

<CODE>upcase-region</CODE>を対話的に呼び出すと、
<VAR>start</VAR>と<VAR>end</VAR>はポイントとマークであり、小さいほうが先にくる。
</DL>
<P>

<A NAME="IDX2311"></A>
<DL>
<DT><U>コマンド:</U> <B>capitalize-word</B> <I>count</I>
<DD>この関数は、ポイントのうしろの<VAR>count</VAR>個の単語を
キャピタライズ（大文字で始まるように）し、ポイントをそれらの末尾に移動する。
つまり、各単語の最初の文字を大文字に、残りの文字を小文字に変換する。
<VAR>count</VAR>が負であると、まえの-<VAR>count</VAR>個の単語を
大文字で始まるようにするが、ポイントは移動しない。
値は<CODE>nil</CODE>である。
<P>

ポイントが単語の途中にあると、単語を前方へ移動するときには
ポイントよりまえにある単語の部分を無視する。
単語の残りの部分を1つの単語として扱う。
<P>

<CODE>capitalize-word</CODE>を対話的に呼び出すと、
<VAR>count</VAR>は数値前置引数である。
</DL>
<P>

<A NAME="IDX2312"></A>
<DL>
<DT><U>コマンド:</U> <B>downcase-word</B> <I>count</I>
<DD>この関数は、ポイントのうしろの<VAR>count</VAR>個の単語を
すべて小文字に替え、ポイントをそれらの末尾に移動する。
<VAR>count</VAR>が負であると、まえの-<VAR>count</VAR>個の単語を
変換するが、ポイントは移動しない。
値は<CODE>nil</CODE>である。
<P>

<CODE>downcase-word</CODE>を対話的に呼び出すと、
<VAR>count</VAR>は数値前置引数である。
</DL>
<P>

<A NAME="IDX2313"></A>
<DL>
<DT><U>コマンド:</U> <B>upcase-word</B> <I>count</I>
<DD>この関数は、ポイントのうしろの<VAR>count</VAR>個の単語を
すべて大文字に替え、ポイントをそれらの末尾に移動する。
<VAR>count</VAR>が負であると、まえの-<VAR>count</VAR>個の単語を
変換するが、ポイントは移動しない。
値は<CODE>nil</CODE>である。
<P>

<CODE>upcase-word</CODE>を対話的に呼び出すと、
<VAR>count</VAR>は数値前置引数である。
</DL>
<P>

<A NAME="Text Properties"></A>
<HR SIZE="6">
<br><A NAME="SEC513"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC512"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC514"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Text Properties"></A>
<H2> 31.19 テキスト属性 </H2>
<!--docid::SEC513::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Text%20Properties">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Text%20Properties</a>"<br>
"texi/elisp21/テキスト属性"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%C2%B0%C0%AD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2314"></A>
<A NAME="IDX2315"></A>
<P>

シンボルの属性リスト（see 節 <A HREF="elisp_8.html#SEC105">7.4 属性リスト</A>）のように、
バッファや文字列の各文字には<EM>テキスト属性リスト</EM>
（text property list）を持てます。
この属性は、（本節の原文のタイトルの）文字`<SAMP>T</SAMP>'や
`<SAMP>foo</SAMP>'の最初の`<SAMP>o</SAMP>'のような特定の箇所の特定の文字に属します。
同じ文字が異なる箇所に現れるとき、
一般にはそれぞれに異なる属性を持てます。
<P>

各属性には、名前と値があります。
どちらも任意のLispオブジェクトでかまいませんが、
名前は普通はシンボルです。
属性リストを参照する普通の方法では、
名前を指定してそれに対応する値を問い合わせます。
<P>

文字に属性<CODE>category</CODE>があるとき、
それを文字の<EM>カテゴリ</EM>（category）といいます。
それはシンボルであるべきです。
そのシンボルの属性が、文字の属性のデフォルトとして働きます。
<P>

文字列とバッファのあいだでテキストをコピーすると、
文字とともにその属性も保たれます。
<CODE>substring</CODE>、<CODE>insert</CODE>、<CODE>buffer-substring</CODE>などの
さまざまな関数がそうします。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC514">31.19.1 テキスト属性を調べる</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Looking at the properties of one character.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC515">31.19.2 テキスト属性の変更</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Setting the properties of a range of text.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC516">31.19.3 テキスト属性を探す関数</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Searching for where a property changes value.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC517">31.19.4 特別な意味を持つ属性</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Particular properties with special meanings.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC518">31.19.5 整形済みテキストの属性</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Properties for representing formatting of text.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC519">31.19.6 テキスト属性のスティッキ性</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How inserted text gets properties from
                                  neighboring text.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC520">31.19.7 テキスト属性をファイルへ保存する</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Saving text properties in files, and reading
                                  them back.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC521">31.19.8 テキスト属性の遅延計算</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Computing text properties in a lazy fashion
                                  only when text is examined.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC522">31.19.9 クリック可能なテキストを定義する</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Using text properties to make regions of text
                                  do something when you click on them.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_32.html#SEC523">31.19.10 テキスト属性が範囲でない理由</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Why text properties do not use
				  Lisp-visible text intervals.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Examining Properties"></A>
<HR SIZE="6">
<br><A NAME="SEC514"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC513"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC515"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Examining Properties"></A>
<H3> 31.19.1 テキスト属性を調べる </H3>
<!--docid::SEC514::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Examining%20Properties">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Examining%20Properties</a>"<br>
"texi/elisp21/テキスト属性を調べる"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%C2%B0%C0%AD%A4%F2%C4%B4%A4%D9%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

テキスト属性を調べるもっとも簡単な方法は、
特定の文字の特定の属性の値を問い合わせることです。
それには、<CODE>get-text-property</CODE>を使います。
文字の属性リスト全体を取得するには<CODE>text-properties-at</CODE>を使います。
複数の文字の属性を一度に調べるための関数については、
See 節 <A HREF="elisp_32.html#SEC516">31.19.3 テキスト属性を探す関数</A>。
<P>

これらの関数は、文字列とバッファの両方を扱えます。
文字列内の位置は0から始まり、
バッファ内の位置は1から始まることに注意してください。
<P>

<A NAME="IDX2316"></A>
<DL>
<DT><U>Function:</U> <B>get-text-property</B> <I>pos prop &#38;optional object</I>
<DD>この関数は、<VAR>object</VAR>（バッファか文字列）内の位置<VAR>pos</VAR>の
うしろの1文字の属性<VAR>prop</VAR>の値を返す。
引数<VAR>object</VAR>は省略でき、
デフォルトはカレントバッファである。
<P>

その文字に属性<VAR>prop</VAR>がなくてもシンボルであるカテゴリがあれば、
<CODE>get-text-property</CODE>は当該シンボルの属性<VAR>prop</VAR>を返す。
</DL>
<P>

<A NAME="IDX2317"></A>
<DL>
<DT><U>Function:</U> <B>get-char-property</B> <I>pos prop &#38;optional object</I>
<DD>この関数は<CODE>get-text-property</CODE>に似ているが、
まずオーバレイを調べてからテキスト属性を調べる。
see 節 <A HREF="elisp_38.html#SEC607">37.8 オーバレイ</A>。
<P>

引数<VAR>object</VAR>は、文字列、バッファ、ウィンドウのいずれかである。
ウィンドウであると、そのウィンドウに表示しているバッファの
テキスト属性とオーバレイを対象にするが、
対象となるオーバレイはそのウィンドウに対して活性なものだけである。
<VAR>object</VAR>がバッファであると、テキスト属性に加えて
そのバッファのすべてのオーバレイを対象にする。
<VAR>object</VAR>が文字列であると、
文字列にはオーバレイはないので、テキスト属性のみを対象にする。
</DL>
<P>

<A NAME="IDX2318"></A>
<DL>
<DT><U>Function:</U> <B>text-properties-at</B> <I>position &#38;optional object</I>
<DD>この関数は、文字列やバッファである<VAR>object</VAR>内の
位置<VAR>position</VAR>にある1文字の属性リスト全体を返す。
<VAR>object</VAR>が<CODE>nil</CODE>であると、デフォルトはカレントバッファである。
</DL>
<P>

<A NAME="IDX2319"></A>
<DL>
<DT><U>Variable:</U> <B>default-text-properties</B>
<DD>この変数は、テキスト属性のデフォルト値を与える属性リストを保持する。
直接的にもカテゴリシンボルを介して間接的にも
文字に属性の値が指定されていないと、
このリストに収めた値をかわりに使う。
つぎに例を示す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(setq default-text-properties '(foo 69))
;; 位置1の文字に属性がないことを保証する
(set-text-properties 1 2 nil)
;; 問い合わせたときに見えるのはデフォルト値である
(get-text-property 1 'foo)
     => 69
</pre></td></tr></table></DL>
<P>

<A NAME="Changing Properties"></A>
<HR SIZE="6">
<br><A NAME="SEC515"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC514"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC516"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Changing Properties"></A>
<H3> 31.19.2 テキスト属性の変更 </H3>
<!--docid::SEC515::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Changing%20Properties">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Changing%20Properties</a>"<br>
"texi/elisp21/テキスト属性の変更"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%C2%B0%C0%AD%A4%CE%CA%D1%B9%B9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

属性を変更する基本関数は、バッファや文字列の指定した範囲に作用します。
関数<CODE>set-text-properties</CODE>（本節の最後）は、
その範囲のテキストの属性リスト全体を設定します。
これは、名前で指定した特定の属性のみを追加／変更／削除するのに
しばしば有用です。
<P>

テキスト属性はバッファ（や文字列）の一部分であるとみなされ、
スクリーン上でのバッファの見た目に影響するので、
バッファのテキスト属性を変更すると、
バッファには変更済みの印を付けます。
バッファのテキスト属性の変更もアンドゥ（see 節 <A HREF="elisp_32.html#SEC497">31.9 アンドゥ</A>）できます。
<P>

<A NAME="IDX2320"></A>
<DL>
<DT><U>Function:</U> <B>put-text-property</B> <I>start end prop value &#38;optional object</I>
<DD>この関数は、文字列やバッファである<VAR>object</VAR>内の
<VAR>start</VAR>と<VAR>end</VAR>のあいだのテキストの属性<VAR>prop</VAR>の値を
<VAR>value</VAR>とする。
<VAR>object</VAR>が<CODE>nil</CODE>であると、デフォルトはカレントバッファである。
</DL>
<P>

<A NAME="IDX2321"></A>
<DL>
<DT><U>Function:</U> <B>add-text-properties</B> <I>start end props &#38;optional object</I>
<DD>この関数は、文字列やバッファである<VAR>object</VAR>内の
<VAR>start</VAR>と<VAR>end</VAR>のあいだのテキストの
テキスト属性に追加／上書きする。
<VAR>object</VAR>が<CODE>nil</CODE>であると、デフォルトはカレントバッファである。
<P>

引数<VAR>props</VAR>で追加する属性を指定する。
これは属性リスト（see 節 <A HREF="elisp_8.html#SEC105">7.4 属性リスト</A>）の形であること。
つまり、属性名とその値を交互に並べたリストであること。
<P>

この関数が属性の値をどれか実際に変更したならば、戻り値は<CODE>t</CODE>である。
さもなければ（<VAR>props</VAR>が<CODE>nil</CODE>だったり、
テキスト内の値と同じ値であると）<CODE>nil</CODE>である。
<P>

たとえば、テキストのある範囲の属性<CODE>comment</CODE>と<CODE>face</CODE>を
設定するにはつぎのようにする。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(add-text-properties <VAR>start</VAR> <VAR>end</VAR>
                     '(comment t face highlight))
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2322"></A>
<DL>
<DT><U>Function:</U> <B>remove-text-properties</B> <I>start end props &#38;optional object</I>
<DD>この関数は、文字列やバッファである<VAR>object</VAR>内の
<VAR>start</VAR>と<VAR>end</VAR>のあいだのテキストから
指定したテキスト属性を削除する。
<VAR>object</VAR>が<CODE>nil</CODE>であると、デフォルトはカレントバッファである。
<P>

引数<VAR>props</VAR>で削除する属性を指定する。
これは属性リスト（see 節 <A HREF="elisp_8.html#SEC105">7.4 属性リスト</A>）の形であること。
つまり、属性名とその値を交互に並べたリストであること。
ただし、意味があるのは名前のみであり、その値は無視する。
たとえば、属性<CODE>face</CODE>を削除するにはつぎのようにする。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(remove-text-properties <VAR>start</VAR> <VAR>end</VAR> '(face nil))
</pre></td></tr></table><P>

この関数が属性の値をどれか実際に変更したならば、戻り値は<CODE>t</CODE>である。
さもなければ（<VAR>props</VAR>が<CODE>nil</CODE>だったり、
指定したテキスト内の文字にそれらのいずれの属性もなければ）
<CODE>nil</CODE>である。
<P>

特定のテキストからすべてのテキスト属性を削除するには、
新たな属性リストとして<CODE>nil</CODE>を指定して
<CODE>set-text-properties</CODE>を使う。
</DL>
<P>

<A NAME="IDX2323"></A>
<DL>
<DT><U>Function:</U> <B>set-text-properties</B> <I>start end props &#38;optional object</I>
<DD>この関数は、文字列やバッファである<VAR>object</VAR>内の
<VAR>start</VAR>と<VAR>end</VAR>のあいだのテキストのテキスト属性を完全に置き換える。
<VAR>object</VAR>が<CODE>nil</CODE>であると、
デフォルトはカレントバッファである。
<P>

引数<VAR>props</VAR>は新たな属性リストである。
これは、属性名とその値を交互に並べたリストであること。
<P>

<CODE>set-text-properties</CODE>から戻ると、
指定した範囲のすべての文字は同一の属性を持つことになる。
<P>

<VAR>props</VAR>が<CODE>nil</CODE>であると、
テキストの指定した範囲からすべての属性を削除する効果がある。
たとえば、つぎのようにする。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(set-text-properties <VAR>start</VAR> <VAR>end</VAR> nil)
</pre></td></tr></table></DL>
<P>

バッファからテキストをコピーするがその属性はコピーしない
関数<CODE>buffer-substring-no-properties</CODE>（see 節 <A HREF="elisp_32.html#SEC485">31.2 バッファの内容を調べる</A>）も
参照してください。
<P>

<A NAME="Property Search"></A>
<HR SIZE="6">
<br><A NAME="SEC516"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC515"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC517"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Property Search"></A>
<H3> 31.19.3 テキスト属性を探す関数 </H3>
<!--docid::SEC516::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Property%20Search">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Property%20Search</a>"<br>
"texi/elisp21/テキスト属性を探す関数"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%C2%B0%C0%AD%A4%F2%C3%B5%A4%B9%B4%D8%BF%F4">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

テキスト属性の典型的な用途では、
ほとんどの場合多くの連続した文字の1つの属性には同じ値があります。
1つずつ文字を調べるようにプログラムするよりは、
同じ属性値を持つテキストの塊を処理するほうがとても速いです。
<P>

このために使える関数をここで説明します。
これらは属性値の比較に<CODE>eq</CODE>を使います。
<VAR>object</VAR>のデフォルトは、すべての場合でカレントバッファです。
<P>

高い効率のためには、これらの関数に引数<VAR>limit</VAR>を使うことが重要であり、
1つの属性を探す関数には特にあてはまります。
さもないと、読者が望む属性が変更されないような場合、
それらの関数はバッファの末尾まで走査して長い時間を費すことになります。
<P>

これらの関数はポイントを移動しませんが、そのかわりに
位置（あるいは<CODE>nil</CODE>）を返します。
位置はつねに2つの文字のあいだにあることに注意してください。
これらの関数が返す位置は、異なる属性を持つ2つの文字のあいだです。
<P>

<A NAME="IDX2324"></A>
<DL>
<DT><U>Function:</U> <B>next-property-change</B> <I>pos &#38;optional object limit</I>
<DD>この関数は、文字列やバッファである<VAR>object</VAR>内の位置<VAR>pos</VAR>から
テキスト属性のいずれかが異なるまでテキストを走査し、その変化する位置を返す。
いいかえれば、<VAR>pos</VAR>の直後の文字のテキスト属性とは異なる
属性を持つ<VAR>pos</VAR>のあとにある最初の文字の位置を返す。
<P>

<VAR>limit</VAR>が<CODE>nil</CODE>以外であると、<VAR>limit</VAR>の位置で走査を終える。
その箇所まで異なる属性がないと、
<CODE>next-property-change</CODE>は<VAR>limit</VAR>を返す。
<P>

<VAR>limit</VAR>が<CODE>nil</CODE>であり<VAR>object</VAR>の末尾まで属性に変化がないと、
値は<CODE>nil</CODE>である。
値が<CODE>nil</CODE>以外であると、それは<VAR>pos</VAR>より大きいか等しい位置である。
値が<VAR>pos</VAR>に等しいのは、<VAR>limit</VAR>が<VAR>pos</VAR>に等しい場合のみである。
<P>

バッファからすべての属性が同じであるテキストの塊を
走査する方法の例をつぎに示す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(while (not (eobp))
  (let ((plist (text-properties-at (point)))
        (next-change
         (or (next-property-change (point) (current-buffer))
             (point-max))))
    ポイントから<VAR>next-change</VAR>までのテキストを処理する<small>...</small>
    (goto-char next-change)))
</FONT></pre></td></tr></table></DL>
<P>

<A NAME="IDX2325"></A>
<DL>
<DT><U>Function:</U> <B>next-single-property-change</B> <I>pos prop &#38;optional object limit</I>
<DD>この関数は、文字列やバッファである<VAR>object</VAR>内の位置<VAR>pos</VAR>から
属性<VAR>prop</VAR>が異なるまでテキストを走査し、その変化する位置を返す。
いいかえれば、<VAR>pos</VAR>の直後の文字の属性<VAR>prop</VAR>とは異なる
属性<VAR>prop</VAR>をもつ<VAR>pos</VAR>のあとにある最初の文字の位置を返す。
<P>

<VAR>limit</VAR>が<CODE>nil</CODE>以外であると、<VAR>limit</VAR>の位置で走査を終える。
その箇所まで異なる属性がないと、
<CODE>next-single-property-change</CODE>は<VAR>limit</VAR>を返す。
<P>

<VAR>limit</VAR>が<CODE>nil</CODE>であり<VAR>object</VAR>の末尾まで属性に変化がないと、
値は<CODE>nil</CODE>である。
値が<CODE>nil</CODE>以外であると、それは<VAR>pos</VAR>より大きいか等しい位置である。
値が<VAR>pos</VAR>に等しいのは、<VAR>limit</VAR>が<VAR>pos</VAR>に等しい場合のみである。
</DL>
<P>

<A NAME="IDX2326"></A>
<DL>
<DT><U>Function:</U> <B>previous-property-change</B> <I>pos &#38;optional object limit</I>
<DD>これは<CODE>next-property-change</CODE>と同様であるが、
前方へではなく<VAR>pos</VAR>から後方へ走査する。
値が<CODE>nil</CODE>以外であると、それは<VAR>pos</VAR>より小さいか等しい位置である。
値が<VAR>pos</VAR>に等しいのは、<VAR>limit</VAR>が<VAR>pos</VAR>に等しい場合のみである。
</DL>
<P>

<A NAME="IDX2327"></A>
<DL>
<DT><U>Function:</U> <B>previous-single-property-change</B> <I>pos prop &#38;optional object limit</I>
<DD>これは<CODE>next-single-property-change</CODE>と同様であるが、
前方へではなく<VAR>pos</VAR>から後方へ走査する。
値が<CODE>nil</CODE>以外であると、それは<VAR>pos</VAR>より小さいか等しい位置である。
値が<VAR>pos</VAR>に等しいのは、<VAR>limit</VAR>が<VAR>pos</VAR>に等しい場合のみである。
</DL>
<P>

<A NAME="IDX2328"></A>
<DL>
<DT><U>Function:</U> <B>next-char-property-change</B> <I>position &#38;optional limit</I>
<DD><A NAME="IDX2329"></A>
これは<CODE>next-property-change</CODE>と同様であるが、
テキスト属性に加えてオーバレイも対象にする。
この関数はカレントバッファにのみ作用するため、
<VAR>object</VAR>を表す引数はない。
どちらかの属性が異なるつぎの位置を返す。
</DL>
<P>

<A NAME="IDX2330"></A>
<DL>
<DT><U>Function:</U> <B>previous-char-property-change</B> <I>position &#38;optional limit</I>
<DD><A NAME="IDX2331"></A>
これは<CODE>next-char-property-change</CODE>と同様であるが、
前方へではなく<VAR>pos</VAR>から後方へ走査する。
</DL>
<P>

<A NAME="IDX2332"></A>
<DL>
<DT><U>Function:</U> <B>text-property-any</B> <I>start end prop value &#38;optional object</I>
<DD><VAR>start</VAR>と<VAR>end</VAR>のあいだに属性<VAR>prop</VAR>の値が<VAR>value</VAR>である
文字が1つでもあれば、この関数は<CODE>nil</CODE>以外を返す。
より正確には、そのような最初の文字の位置を返す。
さもなければ<CODE>nil</CODE>を返す。
<P>

省略可能な5番目の引数<VAR>object</VAR>は、走査すべき文字列やバッファを指定する。
位置は<VAR>object</VAR>に相対である。
<VAR>object</VAR>のデフォルトはカレントバッファである。
</DL>
<P>

<A NAME="IDX2333"></A>
<DL>
<DT><U>Function:</U> <B>text-property-not-all</B> <I>start end prop value &#38;optional object</I>
<DD><VAR>start</VAR>と<VAR>end</VAR>のあいだに属性<VAR>prop</VAR>の値が<VAR>value</VAR>でない
文字が1つでもあれば、この関数は<CODE>nil</CODE>以外を返す。
より正確には、そのような最初の文字の位置を返す。
さもなければ<CODE>nil</CODE>を返す。
<P>

省略可能な5番目の引数<VAR>object</VAR>は、走査すべき文字列やバッファを指定する。
位置は<VAR>object</VAR>に相対である。
<VAR>object</VAR>のデフォルトはカレントバッファである。
</DL>
<P>

<A NAME="Special Properties"></A>
<HR SIZE="6">
<br><A NAME="SEC517"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC516"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC518"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Special Properties"></A>
<H3> 31.19.4 特別な意味を持つ属性 </H3>
<!--docid::SEC517::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Special%20Properties">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Special%20Properties</a>"<br>
"texi/elisp21/特別な意味を持つ属性"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C6%C3%CA%CC%A4%CA%B0%D5%CC%A3%A4%F2%BB%FD%A4%C4%C2%B0%C0%AD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

特別な組み込みの意味を持つテキスト属性名の一覧を以下に示します。
以降の節では、詰め込みや属性の継承を制御する特別な属性名も示します。
それ以外の名前には標準的な意味はないので、
読者はそれらを好きなように使ってかまいません。
<P>

<DL COMPACT>
<A NAME="IDX2334"></A>
<A NAME="IDX2335"></A>
<DT><CODE>category</CODE>
<DD>文字に属性<CODE>category</CODE>があるとき、
これを文字の<EM>カテゴリ</EM>（category）と呼ぶ。
これはシンボルであること。
そのシンボルの属性が、文字の属性のデフォルトとして働く。
<P>

<DT><CODE>face</CODE>
<DD><A NAME="IDX2336"></A>
<A NAME="IDX2337"></A>
テキストのフォントと表示色を制御するために属性<CODE>face</CODE>を使う。
その値はフェイス名かフェイス名のリストである。
詳しくは、see 節 <A HREF="elisp_38.html#SEC611">37.10 フェイス</A>。
<P>

属性値がリストであると、その要素は、
<CODE>(foreground-color . <VAR>color-name</VAR>)</CODE>や
<CODE>(background-color . <VAR>color-name</VAR>)</CODE>の形でもよい。
これらの要素は、前景色だけや背景色だけを指定する。
したがって、使用する各色を表すフェイスを作成する必要はない。
<P>

テキストの内容に基づいて属性<CODE>face</CODE>を自動的に更新する方法に関しては、
see 節 <A HREF="elisp_23.html#SEC355">22.5 フォントロック（font-lock）モード</A>。
<P>

<DT><CODE>mouse-face</CODE>
<DD><A NAME="IDX2338"></A>
マウスが文字の上やその近くにあると、属性<CODE>face</CODE>のかわりに
属性<CODE>mouse-face</CODE>が使われる。
この目的において『近く』とは、
文字とマウスの位置のあいだの
属性<CODE>mouse-face</CODE>の値が同じであるすべてのテキストである。
<P>

<DT><CODE>local-map</CODE>
<DD><A NAME="IDX2339"></A>
<A NAME="IDX2340"></A>
<A NAME="IDX2341"></A>
属性<CODE>local-map</CODE>を用いることで、
バッファ内のテキストの一部分に対して別のキーマップを指定できる。
ポイントのうしろの文字のこの属性の値が<CODE>nil</CODE>以外であると、
バッファのローカルマップのかわりにその値をキー探索に使う。
属性値がシンボルであると、シンボルの関数定義をキーマップとして使う。
see 節 <A HREF="elisp_22.html#SEC323">21.6 活性なキーマップ</A>。
<P>

<DT><CODE>syntax-table</CODE>
<DD>属性<CODE>syntax-table</CODE>は、構文テーブルがこの文字に指定するものに優先する。
see 節 <A HREF="elisp_35.html#SEC570">34.4 構文属性</A>。
<P>

<DT><CODE>read-only</CODE>
<DD><A NAME="IDX2342"></A>
<A NAME="IDX2343"></A>
文字に属性<CODE>read-only</CODE>があると、その文字を変更できない。
変更するどのようなコマンドもエラーになる。
<P>

挿入されるテキストがスティッキ性のために属性<CODE>read-only</CODE>を
継承する場合には、読み出し専用文字のつぎにテキストを挿入するとエラーになる。
したがって、スティッキ性を制御することで、
読み出し専用テキストのつぎへのテキスト挿入を許すかどうかを制御できる。
see 節 <A HREF="elisp_32.html#SEC519">31.19.6 テキスト属性のスティッキ性</A>。
<P>

属性を変更するとバッファを変更したとみなすため、
特別なトリックを知らない限り、属性を<CODE>read-only</CODE>を削除できない。
つまり、<CODE>inhibit-read-only</CODE>に<CODE>nil</CODE>以外の値を束縛して、
属性を削除する。
see 節 <A HREF="elisp_27.html#SEC410">26.7 読み出し専用バッファ <EM>(2003/10/30)</EM></A>。
<P>

<DT><CODE>invisible</CODE>
<DD><A NAME="IDX2344"></A>
属性<CODE>invisible</CODE>が<CODE>nil</CODE>以外であると、
その文字はスクリーンに表示されない。
詳しくは、see 節 <A HREF="elisp_38.html#SEC603">37.4 不可視なテキスト</A>。
<P>

<DT><CODE>intangible</CODE>
<DD><A NAME="IDX2345"></A>
連続する文字に属性<CODE>intangible</CODE>の<CODE>nil</CODE>でない同じ値があると、
それらのあいだにポイントを置けなくなる。
前方に向けてこれらの文字の中にポイントを移動しようとすると、
ポイントは実際にはそれらの末尾へ移動する。
後方に向けてこれらの文字の中にポイントを移動しようとすると、
ポイントは実際にはそれらの先頭へ移動する。
<P>

変数<CODE>inhibit-point-motion-hooks</CODE>が<CODE>nil</CODE>以外であると、
属性<CODE>intangible</CODE>は無視される。
<P>

<DT><CODE>modification-hooks</CODE>
<DD><A NAME="IDX2346"></A>
<A NAME="IDX2347"></A>
<A NAME="IDX2348"></A>
文字に属性<CODE>modification-hooks</CODE>がある場合、それは関数のリストであること。
その文字の変更にはそれらの関数すべてが呼び出される。
各関数は2つの引数、つまり、バッファの変更対象部分の先頭と末尾を受け取る。
1つの操作で変更される一連の文字に同じ変更フック関数が現れる場合、
関数が実際に何回呼ばれるか予測できないことに注意してほしい。
<P>

<DT><CODE>insert-in-front-hooks</CODE>
<DD><DT><CODE>insert-behind-hooks</CODE>
<DD><A NAME="IDX2349"></A>
<A NAME="IDX2350"></A>
バッファにテキストを挿入する操作でも、
挿入箇所のうしろの文字の属性<CODE>insert-in-front-hooks</CODE>と
まえの文字の属性<CODE>insert-behind-hooks</CODE>に指定されている
関数群を呼び出す。
これらの関数は2つの引数、つまり、挿入されたテキストの先頭と末尾を受け取る。
これらの関数が呼ばれるのは、実際の挿入操作を<EM>終えてから</EM>である。
<P>

バッファ内のテキストを変更するときに呼び出される他のフックについては、
<A HREF="elisp_32.html#SEC527">31.23 変更フック</A>も参照。
<P>

<DT><CODE>point-entered</CODE>
<DD><DT><CODE>point-left</CODE>
<DD><A NAME="IDX2351"></A>
<A NAME="IDX2352"></A>
<A NAME="IDX2353"></A>
特別な属性<CODE>point-entered</CODE>と<CODE>point-left</CODE>は、
ポイント移動を報告するフック関数を保持する。
ポイントが動くたびに、Emacsはこれらの2つの属性値、つまり、
<P>

<UL>
<LI>
移動前のポイントのうしろの文字の属性<CODE>point-left</CODE>と
<LI>
移動後のポイントのうしろの文字の属性<CODE>point-entered</CODE>
</UL>
<P>

を比較する。
これら2つの値が異なれば、
ポイントの古い値と新しい値の2つの引数で（<CODE>nil</CODE>でなければ）
それぞれを呼び出す。
<P>

同じことを移動前後のポイントのまえの文字についても行う。
その結果、（同じかもしれない）<CODE>point-left</CODE>の関数を2回、かつ／あるいは、
（同じかもしれない）<CODE>point-entered</CODE>の関数を2回実行する。
いずれにしても、<CODE>point-left</CODE>の関数が最初に呼ばれ、
そのあとで<CODE>point-entered</CODE>の関数が呼ばれる。
<P>

これらの関数では、<CODE>char-after</CODE>を使って
ポイントを移動せずにさまざまな箇所の文字を調べられる。
ポイントの値が実際に変わったときにのみ、これらのフック関数が実行される。
</DL>
<P>

<A NAME="IDX2354"></A>
<DL>
<DT><U>Variable:</U> <B>inhibit-point-motion-hooks</B>
<DD>この変数が<CODE>nil</CODE>以外であると、
<CODE>point-left</CODE>と<CODE>point-entered</CODE>のフック関数は実行されなくなり、
属性<CODE>intangible</CODE>の効果もなくなる。
この変数はグローバルに設定せずに、<CODE>let</CODE>で束縛すること。
</DL>
<P>

<A NAME="Format Properties"></A>
<HR SIZE="6">
<br><A NAME="SEC518"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC517"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC519"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Format Properties"></A>
<H3> 31.19.5 整形済みテキストの属性 </H3>
<!--docid::SEC518::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Format%20Properties">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Format%20Properties</a>"<br>
"texi/elisp21/整形済みテキストの属性"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C0%B0%B7%C1%BA%D1%A4%DF%A5%C6%A5%AD%A5%B9%A5%C8%A4%CE%C2%B0%C0%AD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

これらのテキスト属性は、詰め込みコマンドのふるまいに影響します。
これらは整形済みのテキストを表現するために使われます。
<A HREF="elisp_32.html#SEC499">31.11 詰め込み</A>とSee 節 <A HREF="elisp_32.html#SEC500">31.12 詰め込みのための余白</A>。
<P>

<DL COMPACT>
<DT><CODE>hard</CODE>
<DD>改行文字にこの属性があると、『ハード』改行である。
詰め込みコマンドは『ハード』改行を変更せず、
それらをまたがって単語を移動しない。
しかし、この属性は<CODE>use-hard-newlines</CODE>が
<CODE>nil</CODE>以外の場合にのみ効果を持つ。
<P>

<DT><CODE>right-margin</CODE>
<DD>テキストのこの部分を詰め込むための余分な右端余白を指定する。
<P>

<DT><CODE>left-margin</CODE>
<DD>テキストのこの部分を詰め込むための余分な左端余白を指定する。
<P>

<DT><CODE>justification</CODE>
<DD>テキストのこの部分を詰め込むための幅揃えスタイルを指定する。
</DL>
<P>

<A NAME="Sticky Properties"></A>
<HR SIZE="6">
<br><A NAME="SEC519"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC518"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC520"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Sticky Properties"></A>
<H3> 31.19.6 テキスト属性のスティッキ性 </H3>
<!--docid::SEC519::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Sticky%20Properties">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Sticky%20Properties</a>"<br>
"texi/elisp21/テキスト属性のスティッキ性"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%C2%B0%C0%AD%A4%CE%A5%B9%A5%C6%A5%A3%A5%C3%A5%AD%C0%AD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2355"></A>
<A NAME="IDX2356"></A>
<P>

自己挿入文字は、通常、先行する文字と同じ属性を持ちます。
これを属性の<EM>継承</EM>（inheritance）と呼びます。
<P>

Lispプログラムでは、挿入基本関数を選べば、
継承して挿入したり継承せずに挿入できます。
<CODE>insert</CODE>などの普通のテキスト挿入関数は、
いかなる属性も継承しません。
これらは、挿入する文字列の属性をそのまま持ったテキストを挿入し、
それ以外の属性はありません。
キルリングなどのある文脈から別の文脈へテキストをコピーするプログラムには、
これは正しい動作です。
継承して挿入するには、本節で述べる特別な基本関数を使います。
自己挿入文字はこれらの基本関数を使っているので、属性を継承します。
<P>

継承して挿入するとき、<EM>どの</EM>属性を継承するかは、
2つの特別な属性<CODE>front-sticky</CODE>と<CODE>rear-nonsticky</CODE>に依存します。
<P>

文字のうしろに挿入すると、その文字の<EM>後続スティッキ</EM>（rear-sticky）
である属性を継承します。
文字のまえに挿入すると、その文字の<EM>先行スティッキ</EM>（front-sticky）
である属性を継承します。
デフォルトでは、テキスト属性は先行スティッキではなく後続スティッキです。
したがって、デフォルトでは、まえの文字のすべての属性を継承して、
うしろの文字からはなにも継承しません。
特定の属性のスティッキ性を指定することで、異なるふるまいを指定できます。
<P>

文字の属性<CODE>front-sticky</CODE>が<CODE>t</CODE>であると、
その文字のすべての属性は先行スティッキです。
属性<CODE>front-sticky</CODE>がリストであると、
リストに現れる名前のその文字の属性は先行スティッキです。
たとえば、文字の属性<CODE>front-sticky</CODE>の値が<CODE>(face read-only)</CODE>であると、
この文字のまえに挿入するとこの文字の属性<CODE>face</CODE>と<CODE>read-only</CODE>を
継承しますが、それ以外には継承しません。
<P>

<CODE>rear-nonsticky</CODE>は反対の働きをします。
すべての属性はデフォルトでは後続スティッキですから、
属性<CODE>rear-nonsticky</CODE>はどの属性が
後続スティッキで<EM>ない</EM>かを指定します。
文字の属性<CODE>rear-nonsticky</CODE>が<CODE>t</CODE>であると、
その文字には後続スティッキである属性はありません。
属性<CODE>rear-nonsticky</CODE>がリストであると、
リストに名前が現れ<EM>ない限り</EM>、
属性は後続スティッキです。
<P>

継承するようにテキストを挿入すると、
まえの文字からは後続スティッキであるすべての属性を継承し、
うしろの文字からは先行スティッキであるすべての属性を継承します。
両側の文字に異なるスティッキ性の同じ属性がある場合には、
まえの文字の属性が優先します。
<P>

属性を継承してテキストを挿入する関数はつぎのとおりです。
<P>

<A NAME="IDX2357"></A>
<DL>
<DT><U>Function:</U> <B>insert-and-inherit</B> <I>&#38;rest strings</I>
<DD>関数<CODE>insert</CODE>と同様に文字列<VAR>strings</VAR>を挿入するが、
前後のテキストから任意のスティッキ性の属性を継承する。
</DL>
<P>

<A NAME="IDX2358"></A>
<DL>
<DT><U>Function:</U> <B>insert-before-markers-and-inherit</B> <I>&#38;rest strings</I>
<DD>関数<CODE>insert-before-markers</CODE>と同様に文字列<VAR>strings</VAR>を挿入するが、
前後のテキストから任意のスティッキ性の属性を継承する。
</DL>
<P>

継承しない普通の挿入関数については、See 節 <A HREF="elisp_32.html#SEC487">31.4 テキストの挿入</A>。
<P>

<A NAME="Saving Properties"></A>
<HR SIZE="6">
<br><A NAME="SEC520"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC519"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC521"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Saving Properties"></A>
<H3> 31.19.7 テキスト属性をファイルへ保存する </H3>
<!--docid::SEC520::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Saving%20Properties">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Saving%20Properties</a>"<br>
"texi/elisp21/テキスト属性をファイルへ保存する"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%C2%B0%C0%AD%A4%F2%A5%D5%A5%A1%A5%A4%A5%EB%A4%D8%CA%DD%C2%B8%A4%B9%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2359"></A>
<A NAME="IDX2360"></A>
<A NAME="IDX2361"></A>
<A NAME="IDX2362"></A>
<P>

つぎの2つのフックを使って、
テキスト属性を（テキストそのものとともに）ファイルに保存しておき、
ファイルを訪問したり挿入するときに同じテキスト属性を復元できます。
<P>

<A NAME="IDX2363"></A>
<DL>
<DT><U>Variable:</U> <B>write-region-annotate-functions</B>
<DD>この変数の値は、ファイルへ書き込むテキストに対する注記の形で
テキスト属性を符号化するために<CODE>write-region</CODE>が呼び出す関数の
リストである。
see 節 <A HREF="elisp_25.html#SEC375">24.4 ファイルへの書き出し</A>。
<P>

リスト内の各関数は2つの引数、つまり、
書き込む領域の先頭と末尾で呼び出される。
これらの関数はバッファの内容を変更しないこと。
そのかわりに、バッファのテキストに加えてファイルに書き込むべき
注記を表すリストを返すべきである。
<P>

各関数は、<CODE>(<VAR>position</VAR> . <VAR>string</VAR>)</CODE>の形の要素から成る
リストを返すべきである。
ここで、<VAR>position</VAR>は書き込まれるテキスト内の相対位置を指定する整数、
<VAR>string</VAR>はそこへ追加する注記である。
<P>

これらの関数が返す各リストは、<VAR>position</VAR>の昇順になっている必要がある。
複数の関数があると、<CODE>write-region</CODE>は
リストを破壊的に併合して1つのソートしたリストにする。
<P>

<CODE>write-region</CODE>がバッファからファイルにテキストを実際に書くときに、
指定された注記を対応する位置に混在させる。
バッファを変更せずにこれらすべてを行う。
</DL>
<P>

<A NAME="IDX2364"></A>
<DL>
<DT><U>Variable:</U> <B>after-insert-file-functions</B>
<DD>この変数は、<CODE>insert-file-contents</CODE>がファイルの内容を挿入してから
呼び出す関数のリストを保持する。
これらの関数は挿入されたテキストで注記を走査し、
それらが表すテキスト属性にそれらを変換する。
<P>

各関数は1つの引数、つまり、挿入されたテキストの長さで呼ばれ、
ポイントは挿入されたテキストの先頭を表す。
関数は当該テキストで注記を走査して注記を削除し、
注記が指定するテキスト属性を作成する。
関数は、変更を反映した挿入されたテキストの更新された長さを返すこと。
関数が返した値がつぎの関数の引数になる。
<P>

これらの関数は、挿入されたテキストの先頭にポイントをつねに戻すこと。
<P>

<CODE>after-insert-file-functions</CODE>の意図された用途は、
テキスト表現の注記を実際のテキスト属性に変換することである。
しかし、別の使い方も可能である。
</DL>
<P>

これらのフックを使ってファイルにテキスト属性を保存したり復元する
Lispプログラムを書いて、さまざまなデータ書式を試して
よいものをみつけるようにお願いします。
最終的には、Emacsに取り込める良質で汎用の拡張を
ユーザーが作り出すことを願っています。
<P>

テキスト属性の名前や値として任意のLispオブジェクトを
処理しないように忠告しておきます。
そのような汎用のプログラムは書くのが難しく動作が遅くなりがちです。
そのかわりに、適当に柔軟性があり符号化が難しくないデータ型の集合を選びます。
<P>

関連する機能については、See 節 <A HREF="elisp_25.html#SEC394">24.12 ファイル書式変換</A>。
<P>

<A NAME="Lazy Properties"></A>
<HR SIZE="6">
<br><A NAME="SEC521"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC520"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC522"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Lazy Properties"></A>
<H3> 31.19.8 テキスト属性の遅延計算 </H3>
<!--docid::SEC521::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Lazy%20Properties">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Lazy%20Properties</a>"<br>
"texi/elisp21/テキスト属性の遅延計算"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%C2%B0%C0%AD%A4%CE%C3%D9%B1%E4%B7%D7%BB%BB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

バッファ内のすべてのテキストのテキスト属性を計算するかわりに、
必要になった時点でテキストの一部分のテキスト属性を計算するようにできます。
<P>

バッファからテキスト属性とともにテキストを取り出す基本関数は、
<CODE>buffer-substring</CODE>です。
属性を調べるまえに、この関数はアブノーマルフック
<CODE>buffer-access-fontify-functions</CODE>を実行します。
<P>

<A NAME="IDX2365"></A>
<DL>
<DT><U>Variable:</U> <B>buffer-access-fontify-functions</B>
<DD>この変数は、テキスト属性を計算する関数のリストを保持する。
<CODE>buffer-substring</CODE>がバッファの一部分からテキストとテキスト属性を
コピーするまえに、この関数はこのリスト内の関数すべてを呼び出す。
各関数は、バッファの参照される範囲を指定する2つの引数を受け取る。
（バッファはつねにカレントバッファである。）
</DL>
<P>

関数<CODE>buffer-substring-no-properties</CODE>は
テキスト属性を無視するので、これらの関数を呼び出しません。
<P>

バッファの同じ部分に対してフック関数が複数回呼び出されるのを防ぐには、
変数<CODE>buffer-access-fontified-property</CODE>を使います。
<P>

<A NAME="IDX2366"></A>
<DL>
<DT><U>Variable:</U> <B>buffer-access-fontified-property</B>
<DD>この変数の値が<CODE>nil</CODE>以外であると、
それはテキスト属性の名前として使われるシンボルである。
そのテキスト属性に対する<CODE>nil</CODE>以外の値は、
『この文字の他のテキスト属性はすでに計算済みである』ことを意味する。
<P>

<CODE>buffer-substring</CODE>に指定された範囲のすべての文字において、
この属性に対して<CODE>nil</CODE>以外の値があると、
<CODE>buffer-substring</CODE>は
<CODE>buffer-access-fontify-functions</CODE>の関数を呼び出さない。
それらの文字にはすでに正しいテキスト属性があるとみなし、
それらにすでにある属性をコピーする。
<P>

この機能を使う普通の方法は、
<CODE>buffer-access-fontify-functions</CODE>の関数が
他の属性ととともにこの属性をそれらが操作した文字に追加する。
そうすれば、同じテキストに対して何回も呼び出されるのを防ぐことができる。
</DL>
<P>

<A NAME="Clickable Text"></A>
<HR SIZE="6">
<br><A NAME="SEC522"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC521"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC523"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Clickable Text"></A>
<H3> 31.19.9 クリック可能なテキストを定義する </H3>
<!--docid::SEC522::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Clickable%20Text">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Clickable%20Text</a>"<br>
"texi/elisp21/クリック可能なテキストを定義する"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AF%A5%EA%A5%C3%A5%AF%B2%C4%C7%BD%A4%CA%A5%C6%A5%AD%A5%B9%A5%C8%A4%F2%C4%EA%B5%C1%A4%B9%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2367"></A>
<P>

バッファ内に<EM>クリック可能なテキスト</EM>（clickable text）を設定するには
2つの方法があります。
これは典型的には2つの部分から成ります。
つまり、マウスが重なるとテキストを強調表示し、
テキストのその部分をクリックすると
マウスボタンがなんらかの処理を行うようにします。
<P>

強調表示はテキスト属性<CODE>mouse-face</CODE>で行います。
diredでの方法を例として示します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(condition-case nil
    (if (dired-move-to-filename)
        (put-text-property (point)
                           (save-excursion
                             (dired-move-to-end-of-filename)
                             (point))
                           'mouse-face 'highlight))
  (error nil))
</FONT></pre></td></tr></table><P>

<CODE>put-text-property</CODE>の最初の2つの引数は、
テキストの先頭と末尾を指定します。
<P>

このテキストをクリックしたときにマウスになにかをさせるようにする
普通の方法は、メジャーモードのキーマップで<CODE>mouse-2</CODE>を定義することです。
クリック可能なテキストをクリックしたかどうかの検査は、
コマンド定義で行われます。
diredではつぎのようにしています。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(defun dired-mouse-find-file-other-window (event)
  "In dired, visit the file or directory name you click on."
  (interactive "e")
  (let (file)
    (save-excursion
      (set-buffer (window-buffer (posn-window (event-end event))))
      (save-excursion
        (goto-char (posn-point (event-end event)))
        (setq file (dired-get-filename))))
    (select-window (posn-window (event-end event)))
    (find-file-other-window (file-name-sans-versions file t))))
</FONT></pre></td></tr></table><P>

外側の<CODE>save-excursion</CODE>は、カレントバッファが変わることを防ぎます。
内側のは、クリックしたバッファのポイントを恒久的に変更することを防ぎます。
この例では、diredは関数<CODE>dired-get-filename</CODE>を用いて、
イベントの位置に基づいて訪問すべきファイルを決定します。
<P>

メジャーモードのマウスコマンドを定義するかわりに、
テキスト属性<CODE>local-map</CODE>を使って、
クリック可能なテキストそのものにキーバインディングを定義することもできます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(let ((map (make-sparse-keymap)))
  (define-key-binding map [mouse-2] 'operate-this-button)
  (put-text-property (point)
                     (save-excursion
                       (dired-move-to-end-of-filename)
                       (point))
                     'local-map map))
</pre></td></tr></table><P>

この方法では、テキストのさまざまなクリック可能な部分に
異なるコマンドを定義できます。
さらに、バッファの残りの部分に対しては、
メジャーモードの定義（やグローバルな定義）がそのまま有効です。
<P>

<A NAME="Not Intervals"></A>
<HR SIZE="6">
<br><A NAME="SEC523"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC522"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC524"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Not Intervals"></A>
<H3> 31.19.10 テキスト属性が範囲でない理由 </H3>
<!--docid::SEC523::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Not%20Intervals">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Not%20Intervals</a>"<br>
"texi/elisp21/テキスト属性が範囲でない理由"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%C2%B0%C0%AD%A4%AC%C8%CF%B0%CF%A4%C7%A4%CA%A4%A4%CD%FD%CD%B3">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2368"></A>
<P>

バッファ内のテキストに属性を付加できるエディタのなかには、
ユーザーにテキスト内の『範囲』を指定させ、
その範囲に属性を付加するものがあります。
このようなエディタでは、ユーザーやプログラマが
個々の範囲の先頭と末尾を決定できます。
テキスト変更に伴うある種の矛盾するようなふるまいを避けるために、
熟考の結果Emacs Lispでは別の種類のインターフェイスを提供することにしました。
<P>

複数の範囲に細分することが意味を持つならば、
ある属性の1つの範囲があるだけのバッファと、
その同じテキストをその同じ属性の2つの範囲にしてあるバッファとを
区別できるはずです。
<P>

1つの範囲だけを持つバッファにおいて、そのテキストの一部をキルしたとします。
バッファに残っているテキストは1つの範囲であり、
キルリング（とアンドゥリスト）内のコピーは1つの別の範囲になります。
そしてキルされたテキストをヤンクして戻すと、
同じ属性を持つ2つの範囲ができます。
つまり、編集すると、1つの範囲と2つの範囲の区別を保存できなくなります。
<P>

テキストを挿入すると2つの範囲を融合することで
この問題を『修正』したとします。
バッファにもともと1つの範囲しかなければ、うまくいきます。
しかし、同じ属性の範囲が連続して2つある場合に、
一方の範囲をキルしてからヤンクして戻したとします。
別の場面では救いになる同じ属性の範囲を融合する機能が、
ここではトラブルを引き起こします。
つまり、ヤンクすると1つの範囲になってしまいます。
ここでも、編集すると、1つの範囲と2つの範囲の区別を保存できなくなります。
<P>

2つの範囲の境界にテキストを挿入する場合でも、
満足できる解決方法がない問題を提起します。
<P>

しかし、『この文字の属性はなにか』といった形の問いに対して
一貫したふるまいをするような編集にするのは簡単です。
そのために、これらが唯一の意味ある問いかけであると判断したのです。
範囲の先頭と末尾を問うようなものは実装してありません。
<P>

実用上は、明示的な範囲の境界のかわりに、
テキスト属性を探索する関数を普通は使えます。
それらの関数は、可能な場合にはつねに範囲は融合されると仮定して
範囲の境界を探すと考えることができます。
See 節 <A HREF="elisp_32.html#SEC516">31.19.3 テキスト属性を探す関数</A>。
<P>

Emacsには表示機能として明示的な範囲もあります。
<A HREF="elisp_38.html#SEC607">37.8 オーバレイ</A>を参照してください。
<P>

<A NAME="Substitution"></A>
<HR SIZE="6">
<br><A NAME="SEC524"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC523"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC525"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Substitution"></A>
<H2> 31.20 文字コードの置換 </H2>
<!--docid::SEC524::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Substitution">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Substitution</a>"<br>
"texi/elisp21/文字コードの置換"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CA%B8%BB%FA%A5%B3%A1%BC%A5%C9%A4%CE%C3%D6%B4%B9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

つぎの関数は、指定した領域内の文字をそれらの文字コードに基づいて置き換えます。
<P>

<A NAME="IDX2369"></A>
<DL>
<DT><U>Function:</U> <B>subst-char-in-region</B> <I>start end old-char new-char &#38;optional noundo</I>
<DD><A NAME="IDX2370"></A>
<A NAME="IDX2371"></A>
この関数は、カレントバッファの<VAR>start</VAR>と<VAR>end</VAR>で定義される領域の
すべての文字<VAR>old-char</VAR>を文字<VAR>new-char</VAR>に置き換える。
<P>

<A NAME="IDX2372"></A>
<A NAME="IDX2373"></A>
<VAR>noundo</VAR>が<CODE>nil</CODE>以外であると、
<CODE>subst-char-in-region</CODE>はアンドゥ用の変更を記録せず、
バッファに変更済みの印も付けない。
この機能は、選択表示（see 節 <A HREF="elisp_38.html#SEC604">37.5 選択表示</A>）の制御に使われている。
<P>

<CODE>subst-char-in-region</CODE>はポイントを移動せず、
<CODE>nil</CODE>を返す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
This is the contents of the buffer before.
---------- Buffer: foo ----------

(subst-char-in-region 1 20 ?i ?X)
     => nil

---------- Buffer: foo ----------
ThXs Xs the contents of the buffer before.
---------- Buffer: foo ----------
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2374"></A>
<DL>
<DT><U>Function:</U> <B>translate-region</B> <I>start end table</I>
<DD>この関数は、バッファの<VAR>start</VAR>と<VAR>end</VAR>のあいだの文字に変換表を適用する。
<P>

変換表<VAR>table</VAR>は文字列であり、
<CODE>(aref <VAR>table</VAR> <VAR>ochar</VAR>)</CODE>は、
<VAR>ochar</VAR>に対応する変換した文字を与える。
<VAR>table</VAR>の長さが256未満であると、
<VAR>table</VAR>の長さより大きなコードの文字は変換によっては変更されない。
<P>

<CODE>translate-region</CODE>の戻り値は、
変換によって実際に変更した文字の個数を返す。
これには、変換表で自分自身に変換された文字は数えない。
</DL>
<P>

<A NAME="Registers"></A>
<HR SIZE="6">
<br><A NAME="SEC525"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC524"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC526"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Registers"></A>
<H2> 31.21 レジスタ </H2>
<!--docid::SEC525::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Registers">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Registers</a>"<br>
"texi/elisp21/レジスタ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%EC%A5%B8%A5%B9%A5%BF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2375"></A>
<P>

レジスタは、Emacsの編集においてさまざまな種類の値を保持できる変数の一種です。
各レジスタには1文字の名前が付いています。
すべてのASCII文字とそれらのメタ変種（ただし<KBD>C-g</KBD>を除く）を
レジスタの名前に使えます。
したがって、255個のレジスタを使えます。
Emacs Lispでは、レジスタ名でレジスタを区別します。
<P>

<A NAME="IDX2376"></A>
<DL>
<DT><U>Variable:</U> <B>register-alist</B>
<DD>この変数は、<CODE>(<VAR>name</VAR> . <VAR>contents</VAR>)</CODE>の形の要素の連想リストである。
通常、使用中のEmacsの各レジスタに対して1つの要素がある。
<P>

オブジェクト<VAR>name</VAR>は、レジスタを識別する文字（整数）である。
</DL>
<P>

レジスタの内容（<VAR>contents</VAR>）に可能な型はいくつかあります。
<P>

<DL COMPACT>
<DT>数
<DD>数そのものを表す。
<CODE>insert-register</CODE>がレジスタ内で数をみつけると10進数に変換する。
<P>

<DT>マーカ
<DD>マーカはジャンプ先のバッファ内位置を表す。
<P>

<DT>文字列
<DD>文字列はレジスタに保存されたテキストである。
<P>

<DT>矩形領域
<DD>矩形領域は文字列のリストで表現される。
<P>

<DT><CODE>(<VAR>window-configuration</VAR> <VAR>position</VAR>)</CODE>
<DD>これは、1つのフレームに復元するウィンドウ構成と
カレントバッファでのポイントの移動先を表す。
<P>

<DT><CODE>(<VAR>frame-configuration</VAR> <VAR>position</VAR>)</CODE>
<DD>これは、復元するフレーム構成とカレントバッファでのポイントの移動先を表す。
<P>

<DT>(file <VAR>filename</VAR>)
<DD>訪問すべきファイルを表す。
この値にジャンプするとファイル<VAR>filename</VAR>を訪問する。
<P>

<DT>(file-query <VAR>filename</VAR> <VAR>position</VAR>)
<DD>これは、訪問すべきファイルとその中での位置を表す。
この値にジャンプするとファイル<VAR>filename</VAR>を訪問し
バッファ内位置<VAR>position</VAR>へ移動する。
この種の位置を復元すると、まずユーザーに確認を取る。
</DL>
<P>

本節の関数は、明記してない場合には予測できない値を返します。
<P>

<A NAME="IDX2377"></A>
<DL>
<DT><U>Function:</U> <B>get-register</B> <I>reg</I>
<DD>この関数は、レジスタ<VAR>reg</VAR>の内容、
あるいは、内容がなければ<CODE>nil</CODE>を返す。
</DL>
<P>

<A NAME="IDX2378"></A>
<DL>
<DT><U>Function:</U> <B>set-register</B> <I>reg value</I>
<DD>この関数は、レジスタ<VAR>reg</VAR>の内容を<VAR>value</VAR>とする。
レジスタには任意の値を設定できるが、他のレジスタ関数は
特定のデータ型を期待する。
戻り値は<VAR>value</VAR>である。
</DL>
<P>

<A NAME="IDX2379"></A>
<DL>
<DT><U>コマンド:</U> <B>view-register</B> <I>reg</I>
<DD>このコマンドは、レジスタ<VAR>reg</VAR>になにが入っているかを表示する。
</DL>
<P>

<A NAME="IDX2380"></A>
<DL>
<DT><U>コマンド:</U> <B>insert-register</B> <I>reg &#38;optional beforep</I>
<DD>このコマンドはレジスタ<VAR>reg</VAR>の内容をカレントバッファに挿入する。
<P>

通常、このコマンドは挿入したテキストのまえにポイントを置き、
そのあとにマークを置く。
しかし、省略可能な2番目の引数<VAR>beforep</VAR>が<CODE>nil</CODE>以外であると、
まえにマークを置きあとにポイントを置く。
この関数を対話的に呼び出すときに前置引数を指定すれば、
2番目の引数<VAR>beforep</VAR>に<CODE>nil</CODE>以外を渡せる。
<P>

レジスタに矩形領域が含まれる場合、
ポイント位置に矩形領域の左上隅がくるように挿入される。
つまり、テキストは現在行とそのしたの連続する行に挿入される。
<P>

保存したテキスト（文字列）や矩形領域（リスト）以外がレジスタに入っていると、
現状では有用なことは起こらない。
将来これは変更されるであろう。
</DL>
<P>

<A NAME="Transposition"></A>
<HR SIZE="6">
<br><A NAME="SEC526"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC525"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC527"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Transposition"></A>
<H2> 31.22 テキストの転置 </H2>
<!--docid::SEC526::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Transposition">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Transposition</a>"<br>
"texi/elisp21/テキストの転置"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%A4%CE%C5%BE%C3%D6">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

つぎのサブルーティンは転置コマンドで使われます。
<P>

<A NAME="IDX2381"></A>
<DL>
<DT><U>Function:</U> <B>transpose-regions</B> <I>start1 end1 start2 end2 &#38;optional leave-markers</I>
<DD>この関数は、バッファの重なり合わない2つの部分を入れ換える。
引数<VAR>start1</VAR>と<VAR>end1</VAR>で一方の部分の境界を指定し、
引数<VAR>start2</VAR>と<VAR>end2</VAR>で他方の部分の境界を指定する。
<P>

通常、<CODE>transpose-regions</CODE>は転置したテキスト内のマーカを再配置する。
つまり、2つの転置部分の一方の内側を指していたマーカは
その部分とともに移動して、新しい位置で同じ2つの文字のあいだに留まる。
しかし、<VAR>leave-markers</VAR>が<CODE>nil</CODE>以外であると、
<CODE>transpose-regions</CODE>はこれを行わず、
すべてのマーカは再配置されない。
</DL>
<P>

<A NAME="Change Hooks"></A>
<HR SIZE="6">
<br><A NAME="SEC527"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_32.html#SEC526"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_33.html#SEC528"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Change Hooks"></A>
<H2> 31.23 変更フック </H2>
<!--docid::SEC527::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Change%20Hooks">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Change%20Hooks</a>"<br>
"texi/elisp21/変更フック"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CA%D1%B9%B9%A5%D5%A5%C3%A5%AF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2382"></A>
<A NAME="IDX2383"></A>
<P>

これらのフックにより、すべてのバッファ
（それらをバッファローカルにしておけば特定のバッファ）における
すべての変更を知るようにできます。
テキストの特定部分の変更を検出する方法については、
<A HREF="elisp_32.html#SEC517">31.19.4 特別な意味を持つ属性</A>も参照してください。
<P>

これらのフックに使う関数において正規表現を使う場合には、
マッチデータを保存し復元する必要があります。
さもないと、それらを呼び出す編集操作と奇妙な干渉を引き起こします。
<P>

<A NAME="IDX2384"></A>
<DL>
<DT><U>Variable:</U> <B>before-change-functions</B>
<DD>この変数は、バッファを変更するまえに呼び出すべき関数のリストを保持する。
各関数は2つの引数、つまり、整数で表した変更対象の領域の先頭と末尾を受け取る。
変更対象のバッファはつねにカレントバッファである。
</DL>
<P>

<A NAME="IDX2385"></A>
<DL>
<DT><U>Variable:</U> <B>after-change-functions</B>
<DD>この変数は、バッファを変更したあとに呼び出すべき関数のリストを保持する。
各関数は3つの引数、つまり、変更されたばかりの領域の先頭と末尾、
変更前に存在していたテキストの長さを受け取る。
3つの引数はすべて整数である。
変更対象のバッファはつねにカレントバッファである。
<P>

古いテキストの長さは、変更前のそのテキストの先頭と末尾の
バッファ内位置の差である。
変更済みのテキストの長さは、単純に始めの2つの引数の差である。
</DL>
<P>

<A NAME="IDX2386"></A>
<DL>
<DT><U>Macro:</U> <B>combine-after-change-calls</B> <I>body...</I>
<DD><A NAME="IDX2387"></A>
このマクロは通常どおり<VAR>body</VAR>を実行するが、
一連の変更に対して安全と思えるときには、
<CODE>after-change-functions</CODE>の関数を一度だけ呼び出す。
<P>

プログラムからバッファの同じ部分でテキスト変更を複数回行う場合、
プログラムの当該部分の周りでマクロ<CODE>combine-after-change-calls</CODE>を使うと、
フック<CODE>after-change-functions</CODE>を使用してるときには
動作がかなり速くなりうる。
最終的にフック<CODE>after-change-functions</CODE>が呼ばれると、
<CODE>combine-after-change-calls</CODE>の本体で行った変更すべてを含むような
バッファ部分が引数に指定される。
<P>

<STRONG>警告：</STRONG><CODE> </CODE>
フォーム<CODE>combine-after-change-calls</CODE>の本体の内側では
<CODE>after-change-functions</CODE>と<CODE>after-change-function</CODE>の値を
変更しないこと。
<P>

<STRONG>注意：</STRONG><CODE> </CODE>
変更がバッファの広く分散した部分に行われるときにもこれは動作するが、
推奨できない。
非効率なふるまいをするようなフック関数があるからである。
</DL>
<P>

<A NAME="IDX2388"></A>
<DL>
<DT><U>Variable:</U> <B>before-change-function</B>
<DD>この廃れた変数は、任意のバッファの変更を行うまえに
呼ばれる1つの関数を保持する
（<CODE>nil</CODE>ならばそのような関数はなし）。
<CODE>before-change-functions</CODE>の関数と同様に呼ばれる。
</DL>
<P>

<A NAME="IDX2389"></A>
<DL>
<DT><U>Variable:</U> <B>after-change-function</B>
<DD>この廃れた変数は、任意のバッファの変更を行ったあとに
呼ばれる1つの関数を保持する
（<CODE>nil</CODE>ならばそのような関数はなし）。
<CODE>after-change-functions</CODE>の関数と同様に呼ばれる。
</DL>
<P>

上の4つの変数は、これらの関数が実行中には一時的に<CODE>nil</CODE>に束縛されます。
つまり、これらの関数の1つがバッファを変更しても、
その変更ではこれらの関数を呼び出しません。
フック関数においてこれらの関数を実行するような変更を行いたい場合には、
フック関数でこれらの変数をそれらの通常の値に束縛し直します。
<P>

この保護的な機構の1つの不便な帰結は、
<CODE>after-change-functions</CODE>や<CODE>before-change-functions</CODE>には、
その変数の値を変更する関数を持てないことです。
しかし、これは本当の制限ではありません。
それらの関数で実行すべき関数のリストを変更したければ、
単純に1つの定まった関数をフックに追加し、
その関数では呼び出すべき別の関数を指定する別の変数を調べます。
つぎのようにします。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(setq my-own-after-change-functions nil)
(defun indirect-after-change-function (beg end len)
  (let ((list my-own-after-change-functions))
    (while list
      (funcall (car list) beg end len)
      (setq list (cdr list)))))

(add-hooks 'after-change-functions
           'indirect-after-change-function)
</pre></td></tr></table><P>

<A NAME="IDX2390"></A>
<DL>
<DT><U>Variable:</U> <B>first-change-hook</B>
<DD>この変数は、未変更状態のバッファを変更するたびに実行される
ノーマルフックである。
</DL>
<A NAME="Non-ASCII Characters"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<a name="bottom"> </a>
<script type="text/javascript" src="style2.js"></script>
<div class="footer">
    <br>
    このページはMeadow (Emacs) の紹介ページです <br>
このWebページの各文書は自由にリンク・複製・再配布・改変していただいて構いません．
<br>ただし，複製・再配布・改変の場合は Meadow Memo のURLを記載しておいて下さい．<br>
<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=about%20link">Medow memoへのリンクについて</a>．<br>

間違い，要望等があれば<a href="mailto:akihisa@mail.ne.jp">akihisa@mail.ne.jp</a> か下記でどうぞ<br>

<br>

<FORM METHOD="post" ACTION="http://www.bookshelf.jp/cgi-bin/wwwmail.cgi" >
お名前：<INPUT TYPE="text" NAME="name" SIZE="30" MAXLENGTH="40" VALUE="ななしさん"><br>
メールアドレス：<INPUT TYPE="text" NAME="EMAIL" SIZE="25" MAXLENGTH="60" VALUE="secret@mail.adr"><br>
<input type="hidden" name="HPAGE" value="">
つっこみ：<br><TEXTAREA NAME="MESSAGE" ROWS="5" COLS="50">
</TEXTAREA><br><br>
<INPUT TYPE="submit" VALUE="送信">
<INPUT TYPE="reset" VALUE="クリア">
</FORM>

<br><A HREF="http://www.bookshelf.jp/cgi-bin/xct.cgi">ページ別カウンタ</a>
<br> Since 2002/12/13 <br>
</div>

</BODY>

</HTML>
