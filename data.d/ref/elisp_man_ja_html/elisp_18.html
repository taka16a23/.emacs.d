<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="ja">
<!-- Created on October, 1  2005 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=euc-jp">
<META NAME="keywords" CONTENT="meadow,mule,emacs,lisp,elisp,gnus,setting,設定,unix,cygwin">
<META http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="description" CONTENT="Meadowの設定を紹介するページです">
<TITLE>GNU Emacs Lispリファレンスマニュアル:  Lispプログラムのデバッグ</TITLE>

<META NAME="description" CONTENT="GNU Emacs Lispリファレンスマニュアル:  Lispプログラムのデバッグ">
<META NAME="keywords" CONTENT="GNU Emacs Lispリファレンスマニュアル:  Lispプログラムのデバッグ">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

<LINK REL="contents" HREF="elisp_toc.html#SEC_Contents">
<LINK REL="index" HREF="elisp_48.html#SEC681">
<LINK REL="next" HREF="elisp_19.html#SEC258">
<LINK REL="prev" HREF="elisp_17.html#SEC208">

<META http-equiv="Content-Style-Type" content="text/css">
<!-- 鶯と龜 ←日本語EUC誤判別対策用らしい; -->
<link rel="StyleSheet" href="../../../../soft/css/midnight.css" type="text/css" id="css1">
<script type="text/javascript" src="style1.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../soft/css/meadowmemo.css">

</HEAD>
<BODY LANG="ja" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<!--Infoseek Analyzer start-->
<script LANGUAGE="javascript">PgNo=6;</script>
<script src="http://js1.infoseek.co.jp/bin/57/00170.js"></script>
<noscript><a href="http://ax1.www.infoseek.co.jp/bin/go?0017057f" target="_blank">
<img src="http://ax1.www.infoseek.co.jp/bin/logo?0017057f" border=0></a></noscript>
<!--Infoseek Analyzer end-->
<a name="top"> </a>

<br><A NAME="SEC219"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_17.html#SEC218"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC220"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_17.html#SEC208"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_19.html#SEC258"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Debugging"></A>
<H1> 17. Lispプログラムのデバッグ </H1>
<!--docid::SEC219::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Debugging">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Debugging</a>"<br>
"texi/elisp21/Lispプログラムのデバッグ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2FLisp%A5%D7%A5%ED%A5%B0%A5%E9%A5%E0%A4%CE%A5%C7%A5%D0%A5%C3%A5%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

Emacs Lispプログラムの問題点を調べるには、
問題が発生したときにどのようにプログラムを使っているかに依存して、
3つの方法があります。
<P>

<UL>
<LI>
プログラムを実行したときに問題が発生した場合には、
実行中に何が起こっているかを調べるためにLispデバッガを使える。
通常のデバッガに加えて、Emacsにはソースレベルデバッガedebugもある。
本章では両者について述べる。
<P>

<LI>
構文的な問題があるためにLispがプログラムを読み取れないときには、
EmacsのLisp編集機能を使ってその場所を特定する。
<P>

<LI>
プログラムをバイトコンパイラでコンパイルするときに問題が発生するときには、
コンパイラの入力バッファの調べ方を知る必要がある。
</UL>
<P>

<div class="menuindex"><SCRIPT language=JavaScript src="index17.js"></SCRIPT></div><noscript><BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC220">17.1 Lispデバッガ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How the Emacs Lisp debugger is implemented.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC229">17.2 edebug</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">A source-level Emacs Lisp debugger.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC254">17.3 不正なLisp構文のデバッグ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to find syntax errors.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC257">17.4 コンパイル時の問題のデバッグ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to find errors that show up in byte compilation.</TD></TR>
</TABLE></BLOCKQUOTE></noscript>
<P>

他の有用なデバッグツールは、ドリブルファイルです。
ドリブルファイルをオープンしてあると、
Emacsはすべてのキーボード入力をこのファイルにコピーします。
あとでこのファイルを調べれば、どんな入力があったかわかります。
See 節 <A HREF="elisp_40.html#SEC650">39.8 端末入力</A>。
<P>

端末設定に関した問題を解決するには、
関数<CODE>open-termscript</CODE>が有用です。
See 節 <A HREF="elisp_40.html#SEC654">39.9 端末出力</A>。
<P>

<A NAME="Debugger"></A>
<HR SIZE="6">
<br><A NAME="SEC220"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC219"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC221"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Debugger"></A>
<H2> 17.1 Lispデバッガ </H2>
<!--docid::SEC220::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Debugger">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Debugger</a>"<br>
"texi/elisp21/Lispデバッガ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2FLisp%A5%C7%A5%D0%A5%C3%A5%AC">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX834"></A>
<A NAME="IDX835"></A>
<A NAME="IDX836"></A>
<P>

通常の<EM>Lispデバッガ</EM>は、フォームの評価を一時停止する機能を提供します。
評価を一時停止しているあいだ（<EM>ブレーク</EM>（break）と呼ばれる状態）は、
実行時スタックを調べたり、ローカルやグローバル変数の値を調べたり、
それらの値を変更できます。
ブレークは再帰編集なので、Emacsの通常の編集機能すべてを使えます。
デバッガを再帰的に起動するようなプログラムを実行することさえできます。
See 節 <A HREF="elisp_21.html#SEC313">20.11 再帰編集</A>。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC221">17.1.1 エラーによるデバッガの起動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Entering the debugger when an error happens.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC222">17.1.2 無限ループのデバッグ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Stopping and debugging a program that doesn't exit.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC223">17.1.3 関数呼び出し時のデバッガの起動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Entering it when a certain function is called.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC224">17.1.4 デバッガの明示的な起動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Entering it at a certain point in the program.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC225">17.1.5 デバッガの使い方</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">What the debugger does; what you see while in it.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC226">17.1.6 デバッガコマンド</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Commands used while in the debugger.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC227">17.1.7 デバッガの起動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to call the function <CODE>debug</CODE>.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC228">17.1.8 デバッガの内部</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Subroutines of the debugger, and global variables.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Error Debugging"></A>
<HR SIZE="6">
<br><A NAME="SEC221"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC220"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC222"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Error Debugging"></A>
<H3> 17.1.1 エラーによるデバッガの起動 </H3>
<!--docid::SEC221::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Error%20Debugging">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Error%20Debugging</a>"<br>
"texi/elisp21/エラーによるデバッガの起動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%A8%A5%E9%A1%BC%A4%CB%A4%E8%A4%EB%A5%C7%A5%D0%A5%C3%A5%AC%A4%CE%B5%AF%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX837"></A>
<A NAME="IDX838"></A>
<P>

デバッガへ入るもっとも重要な時期は、Lispエラーが発生したときです。
これにより、エラーの直接原因を調べることができます。
<P>

しかし、デバッガに入るのは、エラーの通常の帰結ではありません。
多くのコマンドは
（バッファの末尾で<KBD>C-f</KBD>を使うなどの）不適切に起動されると
しばしばLispエラーを生じますが、
通常の編集ではそのたびにデバッガに入ったのではとても不便です。
そのため、エラーによってデバッガに入りたい場合には、
変数<CODE>debug-on-error</CODE>に<CODE>nil</CODE>以外を設定します。
（コマンド<CODE>toggle-debug-on-error</CODE>はこれを簡単に行う。）
<P>

<A NAME="IDX839"></A>
<DL>
<DT><U>User Option:</U> <B>debug-on-error</B>
<DD>この変数は、エラーが通知され処理されないときに
デバッガを呼び出すかどうか決定する。
<CODE>debug-on-error</CODE>が<CODE>t</CODE>であると、
すべての種類のエラー（<CODE>debug-ignored-errors</CODE>に指定したものを除く）
はデバッガを呼び出す。
<CODE>nil</CODE>であるとデバッガを呼び出さない。
<P>

その値はデバッガを呼び出すエラー条件のリストでもよい。
たとえば、リスト<CODE>(void-variable)</CODE>にすると、
「値を持たない変数に関したエラー」のみがデバッガを起動する。
<P>

この変数が<CODE>nil</CODE>以外であると、
Emacsはプロセスのフィルタ関数や番兵に対してエラーハンドラを作成しない。
したがって、これらの関数でのエラーもデバッガを起動する。
see 節 <A HREF="elisp_37.html#SEC583">36. プロセス</A>。
</DL>
<P>

<A NAME="IDX840"></A>
<DL>
<DT><U>User Option:</U> <B>debug-ignored-errors</B>
<DD>この変数は、デバッガに入らないエラーの種類を指定する。
その値はエラー条件シンボルや正規表現のリストである。
エラーにこれらの条件シンボルが含まれるか
エラーメッセージが正規表現の1つに一致する場合には、
<CODE>debug-on-error</CODE>の値に関わらず
当該エラーではデバッガに入らない。
<P>

この変数の通常の値は、
編集ではしばしば発生するが、Lispプログラムのバグではほとんど発生しないような
エラー群のリストである。
しかし、『ほとんど』は『けっして』ではない。
このリストに一致するようなエラーで読者のプログラムが失敗する場合、
エラーをデバッグするにはこのリストを変更する必要がある。
もっとも簡単な方法は、<CODE>debug-ignored-errors</CODE>に<CODE>nil</CODE>を
設定することである。
</DL>
<P>

<A NAME="IDX841"></A>
<DL>
<DT><U>User Option:</U> <B>debug-on-signal</B>
<DD>通常、<CODE>condition-case</CODE>で捕捉したエラーは、
たとえ<CODE>debug-on-error</CODE>が<CODE>nil</CODE>以外であっても、
けっしてデバッガを起動しない。
いいかえれば、デバッガを起動するまえに、
<CODE>condition-case</CODE>はエラー処理の機会を得るのである。
<P>

<CODE>debug-on-signal</CODE>に<CODE>nil</CODE>以外の値を設定すると、
各エラーごとにデバッガがまず機会を得る。
<CODE>debug-on-error</CODE>と<CODE>debug-ignored-errors</CODE>の値で指定される
条件に一致すれば、<CODE>condition-case</CODE>に関わらず
エラーはデバッガを起動する。
<P>

<STRONG>警告：</STRONG><CODE> </CODE>
この変数は強力な処方である！<CODE> </CODE>
Emacsのさまざまな部分では通常の動作としてエラーを処理し、
読者にはエラーが発生したことさえわからない。
<CODE>debug-on-signal</CODE>に<CODE>nil</CODE>以外の値を設定すると
それらのエラーでデバッガに入る。
<P>

<STRONG>警告：</STRONG><CODE> </CODE>
<CODE>debug-on-error</CODE>が<CODE>nil</CODE>であると、
<CODE>debug-on-signal</CODE>は意味を持たない。
</DL>
<P>

ファイル`<TT>.emacs</TT>'をロード中に発生するエラーをデバッグするには、
オプション`<SAMP>--debug-init</SAMP>'を使います。
これにより、`<TT>.emacs</TT>'のロード中は<CODE>debug-on-error</CODE>を<CODE>t</CODE>に束縛し、
初期化ファイルでのエラーを捕捉する<CODE>condition-case</CODE>を迂回します。
<P>

読者のファイル`<TT>.emacs</TT>'で<CODE>debug-on-error</CODE>を設定しても、
その効果は`<TT>.emacs</TT>'のロードを終ると持続しません。
（これはコマンド行オプション`<SAMP>--debug-init</SAMP>'の実装における
好ましくない特性である。）
`<TT>.emacs</TT>'で<CODE>debug-on-error</CODE>を恒久的に設定する最良の方法は、
つぎのように、<CODE>after-init-hook</CODE>を用いることです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(add-hook 'after-init-hook
          '(lambda () (setq debug-on-error t)))
</pre></td></tr></table><P>

<A NAME="Infinite Loops"></A>
<HR SIZE="6">
<br><A NAME="SEC222"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC221"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC223"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Infinite Loops"></A>
<H3> 17.1.2 無限ループのデバッグ </H3>
<!--docid::SEC222::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Infinite%20Loops">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Infinite%20Loops</a>"<br>
"texi/elisp21/無限ループのデバッグ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CC%B5%B8%C2%A5%EB%A1%BC%A5%D7%A4%CE%A5%C7%A5%D0%A5%C3%A5%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX842"></A>
<A NAME="IDX843"></A>
<A NAME="IDX844"></A>
<A NAME="IDX845"></A>
<A NAME="IDX846"></A>
<A NAME="IDX847"></A>
<P>

プログラムが無限にループし戻ってこないときには、
まず、ループを停止する必要があります。
ほとんどのオペレーティングシステムでは、
中断を意味する<KBD>C-g</KBD>を使います。
<P>

普通に中断したのでは、
プログラムが無限ループした理由に関する情報は得られません。
より詳しい情報を得るには、
変数<CODE>debug-on-quit</CODE>に<CODE>nil</CODE>以外を設定します。
<KBD>C-g</KBD>による中断はエラーとは扱わないため、
<KBD>C-g</KBD>の処理に関して<CODE>debug-on-error</CODE>はなんの効果もありません。
同様に、<CODE>debug-on-quit</CODE>はエラーに関してなんの効果もありません。
<P>

無限ループの途中でデバッガを起動できれば、
デバッガでステップ実行コマンドを使って先へ進めます。
ループひとまわりをステップ実行すれば、
問題を解決するに十分な情報を得られるはずです。
<P>

<A NAME="IDX848"></A>
<DL>
<DT><U>User Option:</U> <B>debug-on-quit</B>
<DD>この変数は、<CODE>quit</CODE>が通知され処理されなかった場合に、
デバッガを呼び出すかどうかを決定する。
<CODE>debug-on-quit</CODE>が<CODE>nil</CODE>以外である場合、
（<KBD>C-g</KBD>を打って）中断するとデバッガを呼び出す。
<CODE>debug-on-quit</CODE>が<CODE>nil</CODE>であると、
中断してもデバッガを呼び出さない。
see 節 <A HREF="elisp_21.html#SEC311">20.9 中断</A>。
</DL>
<P>

<A NAME="Function Debugging"></A>
<HR SIZE="6">
<br><A NAME="SEC223"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC222"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC224"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Function Debugging"></A>
<H3> 17.1.3 関数呼び出し時のデバッガの起動 </H3>
<!--docid::SEC223::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Debugging">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Function%20Debugging</a>"<br>
"texi/elisp21/関数呼び出し時のデバッガの起動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B4%D8%BF%F4%B8%C6%A4%D3%BD%D0%A4%B7%BB%FE%A4%CE%A5%C7%A5%D0%A5%C3%A5%AC%A4%CE%B5%AF%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX849"></A>
<A NAME="IDX850"></A>
<A NAME="IDX851"></A>
<A NAME="IDX852"></A>
<P>

プログラムの途中で発生する問題点を調べるための1つの有用な技法は、
ある関数を呼び出すたびにデバッガに入ることです。
問題を生じる関数に対してこのようにしておき、
当該関数をステップ実行するか、あるいは、
問題が発生する直前に呼ばれる関数に対してこのようにしておき、
その関数の呼び出しを終えてから、呼び出し側をステップ実行します。
<P>

<A NAME="IDX853"></A>
<DL>
<DT><U>コマンド:</U> <B>debug-on-entry</B> <I>function-name</I>
<DD>この関数は、<VAR>function-name</VAR>が呼び出されるたびに
デバッガを起動するようにする。
当該関数の定義の最初のフォームとして
フォーム<CODE>(debug 'debug)</CODE>を挿入することでこれを行う。
<P>

Lispコードで定義した任意の関数は、
解釈実行コードであろうとコンパイル済みのコードであろうと、
関数に入るときにブレークするようにできる。
関数がコマンドであると、Lispから呼ばれたときや
対話的に呼ばれたときに（引数を読み取ってから）デバッガに入る。
（Cで書いた）基本関数は、この方法ではデバッグできない。
<P>

<CODE>debug-on-entry</CODE>を対話的に呼び出すと、
ミニバッファで<VAR>function-name</VAR>を問い合わせる。
その関数がすでに呼び出し時にデバッガを起動するようになっていると、
<CODE>debug-on-entry</CODE>はなにもしない。
<CODE>debug-on-entry</CODE>はつねに<VAR>function-name</VAR>を返す。
<P>

<STRONG>注意：</STRONG><CODE> </CODE>
<CODE>debug-on-entry</CODE>を使ったあとに当該関数を再定義すると、
デバッガに入るためのコードがなくなる。
実質的には、関数を再定義すると呼び出し時にブレークする機能を
取り消すことになる。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun fact (n)
  (if (zerop n) 1
      (* n (fact (1- n)))))
     => fact
(debug-on-entry 'fact)
     => fact
(fact 3)

------ Buffer: *Backtrace* ------
Entering:
* fact(3)
  eval-region(4870 4878 t)
  byte-code("...")
  eval-last-sexp(nil)
  (let ...)
  eval-insert-last-sexp(nil)
* call-interactively(eval-insert-last-sexp)
------ Buffer: *Backtrace* ------

(symbol-function 'fact)
     => (lambda (n)
          (debug (quote debug))
          (if (zerop n) 1 (* n (fact (1- n)))))
</pre></td></tr></table></DL>
<P>

<A NAME="IDX854"></A>
<DL>
<DT><U>コマンド:</U> <B>cancel-debug-on-entry</B> <I>function-name</I>
<DD>この関数は、<VAR>function-name</VAR>に対する<CODE>debug-on-entry</CODE>の効果
（呼び出し時にブレークする）を取り消す。
対話的に呼び出すと、
ミニバッファで<VAR>function-name</VAR>を問い合わせる。
<VAR>function-name</VAR>が<CODE>nil</CODE>であったり空文字列であると、
すべての関数について、呼び出し時にブレークすることを取り消す。
<P>

呼び出し時にブレークする設定をしていない関数に対して
<CODE>cancel-debug-on-entry</CODE>を呼び出してもなにもしない。
つねに<VAR>function-name</VAR>を返す。
</DL>
<P>

<A NAME="Explicit Debug"></A>
<HR SIZE="6">
<br><A NAME="SEC224"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC223"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC225"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Explicit Debug"></A>
<H3> 17.1.4 デバッガの明示的な起動 </H3>
<!--docid::SEC224::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Explicit%20Debug">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Explicit%20Debug</a>"<br>
"texi/elisp21/デバッガの明示的な起動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C7%A5%D0%A5%C3%A5%AC%A4%CE%CC%C0%BC%A8%C5%AA%A4%CA%B5%AF%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

読者のプログラムに式<CODE>(debug)</CODE>を書くと、
その箇所でデバッガを呼び出すことができます。
つまり、ソースファイルを訪問して適当な箇所にテキスト`<SAMP>(debug)</SAMP>'を挿入し、
<KBD>C-M-x</KBD>と打ちます。
<STRONG>警告：</STRONG><CODE> </CODE>
一時的なデバッグ目的でこれを行う場合には、
ファイルを保存するまえにこの挿入箇所をもとに戻すこと！
<P>

`<SAMP>(debug)</SAMP>'を挿入する箇所は、
余分なフォームを評価してもその値を無視できる場所でなければなりません。
（<CODE>(debug)</CODE>の値が無視されないと、
プログラムの実行を変えてしまう！）
もっとも適した一般的な場所は<CODE>progn</CODE>や暗黙の<CODE>progn</CODE>の内側です
（see 節 <A HREF="elisp_10.html#SEC123">9.1 逐次実行</A>）。
<P>

<A NAME="Using Debugger"></A>
<HR SIZE="6">
<br><A NAME="SEC225"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC224"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC226"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Using Debugger"></A>
<H3> 17.1.5 デバッガの使い方 </H3>
<!--docid::SEC225::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Using%20Debugger">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Using%20Debugger</a>"<br>
"texi/elisp21/デバッガの使い方"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C7%A5%D0%A5%C3%A5%AC%A4%CE%BB%C8%A4%A4%CA%FD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

デバッガに入ると、それまで選択していたバッファをあるウィンドウに、
`<SAMP>*Backtrace*</SAMP>'という名前のバッファを別のウィンドウに表示します。
バックトレースバッファでは、各行は現在実行中のLisp関数の各レベルです。
このバッファの先頭には、デバッガを起動するに至った理由
（エラーで起動されたときにはエラーメッセージと関連データ）
を表すメッセージがあります。
<P>

バックトレースバッファは読み出し専用であり、
各文字をデバッガコマンドであると定義した
特別なメジャーモード、debuggerモードを使います。
Emacsの通常の編集コマンドも使えます。
したがって、エラー発生時に編集していたバッファを調べるためにウィンドウを
切り替えたり、バッファを切り替えたり、ファイルを訪れたり、
その他のどんな編集でもできます。
しかし、デバッガは再帰編集レベル（see 節 <A HREF="elisp_21.html#SEC313">20.11 再帰編集</A>）であるので、
デバッグを終えるときには、バックトレースバッファに戻ってから
デバッガを（コマンド<KBD>q</KBD>で）終了するのが賢い方法です。
デバッガを終了すると、再帰編集から抜けバックトレースバッファを削除します。
<P>

<A NAME="IDX855"></A>
バックトレースバッファでは、実行中の関数とその引数の値を表示します。
また、スタックフレームを記述する行へポイントを移動することで
スタックフレームを指定できます。
（スタックフレームとは、Lispインタープリタが関数の起動に関する情報を
記録しておく場所である。）
ポイントがある行に対応するフレームを<EM>カレントフレーム</EM>（current frame）と
呼びます。
デバッガのある種のコマンドはカレントフレームに作用します。
<P>

デバッガ自身はバイトコンパイルしたものを実行する必要があります。
というのは、デバッガ自身が使用するスタックフレームのサイズを
仮定しているからです。
解釈実行だとこの仮定が成り立ちません。
<P>

<A NAME="Debugger Commands"></A>
<HR SIZE="6">
<br><A NAME="SEC226"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC225"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC227"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Debugger Commands"></A>
<H3> 17.1.6 デバッガコマンド </H3>
<!--docid::SEC226::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Debugger%20Commands">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Debugger%20Commands</a>"<br>
"texi/elisp21/デバッガコマンド"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C7%A5%D0%A5%C3%A5%AC%A5%B3%A5%DE%A5%F3%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX856"></A>
<P>

デバッガ内（debuggerモード）では、
通常のカーソル移動コマンドに加えて以下の特別なコマンドを使えます。
（ウィンドウやバッファの切り替えなどのEmacsの通常の機能も使えることに留意。）
<P>

デバッガコマンドのもっとも重要な使い方はステップ実行であり、
これにより制御の流れを調べることです。
デバッガは、解釈実行版の関数の制御構造をステップ実行できますが、
バイトコンパイルした関数ではできません。
バイトコンパイルした関数をステップ実行したい場合には、
同じ関数を解釈実行版の定義に置き換える必要があります。
（これには、関数のソースを訪れて、その定義内で<KBD>C-M-x</KBD>と打つ。）
<P>

debuggerモードのコマンド一覧を以下に示します。
<P>

<DL COMPACT>
<DT><KBD>c</KBD>
<DD>デバッガを終了し実行を継続する。
継続可能であれば、
（デバッガ内で行った変数値やデータ構造に対する変更などの副作用を除いて）
デバッガを起動しなかったかのようにプログラムの実行を再開する。
<P>

継続が可能なのは、
関数呼び出し時や終了時、明示的な起動、中断によりデバッガに入った場合である。
エラーが原因でデバッガが起動されたときには継続できない。
<P>

<DT><KBD>d</KBD>
<DD>実行を継続するが、任意のLisp関数を呼び出すとデバッガに入る。
これにより、式の部分式をステップ実行して
部分式が計算する値やその動作を調べることができる。
<P>

このようにしてデバッガを起動した関数呼び出しのスタックフレームには
自動的に印が付き、そのスタックから抜けるとデバッガがふたたび呼び出される。
この印を消すにはコマンド<KBD>u</KBD>を使う。
<P>

<DT><KBD>b</KBD>
<DD>フレームから抜けるとデバッガに入るようにカレントフレームに印を付ける。
このように印を付けたフレームには、バックトレースバッファでは星印が付く。
<P>

<DT><KBD>u</KBD>
<DD>カレントフレームから抜けるときにデバッガに入らない。
これは、当該フレームに対するコマンド<KBD>b</KBD>を取り消す。
視覚的にはバックトレースバッファの当該行から星印が取られる。
<P>

<DT><KBD>e</KBD>
<DD>ミニバッファでLisp式を読み取り、それを評価し、その値をエコー領域に表示する。
この操作の一環として、デバッガは重要なある種の変数や
カレントバッファを変更する。
<KBD>e</KBD>はそれらの値をデバッガの外側の値に一時的に復元するので、
それらを調べたり変更したりできる。
これによりデバッガは透過的になる。
対照的に、<KBD>M-:</KBD>はデバッガ内で特別なことは行わない。
デバッガ内での変数値を表示する。
<P>

<DT><KBD>R</KBD>
<DD><KBD>e</KBD>と同様であるが、
バッファ`<SAMP>*Debugger-record*</SAMP>'での評価結果も保存する。
<P>

<DT><KBD>q</KBD>
<DD>デバッグ中のプログラムを終了する。
Emacsのトップレベルのコマンド実行へ戻る。
<P>

<KBD>C-g</KBD>でデバッガへ入ったが、
実際には中断したいのであってデバッグはしたくない場合には
コマンド<KBD>q</KBD>を使う。
<P>

<DT><KBD>r</KBD>
<DD>デバッガから値を指定して戻る。
その値は、ミニバッファで式を読み取り、それを評価して得る。
<P>

（<KBD>b</KBD>で指定したり<KBD>d</KBD>でフレームに入ることで）
Lispの呼び出しフレームから抜けでたためにデバッガが起動された場合に、
コマンド<KBD>r</KBD>は有用である。
コマンド<KBD>r</KBD>で指定した値は、当該フレームの値として使われる。
このコマンドは、<CODE>debug</CODE>を呼び出してその戻り値を使う場合にも有用である。
さもなければ、<KBD>r</KBD>は<KBD>c</KBD>と同じ効果であり、指定した戻り値は関係ない。
<P>

エラーでデバッガに入った場合には<KBD>r</KBD>は使えない。
</DL>
<P>

<A NAME="Invoking the Debugger"></A>
<HR SIZE="6">
<br><A NAME="SEC227"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC226"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC228"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Invoking the Debugger"></A>
<H3> 17.1.7 デバッガの起動 </H3>
<!--docid::SEC227::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Invoking%20the%20Debugger">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Invoking%20the%20Debugger</a>"<br>
"texi/elisp21/デバッガの起動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C7%A5%D0%A5%C3%A5%AC%A4%CE%B5%AF%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

ここでは、デバッガを起動するために使われる関数<CODE>debug</CODE>の詳細を述べます。
<P>

<A NAME="IDX857"></A>
<DL>
<DT><U>Function:</U> <B>debug</B> <I>&#38;rest debugger-args</I>
<DD>この関数はデバッガに入る。
`<SAMP>*Backtrace*</SAMP>'（あるいはデバッガの第2レベルに再帰的に入ると
`<SAMP>*Backtrace*&#60;2&#62;</SAMP>'など）という名前のバッファに切り替え、
Lisp関数の呼び出しスタックに関する情報でこのバッファを満たす。
そして再帰編集に入りdebuggerモードのバックトレースバッファを表示する。
<P>

debuggerモードのコマンド<KBD>c</KBD>や<KBD>r</KBD>で再帰編集から抜けだし、
<CODE>debug</CODE>はそれ以前のバッファに切り替え
<CODE>debug</CODE>を呼び出したところへ戻る。
これは、関数<CODE>debug</CODE>が呼び出し側へ戻る唯一の手段である。
<P>

<VAR>debugger-args</VAR>の使い途は、
<CODE>debug</CODE>が引数の残りをバッファ`<SAMP>*Backtrace*</SAMP>'の先頭に表示し、
ユーザーが読めるようにすることである。
以下に述べる場合を除いて、これがこれらの引数の<EM>唯一</EM>の用途である。
<P>

<CODE>debug</CODE>の第1引数が特定の値を持つ場合、特別な意味がある。
（通常、これらの値はEmacs内部で用いるだけであり、
プログラマが<CODE>debug</CODE>を呼ぶときには使わない。）
以下にこれらの特別な値を示す。
<P>

<DL COMPACT>
<DT><CODE>lambda</CODE>
<DD><A NAME="IDX858"></A>
<A NAME="IDX859"></A>
第1引数が<CODE>lambda</CODE>であると、
<CODE>debug-on-next-call</CODE>が<CODE>nil</CODE>以外であるために
関数に入るときに<CODE>debug</CODE>を呼び出したことを意味する。
デバッガはバッファの先頭にテキスト行`<SAMP>Entering:</SAMP>'を表示する。
<P>

<DT><CODE>debug</CODE>
<DD>第1引数が<CODE>debug</CODE>であると、
関数に入るときにデバッガを起動するようになっていたために
<CODE>debug</CODE>を呼び出したことを示す。
デバッガは、<CODE>lambda</CODE>の場合と同様に、`<SAMP>Entering:</SAMP>'を表示する。
さらに、当該関数のスタックフレームに関数から
戻るときにデバッガを起動するように印を付ける。
<P>

<DT><CODE>t</CODE>
<DD>第1引数が<CODE>t</CODE>であると、
<CODE>debug-on-next-call</CODE>が<CODE>nil</CODE>以外であるときに
フォームの並びを評価したために
<CODE>debug</CODE>を呼び出したことを示す。
デバッガはバッファの先頭行につぎの行を表示する。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>Beginning evaluation of function call form:
</FONT></pre></td></tr></table><P>

<DT><CODE>exit</CODE>
<DD>第1引数が<CODE>exit</CODE>であると、
スタックフレームから抜けるときにデバッガを呼び出すように印を
付けたスタックフレームから抜けたことを示す。
この場合、<CODE>debug</CODE>の第2引数はフレームからの戻り値である。
デバッガはバッファの先頭行に`<SAMP>Return value:</SAMP>'に続けて戻り値を表示する。
<P>

<DT><CODE>error</CODE>
<DD><A NAME="IDX860"></A>
<A NAME="IDX861"></A>
第1引数が<CODE>error</CODE>であると、
エラーや<CODE>quit</CODE>が通知されたが処理されないためにデバッガに入ったことを示し、
`<SAMP>Signaling:</SAMP>'に続けて通知されたエラーと<CODE>signal</CODE>の引数を表示する。
たとえばつぎのとおり。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(let ((debug-on-error t))
  (/ 1 0))

------ Buffer: *Backtrace* ------
Signaling: (arith-error)
  /(1 0)
...
------ Buffer: *Backtrace* ------
</pre></td></tr></table><P>

エラーが通知されたときには、
変数<CODE>debug-on-error</CODE>は<CODE>nil</CODE>以外であるはずである。
<CODE>quit</CODE>が通知されたときには、
変数<CODE>debug-on-quit</CODE>は<CODE>nil</CODE>以外であるはずである。
<P>

<DT><CODE>nil</CODE>
<DD>明示的にデバッガに入るときには、
<VAR>debugger-args</VAR>の先頭として<CODE>nil</CODE>を使う。
<VAR>debugger-args</VAR>の残りはバッファの先頭行に表示される。
この機能を用いてメッセージを表示でき、
たとえば、<CODE>debug</CODE>を呼び出した条件の覚え書きにする。
</DL>
</DL>
<P>

<A NAME="Internals of Debugger"></A>
<HR SIZE="6">
<br><A NAME="SEC228"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC227"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC229"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Internals of Debugger"></A>
<H3> 17.1.8 デバッガの内部 </H3>
<!--docid::SEC228::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Internals%20of%20Debugger">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Internals%20of%20Debugger</a>"<br>
"texi/elisp21/デバッガの内部"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C7%A5%D0%A5%C3%A5%AC%A4%CE%C6%E2%C9%F4">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節では、デバッガが内部的に使用する関数や変数について述べます。
<P>

<A NAME="IDX862"></A>
<DL>
<DT><U>Variable:</U> <B>debugger</B>
<DD>この変数の値は、デバッガを起動するために呼び出す関数である。
その値は、可変個数の引数を取る関数（あるいは典型的には関数名）であること。
その関数でなんらかのデバッガに入ると仮定する。
この変数のデフォルト値は<CODE>debug</CODE>。
<P>

Lispが関数に渡す最初の引数で、呼び出した理由を表す。
引数の規約は<CODE>debug</CODE>に記述してある。
</DL>
<P>

<A NAME="IDX863"></A>
<DL>
<DT><U>コマンド:</U> <B>backtrace</B>
<DD><A NAME="IDX864"></A>
<A NAME="IDX865"></A>
この関数は、現在活性なLisp関数呼び出しのトレースを表示する。
これは、<CODE>debug</CODE>がバッファ`<SAMP>*Backtrace*</SAMP>'を
満たすために用いる関数である。
どの関数呼び出しが活性であるかを
判断するためにスタックを参照する必要があるためCで書いてある。
戻り値はつねに<CODE>nil</CODE>。
<P>

以下の例では、Lisp式で明示的に<CODE>backtrace</CODE>を呼び出す。
これにより、バックトレースをストリーム<CODE>standard-output</CODE>に出力する。
ここではバッファ`<SAMP>backtrace-output</SAMP>'に出力する。
バックトレースの各行は、1つの関数呼び出しを表す。
関数の引数値すべてが判ればそれらを行に表示する。
それらが計算途中であれば、その旨を行に表示する。
スペシャルフォームの引数は省略する。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(with-output-to-temp-buffer "backtrace-output"
  (let ((var 1))
    (save-excursion
      (setq var (eval '(progn
                         (1+ var)
                         (list 'testing (backtrace))))))))

     => nil

----------- Buffer: backtrace-output ------------
  backtrace()
  (list ...computing arguments...)
  (progn ...)
  eval((progn (1+ var) (list (quote testing) (backtrace))))
  (setq ...)
  (save-excursion ...)
  (let ...)
  (with-output-to-temp-buffer ...)
  eval-region(1973 2142 #&#60;buffer *scratch*&#62;)
  byte-code("...  for eval-print-last-sexp ...")
  eval-print-last-sexp(nil)
* call-interactively(eval-print-last-sexp)
----------- Buffer: backtrace-output ------------
</FONT></pre></td></tr></table><P>

文字`<SAMP>*</SAMP>'は、
抜け出るときにデバッガを起動する印が付いているフレームを表す。
</DL>
<P>

<A NAME="IDX866"></A>
<DL>
<DT><U>Variable:</U> <B>debug-on-next-call</B>
<DD><A NAME="IDX867"></A>
<A NAME="IDX868"></A>
<A NAME="IDX869"></A>
この変数が<CODE>nil</CODE>以外であると、
つぎに<CODE>eval</CODE>、<CODE>apply</CODE>、<CODE>funcall</CODE>を呼び出すまえに
デバッガを呼び出すことを指定する。
デバッガに入ると<CODE>debug-on-next-call</CODE>を<CODE>nil</CODE>に設定する。
<P>

デバッガのコマンド<KBD>d</KBD>は、この変数を設定することで動作する。
</DL>
<P>

<A NAME="IDX870"></A>
<DL>
<DT><U>Function:</U> <B>backtrace-debug</B> <I>level flag</I>
<DD>この関数は、<VAR>level</VAR>の深さのスタックフレームに
値<VAR>flag</VAR>に応じてフレームから抜け出るときのデバッガ呼び出しの印を付ける。
<VAR>flag</VAR>が<CODE>nil</CODE>以外であると、
のちに当該フレームから抜けるとデバッガに入る。
非ローカルな脱出で当該フレームから抜けるときにもデバッガに入る。
<P>

この関数はデバッガのみが使用する。
</DL>
<P>

<A NAME="IDX871"></A>
<DL>
<DT><U>Variable:</U> <B>command-debug-status</B>
<DD>この変数は、現在の対話的コマンドのデバッグ状況を記録する。
コマンドが対話的に呼び出されるたびに、
この変数は<CODE>nil</CODE>に束縛される。
デバッガはこの変数に設定することで、
同じコマンドの起動中にデバッガが将来起動された場合に備えて
情報を残すことができる。
<P>

デバッガにとっては、通常のグローバル変数ではなくこの変数を使う利点は、
以降のコマンド起動にデータが繰り越さないことである。
</DL>
<P>

<A NAME="IDX872"></A>
<DL>
<DT><U>Function:</U> <B>backtrace-frame</B> <I>frame-number</I>
<DD>関数<CODE>backtrace-frame</CODE>は、Lispデバッガで使うことを意図している。
深さ<VAR>frame-number</VAR>のスタックフレームで進行中の計算に関する情報を返す。
<P>

当該フレームで引数の評価を完了していなければ（あるいはスペシャルフォーム）、
値は<CODE>(nil <VAR>function</VAR> <VAR>arg-forms</VAR><small>...</small>)</CODE>。
<P>

当該フレームで引数の評価を完了し関数を呼び出していれば、
値は<CODE>(t <VAR>function</VAR> <VAR>arg-values</VAR><small>...</small>)</CODE>。
<P>

戻り値において、<VAR>function</VAR>は評価したリストのCARであるか、
マクロ呼び出しでは<CODE>lambda</CODE>式である。
関数に引数<CODE>&#38;rest</CODE>があれば、リスト<VAR>arg-values</VAR>の残りで表現される。
<P>

<VAR>frame-number</VAR>が範囲外であると、<CODE>backtrace-frame</CODE>は<CODE>nil</CODE>を返す。
</DL>
<P>

<A NAME="Edebug"></A>
<HR SIZE="6">
<br><A NAME="SEC229"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC228"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC230"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC220"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC219"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC254"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Edebug"></A>
<H2> 17.2 edebug </H2>
<!--docid::SEC229::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug</a>"<br>
"texi/elisp21/edebug"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2Fedebug">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX873"></A>
<P>

<A NAME="IDX874"></A>
edebugはEmacs Lispプログラムのソースレベルデバッガであり、
つぎのことを行えます。
<P>

<UL>
<LI>
各式の前後で停止して評価をステップ実行する。
<P>

<LI>
条件付きブレークポイント、無条件ブレークポイントを設定する。
<P>

<LI>
指定した条件が真の場合に停止する（グローバルブレークイベント）。
<P>

<LI>
各停止位置や各ブレークポイントで停止し低速／高速トレースする。
<P>

<LI>
edebugの外側であるかのように、式の結果を表示したり式を評価する。
<P>

<LI>
edebugが表示を更新するたびに、
自動的に式の並びを再評価しその結果を表示する。
<P>

<LI>
関数の出入りに関するトレース情報を出力する。
<P>

<LI>
エラーが発生すると停止する。
<P>

<LI>
edebug自身のフレームを省いて、バックトレースを表示する。
<P>

<LI>
マクロや定義フォームに対して引数の評価を指定する。
<P>

<LI>
基本的なカバレッジテストや頻度数計測を行う。
</UL>
<P>

以下の最初の3つの節では、edebugを使うのに十分な情報を与えます。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC230">17.2.1 edebugの使い方</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Introduction to use of Edebug.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC231">17.2.2 edebug向けの処置</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">You must instrument your code
				  in order to debug it with Edebug.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC232">17.2.3 edebugの実行モード</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Execution modes, stopping more or less often.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC233">17.2.4 ジャンプ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Commands to jump to a specified place.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC234">17.2.5 edebugのその他のコマンド</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Miscellaneous commands.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC235">17.2.6 ブレークポイント</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Setting breakpoints to make the program stop.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC238">17.2.7 エラーの捕捉</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">trapping errors with Edebug.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC239">17.2.8 edebugのビュー</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Views inside and outside of Edebug.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC240">17.2.9 評価</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Evaluating expressions within Edebug.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC241">17.2.10 評価リストバッファ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Expressions whose values are displayed
				  each time you enter Edebug.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC242">17.2.11 edebugでの出力</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Customization of printing.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC243">17.2.12 トレースバッファ</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to produce trace output in a buffer.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC244">17.2.13 カバレッジテスト</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to test evaluation coverage.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC245">17.2.14 外側の文脈</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Data that Edebug saves and restores.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC249">17.2.15 マクロ呼び出しの処置</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Specifying how to handle macro calls.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC253">17.2.16 edebugのオプション</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Option variables for customizing Edebug.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Using Edebug"></A>
<HR SIZE="6">
<br><A NAME="SEC230"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC229"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC231"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Using Edebug"></A>
<H3> 17.2.1 edebugの使い方 </H3>
<!--docid::SEC230::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Using%20Edebug">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Using%20Edebug</a>"<br>
"texi/elisp21/edebugの使い方"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2Fedebug%A4%CE%BB%C8%A4%A4%CA%FD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

edebugでLispプログラムをデバッグするには、
デバッグしたいLispコードをまず<EM>処置</EM>（instrument）しておく必要があります。
これを行う簡単な方法は、関数やマクロの定義にポイントを移動してから、
<KBD>C-u C-M-x</KBD>（前置引数を指定した<CODE>eval-defun</CODE>）を実行します。
コードを処置する別の方法については、See 節 <A HREF="elisp_18.html#SEC231">17.2.2 edebug向けの処置</A>。
<P>

関数をいったん処置しておけば、当該関数を呼び出すとedebugを活性にします。
edebugが活性になると実行を停止し、
読者が選択したedebugの実行モードに応じて、
関数をステップ実行したりデバッグコマンドを検査しながら
表示を更新しつつ実行を継続します。
デフォルトの実行モードはステップ実行であり、
いったん実行を停止します。
See 節 <A HREF="elisp_18.html#SEC232">17.2.3 edebugの実行モード</A>。
<P>

edebugでは、デバッグ中のLispコードのソースを
表示したEmacsバッファを読者は見ます。
このバッファを<EM>ソースコードバッファ</EM>と呼びます。
このバッファは一時的に読み出し専用です。
<P>

左端の矢印は、関数の実行中の行を表します。
ポイントの初期位置は関数の実行中の行にありますが、
読者自身がポイントを移動すると変わります。
<P>

（以下の）<CODE>fac</CODE>の定義を処置してから<CODE>(fac 3)</CODE>を実行したとすると、
つぎのようになります。
ポイントは<CODE>if</CODE>のまえの開き括弧にあります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun fac (n)
=&#62;-!-(if (&#60; 0 n)
      (* n (fac (1- n)))
    1))
</pre></td></tr></table><P>

<A NAME="IDX875"></A>
edebugが関数内で実行を停止できる箇所を<EM>停止位置</EM>（stop point）と呼びます。
これらは、リストである各部分式の前後と各変数参照のうしろにあります。
関数<CODE>fac</CODE>の中にある停止位置をピリオドで示します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun fac (n)
  .(if .(&#60; 0 n.).
      .(* n. .(fac (1- n.).).).
    1).)
</pre></td></tr></table><P>

ソースコードバッファでは、Emacsのlispモードのコマンドに加えて
edebugの特別なコマンドを使えます。
たとえば、つぎの停止位置まで実行するには
edebugコマンド<KBD>SPC</KBD>を打ちます。
<CODE>fac</CODE>に入ったあとで<KBD>SPC</KBD>を1回打つと、
つぎのような表示になります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun fac (n)
=&#62;(if -!-(&#60; 0 n)
      (* n (fac (1- n)))
    1))
</pre></td></tr></table><P>

式のうしろでedebugが実行を停止すると、
式の値をエコー領域に値を表示します。
<P>

多用される他のコマンドには、
停止位置にブレークポイントを設定する<KBD>b</KBD>、
ブレークポイントに達するまで実行する<KBD>g</KBD>、
edebugを終了してトップレベルのコマンドループへ戻る<KBD>q</KBD>があります。
edebugのコマンド一覧を表示するには<KBD>?</KBD>を打ちます。
<P>

<A NAME="Instrumenting"></A>
<HR SIZE="6">
<br><A NAME="SEC231"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC230"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC232"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Instrumenting"></A>
<H3> 17.2.2 edebug向けの処置 </H3>
<!--docid::SEC231::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Instrumenting">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Instrumenting</a>"<br>
"texi/elisp21/edebug向けの処置"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2Fedebug%B8%FE%A4%B1%A4%CE%BD%E8%C3%D6">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

Lispコードのデバッグにedebugを使うためには、
コードをまず<EM>処置</EM>する必要があります。
コードを処置すると、適当な箇所でedebugを起動する追加のコードを挿入します。
<P>

<A NAME="IDX876"></A>
<A NAME="IDX877"></A>
いったんedebugをロードすると、
コマンド<KBD>C-M-x</KBD>（<CODE>eval-defun</CODE>）は再定義されます。
定義内で前置引数を指定して起動すると
定義を評価するまえに処置するようになります。
（ソースコード自体は変更しない。）
変数<CODE>edebug-all-defs</CODE>が<CODE>nil</CODE>以外であると、
前置引数の意味を逆にします。
つまり、前置引数を指定し<EM>ない限り</EM>、
<KBD>C-M-x</KBD>は関数定義を処置します。
変数<CODE>edebug-all-defs</CODE>のデフォルト値は<CODE>nil</CODE>です。
コマンド<KBD>M-x edebug-all-defs</KBD>は変数<CODE>edebug-all-defs</CODE>の値を
トグルします。
<P>

<A NAME="IDX878"></A>
<A NAME="IDX879"></A>
<CODE>edebug-all-defs</CODE>が<CODE>nil</CODE>以外であると、
コマンド<CODE>eval-region</CODE>、<CODE>eval-current-buffer</CODE>、<CODE>eval-buffer</CODE>も
それらが評価する定義を処置します。
同様に、<CODE>edebug-all-forms</CODE>は、
定義以外のフォームであっても<CODE>eval-region</CODE>が
<EM>任意</EM>のフォームを処置するかどうか制御します。
これは、ミニバッファでのロードや評価には適用されません。
コマンド<KBD>M-x edebug-all-forms</KBD>はこのオプションをトグルします。
<P>

<A NAME="IDX880"></A>
別のコマンド<KBD>M-x edebug-eval-top-level-form</KBD>は、
<CODE>edebug-all-defs</CODE>と<CODE>edebug-all-forms</CODE>の値に関わらず
任意のトップレベルのフォームを処置するために使えます。
<P>

edebugが動作中は、
コマンド<KBD>I</KBD>（<CODE>edebug-instrument-callee</CODE>）で、
ポイントのうしろのフォームから呼ばれる関数やマクロの定義を
処置済みでなければ処置できます。
これは、edebugが当該関数のソースを探せる場合にのみ可能です。
edebugをロード後には、
<CODE>eval-region</CODE>は、処置していないものも含めて、
評価した各定義の位置を記録しています。
関数を処置後に呼び出してステップ実行する
コマンド<KBD>i</KBD>（see 節 <A HREF="elisp_18.html#SEC233">17.2.4 ジャンプ</A>）も参照してください。
<P>

<A NAME="IDX881"></A>
<A NAME="IDX882"></A>
<A NAME="IDX883"></A>
<A NAME="IDX884"></A>
<A NAME="IDX885"></A>
<A NAME="IDX886"></A>
edebugは、標準のスペシャルフォームすべて、
式を引数とする<CODE>interactive</CODE>フォーム、
無名ラムダ式、他の定義フォームをどのように処置するかわかっています。
edebugは、マクロ呼び出しを引数に持つユーザー定義マクロをどのように
処置すべきかわかりませんから、読者がそれを指示する必要があります。
詳しくは、See 節 <A HREF="elisp_18.html#SEC249">17.2.15 マクロ呼び出しの処置</A>。
<P>

edebugは、あるセッションで初めてコードを処置する場合、
フック<CODE>edebug-setup-hook</CODE>を実行してから
それに<CODE>nil</CODE>を設定します。
これを利用すると、読者が使用するパッケージに対応した
edebug用仕様（see 節 <A HREF="elisp_18.html#SEC249">17.2.15 マクロ呼び出しの処置</A>）を
edebugを使用する場合にのみロードするようにできます。
<P>

<A NAME="IDX887"></A>
定義から処置を取り除くには、
処置しないような方法でその定義を単に再評価するだけです。
けっして処置せずにフォームを評価する方法は2つあります。
ファイルを<CODE>load</CODE>するか、
ミニバッファで<CODE>eval-expression</CODE>（<KBD>M-:</KBD>）を使います。
<P>

edebugが処置中に構文エラーを検出すると、
コードのエラー箇所にポイントを置いて、
エラー<CODE>invalid-read-syntax</CODE>を通知します。
<P>

edebugの内側で使える他の評価関数についてはSee 節 <A HREF="elisp_18.html#SEC240">17.2.9 評価</A>。
<P>

<A NAME="Edebug Execution Modes"></A>
<HR SIZE="6">
<br><A NAME="SEC232"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC231"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC233"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Edebug Execution Modes"></A>
<H3> 17.2.3 edebugの実行モード </H3>
<!--docid::SEC232::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Execution%20Modes">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Execution%20Modes</a>"<br>
"texi/elisp21/edebugの実行モード"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2Fedebug%A4%CE%BC%C2%B9%D4%A5%E2%A1%BC%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX888"></A>
edebugには読者がデバッグしているプログラムを実行するための
実行モードが複数あります。
これらを<EM>edebugの実行モード</EM>と呼びます。
これらをメジャーモードやマイナモードと混同しないでください。
edebugの実行モードは、停止するまでにどの程度edebugが実行を継続するか、
たとえば、各停止位置で停止するのかつぎのブレークポイントまで継続するのか、
また、停止するまでに評価の進行状況をどの程度edebugが表示するのかを
決定します。
<P>

通常、あるモードにおいて、
プログラムを継続するコマンドを打つことでedebugの実行モードを指定します。
以下にそれらのコマンドの一覧を示します。
<KBD>S</KBD>を除くすべてのコマンドは、
少なくともある程度プログラムの実行を再開します。
<P>

<DL COMPACT>
<DT><KBD>S</KBD>
<DD>停止：<CODE> </CODE>プログラムをいっさい実行せずに、
edebugコマンドの入力を待つ（<CODE>edebug-stop</CODE>）。
<P>

<DT><KBD><KBD>SPC</KBD></KBD>
<DD>ステップ実行：<CODE> </CODE>つぎに出会う停止位置で止まる（<CODE>edebug-step-mode</CODE>）。
<P>

<DT><KBD>n</KBD>
<DD>つぎ：<CODE> </CODE>式のうしろでつぎに出会う停止位置で止まる
（<CODE>edebug-next-mode</CODE>）。
<A HREF="elisp_18.html#SEC234">17.2.5 edebugのその他のコマンド</A>の<CODE>edebug-forward-sexp</CODE>も参照。
<P>

<DT><KBD>t</KBD>
<DD>トレース：<CODE> </CODE>edebugの各停止位置で1秒間休止する
（<CODE>edebug-trace-mode</CODE>）。
<P>

<DT><KBD>T</KBD>
<DD>高速トレース：<CODE> </CODE>各停止位置で表示を更新するが休止しない
（<CODE>edebug-Trace-fast-mode</CODE>）。
<P>

<DT><KBD>g</KBD>
<DD>実行：<CODE> </CODE>つぎのブレークポイントまで実行する
（<CODE>edebug-go-mode</CODE>）。
see 節 <A HREF="elisp_18.html#SEC235">17.2.6 ブレークポイント</A>。
<P>

<DT><KBD>c</KBD>
<DD>継続：<CODE> </CODE>各ブレークポイントで1秒間休止してから継続する
（<CODE>edebug-continue-mode</CODE>）。
<P>

<DT><KBD>C</KBD>
<DD>高速継続：<CODE> </CODE>各ブレークポイントへポイントを移動するが休止しない
（<CODE>edebug-Continue-fast-mode</CODE>）。
<P>

<DT><KBD>G</KBD>
<DD>非停止実行：<CODE> </CODE>ブレークポイントを無視する
（<CODE>edebug-Go-nonstop-mode</CODE>）。
<KBD>S</KBD>や編集コマンドを打てば停止できる。
</DL>
<P>

一般に、上記一覧の上にある実行モードほど下にあるものに比べると
プログラムをゆっくり実行、つまり、早く停止します。
<P>

実行中やトレース中には、edebugコマンドをなにか打てば実行に割り込めます。
edebugはつぎの停止位置でプログラムを止め、
読者が打ったコマンドを実行します。
たとえば、実行中に<KBD>t</KBD>を打てば、つぎの停止位置でトレースモードに
切り替わります。
単に実行を停止するには<KBD>S</KBD>を使います。
<P>

読者の関数が入力を読み取る場合、実行に割り込むつもりで打った文字を
関数が読み取ってしまうかもしれません。
読者のプログラムがいつ入力するかに注意していれば、
このような意図しない結果を避けることができます。
<P>

<A NAME="IDX889"></A>
本節で述べたコマンドを含むキーボードマクロは動作しません。
つまり、プログラムを再開するためにedebugから抜けると
キーボードマクロの制御を失ってしまいます。
これを修正するのは簡単ではありません。
また、edebugの外側でキーボードマクロを定義したり実行しても、
edebug内のコマンドにはなんの影響もありません。
これは普通は利点です。
しかし、オプション<CODE>edebug-continue-kbd-macro</CODE>
（see 節 <A HREF="elisp_18.html#SEC253">17.2.16 edebugのオプション</A>）も参照してください。
<P>

edebugの新たなレベルに入ると、変数<CODE>edebug-initial-mode</CODE>の値を
実行モードの初期値とします。
デフォルトでは、これはステップ実行モードを指定します。
処置した関数を1つのコマンドから複数回呼び出すなどして
edebugの同一レベルに再度入ることができることに注意してください。
<P>

<A NAME="Jumping"></A>
<HR SIZE="6">
<br><A NAME="SEC233"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC232"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC234"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Jumping"></A>
<H3> 17.2.4 ジャンプ </H3>
<!--docid::SEC233::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Jumping">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Jumping</a>"<br>
"texi/elisp21/ジャンプ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%B8%A5%E3%A5%F3%A5%D7">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節で述べるコマンドは、指定した位置に達するまで実行します。
<KBD>i</KBD>を除くすべてのものは、停止する場所に一時的なブレークポイントを
設定してから実行モードに移行します。
意図したブレークポイントより先に別のブレークポイントに達しても
実行を停止します。
ブレークポイントについて詳しくはSee 節 <A HREF="elisp_18.html#SEC235">17.2.6 ブレークポイント</A>。
<P>

非ローカル脱出は、読者が意図したプログラムの停止すべき
一時的なブレークポイントを迂回するため、
これらのコマンドは非ローカル脱出があると意図したように動作しません。
<P>

<DL COMPACT>
<DT><KBD>h</KBD>
<DD>ポイント位置付近の停止位置まで進む（<CODE>edebug-goto-here</CODE>）。
<P>

<DT><KBD>f</KBD>
<DD>プログラムの式1つ分先へ進む（<CODE>edebug-forward-sexp</CODE>）。
<P>

<DT><KBD>o</KBD>
<DD>囲んでいるS式の終りまでプログラムを実行する。
<P>

<DT><KBD>i</KBD>
<DD>ポイントのあとのフォームから呼ばれる関数やマクロへ進む。
</DL>
<P>

コマンド<KBD>h</KBD>は、一時的なブレークポイントを使って、
ポイント位置付近の停止位置まで進みます。
ブレークポイントについて詳しくはSee 節 <A HREF="elisp_18.html#SEC235">17.2.6 ブレークポイント</A>。
<P>

コマンド<KBD>f</KBD>は、プログラムの式1つ分先へ進みます。
より正確には、<KBD>C-M-f</KBD>による移動箇所へ一時的なブレークポイントを設定し、
プログラムがブレークポイントで停止するような実行モードで実行します。
<P>

前置引数<VAR>n</VAR>を指定すると、
ポイント位置から<VAR>n</VAR>個先のS式に一時的なブレークポイントを設定します。
囲んでいるリストの残り要素数が<VAR>n</VAR>より少なければ、
囲んでいる式の末尾で停止します。
<P>

<KBD>C-M-f</KBD>の移動先はプログラムが実際に停止するであろう箇所です。
これが正しくない場合もあり、たとえば、<CODE>cond</CODE>では正しくありません。
<P>

コマンド<KBD>f</KBD>は、柔軟性のために、
停止位置ではなくポイント位置で<CODE>forward-sexp</CODE>を使います。
<EM>現在の停止位置から</EM>式1つだけ実行したい場合には、
まず<KBD>w</KBD>と打ってポイントを停止位置に移動してから<KBD>f</KBD>を打ちます。
<P>

コマンド<KBD>o</KBD>は式から『出る』まで実行します。
ポイントを含むS式の末尾に一時的なブレークポイントを置きます。
このS式が関数定義そのものである場合には、
<KBD>o</KBD>は定義の最後のS式の手前まで実行します。
現在この箇所にいた場合には、関数から戻ってから停止します。
いいかえれば、最後のS式のあとに位置していない限り、
このコマンドは現在実行中の関数から抜けません。
<P>

コマンド<KBD>i</KBD>は、
ポイント位置のあとにあるリストフォームから呼ばれる関数やマクロへ進み、
最初に出会った停止位置で止まります。
そのフォームはこれから評価されるフォームである必要はありません。
しかし、評価されるフォームが関数呼び出しである場合には、
引数を評価するまえにこのコマンドを使うことを覚えておいてください。
さもないとこのコマンドを使う時期が遅すぎます。
<P>

コマンド<KBD>i</KBD>は、呼び出す関数やマクロが処置されていないと
それらを処置します。
これは便利ですが、それらの関数やマクロは、明示的に処置を取り除かない限り、
処置したままになります。
<P>

<A NAME="Edebug Misc"></A>
<HR SIZE="6">
<br><A NAME="SEC234"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC233"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC235"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Edebug Misc"></A>
<H3> 17.2.5 edebugのその他のコマンド </H3>
<!--docid::SEC234::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Misc">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Misc</a>"<br>
"texi/elisp21/edebugのその他のコマンド"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2Fedebug%A4%CE%A4%BD%A4%CE%C2%BE%A4%CE%A5%B3%A5%DE%A5%F3%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

edebugの他のコマンドを以下に示します。
<P>

<DL COMPACT>
<DT><KBD>?</KBD>
<DD>edebugのヘルプメッセージを表示する（<CODE>edebug-help</CODE>）。
<P>

<DT><KBD>C-]</KBD>
<DD>1つまえのレベルのコマンドレベルへ戻る（<CODE>abort-recursive-edit</CODE>）。
<P>

<DT><KBD>q</KBD>
<DD>エディタのトップレベルのコマンドループへ戻る（<CODE>top-level</CODE>）。
edebugのすべての動作中のレベルを含めて、すべての再帰編集レベルから抜ける。
しかし、フォーム<CODE>unwind-protect</CODE>や<CODE>condition-case</CODE>で保護した
処置済みのコードがあるとデバッガを再開する。
<P>

<DT><KBD>Q</KBD>
<DD><KBD>q</KBD>と同様であるが保護したコードでも停止しない
（<CODE>top-level-nonstop</CODE>）。
<P>

<DT><KBD>r</KBD>
<DD>もっとも最近の式の既知の結果をエコー領域に再表示する
（<CODE>edebug-previous-result</CODE>）。
<P>

<DT><KBD>d</KBD>
<DD>わかりやすいようにedebug自体の関数を除外してバックトレースを表示する
（<CODE>edebug-backtrace</CODE>）。
<P>

edebugのバックトレースバッファでは、
標準のデバッガのようにはデバッガのコマンドを使えない。
<P>

実行を継続するとバックトレースバッファは自動的に削除される。
</DL>
<P>

edebugの再帰編集から、edebugを再帰的に活性にするコマンドを起動できます。
edebugが活性であるときにはいつでも<KBD>q</KBD>でトップレベルへ戻るか、
<KBD>C-]</KBD>で1つの再帰編集レベルを抜けることができます。
保留している評価すべてのバックトレースは<KBD>d</KBD>で表示できます。
<P>

<A NAME="Breakpoints"></A>
<HR SIZE="6">
<br><A NAME="SEC235"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC234"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC236"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Breakpoints"></A>
<H3> 17.2.6 ブレークポイント </H3>
<!--docid::SEC235::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Breakpoints">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Breakpoints</a>"<br>
"texi/elisp21/ブレークポイント"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%D6%A5%EC%A1%BC%A5%AF%A5%DD%A5%A4%A5%F3%A5%C8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX890"></A>
edebugのステップ実行モードは、つぎの停止位置に達すると実行を停止します。
edebugが実行を止める方法は3つあります。
ブレークポイント、グローバルブレーク条件、ソースのブレークポイントです。
<P>

edebugを使用中には、読者がテスト中のプログラムに<EM>ブレークポイント</EM>
（breakpoint）、つまり、実行を停止すべき箇所を設定できます。
<A HREF="elisp_18.html#SEC230">17.2.1 edebugの使い方</A>で定義した任意の停止位置にブレークポイントを設定できます。
ブレークポイントの設定や解除において対象となる停止位置は、
ソースコードバッファのポイント位置かそのあとにある停止位置です。
ブレークポイントに関するedebugコマンドはつぎのとおりです。
<P>

<DL COMPACT>
<DT><KBD>b</KBD>
<DD>ポイント位置かそのうしろにある停止位置にブレークポイントを設定する
（<CODE>edebug-set-breakpoint</CODE>）。
前置引数を指定すると、一時的なブレークポイントになる
（そこでプログラムが停止すると解除される）。
<P>

<DT><KBD>u</KBD>
<DD>ポイント位置かそのうしろにある停止位置の（あれば）ブレークポイントを解除する
（<CODE>edebug-unset-breakpoint</CODE>）。
<P>

<DT><KBD>x <VAR>condition</VAR> <KBD>RET</KBD></KBD>
<DD><VAR>condition</VAR>が<CODE>nil</CODE>以外の値に評価される場合にのみ
プログラムを停止する条件付きブレークポイントを設定する
（<CODE>edebug-set-conditional-breakpoint</CODE>）。
前置引数を指定すると、一時的なブレークポイントになる。
<P>

<DT><KBD>B</KBD>
<DD>現在の定義内にあるつぎのブレークポイントにポイント位置を移動する
（<CODE>edebug-next-breakpoint</CODE>）。
</DL>
<P>

edebug内では、<KBD>b</KBD>でブレークポイントを設定し、
<KBD>u</KBD>で解除できます。
まず目的のedegugの停止位置にポイント位置を移動し、
<KBD>b</KBD>を打ってその箇所にブレークポイントを設定したり、
<KBD>u</KBD>を打ってその箇所のブレークポイントを解除します。
設定されていないブレークポイントを解除しても、なにも起こりません。
<P>

定義を再評価したり再処置すると、その中のブレークポイントすべてを解除します。
<P>

<EM>条件付きブレークポイント</EM>（conditional breakpoint）は、
プログラムがこの箇所に達するたびに条件を検査します。
条件を評価中に発生するどんなエラーも無視し、
<CODE>nil</CODE>として扱います。
条件付きブレークポイントを設定するには<KBD>x</KBD>を使い、
条件式はミニバッファで指定します。
すでに条件付きブレークポイントを設定してある停止位置に
条件付きブレークポイントを設定し直すと、
それまでの条件式がミニバッファに入るので編集できます。
<P>

ブレークポイントを設定するコマンドに前置引数を指定すると、
条件付き／無条件ブレークポイントを<EM>一時的</EM>なものにできます。
一時的ブレークポイントでプログラムが停止すると、
そのブレークポイントは自動的に解除されます。
<P>

edebugのモードが非停止実行でなければ、
edebugはブレークポイントでつねに停止するか休止します。
非停止実行モードでは、ブレークポイントを完全に無視します。
<P>

ブレークポイントの場所を確認するには、コマンド<KBD>B</KBD>を使います。
同じ関数内のポイント箇所のうしろにあるブレークポイントか、
後続のものがなければ最初のブレークポイントにポイント位置を移動します。
このコマンドは実行を継続しません。
バッファ内で単にポイントを移動するだけです。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC236">17.2.6.1 グローバルブレーク条件</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Breaking on an event.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC237">17.2.6.2 ソース上のブレークポイント</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Embedding breakpoints in source code.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Global Break Condition"></A>
<HR SIZE="6">
<br><A NAME="SEC236"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC235"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC237"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Global Break Condition"></A>
<H4> 17.2.6.1 グローバルブレーク条件 </H4>
<!--docid::SEC236::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Global%20Break%20Condition">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Global%20Break%20Condition</a>"<br>
"texi/elisp21/グローバルブレーク条件"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%B0%A5%ED%A1%BC%A5%D0%A5%EB%A5%D6%A5%EC%A1%BC%A5%AF%BE%F2%B7%EF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX891"></A>
<A NAME="IDX892"></A>
<EM>グローバルブレーク条件</EM>（global break condition）は、
指定した条件が満たされると、その場所に関わらず、実行を停止させます。
edebugは各停止位置においてグローバルブレーク条件を評価します。
これが<CODE>nil</CODE>以外の値であると、
ブレークポイントに達したかのように、
実行モードに依存して実行を停止するか休止します。
条件の評価中にエラーが発生しても実行は停止しません。
<P>

<A NAME="IDX893"></A>
条件式は<CODE>edebug-global-break-condition</CODE>に保存されます。
コマンド<KBD>X</KBD>で新たな条件式を指定できます
（<CODE>edebug-set-global-break-condition</CODE>）。
<P>

グローバルブレーク条件は、読者のコードのどこでイベントが発生するかを
調べるもっとも簡単な方法ですが、コードの実行速度をかなり遅くします。
ですから、使用しない場合には条件を<CODE>nil</CODE>に再設定すべきです。
<P>

<A NAME="Source Breakpoints"></A>
<HR SIZE="6">
<br><A NAME="SEC237"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC236"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC238"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Source Breakpoints"></A>
<H4> 17.2.6.2 ソース上のブレークポイント </H4>
<!--docid::SEC237::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Source%20Breakpoints">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Source%20Breakpoints</a>"<br>
"texi/elisp21/ソース上のブレークポイント"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%BD%A1%BC%A5%B9%BE%E5%A4%CE%A5%D6%A5%EC%A1%BC%A5%AF%A5%DD%A5%A4%A5%F3%A5%C8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX894"></A>
<A NAME="IDX895"></A>
定義内のすべてのブレークポイントは、定義を処置し直すたびに失われます。
ブレークポイントを失いたくない場合には、
<EM>ソース上のブレークポイント</EM>（source breakpoint）を指定できます。
これはソースコード上で関数<CODE>edebug</CODE>を呼び出すだけです。
もちろん、条件付けして呼び出せます。
たとえば、関数<CODE>fac</CODE>において、引数がゼロの場合に停止するには、
以下に示すように最初の行を挿入します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun fac (n)
  (if (= n 0) (edebug))
  (if (&#60; 0 n)
      (* n (fac (1- n)))
    1))
</pre></td></tr></table><P>

関数<CODE>fac</CODE>を処置してこの関数を呼び出すと、
<CODE>edebug</CODE>の呼び出しはブレークポイントのように動作します。
実行モードに応じて、edebugはその箇所で停止するか休止します。
<P>

<CODE>edebug</CODE>を呼び出したコードが処置済みでなければ、
この関数は<CODE>debug</CODE>を呼び出します。
<P>

<A NAME="Trapping Errors"></A>
<HR SIZE="6">
<br><A NAME="SEC238"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC237"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC239"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Trapping Errors"></A>
<H3> 17.2.7 エラーの捕捉 </H3>
<!--docid::SEC238::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Trapping%20Errors">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Trapping%20Errors</a>"<br>
"texi/elisp21/エラーの捕捉"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%A8%A5%E9%A1%BC%A4%CE%CA%E1%C2%AA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

Emacsは、通常、エラーが通知されても<CODE>condition-case</CODE>で処理されなかった
場合、エラーメッセージを表示します。
edebugが活性であり処置済みのコードを実行していると、
edebugは処理されなかったエラーすべてに反応します。
この動作を<CODE>edebug-on-error</CODE>と<CODE>edebug-on-quit</CODE>で
カスタマイズできます。
See 節 <A HREF="elisp_18.html#SEC253">17.2.16 edebugのオプション</A>。
<P>

edebugがエラーに反応すると、
エラーを起こすまえ出会った最後の停止位置を表示します。
この位置は、実際にエラーを起こした処置してない関数の呼び出し位置である
場合もあります。
未束縛な変数のエラーでは、最後の停止位置は、
当該変数の参照位置からかなり離れている場合があります。
そのような場合には、完全なバックトレースを表示したいでしょう
（see 節 <A HREF="elisp_18.html#SEC234">17.2.5 edebugのその他のコマンド</A>）。
<P>

edebugが活性なときに<CODE>debug-on-error</CODE>や<CODE>debug-on-quit</CODE>を変更しても、
edebugが不活性になったときにそれらの変更を取り消してしまいます。
さらに、edebugの再帰編集中は、これらの変数はedebugの外側での値に
束縛されます。
<P>

<A NAME="Edebug Views"></A>
<HR SIZE="6">
<br><A NAME="SEC239"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC238"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC240"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Edebug Views"></A>
<H3> 17.2.8 edebugのビュー </H3>
<!--docid::SEC239::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Views">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Views</a>"<br>
"texi/elisp21/edebugのビュー"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2Fedebug%A4%CE%A5%D3%A5%E5%A1%BC">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

これらのedebugのコマンドは、edebugに入るまえのバッファやウィンドウの
状態を調べるものです。
外部ウィンドウ構成は、edebugの外側でのウィンドウの集まりや内容に
関するものです。
<P>

<DL COMPACT>
<DT><KBD>v</KBD>
<DD>外部ウィンドウ構成を一時的に見る
（<CODE>edebug-view-outside</CODE>）。
<P>

<DT><KBD>p</KBD>
<DD>edebugの外側でのカレントバッファと外側でのポイント位置を
一時的に表示する（<CODE>edebug-bounce-point</CODE>）。
前置引数<VAR>n</VAR>は、かわりに休止秒数を指定する。
<P>

<DT><KBD>w</KBD>
<DD>ソースコードバッファで現在の停止位置にポイント位置を戻す
（<CODE>edebug-where</CODE>）。
<P>

同じバッファを表示している別のウィンドウでこのコマンドを使うと、
それ以後、そのウィンドウに現在の定義が表示されるようになる。
<P>

<DT><KBD>W</KBD>
<DD>edebugが外部ウィンドウ構成を保存／復元するかどうかをトグルする
（<CODE>edebug-toggle-save-windows</CODE>）。
<P>

前置引数を指定すると選択したウィンドウだけの保存／復元をトグルする。
ソースコードバッファを表示していないウィンドウを指定するには、
グローバルキーマップの<KBD>C-x X W</KBD>を使う必要がある。
</DL>
<P>

<KBD>v</KBD>で外部ウィンドウ構成を見ることができます。
あるいは、（edebugの外側での）カレントバッファが表示されていなくても
<KBD>p</KBD>でカレントバッファのポイント位置を見ることができます。
ポイント位置を移動したら、
<KBD>w</KBD>でソースコードバッファの停止位置へ戻れます。
<P>

外部ウィンドウ構成を保存<EM>しない</EM>ように<KBD>W</KBD>を使うたびに、
edebugは保存しておいた外部ウィンドウ構成を破棄します。
そのため、保存<EM>する</EM>ように戻しても、
（プログラムを続行することで）edebugを抜けると、
現在のウィンドウ構成は変更されません。
しかし、`<SAMP>*edebug*</SAMP>'と`<SAMP>*edebug-trace*</SAMP>'の自動再表示は、
十分なウィンドウが開いてないと、
読者が見たいバッファと衝突するかもしれません。
<P>

<A NAME="Edebug Eval"></A>
<HR SIZE="6">
<br><A NAME="SEC240"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC239"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC241"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Edebug Eval"></A>
<H3> 17.2.9 評価 </H3>
<!--docid::SEC240::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Eval">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Eval</a>"<br>
"texi/elisp21/評価"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C9%BE%B2%C1">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

edebugの内側では、edebugが動作していないがごとく式を評価できます。
edebugは、式の評価と表示に対して見えないようにします。
edebugが明示的に保存／復元する場合を除いて、
副作用を持つ式の評価も期待どおり動作します。
この処理に関して詳しくはSee 節 <A HREF="elisp_18.html#SEC245">17.2.14 外側の文脈</A>。
<P>

<DL COMPACT>
<DT><KBD>e <VAR>exp</VAR> <KBD>RET</KBD></KBD>
<DD>edebugの外側の文脈で式<VAR>exp</VAR>を評価する
（<CODE>edebug-eval-expression</CODE>）。
つまり、edebugは評価への干渉を最小限にとどめようとする。
<P>

<DT><KBD>M-: <VAR>exp</VAR> <KBD>RET</KBD></KBD>
<DD>edebug自身の文脈で式<VAR>exp</VAR>を評価する。
<P>

<DT><KBD>C-x C-e</KBD>
<DD>edebugの外側の文脈でポイント位置のまえの式を評価する
（<CODE>edebug-eval-last-sexp</CODE>）。
</DL>
<P>

<A NAME="IDX896"></A>
edebugは`<TT>cl.el</TT>'（版2.03以降）内の構文
<CODE>lexical-let</CODE>、<CODE>macrolet</CODE>、<CODE>symbol-macrolet</CODE>で
作成されるレキシカル（テキスト上の）束縛を参照する式の評価を扱えます。
<P>

<A NAME="Eval List"></A>
<HR SIZE="6">
<br><A NAME="SEC241"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC240"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC242"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Eval List"></A>
<H3> 17.2.10 評価リストバッファ </H3>
<!--docid::SEC241::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Eval%20List">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Eval%20List</a>"<br>
"texi/elisp21/評価リストバッファ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C9%BE%B2%C1%A5%EA%A5%B9%A5%C8%A5%D0%A5%C3%A5%D5%A5%A1">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

`<SAMP>*edebug*</SAMP>'と呼ばれる<EM>評価リストバッファ</EM>を使って、
式を対話的に評価できます。
さらに、edebugが表示を更新するたびに自動的に評価される
式の<EM>評価リスト</EM>を設定することもできます。
<P>

<DL COMPACT>
<DT><KBD>E</KBD>
<DD>評価リストバッファ`<SAMP>*edebug*</SAMP>'へ切り替える
（<CODE>edebug-visit-eval-list</CODE>）。
</DL>
<P>

バッファ`<SAMP>*edebug*</SAMP>'では、以下の特別なコマンドに加えて
lisp対話モード
（see <a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=emacs21&node=Lisp%20Interaction">GNU Emacs マニュアル</a>）
のコマンドも使えます。
<P>

<DL COMPACT>
<DT><KBD>C-j</KBD>
<DD>外側の文脈でポイント位置のまえの式を評価し、
その値をバッファに挿入する
（<CODE>edebug-eval-print-last-sexp</CODE>）。
<P>

<DT><KBD>C-x C-e</KBD>
<DD>edebugの外側の文脈でポイント位置のまえの式を評価する
（<CODE>edebug-eval-last-sexp</CODE>）。
<P>

<DT><KBD>C-c C-u</KBD>
<DD>バッファの内容から新たな評価リストを構築する
（<CODE>edebug-update-eval-list</CODE>）。
<P>

<DT><KBD>C-c C-d</KBD>
<DD>ポイント位置にある評価リストグループを削除する
（<CODE>edebug-delete-eval-item</CODE>）。
<P>

<DT><KBD>C-c C-w</KBD>
<DD>ソースコードバッファに切り替え現在の停止位置に戻る
（<CODE>edebug-where</CODE>）。
</DL>
<P>

`<SAMP>*scratch*</SAMP>'で行うのと同様に、
評価リストウィンドウでは<KBD>C-j</KBD>や<KBD>C-x C-e</KBD>で式を評価できますが、
それらはedebugの外側の文脈で評価されます。
<P>

実行を継続すると、対話的に入力した式（やその結果）は破棄されますが、
実行を停止するたびに評価される式から成る<EM>評価リスト</EM>（evaluation list）
を設定できます。
<P>

<A NAME="IDX897"></A>
これを行うには、評価リストバッファにて、
1つ以上の<EM>評価リストグループ</EM>（evaluation list group）を書きます。
評価リストグループは、1つ以上のLisp式から成ります。
グループはコメント行で区切ります。
<P>

コマンド<KBD>C-c C-u</KBD>（<CODE>edebug-update-eval-list</CODE>）は、
バッファを走査して各グループの最初の式を使って
評価リストを再構築します。
（各グループの2番目の式は計算結果を表示した値とみなす。）
<P>

edebugに入るたびに、各式に続けてその現在値をバッファに挿入することで
評価リストを再表示します。
このとき、各式がそれぞれグループになるようにコメント行も挿入します。
したがって、バッファのテキストを変更せずに再度<KBD>C-c C-u</KBD>と打つと、
評価リストは実質的には変更されません。
<P>

評価リストの評価中にエラーが発生すると、
エラーメッセージを評価結果とみなして文字列で表示します。
したがって、現在の文脈では不正な変数を式に使っても
読者のデバッグを遮ることはありません。
<P>

評価リストウィンドウに数個の式を追加したときのようすを以下に示します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(current-buffer)
#&#60;buffer *scratch*&#62;
;---------------------------------------------------------------
(selected-window)
#&#60;window 16 on *scratch*&#62;
;---------------------------------------------------------------
(point)
196
;---------------------------------------------------------------
bad-var
"Symbol's value as variable is void: bad-var"
;---------------------------------------------------------------
(recursion-depth)
0
;---------------------------------------------------------------
this-command
eval-last-sexp
;---------------------------------------------------------------
</FONT></pre></td></tr></table><P>

グループを削除するには、そこへポイントを移動して<KBD>C-c C-d</KBD>と打ちます。
あるいは、グループのテキストを単に削除してから<KBD>C-c C-u</KBD>で
評価リストを更新します。
評価リストに新たに式を追加するには、
適切な位置に式を挿入し、新たなコメント行を挿入します。
（コメント行にマイナス記号を挿入する必要はない。
コメントの内容は関係ない。）
そして、<KBD>C-c C-u</KBD>と打ちます
<P>

`<SAMP>*edebug*</SAMP>'を選択したあとは、
<KBD>C-c C-w</KBD>でソースコードバッファへ戻れます。
読者が実行を継続するとバッファ`<SAMP>*edebug*</SAMP>'は削除され、
つぎに必要なときに再度作成されます。
<P>

<A NAME="Printing in Edebug"></A>
<HR SIZE="6">
<br><A NAME="SEC242"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC241"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC243"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Printing in Edebug"></A>
<H3> 17.2.11 edebugでの出力 </H3>
<!--docid::SEC242::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Printing%20in%20Edebug">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Printing%20in%20Edebug</a>"<br>
"texi/elisp21/edebugでの出力"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2Fedebug%A4%C7%A4%CE%BD%D0%CE%CF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX898"></A>
<A NAME="IDX899"></A>
<A NAME="IDX900"></A>
読者のプログラムの式が循環したリスト構造を含む値を作り出す場合、
edebugがそれを出力しようとするとエラーになります。
<P>

循環構造を扱う1つの方法は、出力を切り詰めるために
<CODE>print-length</CODE>や<CODE>print-level</CODE>を設定することです。
edebugが読者のためにこれを行います。
それらが<CODE>nil</CODE>であると、
edebugは<CODE>print-length</CODE>と<CODE>print-level</CODE>を50に束縛します。
（実際は、edebugが使う値は
<CODE>e-debug-print-length</CODE>と<CODE>e-debug-print-level</CODE>が指定する。）
See 節 <A HREF="elisp_19.html#SEC264">18.6 出力に影響する変数</A>。
<P>

<A NAME="IDX901"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-print-length</B>
<DD><CODE>nil</CODE>以外であると、edebugが結果を出力するときには、
これを<CODE>print-length</CODE>に束縛する。
デフォルト値は<CODE>50</CODE>。
</DL>
<P>

<A NAME="IDX902"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-print-level</B>
<DD><CODE>nil</CODE>以外であると、edebugが結果を出力するときには、
これを<CODE>print-level</CODE>に束縛する。
デフォルト値は<CODE>50</CODE>。
</DL>
<P>

パッケージ`<TT>cust-print</TT>'を使えば、
循環構造や要素を共有する構造をより的確に出力することもできます。
<P>

`<TT>cust-print</TT>'をロードしてedebugでのみこの特別な出力を使うようにするには、
単にコマンド<KBD>M-x edebug-install-custom-print</KBD>を使うだけです。
標準の出力関数に戻すには、<KBD>M-x edebug-uninstall-custom-print</KBD>を使います。
<P>

循環構造を作るコードの例を示します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(setq a '(x y))
(setcar a a)
</pre></td></tr></table><P>

特別な出力ではこれを`<SAMP>Result: #1=(#1# y)</SAMP>'と出力します。
`<SAMP>#1=</SAMP>'の記法は、これに続く構造に`<SAMP>1</SAMP>'というラベルを付けます。
また、`<SAMP>#1#</SAMP>'の記法はすでにラベル付けした構造を参照します。
この記法は、リストやベクトルの任意の共有された要素に使われます。
<P>

<A NAME="IDX903"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-print-circle</B>
<DD><CODE>nil</CODE>以外であると、edebugが結果を出力するときには、
これを<CODE>print-circle</CODE>に束縛する。
デフォルト値は<CODE>nil</CODE>。
</DL>
<P>

他のプログラムでもこの特別な出力を使えます。
詳しくは、`<TT>cust-print.el</TT>'を参照してください。
<P>

<A NAME="Trace Buffer"></A>
<HR SIZE="6">
<br><A NAME="SEC243"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC242"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC244"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Trace Buffer"></A>
<H3> 17.2.12 トレースバッファ </H3>
<!--docid::SEC243::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Trace%20Buffer">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Trace%20Buffer</a>"<br>
"texi/elisp21/トレースバッファ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C8%A5%EC%A1%BC%A5%B9%A5%D0%A5%C3%A5%D5%A5%A1">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX904"></A>
<P>

edebugは、実行トレースを`<SAMP>*edebug-trace*</SAMP>'というバッファに保存することで
それらを記録できます。
これは、関数名とそれらの引数、戻り値から成る
関数呼び出しとその戻りの記録です。
トレース記録を有効にするには、
<CODE>edebug-trace</CODE>に<CODE>nil</CODE>以外の値を設定します。
<P>

トレースバッファを作成することとトレース実行モードとは
同じではありません（see 節 <A HREF="elisp_18.html#SEC232">17.2.3 edebugの実行モード</A>）。
<P>

トレース記録を有効にしていると、
各関数へ入るときと出るときに、トレースバッファに行が追加されます。
関数へ入るときの記録は、`<SAMP>::::{</SAMP>'に関数名と引数値が続きます。
関数から出るときの記録は、`<SAMP>::::}</SAMP>'に関数名とその結果が続きます。
<P>

入るときの`<SAMP>:</SAMP>'の個数は、再帰の深さを表します。
関数呼び出しの対応する開始や対応する終了を探すために
トレースバッファでは中括弧を使えます。
<P>

<A NAME="IDX905"></A>
<A NAME="IDX906"></A>
関数<CODE>edebug-print-trace-before</CODE>と<CODE>edebug-print-trace-after</CODE>を
再定義すれば、関数へ入ったときと出るときのトレース記録をカスタマイズできます。
<P>

<A NAME="IDX907"></A>
<DL>
<DT><U>Macro:</U> <B>edebug-tracing</B> <I>string body<small>...</small></I>
<DD>このマクロはフォーム<VAR>body</VAR>の周りにトレース情報を追加する。
引数<VAR>string</VAR>は、トレースバッファに入れるテキストを指定する。
すべての引数を評価する。
<CODE>edebug-tracing</CODE>は<VAR>body</VAR>の最後のフォームの値を返す。
</DL>
<P>

<A NAME="IDX908"></A>
<DL>
<DT><U>Function:</U> <B>edebug-trace</B> <I>format-string &#38;rest format-args</I>
<DD>この関数はトレースバッファにテキストを挿入する。
テキストは<CODE>(apply 'format <VAR>format-string</VAR> <VAR>format-args</VAR>)</CODE>で
計算する。
区切りとして改行も挿入する。
</DL>
<P>

<CODE>edebug-tracing</CODE>と<CODE>edebug-trace</CODE>は、
edebugが活性でない場合であっても呼ばれるとトレースバッファに行を挿入します。
トレースバッファにテキストを挿入するとき、
挿入した最後の行が見えるようにウィンドウをスクロールします。
<P>

<A NAME="Coverage Testing"></A>
<HR SIZE="6">
<br><A NAME="SEC244"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC243"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC245"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Coverage Testing"></A>
<H3> 17.2.13 カバレッジテスト </H3>
<!--docid::SEC244::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Coverage%20Testing">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Coverage%20Testing</a>"<br>
"texi/elisp21/カバレッジテスト"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AB%A5%D0%A5%EC%A5%C3%A5%B8%A5%C6%A5%B9%A5%C8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX909"></A>
<A NAME="IDX910"></A>
<A NAME="IDX911"></A>
edebugでは、初歩的なカバレッジテストや実行頻度を表示できます。
<P>

カバレッジテストでは、各式の結果を以前の結果と比較します。
現在のEmacsセッションでカバレッジテストを始めて以降、
プログラムの各フォームが異なる2つの値を返せば、
当該フォームを『カバーした』とみなします。
したがって、読者のプログラムについてカバレッジテストを行うには、
さまざまな条件でそれを実行して正しく動作しているか注意します。
読者が各フォームが異なる2つの値を返すように試行し終れば、
edebugはそのように通知します。
<P>

カバレッジテストは実行速度を遅くするので、
<CODE>edebug-test-coverage</CODE>が<CODE>nil</CODE>以外の場合にのみテストします。
すべての処置済み関数の実行に関する頻度数計測は、
非停止実行モードであってもカバレッジテストのオン／オフに関わらず行います。
<P>

ある定義に関するカバレッジテストと頻度数計測を表示するには
<KBD>M-x edebug-display-freq-count</KBD>を使います。
<P>

<A NAME="IDX912"></A>
<DL>
<DT><U>コマンド:</U> <B>edebug-display-freq-count</B>
<DD>このコマンドは、現在の定義の各行について頻度数データを表示する。
<P>

頻度数は、コードの各行のあとにコメント行として表示され、
コマンド<CODE>undo</CODE>でそれらのコメント行の挿入をアンドゥできる。
頻度数は、式のまえの`<SAMP>(</SAMP>'や式のうしろの`<SAMP>)</SAMP>'の直下、
あるいは、変数の最後の文字に表示される。
表示を簡素にするために、頻度数が同じ行のまえのほうの式の頻度数と同じであると
表示しない。
<P>

式の頻度数に続く文字`<SAMP>=</SAMP>'は、
その式を評価するたびに同じ値を返したことを意味する。
いいかえれば、カバレッジテストとしては、
その式はまだ『カバーして』いないことになる。
<P>

ある定義に関する頻度数計測とカバレッジデータをクリアするには、
<CODE>eval-defun</CODE>で単に再処置すればよい。
</DL>
<P>

たとえば、<CODE>edebug-test-coverage</CODE>を<CODE>t</CODE>とし、
ソース上のブレークポイントを設定して<CODE>(fac 5)</CODE>を評価すると、
ブレークポイントに達したときの頻度数データはつぎのようになります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun fac (n)
  (if (= n 0) (edebug))
;#6           1      0 =5 
  (if (&#60; 0 n)
;#5         = 
      (* n (fac (1- n)))
;#    5               0  
    1))
;#   0 
</pre></td></tr></table><P>

コメント行は、<CODE>fac</CODE>が6回呼ばれたことを表します。
最初の<CODE>if</CODE>文は、5回とも同じ結果を返したのです。
2番目の<CODE>if</CODE>についても同じです。
<CODE>fac</CODE>の再帰呼び出しは1度も戻っていません。
<P>

<A NAME="The Outside Context"></A>
<HR SIZE="6">
<br><A NAME="SEC245"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC244"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC246"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="The Outside Context"></A>
<H3> 17.2.14 外側の文脈 </H3>
<!--docid::SEC245::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=The%20Outside%20Context">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=The%20Outside%20Context</a>"<br>
"texi/elisp21/外側の文脈"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B3%B0%C2%A6%A4%CE%CA%B8%CC%AE">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

edebugは、読者がデバッグ中のプログラムに対しては透過であるように努めますが、
完全にうまくいくとは限りません。
また、<KBD>e</KBD>で読者が式を評価するときや評価リストバッファでも、
外側の文脈を一時的に復元して透過であるように努めます。
本節では、edebugが復元する文脈について正確に説明し、
edebugが透過にならない場合についても説明します。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC246">17.2.14.1 停止すべきかどうかの検査</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">When Edebug decides what to do.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC247">17.2.14.2 edebugの表示の更新</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">When Edebug updates the display.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC248">17.2.14.3 edebugの再帰編集</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">When Edebug stops execution.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Checking Whether to Stop"></A>
<HR SIZE="6">
<br><A NAME="SEC246"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC245"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC247"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Checking Whether to Stop"></A>
<H4> 17.2.14.1 停止すべきかどうかの検査 </H4>
<!--docid::SEC246::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Checking%20Whether%20to%20Stop">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Checking%20Whether%20to%20Stop</a>"<br>
"texi/elisp21/停止すべきかどうかの検査"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C4%E4%BB%DF%A4%B9%A4%D9%A4%AD%A4%AB%A4%C9%A4%A6%A4%AB%A4%CE%B8%A1%BA%BA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

edebugに入ると、トレース情報を作るのかプログラムを停止するのかを
決定するまえであってもある種のデータを保存／復元する必要が
つねにあります。
<P>

<UL>
<LI>
edebugがスタックに与える影響を軽減するために、
<CODE>max-lisp-eval-depth</CODE>と<CODE>max-specpdl-size</CODE>を一度増加する。
しかし、こうしてもedebugを使うときにスタックを使い切ってしまうことがある。
<P>

<LI>
キーボードマクロの実行状態を保存し復元する。
edebugが活性であると、<CODE>executing-macro</CODE>は
<CODE>edebug-continue-kbd-macro</CODE>に束縛される。
<P>

</UL>
<P>

<A NAME="Edebug Display Update"></A>
<HR SIZE="6">
<br><A NAME="SEC247"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC246"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC248"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Edebug Display Update"></A>
<H4> 17.2.14.2 edebugの表示の更新 </H4>
<!--docid::SEC247::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Display%20Update">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Display%20Update</a>"<br>
"texi/elisp21/edebugの表示の更新"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2Fedebug%A4%CE%C9%BD%BC%A8%A4%CE%B9%B9%BF%B7">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

edebugが（トレースモードなどで）なにかを表示する必要があると、
edebugの『外側』の現在のウィンドウ構成を保存します
（see 節 <A HREF="elisp_28.html#SEC432">27.16 ウィンドウ構成</A>）。
（プログラムを続行して）edebugを抜けるときには、
以前のウィンドウ構成を復元します
<P>

Emacsは休止するときにのみ表示を更新します。
通常、プログラムを続行しても、休止したり入力を読むことなく
ブレークポイントやステップ実行によりedebugへ戻ります。
そのような場合、Emacsには（edebugの）『外側』のようすを再表示する
機会が与えられません。
見かけ上、ウィンドウの表示は直前にedebugが活性であったときと同じになります。
<P>

なにかを表示するためにedebugに入っても以下のデータを保存／復元しますが、
エラーや中断が起こると、故意に復元しないものもあります。
<P>

<UL>
<LI>
<A NAME="IDX913"></A>
カレントであるバッファと、そのバッファ内のポイントとマークは
保存／復元される。
<P>

<LI>
<A NAME="IDX914"></A>
<CODE>edebug-save-windows</CODE>が<CODE>nil</CODE>以外ならば、
外側でのウィンドウ構成を保存／復元する
（see 節 <A HREF="elisp_18.html#SEC247">17.2.14.2 edebugの表示の更新</A>）。
<P>

エラーや中断が起こるとウィンドウ構成は復元されない。
しかし、<CODE>save-excursion</CODE>を使っていれば、
エラーや中断が起こっても、
外側で選択していたウィンドウは選択<EM>される</EM>。
<CODE>edebug-save-windows</CODE>の値がリストであると、
リストに指定したウィンドウのみを保存／復元する。
<P>

ソースコードバッファのウィンドウ開始位置やスクロールは復元しないが、
これは、edebug内での表示が統一されるようにするためである。
<P>

<LI>
<CODE>edebug-save-displayed-buffer-points</CODE>が<CODE>nil</CODE>以外であれば、
表示されている各バッファのポイント位置の値を保存／復元する。
<P>

<LI>
変数<CODE>overlay-arrow-position</CODE>と<CODE>overlay-arrow-string</CODE>は、
保存／復元される。
そのため、同じバッファで再帰編集からedebugを起動しても安全である。
<P>

<LI>
カーソルがウィンドウに表示されるように、
<CODE>cursor-in-echo-area</CODE>は<CODE>nil</CODE>にローカルに束縛する。
</UL>
<P>

<A NAME="Edebug Recursive Edit"></A>
<HR SIZE="6">
<br><A NAME="SEC248"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC247"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC249"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Edebug Recursive Edit"></A>
<H4> 17.2.14.3 edebugの再帰編集 </H4>
<!--docid::SEC248::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Recursive%20Edit">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Recursive%20Edit</a>"<br>
"texi/elisp21/edebugの再帰編集"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2Fedebug%A4%CE%BA%C6%B5%A2%CA%D4%BD%B8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

edebugに入ってユーザーコマンドを読み取るとき、
以下のデータを保存し（のちに復元し）ます。
<P>

<UL>
<LI>
カレントマッチデータ。
see 節 <A HREF="elisp_34.html#SEC557">33.6 マッチデータ</A>。
<P>

<LI>
<CODE>last-command</CODE>、<CODE>this-command</CODE>、<CODE>last-command-char</CODE>、
<CODE>last-input-char</CODE>、<CODE>last-input-event</CODE>、
<CODE>last-command-event</CODE>、<CODE>last-event-frame</CODE>、
<CODE>last-nonmenu-event</CODE>、<CODE>track-mouse</CODE>。
edebug内で使ったコマンドは、edebugの外側でのこれらの変数には影響しない。
<P>

<CODE>this-command-keys</CODE>が返すキー列は
edebug内でコマンドを実行すると変更されてしまい、
Lispからキー列を設定し直す方法はない。
<P>

edebugは<CODE>unread-command-events</CODE>の値を保存／復元できない。
この変数に変な値が入っているときにedebugに入ると、
読者がデバッグするプログラムの実行に干渉することがある。
<P>

<LI>
edebug内で実行された複雑なコマンドは
変数<CODE>command-history</CODE>に追加される。
これにより実行結果を変更することはほとんどない。
<P>

<LI>
edebug内での再帰の深さは、edebugの外側での深さより1だけ深い。
自動的に更新される評価リストウィンドウではそうではない。
<P>

<LI>
<CODE>recursive-edit</CODE>は
<CODE>standard-output</CODE>と<CODE>standard-input</CODE>を<CODE>nil</CODE>に束縛するが、
edebugは評価中にはそれらを一時的に復元する。
<P>

<LI>
キーボードマクロ定義の状態は保存／復元する。
edebuが活性であると、<CODE>defining-kbd-macro</CODE>は
<CODE>edebug-continue-kbd-macro</CODE>に束縛される。
</UL>
<P>

<A NAME="Instrumenting Macro Calls"></A>
<HR SIZE="6">
<br><A NAME="SEC249"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC248"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC250"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Instrumenting Macro Calls"></A>
<H3> 17.2.15 マクロ呼び出しの処置 </H3>
<!--docid::SEC249::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Instrumenting%20Macro%20Calls">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Instrumenting%20Macro%20Calls</a>"<br>
"texi/elisp21/マクロ呼び出しの処置"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%DE%A5%AF%A5%ED%B8%C6%A4%D3%BD%D0%A4%B7%A4%CE%BD%E8%C3%D6">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

edebugがLispマクロを呼び出す式を処置するとき、
それを正しく行うにはマクロに関する余分な情報を必要とします。
マクロ呼び出しのどの部分式が評価されるフォームであるかを
明確に判定する方法がないからです。
（マクロ本体で明示的に評価されるか、
結果の展開形が評価されるときか、あるいは、さらにあと）
<P>

したがって、edebugが出会う各マクロについて、
当該マクロの呼び出し形式を記述するedebug用仕様を定義する必要があります。
これには、<CODE>def-edebug-spec</CODE>を使います。
<P>

<A NAME="IDX915"></A>
<DL>
<DT><U>マクロ:</U> <B>def-edebug-spec</B> <I>macro specification</I>
<DD>マクロ<VAR>macro</VAR>の呼び出しのどの式が評価されるかを指定する。
単純なマクロでは、<VAR>specification</VAR>は
マクロ定義の仮引数リストに似ているが、
その指定はマクロ引数よりも汎用性がある。
<P>

引数<VAR>macro</VAR>はマクロ名だけでなく任意のシンボルでよい。
</DL>
<P>

例題マクロ<CODE>for</CODE>（see 節 <A HREF="elisp_13.html#SEC178">12.6.1 マクロ引数の複数回評価</A>）の
edebug用仕様の等価な定義例2つを示します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(def-edebug-spec for
  (symbolp "from" form "to" form "do" &#38;rest form))

(def-edebug-spec for
  (symbolp ['from form] ['to form] ['do body]))
</pre></td></tr></table><P>

<VAR>specification</VAR>に指定するものとその引数の処理方法は次表のとおりです。
<P>

<DL COMPACT>
<DT><CODE>t</CODE>
<DD>すべての引数を評価するように処置する。
<P>

<DT><CODE>0</CODE>
<DD>引数はいっさい処置しない。
<P>

<DT>シンボル
<DD>edebug用仕様を持つシンボルをかわりに使う。
この間接参照は別の種類の仕様を得るまで繰り返す。
これにより、別のマクロから仕様を継承できる。
<P>

<DT>リスト
<DD>リストの各要素は、呼び出しフォームの引数の型を記述する。
仕様リストの各要素については次節で述べる。
</DL>
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC250">17.2.15.1 仕様リスト</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to specify complex patterns of evaluation.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC251">17.2.15.2 仕様内でのバックトラック</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">What Edebug does when matching fails.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC252">17.2.15.3 仕様の例</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">To help understand specifications.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Specification List"></A>
<HR SIZE="6">
<br><A NAME="SEC250"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC249"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC251"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Specification List"></A>
<H4> 17.2.15.1 仕様リスト </H4>
<!--docid::SEC250::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Specification%20List">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Specification%20List</a>"<br>
"texi/elisp21/仕様リスト"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BB%C5%CD%CD%A5%EA%A5%B9%A5%C8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX916"></A>
マクロ呼び出しの引数のあるものは評価し別のものは評価しない場合には、
edebug用仕様に<EM>仕様リスト</EM>（specification list）が必要になります。
複数の引数に一致する仕様リストの要素もありますが、
後続の要素の処理を修飾する要素もあります。
後者は<EM>仕様キーワード</EM>（specification keyword）と呼ばれ、
（<CODE>&#38;optional</CODE>のように）`<SAMP>&#38;</SAMP>'で始まるシンボルです。
<P>

仕様リストには、それ自体がリストである引数に一致する部分リストや
グループ化に使うベクトルを含んでもかまいません。
部分リストやグループは仕様リストを階層に分けます。
仕様キーワードはそれらを含む部分リストやグループの残りに適用されます。
<P>

仕様リストに選択肢や繰り返しが含まれる場合、
実際のマクロ呼び出しに一致させるにはバックトラックが必要な場合もあります。
詳しくはSee 節 <A HREF="elisp_18.html#SEC251">17.2.15.2 仕様内でのバックトラック</A>。
<P>

edebug用仕様では、正規表現による一致と文脈自由文法の構文を使えます。
対応した括弧に囲まれた部分リスト、フォームの再帰的処理、
間接仕様による再帰です。
<P>

仕様リストの要素に指定できるものとそれらの意味を以下に示します。
<P>

<DL COMPACT>
<DT><CODE>sexp</CODE>
<DD>処置しない評価しない1つのLispオブジェクト。
<P>

<DT><CODE>form</CODE>
<DD>処置した評価する1つの式。
<P>

<DT><CODE>place</CODE>
<DD><A NAME="IDX917"></A>
Common Lispの<CODE>setf</CODE>構文のように値を格納する場所。
<P>

<DT><CODE>body</CODE>
<DD><CODE>&#38;rest form</CODE>の省略形。
以下の<CODE>&#38;rest</CODE>を参照。
<P>

<DT><CODE>function-form</CODE>
<DD>関数フォーム。
クォートした関数シンボル、クォートしたラムダ式、
あるいは、（関数シンボルやラムダ式に評価される）フォーム。
これは、ラムダ式である引数が、
<CODE>function</CODE>ではなく<CODE>quote</CODE>でクォートされるときに有用である。
というのは、ラムダ式の本体をいずれかの方法で処置するからである。
<P>

<DT><CODE>lambda-expr</CODE>
<DD>クォートしていないラムダ式。
<P>

<DT><CODE>&#38;optional</CODE>
<DD><A NAME="IDX918"></A>
この仕様リスト内の後続の要素すべては省略可能。
一致しないと、edebugはただちにこのレベルの一致を止める。
<P>

数個の省略可能な要素に省略不可な要素を続けるには、
<CODE>[&#38;optional <VAR>specs</VAR><small>...</small>]</CODE>を使う。
数個の要素がすべて一致するかまったく一致しないことを指定するには、
<CODE>&#38;optional [<VAR>specs</VAR><small>...</small>]</CODE>を使う。
以下の<CODE>defun</CODE>の例を参照。
<P>

<DT><CODE>&#38;rest</CODE>
<DD><A NAME="IDX919"></A>
この仕様リスト内の後続の要素すべてを0回以上繰り返す。
最後の繰り返しでは、仕様リストの要素すべてに一致するまえに
式を使い尽くしても問題にはならない。
<P>

数個の要素のみを繰り返すには<CODE>[&#38;rest <VAR>specs</VAR><small>...</small>]</CODE>を使う。
各繰り返しですべてが一致するような数個の要素を指定するには、
<CODE>&#38;rest [<VAR>specs</VAR><small>...</small>]</CODE>を使う。
<P>

<DT><CODE>&#38;or</CODE>
<DD><A NAME="IDX920"></A>
仕様リスト内の後続の各リストは選択肢を表す。
選択肢の1つに一致しなければ、仕様<CODE>&#38;or</CODE>は失敗。
<P>

<CODE>&#38;or</CODE>に続く各要素は1つの選択肢を表す。
複数の要素を1つの選択肢としてグループにまとめるには、
それらを<CODE>[<small>...</small>]</CODE>で囲む。
<P>

<DT><CODE>&#38;not</CODE>
<DD><A NAME="IDX921"></A>
<CODE>&#38;or</CODE>を使ったかように後続の要素を選択肢として一致させるが、
どれかが一致すると仕様は失敗。
どれにも一致しなければ、仕様<CODE>&#38;not</CODE>は成功。
<P>

<DT><CODE>&#38;define</CODE>
<DD><A NAME="IDX922"></A>
仕様は定義フォームに対するものであることを表す。
定義フォームそのものは処置しない
（つまり、edbugは定義フォームの前後で停止しない）が、
この内側にあるフォームは典型的には処置される。
キーワード<CODE>&#38;define</CODE>はリスト仕様の最初の要素である必要がある。
<P>

<DT><CODE>nil</CODE>
<DD>現在の引数リストのレベルにおいて一致する引数がなければ成功する。
さもなければ失敗。
部分リスト仕様と以下のバッククォートの例を参照。
<P>

<DT><CODE>gate</CODE>
<DD><A NAME="IDX923"></A>
いかなる引数とも一致しないが、このゲートを通ると、
このレベルの仕様の残りの部分と一致を調べる際には
バックトラックを禁止する。
これは主により詳しい構文エラーメッセージを生成するために使う。
詳しくは<A HREF="elisp_18.html#SEC251">17.2.15.2 仕様内でのバックトラック</A>を参照。
例については以下の<CODE>let</CODE>を参照。
<P>

<DT><CODE><VAR>その他のシンボル</VAR></CODE>
<DD><A NAME="IDX924"></A>
仕様リストのその他のシンボルは述語であるか間接仕様である。
<P>

シンボルにedebug用仕様があれば、
この<EM>間接仕様</EM>は、シンボルのかわりに使われる仕様リストであるか、
引数を処理するために呼び出される関数であること。
仕様は、マクロ向けに<CODE>def-edebug-spec</CODE>で定義した仕様であってもよい。
以下の<CODE>defun</CODE>の例を参照。
<P>

さもなければ、シンボルは述語であること。
述語は引数で呼び出され、述語が<CODE>nil</CODE>を返すと仕様は失敗する。
いずれの場合でも、当該引数は処置されない。
<P>

適当な述語には、<CODE>symbolp</CODE>、<CODE>integerp</CODE>、
<CODE>stringp</CODE>、<CODE>vectorp</CODE>、<CODE>atom</CODE>がある。
<P>

<DT><CODE>[<VAR>elements</VAR><small>...</small>]</CODE>
<DD><A NAME="IDX925"></A>
要素のベクトルは要素群を単一の<EM>グループ仕様</EM>にまとめる。
この意味はベクトルの意味とは関係ない。
<P>

<DT><CODE>"<VAR>string</VAR>"</CODE>
<DD>引数は<VAR>string</VAR>という名前のシンボルであること。
この仕様は、<VAR>symbol</VAR>の名前が<VAR>string</VAR>である
クォートとしたシンボル<CODE>'<VAR>symbol</VAR></CODE>と等価であるが、
文字列のほうが望ましい。
<P>

<DT><CODE>(vector <VAR>elements</VAR><small>...</small>)</CODE>
<DD>引数は、仕様内の<VAR>elements</VAR>に一致するものを要素とするベクトルであること。
以下のバッククォートの例を参照。
<P>

<DT><CODE>(<VAR>elements</VAR><small>...</small>)</CODE>
<DD>その他のリストは<EM>部分リスト仕様</EM>であり、
引数は仕様<VAR>elements</VAR>に一致するものを要素とするリストであること。
<P>

<A NAME="IDX926"></A>
部分リスト仕様はドット対リストでもよく、その場合、
対応するリスト引数はドット対リストである。
あるいは、ドット対リスト仕様の最後のCDRは
（<CODE>(spec .  [(more specs<small>...</small>)])</CODE>などの
グループや間接仕様を介した）
別の部分リスト仕様であってもよいが、
それらの要素はドット対ではないリスト引数に一致する。
これは、以下のバッククォートの例のような再帰仕様に有用である。
このような再帰を終らせるうえの仕様<CODE>nil</CODE>も参照。
<P>

<CODE>(specs .  nil)</CODE>や
<CODE>(specs . (sublist-elements<small>...</small>))</CODE>のような部分リスト仕様は
<CODE>(specs sublist-elements<small>...</small>)</CODE>と等価であることに注意。
</DL>
<P>

<CODE>&#38;define</CODE>のうしろに追加できる仕様の一覧を以下に示します。
以下の<CODE>defun</CODE>の例を参照してください。
<P>

<DL COMPACT>
<DT><CODE>name</CODE>
<DD>引数はシンボルであり、定義フォームの名前である。
<P>

定義フォームには単一の名前フィールドがある必要はなく、
複数の名前フィールドを持っていてもよい。
<P>

<DT><CODE>:name</CODE>
<DD>この構造は引数には実際には一致しない。
<CODE>:name</CODE>に続く要素はシンボルであること。
定義に対する追加の名前要素として使う。
定義の名前に一意で静的な要素を追加するために使う。
複数あってもよい。
<P>

<DT><CODE>arg</CODE>
<DD>引数はシンボルであり、定義フォームの引数の名前である。
しかし、ラムダリストキーワード（`<SAMP>&#38;</SAMP>'で始まるシンボル）は許されない。
<P>

<DT><CODE>lambda-list</CODE>
<DD><A NAME="IDX927"></A>
ラムダリスト、すなわち、ラムダ式の引数リストに一致する。
<P>

<DT><CODE>def-body</CODE>
<DD>引数は、定義内のコード本体である。
これは、上に述べた<CODE>body</CODE>に似ているが、
定義本体は定義に関連した情報を調べる異なるedebug呼び出しで処置する必要がある。
定義内のフォームの最上位レベルのリストには<CODE>def-body</CODE>を使う。
<P>

<DT><CODE>def-form</CODE>
<DD>引数は、定義内の単一の最上位レベルのフォームである。
これは<CODE>def-body</CODE>に似ているが、
フォームのリストではなく単一のフォームに一致するものに使う。
特別な場合として、<CODE>def-form</CODE>は
フォームを実行したときにトレース情報を出力しないことを意味する。
以下の<CODE>interactive</CODE>の例を参照。
</DL>
<P>

<A NAME="Backtracking"></A>
<HR SIZE="6">
<br><A NAME="SEC251"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC250"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC252"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Backtracking"></A>
<H4> 17.2.15.2 仕様内でのバックトラック </H4>
<!--docid::SEC251::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Backtracking">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Backtracking</a>"<br>
"texi/elisp21/仕様内でのバックトラック"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BB%C5%CD%CD%C6%E2%A4%C7%A4%CE%A5%D0%A5%C3%A5%AF%A5%C8%A5%E9%A5%C3%A5%AF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<A NAME="IDX928"></A>
<A NAME="IDX929"></A>
仕様の一致がある箇所で失敗しても、
必ずしも構文エラーが通知されるとは限りません。
そのかわりに、選択肢すべてを試し尽くすまで<EM>バックトラック</EM>します。
最終的に、引数リストの各要素は仕様内のいずれかの要素に一致する必要があり、
仕様内の各必須要素はいずれかの引数に一致する必要があります。
  
構文エラーを検出しても、より高いレベルの選択肢を使い切るまでは報告されず、
実際のエラー箇所から離れた箇所にポイントが置かれます。
しかし、エラー発生時にバックトラックが禁止されていれば、
ただちにエラーが報告されます。
さまざまな状況でバックトラックが自動的に再許可されることに注意してください。
<CODE>&#38;optional</CODE>や<CODE>&#38;rest</CODE>や<CODE>&#38;or</CODE>で新たに選択肢が指定されたり、
部分リストやグループや間接仕様を処理し始めると、
自動的に再許可されます。
バックトラックの許可／禁止の効果は、
現在処理しているレベルやそれより低いレベルに限定されます。
<P>

任意のフォーム仕様（つまり、<CODE>form</CODE>、<CODE>body</CODE>、<CODE>def-form</CODE>、
<CODE>def-body</CODE>）の一致処理中には、バックトラックを禁止します。
これらの仕様は任意のフォームに一致するので、
エラーはより上のレベルではなくフォーム自身にあるはずです。
<P>

また、クォートしたシンボルや文字列の仕様に一致すると
バックトラックを禁止します。
というのは、通常、これは構造を認識したことを意味するからです。
しかし、すべてが同一シンボルで始まる選択肢を指定する場合には、
<CODE>["foo" &#38;or [first case] [second case] ...]</CODE>のように、
そのシンボルを選択肢から括り出せばバックトラックするようにできます。
<P>

多くの場合では、バックトラックを自動的に禁止するこれらの2つの方法で十分ですが、
仕様<CODE>gate</CODE>を使ってバックトラックを明示的に禁止すると有用な場合もあります。
上位の選択肢が適用できないとわかっている場合に有用です。
仕様<CODE>let</CODE>の例を参照してください。
<P>

<A NAME="Specification Examples"></A>
<HR SIZE="6">
<br><A NAME="SEC252"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC251"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC253"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Specification Examples"></A>
<H4> 17.2.15.3 仕様の例 </H4>
<!--docid::SEC252::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Specification%20Examples">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Specification%20Examples</a>"<br>
"texi/elisp21/仕様の例"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BB%C5%CD%CD%A4%CE%CE%E3">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

以下の例を参考にするとedebug用仕様を理解しやすいでしょう。
<P>

スペシャルフォーム<CODE>let</CODE>には束縛と本体の並びがあります。
各束縛は、シンボル、あるいは、シンボルと省略可能な式から成る部分リストです。
以下のedebug用仕様では、部分リストの内側にある<CODE>gate</CODE>で、
部分リストを一度みつけるとバックトラックを禁止していることに
注意してください。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(def-edebug-spec let
  ((&#38;rest
    &#38;or symbolp (gate symbolp &#38;optional form))
   body))
</pre></td></tr></table><P>

edebugは、<CODE>defun</CODE>と<CODE>defmacro</CODE>、
および、対応する引数リストと仕様<CODE>interactive</CODE>に対しては、
以下のedebug用仕様を使います。
式の引数は実際には関数本体の外側で評価されるので、
対話宣言フォームを特別扱いする必要があります。
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(def-edebug-spec defmacro defun) ; 仕様<CODE>defun</CODE>の間接参照
(def-edebug-spec defun 
  (&#38;define name lambda-list 
           [&#38;optional stringp]   ; あれば、説明文字列に一致する
           [&#38;optional ("interactive" interactive)]
           def-body))

(def-edebug-spec lambda-list
  (([&#38;rest arg]
    [&#38;optional ["&#38;optional" arg &#38;rest arg]]
    &#38;optional ["&#38;rest" arg]
    )))

(def-edebug-spec interactive
  (&#38;optional &#38;or stringp def-form))    ; <CODE>def-form</CODE>を参照
</FONT></pre></td></tr></table><P>

以下のバッククォートに対する仕様は、
ドット対リストの一致の仕方と再帰を終らせる<CODE>nil</CODE>の使い方を示します。
また、ベクトルの要素の一致の仕方も示します。
（edebugが実際に定義している仕様では、
失敗の可能性がある非常に深い再帰をもたらすためドット対リストを扱わない。）
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(def-edebug-spec ` (backquote-form))   ; わかりやすいように別名を付ける

(def-edebug-spec backquote-form
  (&#38;or ([&#38;or "," ",&#64;"] &or ("quote" backquote-form) form)
       (backquote-form . [&#38;or nil backquote-form])
       (vector &#38;rest backquote-form)
       sexp))
</FONT></pre></td></tr></table><P>

<A NAME="Edebug Options"></A>
<HR SIZE="6">
<br><A NAME="SEC253"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC252"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC254"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Edebug Options"></A>
<H3> 17.2.16 edebugのオプション </H3>
<!--docid::SEC253::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Options">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Edebug%20Options</a>"<br>
"texi/elisp21/edebugのオプション"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2Fedebug%A4%CE%A5%AA%A5%D7%A5%B7%A5%E7%A5%F3">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

以下のオプションはedebugの動作に影響します。
<P>

<A NAME="IDX930"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-setup-hook</B>
<DD>edebugを使うまえに呼び出す関数群。
新たな値に設定されるたびに、edebugはこれらの関数を呼び出し、
そのあとで<CODE>edebug-setup-hook</CODE>を<CODE>nil</CODE>に再設定する。
これを用いて、edebugを使用する場合にのみ、
使用するパッケージに対応するedebug用仕様をロードできる。
see 節 <A HREF="elisp_18.html#SEC231">17.2.2 edebug向けの処置</A>。
</DL>
<P>

<A NAME="IDX931"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-all-defs</B>
<DD>これが<CODE>nil</CODE>以外であると、
<CODE>defun</CODE>や<CODE>defmacro</CODE>のような定義フォームを普通に評価すると、
edebug用にそれらを処置する。
これは、<CODE>eval-defun</CODE>、<CODE>eval-region</CODE>、<CODE>eval-buffer</CODE>、
<CODE>eval-current-buffer</CODE>にも適用される。
<P>

このオプションの値をトグルするにはコマンド<KBD>M-x edebug-all-defs</KBD>を使う。
see 節 <A HREF="elisp_18.html#SEC231">17.2.2 edebug向けの処置</A>。
</DL>
<P>

<A NAME="IDX932"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-all-forms</B>
<DD>これがcode{nil}以外であると、コマンド<CODE>eval-defun</CODE>、
<CODE>eval-region</CODE>、<CODE>eval-buffer</CODE>、<CODE>eval-current-buffer</CODE>は、
定義しないフォームの場合であってもすべてのフォームを処置する。
これは、ロードやミニバッファでの評価には適用されない。
<P>

このオプションの値をトグルするにはコマンド<KBD>M-x edebug-all-forms</KBD>を使う。
see 節 <A HREF="elisp_18.html#SEC231">17.2.2 edebug向けの処置</A>。
</DL>
<P>

<A NAME="IDX933"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-save-windows</B>
<DD>これが<CODE>nil</CODE>以外であると、edebugはウィンドウ構成を保存／復元する。
これには時間がかかるので、読者のプログラムがウィンドウ構成に
依存しないのならば、この変数は<CODE>nil</CODE>に設定しておくほうがよい。
<P>

値がリストであると、リスト内のウィンドウのみを保存／復元する。
<P>

edebugのコマンド<KBD>W</KBD>を使ってこの変数を対話的に変更できる。
see 節 <A HREF="elisp_18.html#SEC247">17.2.14.2 edebugの表示の更新</A>。
</DL>
<P>

<A NAME="IDX934"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-save-displayed-buffer-points</B>
<DD>これが<CODE>nil</CODE>以外であると、edebugは表示されているすべてのバッファの
ポイントを保存／復元する。
<P>

選択していないウィンドウに表示されたバッファのポイントを変更する
コードをデバッグ中には、別のバッファのポイントを保存／復元する必要がある。
edebugやユーザーが当該ウィンドウを選択すると、
そのバッファのポイントはウィンドウのポイント位置に移動する。
<P>

すべてのバッファでポイントを保存／復元するには
各ウィンドウを2度選択する必要があるため手間がかかる。
そのため、必要な場合にのみこの機能を有効にする。
see 節 <A HREF="elisp_18.html#SEC247">17.2.14.2 edebugの表示の更新</A>。
</DL>
<P>

<A NAME="IDX935"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-initial-mode</B>
<DD>この変数が<CODE>nil</CODE>以外であれば、
edebugが初めて動作するときの初期の動作モードを指定する。
可能な値は、
<CODE>step</CODE>、<CODE>next</CODE>、<CODE>go</CODE>、<CODE>Go-nonstop</CODE>, <CODE>trace</CODE>、
<CODE>Trace-fast</CODE>、<CODE>continue</CODE>、<CODE>Continue-fast</CODE>。
<P>

デフォルト値は<CODE>step</CODE>。
see 節 <A HREF="elisp_18.html#SEC232">17.2.3 edebugの実行モード</A>。
</DL>
<P>

<A NAME="IDX936"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-trace</B>
<DD><CODE>nil</CODE>以外であると、関数へ入るときと出るときのトレースを表示することを
意味する。
トレース出力は、`<SAMP>*edebug-trace*</SAMP>'という名前のバッファに、
関数へ入るときと出るときを各行に再帰の深さで字下げして表示する。
<P>

デフォルト値は<CODE>nil</CODE>。
<P>

<A HREF="elisp_18.html#SEC243">17.2.12 トレースバッファ</A>の<CODE>edebug-tracing</CODE>も参照。
</DL>
<P>

<A NAME="IDX937"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-test-coverage</B>
<DD><CODE>nil</CODE>以外であれば、edebugはデバッグ対象のすべての式のカバレッジ
テストを行う。
see 節 <A HREF="elisp_18.html#SEC244">17.2.13 カバレッジテスト</A>。
</DL>
<P>

<A NAME="IDX938"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-continue-kbd-macro</B>
<DD><CODE>nil</CODE>以外であれば、
edebugの外側で実行するキーボードマクロを定義したり実行する。
デバッグしないので注意してこのオプションを使うこと。
</DL>
<P>

<A NAME="IDX939"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-on-error</B>
<DD><CODE>debug-on-error</CODE>の以前の値が<CODE>nil</CODE>であると、
edebugは<CODE>debug-on-error</CODE>にこの値を束縛する。
see 節 <A HREF="elisp_18.html#SEC238">17.2.7 エラーの捕捉</A>。
</DL>
<P>

<A NAME="IDX940"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-on-quit</B>
<DD><CODE>debug-on-quit</CODE>の以前の値が<CODE>nil</CODE>であると、
edebugは<CODE>debug-on-quit</CODE>にこの値を束縛する。
see 節 <A HREF="elisp_18.html#SEC238">17.2.7 エラーの捕捉</A>。
</DL>
<P>

edebugが動作中に<CODE>edebug-on-error</CODE>や<CODE>edebug-on-quit</CODE>の値を
変更しても、新たなコマンドでedebugを<EM>つぎに</EM>起動するまでは
これらの値は使用されない。
<P>

<A NAME="IDX941"></A>
<DL>
<DT><U>User Option:</U> <B>edebug-global-break-condition</B>
<DD><CODE>nil</CODE>以外であると、各停止位置で検査される式である。
結果が<CODE>nil</CODE>以外であるとブレークする。
エラーは無視する。
see 節 <A HREF="elisp_18.html#SEC236">17.2.6.1 グローバルブレーク条件</A>。
</DL>
<P>

<A NAME="Syntax Errors"></A>
<HR SIZE="6">
<br><A NAME="SEC254"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC253"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC255"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Syntax Errors"></A>
<H2> 17.3 不正なLisp構文のデバッグ </H2>
<!--docid::SEC254::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Syntax%20Errors">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Syntax%20Errors</a>"<br>
"texi/elisp21/不正なLisp構文のデバッグ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C9%D4%C0%B5%A4%CALisp%B9%BD%CA%B8%A4%CE%A5%C7%A5%D0%A5%C3%A5%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

Lispリーダは不正な構文を報告しますが、どこに問題があるかは報告できません。
たとえば、式を評価中のエラー『End of file during parsing』
（構文解析中にファイルの終り）は、開き括弧（あるいは開き角括弧）が
多すぎることを表します。
Lispリーダは括弧が対応していないことをファイルの末尾で検出しますが、
どこに閉じ括弧があるべきかは判断できません。
同様に、『Invalid read syntax: ")"』（不正な構文：")"）は
閉じ括弧が多すぎるか開き括弧が足りないことを表しますが、
どこに括弧が足りないかは判断できません。
それでは、どこを変更すべきかどのように調べるのでしょう？
<P>

問題が単純な括弧の非対応でなければ、
各関数定義の先頭で<KBD>C-M-e</KBD>を試し、
関数定義の末尾に移動するかどうかをみるのは有用な技法です。
正しく移動しなければ、その関数に問題があります。
<P>

Lispによくある構文エラーは括弧の非対応なので、
これらの場面について詳しい助言を述べておきます。
（さらに、対応括弧表示モードをオンにしてポイントを移動すると非対応を
探しやすい。）
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC255">17.3.1 開き括弧の過剰</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to find a spurious open paren or missing close.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_18.html#SEC256">17.3.2 閉じ括弧の過剰</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to find a spurious close paren or missing open.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Excess Open"></A>
<HR SIZE="6">
<br><A NAME="SEC255"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC254"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC256"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Excess Open"></A>
<H3> 17.3.1 開き括弧の過剰 </H3>
<!--docid::SEC255::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Excess%20Open">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Excess%20Open</a>"<br>
"texi/elisp21/開き括弧の過剰"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B3%AB%A4%AD%B3%E7%B8%CC%A4%CE%B2%E1%BE%EA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

最初の手順は、括弧が対応していない関数定義を探すことです。
開き括弧が過剰であれば、ファイルの末尾に閉じ括弧を挿入し
<KBD>C-M-b</KBD>（<CODE>backward-sexp</CODE>）を打ちます。
こうすると、括弧が対応していない関数定義の先頭へ移動します。
（そうしたら、<KBD>C-<KBD>SPC</KBD> C-_ C-u C-<KBD>SPC</KBD></KBD>と打って、
当該箇所にマークを設定してから閉じ括弧の挿入を取り消し、
最終的にマークへ戻る。）
<P>

つぎの手順は、なにが悪いか正確に判断することです。
プログラムを調べる以外にこれを確実に行う方法はありませんが、
しばしば、既存の字下げが括弧のありかたを予想する鍵になります。
これを利用するもっとも簡単な方法は<KBD>C-M-q</KBD>で字下げし直し、
どのようになるか見ることです。
<STRONG>まだやらないでください！</STRONG><CODE> </CODE>
まず読み進んてください。
<P>

これを行うまえに、関数定義に充分な数の閉じ括弧があることを確認してください。
さもないと、<KBD>C-M-q</KBD>がエラーになったり、
ファイルの末尾までを字下げし直してしまいます。
ですから、関数定義の末尾へ移動して閉じ括弧を挿入しておきます。
<KBD>C-M-e</KBD>を使って移動しないでください。
というのは、関数定義の括弧の対応が取れていないと失敗するからです。
<P>

関数定義の先頭へ移動して<KBD>C-M-q</KBD>を打ちます。
通常、ある場所から関数の末尾までの行が右へずれます。
その場所の近くで、閉じ括弧が足りなかったり開き括弧が多すぎるのです。
（しかし、これが正しいと仮定してはならない。
コードを調べて確認すること。）
不具合箇所がみつかったならば、
意図した括弧に対しては古い字下げが適しているでしょうから
<KBD>C-_</KBD>で<KBD>C-M-q</KBD>をアンドゥします。
<P>

問題を解決できたと思ったら、再度<KBD>C-M-q</KBD>を使います。
古い字下げが意図した括弧の入れ子に対応していて、
必要な括弧を挿入できているならば、
<KBD>C-M-q</KBD>はなにも変えないはずです。
<P>

<A NAME="Excess Close"></A>
<HR SIZE="6">
<br><A NAME="SEC256"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC255"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC257"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Excess Close"></A>
<H3> 17.3.2 閉じ括弧の過剰 </H3>
<!--docid::SEC256::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Excess%20Close">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Excess%20Close</a>"<br>
"texi/elisp21/閉じ括弧の過剰"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CA%C4%A4%B8%B3%E7%B8%CC%A4%CE%B2%E1%BE%EA">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

過剰な閉じ括弧に対処するには、まず、ファイルの先頭に開き括弧を挿入し、
その括弧のまえで<KBD>C-M-f</KBD>を打って、
括弧が対応していない関数定義の末尾を探します。
（そして、<KBD>C-<KBD>SPC</KBD> C-_ C-u C-<KBD>SPC</KBD></KBD>と打って、
当該箇所にマークを設定して開き括弧の挿入をアンドゥし、
最終的にマークへ戻る。）
<P>

その関数定義の先頭で<KBD>C-M-f</KBD>と打って、
実際に対応している閉じ括弧を探します。
これにより、関数定義が終るべき場所より手前の箇所に移動するはずです。
この付近に余分な閉じ括弧がみつかることもあるでしょう。
<P>

その場所に問題がなければ、つぎにすべきことは、
関数定義の先頭で<KBD>C-M-q</KBD>と打つことです。
ある範囲の行が左にずれるでしょう。
もしそうならば、開き括弧が足りないか余分な閉じ括弧は、
そのような行の先頭付近にあるでしょう。
（しかし、これが正しいと仮定してはならない。
コードを調べて確認すること。）
不具合箇所がみつかったならば、
意図した括弧に対しては古い字下げが適しているでしょうから
<KBD>C-_</KBD>で<KBD>C-M-q</KBD>をアンドゥします。
<P>

問題を解決できたと思ったら、再度<KBD>C-M-q</KBD>を使います。
古い字下げが意図した括弧の入れ子に対応していて、
必要な括弧を挿入できているならば、
<KBD>C-M-q</KBD>はなにも変えないはずです。
<P>

<A NAME="Compilation Errors"></A>
<HR SIZE="6">
<br><A NAME="SEC257"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_18.html#SEC256"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_19.html#SEC258"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Compilation Errors"></A>
<H2> 17.4 コンパイル時の問題のデバッグ </H2>
<!--docid::SEC257::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Compilation%20Errors">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Compilation%20Errors</a>"<br>
"texi/elisp21/コンパイル時の問題のデバッグ"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%B3%A5%F3%A5%D1%A5%A4%A5%EB%BB%FE%A4%CE%CC%E4%C2%EA%A4%CE%A5%C7%A5%D0%A5%C3%A5%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

バイトコンパイル時にエラーが発生したときは、
通常、読者がコンパイルしているプログラムの不正な構文に原因があります。
コンパイラはバッファ`<SAMP>*Compile-Log*</SAMP>'に適切なエラーメッセージを
表示してから停止します。
メッセージにはエラーとなった関数の名前があったりなかったりします。
いずれにしても、つぎのようにしてファイルのどこでエラーが生じたかを調べます。
<P>

まず、バッファ`<SAMP> *Compiler Input*</SAMP>'に切り替えます。
（バッファ名が空白で始まり、そのため、
<KBD>M-x list-buffers</KBD>では表示されないことに注意。）
このバッファにはコンパイルしたプログラムが入っていて、
ポイント位置はバイトコンパイラがどこまで読み取ったかを表します。
<P>

エラーの原因が不正なLisp構文であるならば、
ポイント位置が不正構文を<EM>検出した</EM>箇所を正確に表します。
エラー原因が近くにあるとは限りません！<CODE> </CODE>
エラーを探すために前節の方法を使ってください。
<P>

正しく読み取ったフォームのコンパイル中にエラーを検出したときには、
ポイントはそのフォームの末尾に位置しています。
この場合、この方法ではエラー箇所を正確に判別できませんが、
どの関数を確認すべきかを示しています。
<A NAME="Read and Print"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<a name="bottom"> </a>
<script type="text/javascript" src="style2.js"></script>
<div class="footer">
    <br>
    このページはMeadow (Emacs) の紹介ページです <br>
このWebページの各文書は自由にリンク・複製・再配布・改変していただいて構いません．
<br>ただし，複製・再配布・改変の場合は Meadow Memo のURLを記載しておいて下さい．<br>
<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=about%20link">Medow memoへのリンクについて</a>．<br>

間違い，要望等があれば<a href="mailto:akihisa@mail.ne.jp">akihisa@mail.ne.jp</a> か下記でどうぞ<br>

<br>

<FORM METHOD="post" ACTION="http://www.bookshelf.jp/cgi-bin/wwwmail.cgi" >
お名前：<INPUT TYPE="text" NAME="name" SIZE="30" MAXLENGTH="40" VALUE="ななしさん"><br>
メールアドレス：<INPUT TYPE="text" NAME="EMAIL" SIZE="25" MAXLENGTH="60" VALUE="secret@mail.adr"><br>
<input type="hidden" name="HPAGE" value="">
つっこみ：<br><TEXTAREA NAME="MESSAGE" ROWS="5" COLS="50">
</TEXTAREA><br><br>
<INPUT TYPE="submit" VALUE="送信">
<INPUT TYPE="reset" VALUE="クリア">
</FORM>

<br><A HREF="http://www.bookshelf.jp/cgi-bin/xct.cgi">ページ別カウンタ</a>
<br> Since 2002/12/13 <br>
</div>

</BODY>

</HTML>
