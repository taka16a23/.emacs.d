<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="ja">
<!-- Created on October, 1  2005 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=euc-jp">
<META NAME="keywords" CONTENT="meadow,mule,emacs,lisp,elisp,gnus,setting,設定,unix,cygwin">
<META http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="description" CONTENT="Meadowの設定を紹介するページです">
<TITLE>GNU Emacs Lispリファレンスマニュアル:  バッファ内の位置</TITLE>

<META NAME="description" CONTENT="GNU Emacs Lispリファレンスマニュアル:  バッファ内の位置">
<META NAME="keywords" CONTENT="GNU Emacs Lispリファレンスマニュアル:  バッファ内の位置">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

<LINK REL="contents" HREF="elisp_toc.html#SEC_Contents">
<LINK REL="index" HREF="elisp_48.html#SEC681">
<LINK REL="next" HREF="elisp_31.html#SEC474">
<LINK REL="prev" HREF="elisp_29.html#SEC434">

<META http-equiv="Content-Style-Type" content="text/css">
<!-- 鶯と龜 ←日本語EUC誤判別対策用らしい; -->
<link rel="StyleSheet" href="../../../../soft/css/midnight.css" type="text/css" id="css1">
<script type="text/javascript" src="style1.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../soft/css/meadowmemo.css">

</HEAD>
<BODY LANG="ja" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<!--Infoseek Analyzer start-->
<script LANGUAGE="javascript">PgNo=6;</script>
<script src="http://js1.infoseek.co.jp/bin/57/00170.js"></script>
<noscript><a href="http://ax1.www.infoseek.co.jp/bin/go?0017057f" target="_blank">
<img src="http://ax1.www.infoseek.co.jp/bin/logo?0017057f" border=0></a></noscript>
<!--Infoseek Analyzer end-->
<a name="top"> </a>

<br><A NAME="SEC462"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_29.html#SEC461"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC463"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_29.html#SEC434"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_31.html#SEC474"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Positions"></A>
<H1> 29. バッファ内の位置 </H1>
<!--docid::SEC462::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Positions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Positions</a>"<br>
"texi/elisp21/バッファ内の位置"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%D0%A5%C3%A5%D5%A5%A1%C6%E2%A4%CE%B0%CC%C3%D6">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2056"></A>
<P>

バッファ内<EM>位置</EM>（position）は、
バッファ内のテキストの文字を添字付けします。
より正確にいえば、バッファ内位置は2つの文字のあいだの箇所
（あるいは、先頭文字ではそのまえ、最後の文字ではそのうしろ）を識別して、
指定位置のまえやうしろの文字を指定できるようにします。
しかし、しばしば位置『にある』文字といいますが、
これは位置の直後の文字を意味します。
<P>

バッファ内位置は、通常、1から始まる整数で表しますが、
<EM>マーカ</EM>（marker）で表すこともできます。
マーカは特別なオブジェクトであり、
テキストを挿入したり削除しても
同じ周りの文字に留まるように自動的に再配置されます。
See 節 <A HREF="elisp_31.html#SEC474">30. マーカ</A>。
<P>

<div class="menuindex"><SCRIPT language=JavaScript src="index29.js"></SCRIPT></div><noscript><BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC463">29.1 ポイント</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">The special position where editing takes place.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC464">29.2 移動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Changing point.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC472">29.3 エクスカージョン</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Temporary motion and buffer changes.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC473">29.4 ナロイング</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Restricting editing to a portion of the buffer.</TD></TR>
</TABLE></BLOCKQUOTE></noscript>
<P>

<A NAME="Point"></A>
<HR SIZE="6">
<br><A NAME="SEC463"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC462"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC464"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Point"></A>
<H2> 29.1 ポイント </H2>
<!--docid::SEC463::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Point">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Point</a>"<br>
"texi/elisp21/ポイント"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%DD%A5%A4%A5%F3%A5%C8">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2057"></A>
<P>

<EM>ポイント</EM>（point）は、
自己挿入文字やテキスト挿入関数を含む多くの編集コマンドが使う
バッファ内の特別な位置です。
他のコマンドは、バッファ内の別の箇所で編集したり挿入できるように
ポイントをテキスト内で移動します。
<P>

他のバッファ内位置と同様に、ポイントは文字そのものではなく、
2つの文字のあいだの箇所
（あるいは、先頭文字ではそのまえ、最後の文字ではそのうしろ）を指定します。
通常、端末では、ポイントの直後の文字に重ねてカーソルを表示します。
ポイントはカーソルがある文字のまえに実際にはあります。
<P>

<A NAME="IDX2058"></A>
ポイントの値は、1からバッファのサイズ足す1です。
ナロイング（see 節 <A HREF="elisp_30.html#SEC473">29.4 ナロイング</A>）していると、
ポイントはバッファの参照可能な
（バッファの端を含むかもしれない）範囲内に制限されます。
<P>

各バッファには独自のポイント値があり、
それは他のバッファのポイント値とは独立です。
各ウィンドウにも独自のポイント値があり、
同じバッファを表示している他のウィンドウのポイント値とは独立です。
このようなわけで、同じバッファを表示しているさまざまなウィンドウで
異なるポイント値を持てるのです。
1つのウィンドウだけにバッファが表示されているときには、
バッファのポイントとウィンドウのポイントは、通常、同じ値であり、
それらを区別することはほとんど重要ではありません。
詳しくは、See 節 <A HREF="elisp_28.html#SEC425">27.9 ウィンドウとポイント</A>。
<P>

<A NAME="IDX2059"></A>
<DL>
<DT><U>Function:</U> <B>point</B>
<DD><A NAME="IDX2060"></A>
この関数はカレントバッファのポイント値を整数で返す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(point)
     => 175
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2061"></A>
<DL>
<DT><U>Function:</U> <B>point-min</B>
<DD>この関数は、カレントバッファで参照可能なポイント値の最小値を返す。
これは通常1であるが、
ナロイングしているときには、ナロイングした領域の開始位置である。
（see 節 <A HREF="elisp_30.html#SEC473">29.4 ナロイング</A>。）
</DL>
<P>

<A NAME="IDX2062"></A>
<DL>
<DT><U>Function:</U> <B>point-max</B>
<DD>この関数は、カレントバッファで参照可能なポイント値の最大値を返す。
ナロイングしていなければ、これは<CODE>(1+ (buffer-size))</CODE>である。
ナロイングしているときには、ナロイングした領域の終了位置である。
（see 節 <A HREF="elisp_30.html#SEC473">29.4 ナロイング</A>。）
</DL>
<P>

<A NAME="IDX2063"></A>
<DL>
<DT><U>Function:</U> <B>buffer-end</B> <I>flag</I>
<DD>この関数は、<VAR>flag</VAR>が1未満であれば<CODE>(point-min)</CODE>を返し、
さもなければ<CODE>(point-max)</CODE>を返す。
引数<VAR>flag</VAR>は整数であること。
</DL>
<P>

<A NAME="IDX2064"></A>
<DL>
<DT><U>Function:</U> <B>buffer-size</B>
<DD>この関数は、カレントバッファ内の総文字数を返す。
ナロイング（see 節 <A HREF="elisp_30.html#SEC473">29.4 ナロイング</A>）していなければ、
<CODE>point-max</CODE>はこの値より1大きな値を返す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(buffer-size)
     => 35
(point-max)
     => 36
</pre></td></tr></table></DL>
<P>

<A NAME="Motion"></A>
<HR SIZE="6">
<br><A NAME="SEC464"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC463"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC465"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Motion"></A>
<H2> 29.2 移動 </H2>
<!--docid::SEC464::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Motion">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Motion</a>"<br>
"texi/elisp21/移動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B0%DC%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

移動関数は、現在のポイント値やバッファの先頭や末尾を基準にして、
あるいは、選択されているウィンドウの端を基準にして、
ポイント値を変更します。
See 節 <A HREF="elisp_30.html#SEC463">29.1 ポイント</A>。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC465">29.2.1 文字単位の移動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Moving in terms of characters.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC466">29.2.2 単語単位の移動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Moving in terms of words.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC467">29.2.3 バッファの両端への移動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Moving to the beginning or end of the buffer.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC468">29.2.4 テキスト行単位の移動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Moving in terms of lines of text.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC469">29.2.5 スクリーン行分の移動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Moving in terms of lines as displayed.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC470">29.2.6 式単位の移動</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Moving by parsing lists and sexps.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_30.html#SEC471">29.2.7 文字群の飛び越し</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Skipping characters belonging to a certain set.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Character Motion"></A>
<HR SIZE="6">
<br><A NAME="SEC465"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC464"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC466"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Character Motion"></A>
<H3> 29.2.1 文字単位の移動 </H3>
<!--docid::SEC465::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Character%20Motion">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Character%20Motion</a>"<br>
"texi/elisp21/文字単位の移動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CA%B8%BB%FA%C3%B1%B0%CC%A4%CE%B0%DC%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

これらの関数は、文字数に基づいてポイントを移動します。
<CODE>goto-char</CODE>が基本になる基本関数であり、他の関数はこれを使っています。
<P>

<A NAME="IDX2065"></A>
<DL>
<DT><U>コマンド:</U> <B>goto-char</B> <I>position</I>
<DD>この関数は、カレントバッファのポイント位置を値<VAR>position</VAR>とする。
<VAR>position</VAR>が1未満であると、バッファの先頭にポイントを移動する。
<VAR>position</VAR>がバッファの長さより大きい場合には、
バッファの末尾にポイントを移動する。
<P>

ナロイングしている場合であっても、
<VAR>position</VAR>はバッファの先頭から数えるが、
参照可能部分の外側にはポイントは移動できない。
<VAR>position</VAR>が範囲外であると、
<CODE>goto-char</CODE>は参照可能部分の先頭か末尾にポイントを移動する。
<P>

この関数を対話的に呼び出すと、
前置引数があれば<VAR>position</VAR>は数値前置引数である。
さもなければミニバッファから読む。
<P>

<CODE>goto-char</CODE>は<VAR>position</VAR>を返す。
</DL>
<P>

<A NAME="IDX2066"></A>
<DL>
<DT><U>コマンド:</U> <B>forward-char</B> <I>&#38;optional count</I>
<DD>この関数は、前方へ、つまり、バッファの末尾に向けて
（<VAR>count</VAR>が負であれば、後方へ、つまり、バッファの先頭へ向けて）
<VAR>count</VAR>文字分ポイントを移動する。
バッファの先頭や末尾を越えて
（ナロイングしているときには参照可能部分を越えて）
ポイントを移動しようとすると、
<CODE>beginning-of-buffer</CODE>か<CODE>end-of-buffer</CODE>のエラーコードで
エラーを通知する。
<P>

対話的に呼び出されると、<VAR>count</VAR>は数値前置引数である。
</DL>
<P>

<A NAME="IDX2067"></A>
<DL>
<DT><U>コマンド:</U> <B>backward-char</B> <I>&#38;optional count</I>
<DD>この関数は、後方へ、つまり、バッファの先頭に向けて
（<VAR>count</VAR>が負であれば、前方へ、つまり、バッファの末尾へ向けて）
<VAR>count</VAR>文字分ポイントを移動する。
バッファの先頭や末尾を越えて
（ナロイングしているときには参照可能部分を越えて）
ポイントを移動しようとすると、
<CODE>beginning-of-buffer</CODE>か<CODE>end-of-buffer</CODE>のエラーコードで
エラーを通知する。
<P>

対話的に呼び出されると、<VAR>count</VAR>は数値前置引数である。
</DL>
<P>

<A NAME="Word Motion"></A>
<HR SIZE="6">
<br><A NAME="SEC466"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC465"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC467"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Word Motion"></A>
<H3> 29.2.2 単語単位の移動 </H3>
<!--docid::SEC466::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Word%20Motion">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Word%20Motion</a>"<br>
"texi/elisp21/単語単位の移動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C3%B1%B8%EC%C3%B1%B0%CC%A4%CE%B0%DC%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

これらの単語を解析する関数は、
当該文字が単語の一部かどうかを判定するために構文テーブルを使います。
See 節 <A HREF="elisp_35.html#SEC564">34. 構文テーブル</A>。
<P>

<A NAME="IDX2068"></A>
<DL>
<DT><U>コマンド:</U> <B>forward-word</B> <I>count</I>
<DD>この関数は、前方へ（<VAR>count</VAR>が負ならば後方へ）
<VAR>count</VAR>単語分ポイントを移動する。
『1単語分移動する』とは、
単語構成文字を越えてから単語区切り文字（あるいはバッファの参照可能部分の
境界）に出会うまでポイントを移動することを意味する。
<P>

バッファの境界で止まらず（最後の単語は除く）に
<VAR>count</VAR>単語分移動できると、値は<CODE>t</CODE>である。
さもなければ値は<CODE>nil</CODE>であり、ポイントはバッファの境界で止まる。
<P>

対話的に呼び出されると、<VAR>count</VAR>は数値前置引数である。
</DL>
<P>

<A NAME="IDX2069"></A>
<DL>
<DT><U>コマンド:</U> <B>backward-word</B> <I>count</I>
<DD>この関数は<CODE>forward-word</CODE>と同様であるが、
前方へではなく後方へ単語の先頭に出会うまで移動する。
<P>

対話的に呼び出されると、<VAR>count</VAR>は数値前置引数である。
<P>

この関数は、プログラムではほとんど使われない。
負の引数で<CODE>forward-word</CODE>を呼び出すほうが効率的だからである。
</DL>
<P>

<A NAME="IDX2070"></A>
<DL>
<DT><U>Variable:</U> <B>words-include-escapes</B>
<DD>この変数は、<CODE>forward-word</CODE>とそれを使うもののふるまいに影響する。
<CODE>nil</CODE>以外であると、『エスケープ』や『文字クォート』の
構文クラスに属する文字も単語の一部とみなす。
さもなければ、単語の一部とはみなさない。
</DL>
<P>

<A NAME="Buffer End Motion"></A>
<HR SIZE="6">
<br><A NAME="SEC467"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC466"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC468"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Buffer End Motion"></A>
<H3> 29.2.3 バッファの両端への移動 </H3>
<!--docid::SEC467::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Buffer%20End%20Motion">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Buffer%20End%20Motion</a>"<br>
"texi/elisp21/バッファの両端への移動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%D0%A5%C3%A5%D5%A5%A1%A4%CE%CE%BE%C3%BC%A4%D8%A4%CE%B0%DC%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

バッファの先頭にポイントを移動するには、つぎのように書きます。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(goto-char (point-min))
</pre></td></tr></table><P>

同様に、バッファの末尾に移動するには、つぎのようにします。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(goto-char (point-max))
</pre></td></tr></table><P>

上のことを行うためにユーザーが使うコマンドが2つあります。
これらはマークを設定してエコー領域にメッセージを表示するので、
これらをLispプログラムからは使わないように警告しておきます。
<P>

<A NAME="IDX2071"></A>
<DL>
<DT><U>コマンド:</U> <B>beginning-of-buffer</B> <I>&#38;optional n</I>
<DD>この関数は、バッファ（あるいはナロイングしているときには参照可能部分）
の先頭にポイントを移動し、移動前の位置にマークを設定する。
<VAR>n</VAR>が<CODE>nil</CODE>以外であると、
バッファの先頭から10分の<VAR>n</VAR>の箇所にポイントを移動する。
<P>

対話的に呼び出すと、前置引数があれば<VAR>n</VAR>は数値前置引数である。
さもなければ<VAR>n</VAR>のデフォルトは<CODE>nil</CODE>である。
<P>

<STRONG>警告：</STRONG><CODE> </CODE>Lispプログラムではこの関数を使わないこと！
</DL>
<P>

<A NAME="IDX2072"></A>
<DL>
<DT><U>コマンド:</U> <B>end-of-buffer</B> <I>&#38;optional n</I>
<DD>この関数は、バッファ（あるいはナロイングしているときには参照可能部分）
の末尾にポイントを移動し、移動前の位置にマークを設定する。
<VAR>n</VAR>が<CODE>nil</CODE>以外であると、
バッファの末尾から10分の<VAR>n</VAR>の箇所にポイントを移動する。
<P>

対話的に呼び出すと、前置引数があれば<VAR>n</VAR>は数値前置引数である。
さもなければ<VAR>n</VAR>のデフォルトは<CODE>nil</CODE>である。
<P>

<STRONG>警告：</STRONG><CODE> </CODE>Lispプログラムではこの関数を使わないこと！
</DL>
<P>

<A NAME="Text Lines"></A>
<HR SIZE="6">
<br><A NAME="SEC468"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC467"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC469"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Text Lines"></A>
<H3> 29.2.4 テキスト行単位の移動 </H3>
<!--docid::SEC468::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Text%20Lines">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Text%20Lines</a>"<br>
"texi/elisp21/テキスト行単位の移動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%C6%A5%AD%A5%B9%A5%C8%B9%D4%C3%B1%B0%CC%A4%CE%B0%DC%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2073"></A>
<P>

テキスト行とは、改行文字で区切られたバッファの部分です。
改行文字はまえの行に属するとみなします。
最初のテキスト行がバッファの先頭から始まり、
バッファの末尾の文字が改行であってもなくても、
最後のテキスト行はバッファの末尾で終ります。
バッファをテキスト行に分割することは、
ウィンドウの幅、表示上の行の継続、タブやコントロール文字の表示方法には
影響されません。
<P>

<A NAME="IDX2074"></A>
<DL>
<DT><U>コマンド:</U> <B>goto-line</B> <I>line</I>
<DD>この関数は、バッファの先頭を1行目と数えて<VAR>line</VAR>行目の先頭に
ポイントを移動する。
<VAR>line</VAR>が1未満であると、バッファの先頭へポイントを移動する。
<VAR>line</VAR>がバッファ内の行数より大きいと、
バッファの末尾、つまり、<EM>バッファの最後の行の末尾</EM>にポイントを移動する。
これは、<CODE>goto-line</CODE>が行頭にポイントを移動しない唯一の場面である。
<P>

ナロイングしているときでも、
<VAR>line</VAR>はバッファの先頭から数えるが、
参照可能部分の外側にはポイントは移動しない。
したがって、行番号が参照不可な部分を指定するときには、
<CODE>goto-line</CODE>は参照可能部分の先頭か末尾へポイントを移動する。
<P>

<CODE>goto-line</CODE>の戻り値は、
（ナロイングを考慮せずにバッファ全体でみた）
<VAR>line</VAR>と実際のポイントの移動先の行の行番号との差である。
したがって、指定した行に達するまえにバッファの末尾に出会うと値は正である。
バッファの実際の末尾にではなく参照可能部分の末尾に出会うと値は0である。
<P>

対話的に呼び出すと、
前置引数があれば<VAR>line</VAR>は数値前置引数である。
さもなければ<VAR>line</VAR>をミニバッファから読む。
</DL>
<P>

<A NAME="IDX2075"></A>
<DL>
<DT><U>コマンド:</U> <B>beginning-of-line</B> <I>&#38;optional count</I>
<DD>この関数は、現在行の先頭にポイントを移動する。
引数<VAR>count</VAR>が<CODE>nil</CODE>でも1でもないと、
<VAR>count</VAR>-1行だけ前方へ移動してから行頭に移動する。
<P>

バッファ（ナロイングしているときには参照可能部分）の末尾に達すると
ポイントをそこへ移動する。
エラーは通知しない。
</DL>
<P>

<A NAME="IDX2076"></A>
<DL>
<DT><U>コマンド:</U> <B>end-of-line</B> <I>&#38;optional count</I>
<DD>この関数は、現在行の末尾にポイントを移動する。
引数<VAR>count</VAR>が<CODE>nil</CODE>でも1でもないと、
<VAR>count</VAR>-1行だけ前方へ移動してから行末に移動する。
<P>

バッファ（ナロイングしているときには参照可能部分）の末尾に達すると
ポイントをそこへ移動する。
エラーは通知しない。
</DL>
<P>

<A NAME="IDX2077"></A>
<DL>
<DT><U>コマンド:</U> <B>forward-line</B> <I>&#38;optional count</I>
<DD><A NAME="IDX2078"></A>
この関数は、<VAR>count</VAR>行前方の行頭にポイントを移動する。
<VAR>count</VAR>が負であると、
-<VAR>count</VAR>行後方の行頭にポイントを移動する。
<VAR>count</VAR>が0であると、現在行の先頭にポイントを移動する。
<P>

指定行数だけ移動するまえに
バッファ（ナロイングしているときには参照可能部分）の先頭や末尾に達すると
ポイントをそこへ移動する。
エラーは通知しない。
<P>

<CODE>forward-line</CODE>は、
<VAR>count</VAR>と実際に移動した行数の差を返す。
3行しかないバッファの先頭で5行前方へ移動しようとすると、
ポイントは最後の行の末尾で止まり、値は2になる。
<P>

対話的に呼び出すと、<VAR>count</VAR>は数値前置引数である。
</DL>
<P>

<A NAME="IDX2079"></A>
<DL>
<DT><U>Function:</U> <B>count-lines</B> <I>start end</I>
<DD><A NAME="IDX2080"></A>
この関数は、カレントバッファの<VAR>start</VAR>と<VAR>end</VAR>の
あいだの部分にある行の行数を返す。
<VAR>start</VAR>と<VAR>end</VAR>が等しければ0を返す。
さもなければ、<VAR>start</VAR>と<VAR>end</VAR>が同じ行にある場合であっても
少なくとも1を返す。
というのは、それらのあいだのテキストは孤立しているとみなされ、
空でなければ少なくとも1行はあるはずだからである。
<P>

<CODE>count-lines</CODE>の使用例を示す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun current-line ()
  "Return the vertical position of point<small>...</small>"
  (+ (count-lines (window-start) (point))
     (if (= (current-column) 0) 1 0)
     -1))
</pre></td></tr></table></DL>
<P>

<A HREF="elisp_32.html#SEC484">31.1 ポイント付近のテキストを調べる</A>の関数<CODE>bolp</CODE>や<CODE>eolp</CODE>も参照してください。
これらの関数はポイントを移動しませんが、ポイントがすでに行の先頭や末尾に
あるかどうかを検査します。
<P>

<A NAME="Screen Lines"></A>
<HR SIZE="6">
<br><A NAME="SEC469"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC468"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC470"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Screen Lines"></A>
<H3> 29.2.5 スクリーン行分の移動 </H3>
<!--docid::SEC469::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Screen%20Lines">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Screen%20Lines</a>"<br>
"texi/elisp21/スクリーン行分の移動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%B9%A5%AF%A5%EA%A1%BC%A5%F3%B9%D4%CA%AC%A4%CE%B0%DC%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

前節の行単位の関数は、改行文字で区切られたテキスト行だけを数えます。
対照的に、これらの関数は、スクリーン上にどのようにテキストが現れるかで
定義されるスクリーン上の行を数えます。
テキスト行が選択されているウィンドウの幅に収まるだけ短ければ、
1テキスト行は1スクリーン行ですが、
しかし、それ以外では1テキスト行は複数のスクリーン行を占めます。
<P>

テキスト行を複数のスクリーン行に継続せずに
スクリーン上で切り詰める場合もあります。
このような場合、<CODE>vertical-motion</CODE>は、
<CODE>forward-line</CODE>によく似たポイントの移動を行います。
See 節 <A HREF="elisp_38.html#SEC601">37.2 表示の切り詰め</A>。
<P>

与えられた文字列の幅は、各文字の見ためを制御するフラグに依存するので、
<CODE>vertical-motion</CODE>は、
テキストを収めたバッファや選択されているウィンドウ
（その幅や切り詰めフラグ、ウィンドウごとに異なりうる表示テーブルが
あるため）に依存して、特定のテキスト部分に対して異なったふるまいをします。
See 節 <A HREF="elisp_38.html#SEC618">37.13 通常の画面表示慣習</A>。
<P>

これらの関数は、スクリーン行がどこで区切れるかを決定するためにテキストを走査
するので、走査する量に比例して時間がかかります。
読者がこれらを多用する意図があるときには、
読者のコードの効率を改善するキャッシュをEmacsが提供します。
See 節 <A HREF="elisp_38.html#SEC601">cache-long-line-scans</A>。
<P>

<A NAME="IDX2081"></A>
<DL>
<DT><U>Function:</U> <B>vertical-motion</B> <I>count &#38;optional window</I>
<DD>この関数は、ポイントを含むスクリーン行から
<VAR>count</VAR>スクリーン行数だけ下向きにポイントを移動する。
<VAR>count</VAR>が負であると上向きに移動する。
<P>

<CODE>vertical-motion</CODE>は、ポイントを移動したスクリーン行数を返す。
バッファの先頭や末尾に達すると、
この値は絶対値では<VAR>count</VAR>より小さい。
<P>

ウィンドウ<VAR>window</VAR>は、
幅、水平スクロール、表示テーブルなどのパラメータを得るために使われる。
しかし、<VAR>window</VAR>に別のバッファが表示されているとしても、
<CODE>vertical-motion</CODE>はつねにカレントバッファに作用する。
</DL>
<P>

<A NAME="IDX2082"></A>
<DL>
<DT><U>コマンド:</U> <B>move-to-window-line</B> <I>count</I>
<DD>この関数は、選択されているウィンドウに現在表示されているテキストに
基づいてポイントを移動する。
ウィンドウの先頭から<VAR>count</VAR>スクリーン行の先頭にポイントを移動する。
<VAR>count</VAR>が負であると、底（あるいはバッファの末尾がスクリーンの
底より上にある場合にはバッファの最終行）から数えて
-<VAR>count</VAR>スクリーン行位置を指定する。
<P>

<VAR>count</VAR>が<CODE>nil</CODE>であると、
ウィンドウの中央の行の先頭にポイントを移動する。
<VAR>count</VAR> の絶対値がウィンドウのサイズよりも大きいときには、
ウィンドウに十分な高さがあった場合に移動するであろう
スクリーン行の箇所にポイントを移動する。
そのため、スクロールして当該箇所がスクリーンに現れるように再表示する。
<P>

対話的に呼び出されると、<VAR>count</VAR>は数値前置引数である。
<P>

戻り値は、ウィンドウの先頭行を0と数えて、移動先の行のウィンドウ行番号である。
</DL>
<P>

<A NAME="IDX2083"></A>
<DL>
<DT><U>Function:</U> <B>compute-motion</B> <I>from frompos to topos width offsets window</I>
<DD>この関数は、スクリーン上での位置を計算しながらカレントバッファを走査する。
バッファ内位置<VAR>from</VAR>がスクリーン座標<VAR>frompos</VAR>に対応すると仮定して、
<VAR>from</VAR>から前方へ向けて<VAR>to</VAR>か<VAR>topos</VAR>のどちらかに
達するまでバッファを走査する。
バッファ内の終了位置とスクリーン座標を返す。
<P>

座標引数<VAR>frompos</VAR>と<VAR>topos</VAR>は、
<CODE>(<VAR>hpos</VAR> . <VAR>vpos</VAR>)</CODE>の形のコンスセルである。
<P>

引数<VAR>width</VAR>は、テキストを表示できるコラム数であり、
これは継続行の扱いに影響する。
読者が選んだウィンドウに対して<CODE>window-width</CODE>が返した値、
つまり、通常、<CODE>(window-width <VAR>window</VAR>)</CODE>を使う。
<P>

引数<VAR>offsets</VAR>は、<CODE>nil</CODE>であるか、
<CODE>(<VAR>hscroll</VAR> . <VAR>tab-offset</VAR>)</CODE>の形のコンスセルである。
ここで、<VAR>hscroll</VAR>は左端に表示されていないコラム数であり、
多くの場合は<CODE>window-hscroll</CODE>を呼び出して得た値を使う。
一方、<VAR>tab-offset</VAR>はスクリーン上でのコラム番号と
バッファ内でのコラム番号の差である。
この値は、継続行においてまえのスクリーン行の幅が<CODE>tab-width</CODE>で終らない
場合に0以外になる。
継続しない行ではつねに0である。
<P>

ウィンドウ<VAR>window</VAR>は、使用する表示テーブルを指定するためだけに使われる。
<VAR>window</VAR>に表示されているバッファに関わらず、
<CODE>compute-motion</CODE>はつねにカレントバッファに作用する。
<P>

戻り値は、5要素のリストである。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(<VAR>pos</VAR> <VAR>vpos</VAR> <VAR>hpos</VAR> <VAR>prevhpos</VAR> <VAR>contin</VAR>)
</pre></td></tr></table><P>

ここで、<VAR>pos</VAR>は走査を終えたバッファ内位置であり、
<VAR>vpos</VAR>は垂直方向のスクリーン位置、
<VAR>hpos</VAR>は水平方向のスクリーン位置である。
<P>

結果の<VAR>prevhpos</VAR>は、<VAR>pos</VAR>から1文字分戻った箇所の水平位置である。
この文字のあとで最終行が継続しているときには、
結果の<VAR>contin</VAR>は<CODE>t</CODE>である。
<P>

たとえば、あるウィンドウの<VAR>line</VAR>スクリーン行の<VAR>col</VAR>コラムに
対応するバッファ内位置を探すには、
<VAR>from</VAR>としてウィンドウの表示開始位置、
<VAR>frompos</VAR>としてウィンドウの左上隅の座標を渡します。
<VAR>to</VAR>にはバッファの<CODE>(point-max)</CODE>を渡して
走査をバッファの参照可能部分のみに制限し、
<VAR>topos</VAR>として<VAR>line</VAR>と<VAR>col</VAR>を渡す。
つぎのように呼び出す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defun coordinates-of-position (col line)
  (car (compute-motion (window-start)
                       '(0 . 0)
                       (point-max)
                       (cons col line)
                       (window-width)
                       (cons (window-hscroll) 0)
                       (selected-window))))
</pre></td></tr></table><P>

ミニバッファに対して<CODE>compute-motion</CODE>を使うときには、
<CODE>minibuffer-prompt-width</CODE>を使って
最初のスクリーン行の先頭の水平位置を得る必要がある。
see 節 <A HREF="elisp_20.html#SEC280">19.9 ミニバッファに関するその他</A>。
</DL>
<P>

<A NAME="List Motion"></A>
<HR SIZE="6">
<br><A NAME="SEC470"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC469"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC471"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="List Motion"></A>
<H3> 29.2.6 式単位の移動 </H3>
<!--docid::SEC470::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=List%20Motion">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=List%20Motion</a>"<br>
"texi/elisp21/式単位の移動"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%BC%B0%C3%B1%B0%CC%A4%CE%B0%DC%C6%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2084"></A>
<A NAME="IDX2085"></A>
<A NAME="IDX2086"></A>
<A NAME="IDX2087"></A>
<A NAME="IDX2088"></A>
<A NAME="IDX2089"></A>
<P>

ここでは、釣り合った括弧で囲まれた式
（Emacs内でそれらを単位に移動するときには<EM>S式</EM>（sexps）とも呼ばれる）を
扱う関数について述べます。
構文テーブルは、これらの関数がさまざまな文字を
どのように解釈するかを制御します。
<A HREF="elisp_35.html#SEC564">34. 構文テーブル</A>を参照してください。
S式やその一部を走査する下位レベルの基本関数については、
See 節 <A HREF="elisp_35.html#SEC572">34.6 釣り合った式の解析</A>。
ユーザーレベルのコマンドに関しては、
<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=emacs21&node=List%20Commands">GNU Emacs マニュアル</a>を参照してください。
<P>

<A NAME="IDX2090"></A>
<DL>
<DT><U>コマンド:</U> <B>forward-list</B> <I>arg</I>
<DD>この関数は、釣り合った括弧で囲まれたものを<VAR>arg</VAR>個前方へ飛び越えて移動する。
（単語や文字列のクォート対などの他の構文要素は無視する。）
</DL>
<P>

<A NAME="IDX2091"></A>
<DL>
<DT><U>コマンド:</U> <B>backward-list</B> <I>arg</I>
<DD>この関数は、釣り合った括弧で囲まれたものを<VAR>arg</VAR>個後方へ飛び越えて移動する。
（単語や文字列のクォート対などの他の構文要素は無視する。）
</DL>
<P>

<A NAME="IDX2092"></A>
<DL>
<DT><U>コマンド:</U> <B>up-list</B> <I>arg</I>
<DD>この関数は、前方へ向けて<VAR>arg</VAR>個の括弧のレベルを抜ける。
負の引数では後方へ向けて浅いレベルへ移動する。
</DL>
<P>

<A NAME="IDX2093"></A>
<DL>
<DT><U>コマンド:</U> <B>down-list</B> <I>arg</I>
<DD>この関数は、前方へ向けて<VAR>arg</VAR>個の括弧のレベルだけ深く入る。
負の引数では後方へ向けて括弧の深い（-<VAR>arg</VAR>）レベルへ移動する。
</DL>
<P>

<A NAME="IDX2094"></A>
<DL>
<DT><U>コマンド:</U> <B>forward-sexp</B> <I>arg</I>
<DD>この関数は、<VAR>arg</VAR>個の釣り合った式を前方へ向けて飛び越えて移動する。
釣り合った式には、括弧で区切られたものに加えて、
単語や文字列定数などの他の種類も含まれる。
たとえばつぎのとおり。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
(concat-!- "foo " (car x) y z)
---------- Buffer: foo ----------

(forward-sexp 3)
     => nil

---------- Buffer: foo ----------
(concat "foo " (car x) y-!- z)
---------- Buffer: foo ----------
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2095"></A>
<DL>
<DT><U>コマンド:</U> <B>backward-sexp</B> <I>arg</I>
<DD>この関数は、<VAR>arg</VAR>個の釣り合った式を後方へ向けて飛び越えて移動する。
</DL>
<P>

<A NAME="IDX2096"></A>
<DL>
<DT><U>コマンド:</U> <B>beginning-of-defun</B> <I>arg</I>
<DD>この関数は、前方へ向けて<VAR>arg</VAR>個目の関数定義の先頭へ移動する。
<VAR>arg</VAR>が負であると、後方へ向けて、
関数定義の末尾ではなく関数定義の先頭へ移動する。
</DL>
<P>

<A NAME="IDX2097"></A>
<DL>
<DT><U>コマンド:</U> <B>end-of-defun</B> <I>arg</I>
<DD>この関数は、前方へ向けて<VAR>arg</VAR>個目の関数定義の末尾へ移動する。
<VAR>arg</VAR>が負であると、後方へ向けて、
関数定義の先頭ではなく関数定義の末尾へ移動する。
</DL>
<P>

<A NAME="IDX2098"></A>
<DL>
<DT><U>User Option:</U> <B>defun-prompt-regexp</B>
<DD>この変数が<CODE>nil</CODE>以外であると、
関数定義を始める開き括弧のまえに現れうるテキストを指定する正規表現を保持する。
つまり、関数定義は、
行の先頭がこの正規表現に一致するテキストで始まり、
それに開き括弧の構文に属する文字が続く行で始まる。
</DL>
<P>

<A NAME="Skipping Characters"></A>
<HR SIZE="6">
<br><A NAME="SEC471"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC470"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC472"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Skipping Characters"></A>
<H3> 29.2.7 文字群の飛び越し </H3>
<!--docid::SEC471::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Skipping%20Characters">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Skipping%20Characters</a>"<br>
"texi/elisp21/文字群の飛び越し"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CA%B8%BB%FA%B7%B2%A4%CE%C8%F4%A4%D3%B1%DB%A4%B7">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2099"></A>
<P>

つぎの2つの関数は、指定した種類の文字を飛び越えてポイントを移動します。
たとえば、白文字を飛び越すためにこれらはしばしば使われます。
関連する関数については、<A HREF="elisp_35.html#SEC571">34.5 移動と構文</A>を参照してください。
<P>

<A NAME="IDX2100"></A>
<DL>
<DT><U>Function:</U> <B>skip-chars-forward</B> <I>character-set &#38;optional limit</I>
<DD>この関数は、指定した文字の集まりを飛び越えて、
カレントバッファ内で前方にポイントを移動する。
ポイントのあとの文字を調べ、
その文字が<VAR>character-set</VAR>に一致するとポイントを進める。
これを<VAR>character-set</VAR>に一致しない文字に達するまで繰り返す。
この関数は飛び越えた文字の個数を返す。
<P>

引数<VAR>character-set</VAR>は、正規表現の`<SAMP>[<small>...</small>]</SAMP>'の内側と同じであるが、
`<SAMP>]</SAMP>'は特別扱いせず、`<SAMP>\</SAMP>'は`<SAMP>^</SAMP>'や`<SAMP>-</SAMP>'や`<SAMP>\</SAMP>'をクォートする。
したがって、<CODE>"a-zA-Z"</CODE>はすべての英文字を飛び越えて
最初の英文字でない文字のまえで止まる。
<CODE>"^a-zA-Z"</CODE>は英文字でない文字を飛び越えて最初の英文字で止まる。
see 節 <A HREF="elisp_34.html#SEC551">33.2 正規表現</A>。
<P>

<VAR>limit</VAR>を指定すると（数かマーカであること）、
ポイントを移動できるバッファ内の最大位置を指定する。
ポイントは、<VAR>limit</VAR>で止まるか<VAR>limit</VAR>に達するまえに止まる。
<P>

つぎの例では、ポイントは最初は`<SAMP>T</SAMP>'の直前に位置している。
フォームを評価後には、ポイントはその行末
（`<SAMP>hat</SAMP>'の`<SAMP>t</SAMP>'と改行のあいだ）に位置している。
この関数は、すべての英文字と空白を飛び越えるが、改行は飛び越えない。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
I read "-!-The cat in the hat
comes back" twice.
---------- Buffer: foo ----------

(skip-chars-forward "a-zA-Z ")
     => nil

---------- Buffer: foo ----------
I read "The cat in the hat-!-
comes back" twice.
---------- Buffer: foo ----------
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2101"></A>
<DL>
<DT><U>Function:</U> <B>skip-chars-backward</B> <I>character-set &#38;optional limit</I>
<DD>この関数は、<VAR>limit</VAR>に達するまで、
後方へ向かって<VAR>character-set</VAR>に一致する文字を飛び越えてポイントを移動する。
これは<CODE>skip-chars-forward</CODE>と同様であるが、移動方向が異なる。
<P>

移動距離を表す値を返す。
それは0以下の整数である。
</DL>
<P>

<A NAME="Excursions"></A>
<HR SIZE="6">
<br><A NAME="SEC472"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC471"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC473"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Excursions"></A>
<H2> 29.3 エクスカージョン </H2>
<!--docid::SEC472::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Excursions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Excursions</a>"<br>
"texi/elisp21/エクスカージョン"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%A8%A5%AF%A5%B9%A5%AB%A1%BC%A5%B8%A5%E7%A5%F3">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2102"></A>
<P>

プログラムの局所的な部分で『一時的に』ポイントを移動したり、
一時的にバッファを切り替えられるとしばしば有用です。
これを<EM>エクスカージョン</EM>（excursion、周遊）と呼び、
スペシャルフォーム<CODE>save-excursion</CODE>で行います。
この構文は、カレントバッファとそのポイントやマーカの値を保存し、
エクスカージョンの完了後にそれらを復元します。
<P>

ウィンドウの構成を保存したり復元するフォームは、
別のところで述べてあります
（<A HREF="elisp_28.html#SEC432">27.16 ウィンドウ構成</A>とsee 節 <A HREF="elisp_29.html#SEC450">28.12 フレーム構成</A>）。
<P>

<A NAME="IDX2103"></A>
<DL>
<DT><U>Special Form:</U> <B>save-excursion</B> <I>forms<small>...</small></I>
<DD><A NAME="IDX2104"></A>
<A NAME="IDX2105"></A>
<A NAME="IDX2106"></A>
スペシャルフォーム<CODE>save-excursion</CODE>は、
カレントバッファの識別子とそのポイントやマーカの値を保存し、
<VAR>forms</VAR>を評価し、最後に、
バッファと保存しておいたポイントやマーカの値を復元する。
<CODE>throw</CODE>やエラーによる異常脱出（see 節 <A HREF="elisp_10.html#SEC127">9.5 非ローカル脱出</A>）であっても、
これらの保存した値を復元する。
<P>

スペシャルフォーム<CODE>save-excursion</CODE>は、
プログラムの一部分だけでバッファやポイントを移動し
プログラムの他の部分への影響を防ぐ標準的な方法である。
EmacsのLispソースでは4000回以上も使われている。
<P>

<CODE>save-excursion</CODE>は他のバッファのポイントやマークの値は保存しないので、
他のバッファでの変更は<CODE>save-excursion</CODE>から抜けても持続する。
<P>

<A NAME="IDX2107"></A>
同様に、<CODE>save-excursion</CODE>は、
<CODE>switch-to-buffer</CODE>などの関数で変更された
ウィンドウとバッファの対応関係は復元しない。
これらの対応関係や選択されているウィンドウを復元する1つの方法は、
<CODE>save-excursion</CODE>の内側で<CODE>save-window-excursion</CODE>を
使うことである（see 節 <A HREF="elisp_28.html#SEC432">27.16 ウィンドウ構成</A>）。
<P>

<CODE>save-excursion</CODE>の戻り値は、<VAR>forms</VAR>の最後の結果であるか、
<VAR>forms</VAR>を与えなければ<CODE>nil</CODE>である。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(save-excursion <VAR>forms</VAR>)
==
(let ((old-buf (current-buffer))
      (old-pnt (point-marker))
      (old-mark (copy-marker (mark-marker))))
  (unwind-protect
      (progn <VAR>forms</VAR>)
    (set-buffer old-buf)
    (goto-char old-pnt)
    (set-marker (mark-marker) old-mark)))
</pre></td></tr></table></DL>
<P>

  <STRONG>警告：</STRONG><CODE> </CODE>保存されたポイント値の箇所に
普通にテキストを挿入すると、すべてのマーカを再配置するように
保存されたポイント値を再配置する。
したがって、保存されたポイント値が復元されると、
ポイントは挿入されたテキストのまえに普通どおりにくる。
<P>

<CODE>save-excursion</CODE>はマーカの位置を保存しますが、
バッファを変更する関数が<CODE>deactivate-mark</CODE>を行うことを防ぎませんから、
コマンドが終了するとマーカが不活性になってしまいます。
See 節 <A HREF="elisp_31.html#SEC481">30.7 マーク</A>。
<P>

<A NAME="Narrowing"></A>
<HR SIZE="6">
<br><A NAME="SEC473"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_30.html#SEC472"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_31.html#SEC474"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Narrowing"></A>
<H2> 29.4 ナロイング </H2>
<!--docid::SEC473::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Narrowing">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Narrowing</a>"<br>
"texi/elisp21/ナロイング"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%CA%A5%ED%A5%A4%A5%F3%A5%B0">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<A NAME="IDX2108"></A>
<A NAME="IDX2109"></A>
<A NAME="IDX2110"></A>
<P>

<EM>ナロイング</EM>（narrowing）とは、
Emacsの編集コマンドが参照できるテキストを
バッファの制限された文字の範囲に限定することです。
参照できるテキストのことをバッファの
<EM>参照可能部分</EM>（accessible portion）と呼びます。
<P>

ナロイングは、参照可能部分の先頭と末尾になる2つのバッファ内位置で指定します。
ほとんどの編集コマンドやほとんどのEmacs基本関数にとっては、
これらの位置はバッファの先頭や末尾の値を置き換えることになります。
ナロイングしていると、参照可能部分の外側のテキストは表示されませんし、
ポイントは参照可能部分の外側へは移動できません。
<P>

通常はバッファの先頭から数える位置や行番号などの値は
ナロイングしていても同様に数えますが、
それらを使う関数は参照できないテキストを操作することを拒否します。
<P>

バッファを保存するコマンドはナロイングの影響を受けません。
つまり、ナロイングに関係なくバッファ全体を保存します。
<P>

<A NAME="IDX2111"></A>
<DL>
<DT><U>コマンド:</U> <B>narrow-to-region</B> <I>start end</I>
<DD>この関数は、カレントバッファの<VAR>start</VAR>で始まり<VAR>end</VAR>で終る部分を
参照可能部分にする。
どちらの引数も文字の位置であること。
<P>

対話的に呼び出されると、<VAR>start</VAR>と<VAR>end</VAR>は
現在のリージョンの境界（ポイントとマークの小さいほうがさきにくる）である。
</DL>
<P>

<A NAME="IDX2112"></A>
<DL>
<DT><U>コマンド:</U> <B>narrow-to-page</B> <I>move-count</I>
<DD>このコマンドは、カレントバッファの参照可能部分を
現在のページのみを含むようにする。
省略可能な第1引数<VAR>move-count</VAR>が<CODE>nil</CODE>以外であると、
<VAR>move-count</VAR>ページだけ前方か後方へ移動してから
1ページ分にナロイングする。
変数<CODE>page-delimiter</CODE>がページの開始箇所と終了箇所を指定する
（see 節 <A HREF="elisp_34.html#SEC563">33.8 編集に用いられる標準的な正規表現</A>）。
<P>

対話的に呼び出されると、<VAR>move-count</VAR>は数値前置引数である。
</DL>
<P>

<A NAME="IDX2113"></A>
<DL>
<DT><U>コマンド:</U> <B>widen</B>
<DD><A NAME="IDX2114"></A>
この関数は、カレントバッファのナロイングを解除し、
全体を参照できるようにする。
これを<EM>ワイドニング</EM>（widening）と呼ぶ。
これはつぎの式と等価である。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(narrow-to-region 1 (1+ (buffer-size)))
</pre></td></tr></table></DL>
<P>

<A NAME="IDX2115"></A>
<DL>
<DT><U>Special Form:</U> <B>save-restriction</B> <I>body<small>...</small></I>
<DD>このスペシャルフォームは、現在の参照可能部分の境界を保存し、
フォーム<VAR>body</VAR>を評価し、最後に、保存した境界を復元して
まえと同じナロイング状態（あるいはナロイングなし）に復元する。
<CODE>throw</CODE>やエラーによる異常脱出（see 節 <A HREF="elisp_10.html#SEC127">9.5 非ローカル脱出</A>）であっても、
ナロイング状態を復元する。
<P>

<CODE>save-restriction</CODE>の戻り値は、<VAR>body</VAR>の最後の結果であるか、
<VAR>body</VAR>を与えなければ<CODE>nil</CODE>である。
<P>

<STRONG>注意：</STRONG><CODE> </CODE>構文<CODE>save-restriction</CODE>を使うときには
まちがいやすい。
使うまえにこの説明全体を読むこと。
<P>

<VAR>body</VAR>でカレントバッファを切り替えても
<CODE>save-restriction</CODE>はもとのバッファ（バッファの制限を保存したバッファ）に
制限を復元するが、もとのカレントバッファには戻さない。
<P>

<CODE>save-restriction</CODE>はポイントやマークは復元<EM>しない</EM>。
それには<CODE>save-excursion</CODE>を使う。
<CODE>save-restriction</CODE>と<CODE>save-excursion</CODE>の両者を
一緒に使うときには、<CODE>save-excursion</CODE>が先に（外側に）くること。
さもないと、古いポイント値は一時的なナロイングが有効な状態で復元される。
古いポイント値が一時的なナロイングの範囲外にあると正しく復元できない。
<P>

スペシャルフォーム<CODE>save-restriction</CODE>は、
参照可能部分の先頭と末尾をバッファの先頭と末尾からの距離として記録する。
いいかえれば、参照可能部分の前後の参照できないテキストの量を記録する。
<P>

この方法は、<VAR>body</VAR>でさらにナロイングしても正しい結果を生じる。
しかし、<VAR>body</VAR>でワイドニングして保存されているナロイングの範囲外を
変更すると<CODE>save-restriction</CODE>が混乱する。
このようにしたいときには、
<CODE>save-restriction</CODE>は正しい解法ではない。
つぎのようにする必要がある。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(let ((beg (point-min-marker))
      (end (point-max-marker)))
  (unwind-protect
      (progn <VAR>body</VAR>)
    (save-excursion
      (set-buffer (marker-buffer beg))
      (narrow-to-region beg end))))
</pre></td></tr></table><P>

<CODE>save-restriction</CODE>の正しい使い方の簡単な例を示す。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>---------- Buffer: foo ----------
This is the contents of foo
This is the contents of foo
This is the contents of foo-!-
---------- Buffer: foo ----------

(save-excursion
  (save-restriction
    (goto-char 1)
    (forward-line 2)
    (narrow-to-region 1 (point))
    (goto-char (point-min))
    (replace-string "foo" "bar")))

---------- Buffer: foo ----------
This is the contents of bar
This is the contents of bar
This is the contents of foo-!-
---------- Buffer: foo ----------
</pre></td></tr></table></DL>
<A NAME="Markers"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<a name="bottom"> </a>
<script type="text/javascript" src="style2.js"></script>
<div class="footer">
    <br>
    このページはMeadow (Emacs) の紹介ページです <br>
このWebページの各文書は自由にリンク・複製・再配布・改変していただいて構いません．
<br>ただし，複製・再配布・改変の場合は Meadow Memo のURLを記載しておいて下さい．<br>
<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=about%20link">Medow memoへのリンクについて</a>．<br>

間違い，要望等があれば<a href="mailto:akihisa@mail.ne.jp">akihisa@mail.ne.jp</a> か下記でどうぞ<br>

<br>

<FORM METHOD="post" ACTION="http://www.bookshelf.jp/cgi-bin/wwwmail.cgi" >
お名前：<INPUT TYPE="text" NAME="name" SIZE="30" MAXLENGTH="40" VALUE="ななしさん"><br>
メールアドレス：<INPUT TYPE="text" NAME="EMAIL" SIZE="25" MAXLENGTH="60" VALUE="secret@mail.adr"><br>
<input type="hidden" name="HPAGE" value="">
つっこみ：<br><TEXTAREA NAME="MESSAGE" ROWS="5" COLS="50">
</TEXTAREA><br><br>
<INPUT TYPE="submit" VALUE="送信">
<INPUT TYPE="reset" VALUE="クリア">
</FORM>

<br><A HREF="http://www.bookshelf.jp/cgi-bin/xct.cgi">ページ別カウンタ</a>
<br> Since 2002/12/13 <br>
</div>

</BODY>

</HTML>
