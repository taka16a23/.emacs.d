<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML lang="ja">
<!-- Created on October, 1  2005 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=euc-jp">
<META NAME="keywords" CONTENT="meadow,mule,emacs,lisp,elisp,gnus,setting,設定,unix,cygwin">
<META http-equiv="Content-Script-Type" content="text/javascript">
<META NAME="description" CONTENT="Meadowの設定を紹介するページです">
<TITLE>GNU Emacs Lispリファレンスマニュアル:  カスタマイズ定義の書き方</TITLE>

<META NAME="description" CONTENT="GNU Emacs Lispリファレンスマニュアル:  カスタマイズ定義の書き方">
<META NAME="keywords" CONTENT="GNU Emacs Lispリファレンスマニュアル:  カスタマイズ定義の書き方">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

<LINK REL="contents" HREF="elisp_toc.html#SEC_Contents">
<LINK REL="index" HREF="elisp_48.html#SEC681">
<LINK REL="next" HREF="elisp_15.html#SEC191">
<LINK REL="prev" HREF="elisp_13.html#SEC171">

<META http-equiv="Content-Style-Type" content="text/css">
<!-- 鶯と龜 ←日本語EUC誤判別対策用らしい; -->
<link rel="StyleSheet" href="../../../../soft/css/midnight.css" type="text/css" id="css1">
<script type="text/javascript" src="style1.js"></script>
<link rel="stylesheet" type="text/css" href="../../../../soft/css/meadowmemo.css">

</HEAD>
<BODY LANG="ja" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">
<!--Infoseek Analyzer start-->
<script LANGUAGE="javascript">PgNo=6;</script>
<script src="http://js1.infoseek.co.jp/bin/57/00170.js"></script>
<noscript><a href="http://ax1.www.infoseek.co.jp/bin/go?0017057f" target="_blank">
<img src="http://ax1.www.infoseek.co.jp/bin/logo?0017057f" border=0></a></noscript>
<!--Infoseek Analyzer end-->
<a name="top"> </a>

<br><A NAME="SEC182"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_13.html#SEC181"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC183"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_13.html#SEC171"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_15.html#SEC191"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Customization"></A>
<H1> 13. カスタマイズ定義の書き方 </H1>
<!--docid::SEC182::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Customization">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Customization</a>"<br>
"texi/elisp21/カスタマイズ定義の書き方"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AB%A5%B9%A5%BF%A5%DE%A5%A4%A5%BA%C4%EA%B5%C1%A4%CE%BD%F1%A4%AD%CA%FD">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本章では、カスタマイズのためのユーザーオプションの宣言方法、
および、それらを分類するカスタマイズグループの宣言方法を説明します。
フェイスの定義（see 節 <A HREF="elisp_38.html#SEC613">37.10.2 フェイスを定義する</A>）に加えて、
カスタマイズの両方の種類を含めて、
<EM>カスタマイズ項目</EM>（customization item）という用語を使います。
<P>

<div class="menuindex"><SCRIPT language=JavaScript src="index13.js"></SCRIPT></div><noscript><BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_14.html#SEC183">13.1 すべての種類の項目に共通のキーワード</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_14.html#SEC184">13.2 カスタマイズグループを定義する</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_14.html#SEC185">13.3 カスタマイズ変数を定義する</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_14.html#SEC186">13.4 カスタマイズ型</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE></noscript>
<P>

<A NAME="Common Keywords"></A>
<HR SIZE="6">
<br><A NAME="SEC183"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC182"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC184"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Common Keywords"></A>
<H2> 13.1 すべての種類の項目に共通のキーワード </H2>
<!--docid::SEC183::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Common%20Keywords">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Common%20Keywords</a>"<br>
"texi/elisp21/すべての種類の項目に共通のキーワード"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A4%B9%A4%D9%A4%C6%A4%CE%BC%EF%CE%E0%A4%CE%B9%E0%CC%DC%A4%CB%B6%A6%C4%CC%A4%CE%A5%AD%A1%BC%A5%EF%A1%BC%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

（変数やグループ、フェイスの）すべての種類のカスタマイズ宣言では、
さまざまな情報を指定するためのキーワード引数を受け付けます。
本節では、全種類に適用できるキーワードを説明します。
<P>

<CODE>:tag</CODE>を除くこれらのキーワードすべては、各項目で複数回使えます。
キーワードのそれぞれの使用には、独立の効果があります。
キーワード<CODE>:tag</CODE>は例外です。
任意の項目には名前を1つしか表示できないからです。
<P>

<DL COMPACT>
<DT><CODE>:tag <VAR>name</VAR></CODE>
<DD>カスタマイズメニューやカスタマイズバッファ内で
項目に付けるラベルとして、項目の名前のかわりに文字列<VAR>name</VAR>を使う。
<P>

<DT><CODE>:group <VAR>group</VAR></CODE>
<DD>このカスタマイズ項目をグループ<VAR>group</VAR>に入れる。
<CODE>defgroup</CODE>の中で<CODE>:group</CODE>を使うと、
新たなグループを<VAR>group</VAR>の下位グループにする。
<P>

このキーワードを複数回使うと、
1つの項目を複数のグループに入れることができる。
それらのグループのどれを表示しても、この項目が表示される。
これを多用しすぎないように注意すること！
<P>

<DT><CODE>:link <VAR>link-data</VAR></CODE>
<DD>この項目に対する説明文字列のうしろに外部リンクを含める。
これは、他の説明文字列を参照するアクティブフィールドを含む文である。
<P>

<VAR>link-data</VAR>として使えるものは3種類ある。
<P>

<DL COMPACT>
<DT><CODE>(custom-manual <VAR>info-node</VAR>)</CODE>
<DD>infoのノードへリンクする。
<VAR>info-node</VAR>は、<CODE>"(emacs)Top"</CODE>のようなノード名を指定する文字列。
リンクは、カスタマイズバッファでは`<SAMP>[manual]</SAMP>'のように表示される。
<P>

<DT><CODE>(info-link <VAR>info-node</VAR>)</CODE>
<DD><CODE>custom-manual</CODE>と同様であるが、
カスタマイズバッファに現れるリンクはinfoのノード名になる。
<P>

<DT><CODE>(url-link <VAR>url</VAR>)</CODE>
<DD>webページへリンクする。
<VAR>url</VAR>は、URLを指定する文字列。
カスタマイズバッファに現れるリンクは<VAR>url</VAR>になる。
</DL>
<P>

<VAR>link-data</VAR>の先頭要素のうしろに<CODE>:tag <VAR>name</VAR></CODE>を使うことで、
カスタマイズバッファに使うテキストを指定できる。
たとえば、<CODE>(info-link :tag "foo" "(emacs)Top")</CODE>とすると、
バッファでは`<SAMP>foo</SAMP>'と表示されるEmacsマニュアルへのリンクを作れる。
<P>

1つの項目に複数個の外部リンクがあってもよいが、
ほとんどの項目には外部リンクはない。
<P>

<DT><CODE>:load <VAR>file</VAR></CODE>
<DD>このカスタマイズ項目を表示するまえにファイル<VAR>file</VAR>（文字列）をロードする。
ファイルをすでにロードしていない場合に限り、
<CODE>load-library</CODE>でロードする。
<P>

<DT><CODE>:require <VAR>feature</VAR></CODE>
<DD>カスタマイズ機能を用いて保存するこの項目に対する値をインストールするときに
必要となる機能<VAR>feature</VAR>（シンボル）を指定する。
<CODE>require</CODE>を呼び出す。
<P>

<CODE>:require</CODE>を使うもっとも一般的な理由は、
変数がマイナモードなどの機能をオンにするとき、
そのモードを実装するコードをロードしてないと、
変数にはなんの効果もないからである。
</DL>
<P>

<A NAME="Group Definitions"></A>
<HR SIZE="6">
<br><A NAME="SEC184"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC183"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC185"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Group Definitions"></A>
<H2> 13.2 カスタマイズグループを定義する </H2>
<!--docid::SEC184::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Group%20Definitions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Group%20Definitions</a>"<br>
"texi/elisp21/カスタマイズグループを定義する"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AB%A5%B9%A5%BF%A5%DE%A5%A4%A5%BA%A5%B0%A5%EB%A1%BC%A5%D7%A4%F2%C4%EA%B5%C1%A4%B9%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

Emacs Lispの各パッケージには、
そのパッケージのすべてのオプション、フェイス、他のグループを含んだ
1つの主要なカスタマイズグループがあるべきです。
パッケージに少数のオプションやフェイスしかなければ、
それらを1つのグループにまとめます。
12個を超えるオプションやフェイスがある場合には、
それらを下位グループに構造化して、
下位グループすべてをパッケージの主カスタマイズグループに入れておきます。
パッケージの主グループに下位グループとともにいくつかのオプションやフェイスを
入れておくのもよいでしょう。
<P>

パッケージの主グループや単一のグループは、
標準カスタマイズグループの1つかそれ以上のメンバであるべきです。
（それらの完全な一覧を表示するには<KBD>M-x customize</KBD>を使う。）
それらの中から1個か数個を選び（多すぎないこと）、
キーワード<CODE>:group</CODE>を使って、それぞれに読者のグループを追加します。
<P>

新たなカスタマイズグループは、<CODE>defgroup</CODE>で宣言します。
<P>

<A NAME="IDX707"></A>
<DL>
<DT><U>Macro:</U> <B>defgroup</B> <I>group members doc [keyword value]...</I>
<DD><A NAME="IDX708"></A>
<VAR>members</VAR>を含むカスタマイズグループとして<VAR>group</VAR>を宣言する。
シンボル<VAR>group</VAR>をクォートしないこと。
引数<VAR>doc</VAR>は、グループの説明文字列を指定する。
<P>

引数<VAR>members</VAR>は、グループのメンバとなる
カスタマイズ項目の初期集合を指定するリストである。
しかし、ほとんどの場合、<VAR>members</VAR>は<CODE>nil</CODE>であり、
それらのメンバを定義するときに、キーワード<CODE>:group</CODE>を使って、
グループのメンバであることを指定する。
<P>

<VAR>members</VAR>でグループのメンバを指定する場合には、
各要素は<CODE>(<VAR>name</VAR> <VAR>widget</VAR>)</CODE>という形式であること。
ここで、<VAR>name</VAR>はシンボル、
<VAR>widget</VAR>はそのシンボルを編集するためのウィジェット型である。
有用なウィジェットは、変数に対しては<CODE>custom-variable</CODE>、
フェイスに対しては<CODE>custom-face</CODE>、
グループに対しては<CODE>custom-group</CODE>である。
<P>

共通のキーワード（see 節 <A HREF="elisp_14.html#SEC183">13.1 すべての種類の項目に共通のキーワード</A>）に加えて、
<CODE>defgroup</CODE>ではつぎのキーワードも使える。
<P>

<DL COMPACT>
<DT><CODE>:prefix <VAR>prefix</VAR></CODE>
<DD>グループ内の項目の名前が<VAR>prefix</VAR>で始まるときには、
その項目に対するタグを（デフォルトでは）<VAR>prefix</VAR>を省略して作る。
<P>

1つのグループに<CODE>prefix</CODE>がいくつあってもよい。
</DL>
</DL>
<P>

接頭辞を取りさる機能は、現在、オフにしてあります。
つまり、<CODE>:prefix</CODE>は、現在、なんの効果もありません。
このようにしたのは、指定した接頭辞を取りさると、
オプション名がしばしば混乱するからです。
さまざまなグループの<CODE>defgroup</CODE>定義を書く人は、
論理的と考えられるとき、つまり、ライブラリに共通の接頭辞があるときには
キーワード<CODE>:prefix</CODE>を追加するので、このようになるのです。
<P>

<CODE>:prefix</CODE>を使ってよい結果を得るには、
グループ内の特定の項目とそれらの名前と説明文字列に関して、
特定の接頭辞を取りさった場合の効果を調べる必要があります。
その結果、テキストがわかり難ければ、
その場面では、<CODE>:prefix</CODE>を使うべきではないのでしょう。
<P>

カスタマイズグループすべてを調べ直して、
わかり難くなる結果をもたらす<CODE>:prefix</CODE>指定を削除し、
この機能をオンにすることは、誰かが頑張れば、可能です。
<P>

<A NAME="Variable Definitions"></A>
<HR SIZE="6">
<br><A NAME="SEC185"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC184"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC186"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Variable Definitions"></A>
<H2> 13.3 カスタマイズ変数を定義する </H2>
<!--docid::SEC185::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Variable%20Definitions">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Variable%20Definitions</a>"<br>
"texi/elisp21/カスタマイズ変数を定義する"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AB%A5%B9%A5%BF%A5%DE%A5%A4%A5%BA%CA%D1%BF%F4%A4%F2%C4%EA%B5%C1%A4%B9%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<CODE>defcustom</CODE>を使って、ユーザーが編集可能な変数を宣言します。
<P>

<A NAME="IDX709"></A>
<DL>
<DT><U>Macro:</U> <B>defcustom</B> <I>option default doc [keyword value]...</I>
<DD><A NAME="IDX710"></A>
カスタマイズ可能なユーザーオプション変数として<VAR>option</VAR>を宣言する。
<VAR>option</VAR>をクォートしないこと。
引数<VAR>doc</VAR>は変数の説明文字列を指定する。
<P>

<VAR>option</VAR>が空であると、<CODE>defcustom</CODE>は<VAR>default</VAR>で初期化する。
<VAR>default</VAR>は値を計算する式であること。
これは複数回評価される可能性があるので、書き方には注意すること。
</DL>
<P>

<CODE>defcustom</CODE>では、つぎの追加キーワードも使えます。
<P>

<DL COMPACT>
<DT><CODE>:type <VAR>type</VAR></CODE>
<DD>このオプションのデータ型として<VAR>type</VAR>を使う。
これは、正しい値とその表示方法を指定する。
詳しくは、see 節 <A HREF="elisp_14.html#SEC186">13.4 カスタマイズ型</A>。
<P>

<DT><CODE>:options <VAR>list</VAR></CODE>
<DD>このオプションに使える合理的な値のリストとして<VAR>list</VAR>を指定する。
<P>

これは、現時点では、型が<CODE>hook</CODE>のときだけ意味を持つ。
その場合、<VAR>list</VAR>の要素は、フックの値の要素として使える関数であること。
ユーザーはこれらの関数以外も使えるが、便利な選択肢として提示する。
<P>

<DT><CODE>:version <VAR>version</VAR></CODE>
<DD>このオプションは、変数を最初に導入したり、デフォルト値を変更したりした
Emacsの版<VAR>version</VAR>を指定する。
値<VAR>version</VAR>は、文字列であること。
たとえば、つぎのとおり。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defcustom foo-max 34
  "*Maximum number of foo's allowed."
  :type 'integer
  :group 'foo
  :version "20.3")
</pre></td></tr></table><P>

<DT><CODE>:set <VAR>setfunction</VAR></CODE>
<DD>このオプションの値を変更する方法として<VAR>setfunction</VAR>を指定する。
関数<VAR>setfunction</VAR>は、2つの引数、つまり、シンボルと新しい値を取り、
このオプションの値を（Lisp変数としてオプションを設定するだけでなく）
適切に更新するために必要なことを行うこと。
<VAR>setfunction</VAR>のデフォルトは<CODE>set-default</CODE>。
<P>

<DT><CODE>:get <VAR>getfunction</VAR></CODE>
<DD>このオプションの値を取り出す方法として<VAR>getfunction</VAR>を指定する。
関数<VAR>getfunction</VAR>は、1つの引数、つまり、シンボルを取り、
そのシンボル（のLisp値とは必ずしも限らない）の『現在値』を返すこと。
デフォルトは<CODE>default-value</CODE>。
<P>

<DT><CODE>:initialize <VAR>function</VAR></CODE>
<DD><VAR>function</VAR>は、<CODE>defcustom</CODE>を評価したときに変数の初期化に使う関数。
この関数は、2つの引数、つまり、シンボルと値を取ること。
このように使うことを意図した定義済みの関数がいくつかある。
<P>

<DL COMPACT>
<DT><CODE>custom-initialize-set</CODE>
<DD>変数の<CODE>:set</CODE>関数を使って変数を初期化するが、
変数の値が空でないときには再初期化しない。
これは<CODE>:initialize</CODE>のデフォルト。
<P>

<DT><CODE>custom-initialize-default</CODE>
<DD><CODE>custom-initialize-set</CODE>に似ているが、
変数の<CODE>:set</CODE>関数のかわりに関数<CODE>set-default</CODE>を使って変数を設定する。
変数の<CODE>:set</CODE>関数がマイナモードをオン／オフする場合には、
普通はこれを選ぶ。
これを選ぶと、変数を定義してもマイナモード関数を呼び出さないが、
変数をカスタマイズするとマイナモード関数を呼び出す。
<P>

<DT><CODE>custom-initialize-reset</CODE>
<DD>変数を初期化するにはつねに<CODE>:set</CODE>関数を使う。
変数の値が空でない場合には、（<CODE>:get</CODE>で得られる）現在値で
<CODE>:set</CODE>関数を呼び出して、変数をリセットする。
<P>

<DT><CODE>custom-initialize-changed</CODE>
<DD>変数がすでに設定されていたりカスタマイズしてあるときに、
変数を初期化するために<CODE>:set</CODE>関数を使う。
さもなければ、<CODE>set-default</CODE>を使う。
</DL>
</DL>
<P>

<CODE>:require</CODE>オプションは、
特定の機能をオンにするようなオプションには便利です。
パッケージがオプション変数の値を検査するように書かれていたとしても、
パッケージをロードするようにする必要があります。
これを<CODE>:require</CODE>で行えるのです。
See 節 <A HREF="elisp_14.html#SEC183">13.1 すべての種類の項目に共通のキーワード</A>。
ライブラリ`<TT>paren.el</TT>'からとった例をつぎに示します。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defcustom show-paren-mode nil
  "Toggle Show Paren mode<small>....</small>"
  :set (lambda (symbol value)
         (show-paren-mode (or value 0)))
  :initialize 'custom-initialize-default
  :type 'boolean
  :group 'paren-showing
  :require 'paren)
</pre></td></tr></table><P>

内部的には、<CODE>defcustom</CODE>は、
デフォルト値を与える式は属性<CODE>standard-value</CODE>を使って記録し、
ユーザーがカスタマイズバッファで保存した値は
属性<CODE>saved-value</CODE>を使って記録しています。
属性<CODE>saved-value</CODE>は実際にはリストであり、
そのCARが値に評価される式です。
<P>

<A NAME="Customization Types"></A>
<HR SIZE="6">
<br><A NAME="SEC186"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC185"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC187"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Customization Types"></A>
<H2> 13.4 カスタマイズ型 </H2>
<!--docid::SEC186::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Customization%20Types">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Customization%20Types</a>"<br>
"texi/elisp21/カスタマイズ型"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%AB%A5%B9%A5%BF%A5%DE%A5%A4%A5%BA%B7%BF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<CODE>defcustom</CODE>でユーザーオプションを定義するときには、
その<EM>カスタマイズ型</EM>（customization type）を定義する必要があります。
これはLispオブジェクトであり、
（1）どのような値が正しいものであり、
（2）編集用にカスタマイズバッファに表示する方法、
を示します。
<P>

カスタマイズ型は、<CODE>defcustom</CODE>内の<CODE>:type</CODE>キーワードで指定します。
<CODE>:type</CODE>の引数は評価されます。
実行時に型が変わるものはほとんど使い途がないので、
普通、クォートした型を指定します。
たとえば、つぎのとおりです。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(defcustom diff-command "diff"
  "*The command to use to run diff."
  :type '(string)
  :group 'diff)
</pre></td></tr></table><P>

一般に、カスタマイズ型はリストであり、
その先頭要素はシンボルで、次節以降で定義するカスタマイズ型名の1つです。
このシンボルのあとには、シンボルに依存した数個の引数が続きます。
型シンボルとその引数のあいだには、
キーワード・値の対を書くこともできます
（see 節 <A HREF="elisp_14.html#SEC190">13.4.4 型キーワード</A>）。
<P>

型シンボルには、引数を取らないものもあります。
これらを<EM>単純型</EM>（simple types）と呼びます。
単純型では、キーワード・値の対を指定しなければ、
型シンボルを囲む括弧を省略できます。
たとえば、カスタマイズ型としての<CODE>string</CODE>は、
<CODE>(string)</CODE>と等価です。
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_14.html#SEC187">13.4.1 単純型</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_14.html#SEC188">13.4.2 複合型</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_14.html#SEC189">13.4.3 リストに繋ぎ合わせる</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="elisp_14.html#SEC190">13.4.4 型キーワード</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Simple Types"></A>
<HR SIZE="6">
<br><A NAME="SEC187"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC186"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC188"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Simple Types"></A>
<H3> 13.4.1 単純型 </H3>
<!--docid::SEC187::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Simple%20Types">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Simple%20Types</a>"<br>
"texi/elisp21/単純型"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%C3%B1%BD%E3%B7%BF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

本節では、すべての単純型を説明します。
<P>

<DL COMPACT>
<DT><CODE>sexp</CODE>
<DD>値は、表示したり読み取れるならば、任意のLispオブジェクトでよい。
使用する型をより限定する手間を省きたければ、
任意のオプションに対するデフォルトとして、
<CODE>sexp</CODE>を使うことができる。
<P>

<DT><CODE>integer</CODE>
<DD>値は整数である必要があり、カスタマイズバッファではテキストで表示する。
<P>

<DT><CODE>number</CODE>
<DD>値は数である必要があり、カスタマイズバッファではテキストで表示する。
<P>

<DT><CODE>string</CODE>
<DD>値は文字列である必要があり、
カスタマイズバッファでは、その内容だけを表示し、
文字`<SAMP>"</SAMP>'で区切ったり、`<SAMP>\</SAMP>'でクォートしない。
<P>

<DT><CODE>regexp</CODE>
<DD><CODE>string</CODE>と同様であるが、
文字列は正規表現である必要がある。
<P>

<DT><CODE>character</CODE>
<DD>値は文字コードである必要がある。
文字コードは実際には整数であるが、
この型では、数として表示するのではなく、
文字としてバッファに挿入してその値を表示する。
<P>

<DT><CODE>file</CODE>
<DD>値はファイル名である必要があり、<KBD>M-<KBD>TAB</KBD></KBD>で補完できる。
<P>

<DT><CODE>(file :must-match t)</CODE>
<DD>値は既存のファイル名である必要があり、<KBD>M-<KBD>TAB</KBD></KBD>で補完できる。
<P>

<DT><CODE>directory</CODE>
<DD>値はディレクトリ名である必要があり、<KBD>M-<KBD>TAB</KBD></KBD>で補完できる。
<P>

<DT><CODE>hook</CODE>
<DD>値は関数のリスト（あるいは、単一の関数。ただし、この使い方は廃れている）
である必要がある。
このカスタマイズ型は、フック変数に使用する。
フックに使う推奨される関数のリストを指定するために、
フック変数の<CODE>defcustom</CODE>で<CODE>:options</CODE>キーワードを使用できる。
see 節 <A HREF="elisp_14.html#SEC185">13.3 カスタマイズ変数を定義する</A>。
<P>

<DT><CODE>symbol</CODE>
<DD>値はシンボルである必要がある。
カスタマイズバッファでは、シンボルの名前を表示する。
<P>

<DT><CODE>function</CODE>
<DD>値はラムダ式か関数名である必要がある。
関数名の場合、<KBD>M-<KBD>TAB</KBD></KBD>で補完できる。
<P>

<DT><CODE>variable</CODE>
<DD>値は変数名である必要があり、<KBD>M-<KBD>TAB</KBD></KBD>で補完できる。
<P>

<DT><CODE>face</CODE>
<DD>値はフェイス名を表すシンボルである必要があり、<KBD>M-<KBD>TAB</KBD></KBD>で補完できる。
<P>

<DT><CODE>boolean</CODE>
<DD>値は真理値、つまり、<CODE>nil</CODE>か<CODE>t</CODE>である必要がある。
<CODE>choice</CODE>と<CODE>const</CODE>を同時に使うと（次節参照）、
値は<CODE>nil</CODE>か<CODE>t</CODE>である必要があることを指定し、
さらに、どちらの値がどの選択肢に合うかを記述するテキストを
指定できることに注意。
</DL>
<P>

<A NAME="Composite Types"></A>
<HR SIZE="6">
<br><A NAME="SEC188"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC187"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC189"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Composite Types"></A>
<H3> 13.4.2 複合型 </H3>
<!--docid::SEC188::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Composite%20Types">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Composite%20Types</a>"<br>
"texi/elisp21/複合型"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%CA%A3%B9%E7%B7%BF">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

単純型が適切でない場合には、
他の型から新たな型を作り上げる複合型を使えます。
これには、いくつかの方法があります。
<P>

<DL COMPACT>
<DT><CODE>(restricted-sexp :match-alternatives <VAR>criteria</VAR>)</CODE>
<DD>値は、<VAR>criteria</VAR>の1つを満たす任意のLispオブジェクトでよい。
<VAR>criteria</VAR>はリストであり、その各要素は以下の1つであること。
<P>

<UL>
<LI>
述語。
つまり、引数を1つ取る副作用のない関数であり、
引数に応じて<CODE>nil</CODE>か<CODE>nil</CODE>以外を返す。
リスト内の述語がオブジェクトに対して<CODE>nil</CODE>以外を返せば
そのオブジェクトを受理することを意味する。
<P>

<LI>
クォートした定数。
つまり、<CODE>'<VAR>object</VAR></CODE>。
リスト内のこの種の要素は、
<VAR>object</VAR>そのものが受理できる値であることを意味する。
</UL>
<P>

たとえば、
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(restricted-sexp :match-alternatives
                 (integerp 't 'nil))
</pre></td></tr></table><P>

は、整数、<CODE>t</CODE>、<CODE>nil</CODE>が正しい値である。
<P>

カスタマイズバッファでは、すべての正しい値はその入力構文で表示し、
ユーザーはそれらをテキストとして編集する。
<P>

<DT><CODE>(cons <VAR>car-type</VAR> <VAR>cdr-type</VAR>)</CODE>
<DD>値はコンスセルである必要があり、
そのCARは<VAR>car-type</VAR>に合い、かつ、
そのCDRは<VAR>cdr-type</VAR>に合う必要がある。
たとえば、<CODE>(cons string symbol)</CODE>は、
<CODE>("foo" . foo)</CODE>などの値に一致するカスタマイズ型である。
<P>

カスタマイズバッファでは、
CARとCDRは、
それらに指定した型に応じて別々に表示され、個別に編集できる。
<P>

<DT><CODE>(list <VAR>element-types</VAR><small>...</small>)</CODE>
<DD>値は<VAR>element-types</VAR>に指定したとおりの個数のリストである必要があり、
各要素は<VAR>element-type</VAR>に合うこと。
<P>

たとえば、<CODE>(list integer string function)</CODE>は、
3要素のリストを意味し、
第1要素は整数、第2要素は文字列、第3要素は関数であることを指定する。
<P>

カスタマイズバッファでは、
各要素は、それらに指定した型に応じて別々に表示され、個別に編集できる。
<P>

<DT><CODE>(vector <VAR>element-types</VAR><small>...</small>)</CODE>
<DD><CODE>list</CODE>と同様だが、値はリストではなくベクトルである必要がある。
その要素は<CODE>list</CODE>の場合と同じ。
<P>

<DT><CODE>(choice <VAR>alternative-types</VAR>...)</CODE>
<DD>値は、<VAR>alternative-types</VAR>の少なくとも1つに合う必要がある。
たとえば、<CODE>(choice integer string)</CODE>は、整数か文字列を許す。
<P>

カスタマイズバッファでは、ユーザーはメニューを使って選択肢を選び、
その選択肢において普通の方法で値を編集する。
<P>

通常、このメニューの選択肢名は、選択肢から自動的に決定されるが、
選択肢に<CODE>:tag</CODE>キーワードを含めることで、
メニューに異なる名前を指定できる。
たとえば、整数が空白の個数を表し、文字列がそのまま使うテキストを表す場合には、
つぎのようにカスタマイズ型を書く。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(choice (integer :tag "Number of spaces")
        (string :tag "Literal text"))
</pre></td></tr></table><P>

そうすると、メニューには、
`<SAMP>Number of spaces</SAMP>'と`<SAMP>Literal Text</SAMP>'が表示される。
<P>

<CODE>const</CODE>以外の<CODE>nil</CODE>が正当な値ではない選択肢では、
そのような選択肢には<CODE>:value</CODE>キーワードを使って
正当なデフォルト値を指定すること。
See 節 <A HREF="elisp_14.html#SEC190">13.4.4 型キーワード</A>。
<P>

<DT><CODE>(const <VAR>value</VAR>)</CODE>
<DD>値は<VAR>value</VAR>であること。
それ以外は許さない。
<P>

<CODE>const</CODE>の主な用途は<CODE>choice</CODE>の内側である。
たとえば、<CODE>(choice integer (const nil))</CODE>は、整数か<CODE>nil</CODE>を許す。
<P>

<CODE>choice</CODE>の内側では、<CODE>const</CODE>にしばしば<CODE>:tag</CODE>を使う。
たとえば、
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(choice (const :tag "Yes" t)
        (const :tag "No" nil)
        (const :tag "Ask" foo))
</pre></td></tr></table><P>

は、<CODE>t</CODE>は『yes』（はい）、<CODE>nil</CODE>は『no』（いいえ）、
<CODE>foo</CODE>は『ask』（問い合わせる）を意味する変数を記述する。
<P>

<DT><CODE>(other <VAR>value</VAR>)</CODE>
<DD>この選択肢は任意のLisp値に一致するが、
ユーザーがこの選択肢を選ぶと、値<VAR>value</VAR>を選ぶことになる。
<P>

<CODE>other</CODE>は、主に、<CODE>choice</CODE>の最後の要素として使うことである。
たとえば、
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(choice (const :tag "Yes" t)
        (const :tag "No" nil)
        (other :tag "Ask" foo))
</pre></td></tr></table><P>

は、<CODE>t</CODE>は『yes』（はい）、<CODE>nil</CODE>は『no』（いいえ）、
それ以外は『ask』（問い合わせる）を意味することを示す。
ユーザーが選択肢のメニューから`<SAMP>Ask</SAMP>'を選ぶと、値<CODE>foo</CODE>を指定する。
しかし、（<CODE>t</CODE>でも<CODE>nil</CODE>でも<CODE>foo</CODE>でもない）それ以外の値は、
<CODE>foo</CODE>と同様に`<SAMP>Ask</SAMP>'と表示される。
<P>

<DT><CODE>(function-item <VAR>function</VAR>)</CODE>
<DD><CODE>const</CODE>と同様だが、関数であるような値に使う。
これは、関数名に加えて説明文字列を表示する。
説明文字列は、<CODE>:doc</CODE>に指定したものか、
<VAR>function</VAR>そのものの説明文字列である。
<P>

<DT><CODE>(variable-item <VAR>variable</VAR>)</CODE>
<DD><CODE>const</CODE>と同様だが、変数名であるような値に使う。
これは、変数名に加えて説明文字列を表示する。
説明文字列は、<CODE>:doc</CODE>に指定したものか、
<VAR>variable</VAR>そのものの説明文字列である。
<P>

<DT><CODE>(set <VAR>elements</VAR><small>...</small>)</CODE>
<DD>値はリストである必要があり、
その各要素は<VAR>elements</VAR>に指定したものの1つである必要がある。
これは、カスタマイズバッファにはチェックリストとして表示される。
<P>

<DT><CODE>(repeat <VAR>element-type</VAR>)</CODE>
<DD>値はリストである必要があり、
その各要素は<VAR>element-type</VAR>に指定した型に合う必要がある。
これは、カスタマイズバッファには、
要素を追加したり削除したりする`<SAMP>[INS]</SAMP>'や`<SAMP>[DEL]</SAMP>'ボタンを伴って、
要素のリストとして表示される。
</DL>
<P>

<A NAME="Splicing into Lists"></A>
<HR SIZE="6">
<br><A NAME="SEC189"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC188"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC190"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Splicing into Lists"></A>
<H3> 13.4.3 リストに繋ぎ合わせる </H3>
<!--docid::SEC189::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Splicing%20into%20Lists">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Splicing%20into%20Lists</a>"<br>
"texi/elisp21/リストに繋ぎ合わせる"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%A5%EA%A5%B9%A5%C8%A4%CB%B7%D2%A4%AE%B9%E7%A4%EF%A4%BB%A4%EB">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

<CODE>:inline</CODE>機能により、可変個数の要素をリストやベクトルの
途中に繋ぎ合わせることができます。
<CODE>list</CODE>や<CODE>vector</CODE>の要素型に現れる
<CODE>set</CODE>型、<CODE>choice</CODE>型、<CODE>repeat</CODE>型の中に使います。
<P>

通常、<CODE>list</CODE>や<CODE>vector</CODE>のおのおのの要素型は、
リストやベクトルのたった1つの要素を記述します。
したがって、要素型が<CODE>repeat</CODE>であると、
1要素として表示される長さを指定しないリストを指定します。
<P>

しかし、要素型に<CODE>:inline</CODE>を使うと、
これに一致する値は、<CODE>:inline</CODE>を含むシーケンスに直接に併合されます。
たとえば、3要素のリストに一致すると、
それがシーケンス全体の3つの要素になります。
これはバッククォート構文の`<SAMP>,&#64;</SAMP>'の使い方に似ています。
<P>

たとえば、先頭要素が<CODE>t</CODE>であり、
残りが<CODE>foo</CODE>か<CODE>bar</CODE>の0個以上の繰り返しであるリストを指定するには、
つぎのカスタマイズ型を使います。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(list (const t) (set :inline t foo bar))
</pre></td></tr></table><P>

これは、<CODE>(t)</CODE>、<CODE>(t foo)</CODE>、<CODE>(t bar)</CODE>、<CODE>(t foo bar)</CODE>などの
値に一致します。
<P>

要素型が<CODE>choice</CODE>であるときには、
<CODE>choice</CODE>そのものには<CODE>:inline</CODE>を使いませんが、
<CODE>choice</CODE>の選択肢（のどれか）に<CODE>:inline</CODE>を使います。
たとえば、ファイル名で始まりシンボル<CODE>t</CODE>か2つの文字列が続くような
リストに一致するようにするには、
つぎのカスタマイズ型を使います。
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(list file
      (choice (const t)
              (list :inline t string string)))
</pre></td></tr></table><P>

ユーザーが最初の選択肢を選ぶと、全体としてのリストは2要素になり、
第2要素は<CODE>t</CODE>です。
ユーザーが2番目の選択肢を選ぶと、
全体としてのリストは3要素になり、
第2要素と第3要素は文字列である必要があります。
<P>

<A NAME="Type Keywords"></A>
<HR SIZE="6">
<br><A NAME="SEC190"> </A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_14.html#SEC189"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_15.html#SEC191"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<A NAME="Type Keywords"></A>
<H3> 13.4.4 型キーワード </H3>
<!--docid::SEC190::-->
<div class="info">URL="<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Type%20Keywords">http://www.bookshelf.jp/cgi-bin/goto.cgi?file=elisp21&node=Type%20Keywords</a>"<br>
"texi/elisp21/型キーワード"への<a href="http://www.bookshelf.jp/pukiwiki/pukiwiki.php?refer=Meadow%20memo&cmd=read&page=texi%2Felisp21%2F%B7%BF%A5%AD%A1%BC%A5%EF%A1%BC%A5%C9">コメント</a>(無し)</div><FORM METHOD="GET" ACTION="http://www.bookshelf.jp/cgi-bin/wwwsrch.cgi"><div class="info">検索<INPUT TYPE=text NAME=WORD SIZE=30><INPUT TYPE=hidden NAME=index VALUE=memo CHECKED><INPUT TYPE=hidden NAME=target VALUE=all CHECKED><INPUT TYPE=hidden NAME="memoall" VALUE="on" CHECKED><INPUT TYPE=hidden NAME=ANDOR VALUE=and CHECKED><INPUT TYPE=radio NAME=lisp VALUE=off CHECKED>全文<INPUT TYPE=radio NAME=lisp VALUE=on>Elisp<INPUT TYPE=submit VALUE="検索"></div></FORM>
<P>

型名のシンボルのあとに、カスタマイズ型内にキーワード・引数の対を指定できます。
使えるキーワードとその意味を以下に示します。
<P>

<DL COMPACT>
<DT><CODE>:value <VAR>default</VAR></CODE>
<DD><CODE>choice</CODE>の内側の選択肢として現れる型に使う。
これは、カスタマイズバッファのメニューでユーザーがこの選択肢を選ぶと、
使用するデフォルト値をまず指定する。
<P>

もちろん、オプションの実際の値がこの選択肢に合えば、
<VAR>default</VAR>ではなく実際の値が表示される。
<P>

選択肢の値として<CODE>nil</CODE>が不正であるときには、
<CODE>:value</CODE>で正当なデフォルトを指定することが本質的である。
<P>

<DT><CODE>:format <VAR>format-string</VAR></CODE>
<DD>この文字列は、型に対応する値を表現するためにバッファに挿入される。
<VAR>format-string</VAR>には、以下に示す`<SAMP>%</SAMP>'を使える。
<P>

<DL COMPACT>
<DT>`<SAMP>%[<VAR>button</VAR>%]</SAMP>'
<DD>ボタンとして印を付けたテキスト<VAR>button</VAR>を表示する。
<CODE>:action</CODE>属性は、ユーザーがボタンを起動したらなにを行うかを指定する。
その値は2つの引数、つまり、ボタンが現れるウィジェットとイベント
を取る関数であること。
<P>

異なるアクションを有する異なるボタンを指定する方法はない。
<P>

<DT>`<SAMP>%{<VAR>sample</VAR>%}</SAMP>'
<DD><CODE>:sample-face</CODE>で指定した特別なフェイスで<VAR>sample</VAR>を表示する。
<P>

<DT>`<SAMP>%v</SAMP>'
<DD>項目の値で置き換える。
値の表示方法は項目の種類と、
（変数の）カスタマイズ型に依存する。
<P>

<DT>`<SAMP>%d</SAMP>'
<DD>項目の説明文字列で置き換える。
<P>

<DT>`<SAMP>%h</SAMP>'
<DD>`<SAMP>%d</SAMP>'と同様だが、説明文字列が1行を超えるときには、
説明文字列全体を表示するか先頭行だけを表示するかを
制御するアクティブフィールドを追加する。
<P>

<DT>`<SAMP>%t</SAMP>'
<DD>タグで置き換える。
タグは<CODE>:tag</CODE>キーワードで指定する。
<P>

<DT>`<SAMP>%%</SAMP>'
<DD>`<SAMP>%</SAMP>'をそのまま表示する。
</DL>
<P>

<DT><CODE>:action <VAR>action</VAR></CODE>
<DD>ユーザーがボタンをクリックしたら<VAR>action</VAR>を行う。
<P>

<DT><CODE>:button-face <VAR>face</VAR></CODE>
<DD>`<SAMP>%[<small>...</small>%]</SAMP>'で表示するボタンテキストに
フェイス<VAR>face</VAR>（フェイス名かフェイス名のリスト）を使う。
<P>

<DT><CODE>:button-prefix <VAR>prefix</VAR></CODE>
<DD><DT><CODE>:button-suffix <VAR>suffix</VAR></CODE>
<DD>これらは、以下のようにボタンの前後に表示するテキストを指定する。
<P>

<DL COMPACT>
<DT><CODE>nil</CODE>
<DD>テキストを挿入しない。
<P>

<DT>文字列
<DD>文字列をそのまま挿入する。
<P>

<DT>シンボル
<DD>シンボルの値を使う。
</DL>
<P>

<DT><CODE>:tag <VAR>tag</VAR></CODE>
<DD>この型に対応する値（やその一部）に対するタグとして
<VAR>tag</VAR>（文字列）を使う
<P>

<DT><CODE>:doc <VAR>doc</VAR></CODE>
<DD>この型に対応する値（やその一部）に対する説明文字列として
<VAR>doc</VAR>を使う。
これが動作するためには、
<CODE>:format</CODE>の値を指定し、かつ、
その値の中で`<SAMP>%d</SAMP>'や`<SAMP>%h</SAMP>'を使う必要がある。
<P>

型に対して説明文字列を指定するのは、
<CODE>:choice</CODE>の選択肢や他の複合型の一部の意味について
より多くの情報をユーザーに与えるためである。
<P>

<DT><CODE>:help-echo <VAR>motion-doc</VAR></CODE>
<DD><CODE>widget-forward</CODE>や<CODE>widget-backward</CODE>でこの項目に移動すると、
エコー領域に文字列<VAR>motion-doc</VAR>を表示する。
<P>

<DT><CODE>:match <VAR>function</VAR></CODE>
<DD>値がこの型に一致することを調べる方法を指定する。
対応する値<VAR>function</VAR>は、2つの引数、つまり、
ウィジェットと値を取る関数であること。
受理できる値の場合には<CODE>nil</CODE>以外を返すこと。
<P>

</DL>
<A NAME="Loading"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[ &lt;&lt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[ &gt;&gt; ]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp.html#SEC_Top">表紙</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_toc.html#SEC_Contents">目次</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="elisp_48.html#SEC681">索引</A>]</TD>
<TD> [<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=search">検索</a>] [<a href="#top">上端</a> / <a href="#bottom">下端</a>]</TD></TR></TABLE>
<a name="bottom"> </a>
<script type="text/javascript" src="style2.js"></script>
<div class="footer">
    <br>
    このページはMeadow (Emacs) の紹介ページです <br>
このWebページの各文書は自由にリンク・複製・再配布・改変していただいて構いません．
<br>ただし，複製・再配布・改変の場合は Meadow Memo のURLを記載しておいて下さい．<br>
<a href="http://www.bookshelf.jp/cgi-bin/goto.cgi?file=meadow&node=about%20link">Medow memoへのリンクについて</a>．<br>

間違い，要望等があれば<a href="mailto:akihisa@mail.ne.jp">akihisa@mail.ne.jp</a> か下記でどうぞ<br>

<br>

<FORM METHOD="post" ACTION="http://www.bookshelf.jp/cgi-bin/wwwmail.cgi" >
お名前：<INPUT TYPE="text" NAME="name" SIZE="30" MAXLENGTH="40" VALUE="ななしさん"><br>
メールアドレス：<INPUT TYPE="text" NAME="EMAIL" SIZE="25" MAXLENGTH="60" VALUE="secret@mail.adr"><br>
<input type="hidden" name="HPAGE" value="">
つっこみ：<br><TEXTAREA NAME="MESSAGE" ROWS="5" COLS="50">
</TEXTAREA><br><br>
<INPUT TYPE="submit" VALUE="送信">
<INPUT TYPE="reset" VALUE="クリア">
</FORM>

<br><A HREF="http://www.bookshelf.jp/cgi-bin/xct.cgi">ページ別カウンタ</a>
<br> Since 2002/12/13 <br>
</div>

</BODY>

</HTML>
